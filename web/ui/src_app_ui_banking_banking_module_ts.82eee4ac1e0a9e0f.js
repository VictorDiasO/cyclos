"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([["src_app_ui_banking_banking_module_ts"],{2436:(ex,It,m)=>{m.r(It),m.d(It,{BankingModule:()=>Ky});var ce=m(5300),s=m(3075),$=m(2614),v=m(6243),e=m(6435),p=m(520),K=m(1352),d=m(8637),f=m(2198),c=m(4850),ee=m(297);let an=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getUserAccountVisibilityData$Response(t,i){const o=new d.c(this.rootUrl,n.GetUserAccountVisibilityDataPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getUserAccountVisibilityData(t,i){return this.getUserAccountVisibilityData$Response(t,i).pipe((0,c.U)(o=>o.body))}saveUserAccountVisibility$Response(t,i){const o=new d.c(this.rootUrl,n.SaveUserAccountVisibilityPath,"put");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}saveUserAccountVisibility(t,i){return this.saveUserAccountVisibility$Response(t,i).pipe((0,c.U)(o=>o.body))}setUserAccountVisibilityAsVisible$Response(t,i){const o=new d.c(this.rootUrl,n.SetUserAccountVisibilityAsVisiblePath,"post");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setUserAccountVisibilityAsVisible(t,i){return this.setUserAccountVisibilityAsVisible$Response(t,i).pipe((0,c.U)(o=>o.body))}setUserAccountVisibilityAsHidden$Response(t,i){const o=new d.c(this.rootUrl,n.SetUserAccountVisibilityAsHiddenPath,"post");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setUserAccountVisibilityAsHidden(t,i){return this.setUserAccountVisibilityAsHidden$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserAccountVisibilityDataPath="/{user}/account-visibility",n.SaveUserAccountVisibilityPath="/{user}/account-visibility",n.SetUserAccountVisibilityAsVisiblePath="/{user}/account-visibility/{accountType}/show",n.SetUserAccountVisibilityAsHiddenPath="/{user}/account-visibility/{accountType}/hide",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var A=m(1963),Z=m(2032),u=m(9808),oe=m(9653),rn=m(9238),J=m(8868),L=m(6903),k=m(1556);function sn(n,a){if(1&n&&e._UZ(0,"user-info",8),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function cn(n,a){if(1&n&&e._UZ(0,"field-option",9),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("value",t.type.id)("id",t.type.id)("internalName",t.type.internalName)("text",i.getDisplay(t))("disabled",!t.canHide)}}function ln(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",4),e._uU(2),e.qZA(),e.YNc(3,sn,1,1,"user-info",5),e.TgZ(4,"checkbox-group-field",6),e.YNc(5,cn,1,5,"field-option",7),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij("",t.i18n.account.visibilitySettings.information," "),e.xp6(1),e.Q6J("ngIf",t.data.user&&!t.isSelf),e.xp6(1),e.Q6J("formControl",t.accounts)("label",t.i18n.account.visibilitySettings.accounts),e.xp6(1),e.Q6J("ngForOf",t.data.accounts)}}let un=(()=>{class n extends $.y{constructor(t,i){super(t),this.accountVisibilityService=i}ngOnInit(){super.ngOnInit(),this.userParam=this.route.snapshot.params.user,this.accountVisibilityService.getUserAccountVisibilityData({user:this.userParam}).subscribe(i=>this.data=i)}onDataInitialized(t){this.isSelf=this.authHelper.isSelf(t.user);const i=t.accounts.filter(o=>o.visible).map(o=>o.type.id);this.accounts=new s.NI(i)}getDisplay(t){return t.number?t.type.name+" - "+t.number:t.type.name}save(){this.addSub(this.accountVisibilityService.saveUserAccountVisibility({user:this.userParam,body:{accounts:this.accounts.value}}).subscribe(()=>{this.isSelf?this.addSub(this.dataForFrontendHolder.reload().subscribe(()=>{this.menu.setActiveMenu(v.v2.ACCOUNT_VISIBILTIY),this.notification.snackBar(this.i18n.account.visibilitySettings.saved)})):(this.notification.snackBar(this.i18n.account.visibilitySettings.saved),this.reload())}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.ACCOUNT_VISIBILTIY)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(an))},n.\u0275cmp=e.Xpm({type:n,selectors:[["account-visibility-settings"]],features:[e.qOj],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading"],[4,"ngIf"],[3,"disabled","label","action"],[1,"mb-3"],[3,"user",4,"ngIf"],[3,"formControl","label"],[3,"value","id","internalName","text","disabled",4,"ngFor","ngForOf"],[3,"user"],[3,"value","id","internalName","text","disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.YNc(3,ln,6,5,"ng-container",2),e.TgZ(4,"actions")(5,"action-button",3),e.NdJ("action",function(){return i.save()}),e.ALo(6,"async"),e.qZA()()()()),2&t&&(e.Q6J("ready",e.lcZ(1,6,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.account.visibilitySettings.title)("mobileHeading",i.i18n.account.visibilitySettings.mobileTitle),e.xp6(1),e.Q6J("ngIf",i.data),e.xp6(2),e.Q6J("disabled",e.lcZ(6,8,i.requesting$))("label",i.i18n.general.save))},directives:[A.w,Z.Y,u.O5,oe.M,rn.S,s.JJ,s.oH,u.sg,J.s,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var ot=m(1706),x=m(1879),b=m(7e3),h=m(6163),ae=m(2292),y=m(591),pn=m(567),yt=m(9376),N=m(2568),C=m(195),Q=m(7107),O=m(7816),be=m(5255),j=m(8170),B=m(2479),F=m(3728),te=m(8747),fe=m(9998),Ze=m(7072),q=m(7947),w=m(2180);function mn(n,a){1&n&&e._UZ(0,"hr",7)}const dn=function(n){return{"status-label-last":n}};function fn(n,a){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(2,dn,!t.account.user||!t.showUser)),e.xp6(1),e.hij(" ",t.account.type.name," ")}}function _n(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._UZ(4,"user-link",11),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.general.user," "),e.xp6(2),e.Q6J("user",t.account.user)}}function hn(n,a){1&n&&e._UZ(0,"hr")}function gn(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"currency"),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.amount,i.currency)," ")}}const yn=function(n,a,t){return{negative:n,positive:a,"status-value-last":t}};function xn(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",12)(2,"span",13),e._uU(3),e.qZA()(),e.TgZ(4,"div",14),e.YNc(5,gn,3,4,"ng-container",5),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=a.last,o=e.oxw(2);e.xp6(1),e.Q6J("ngClass",i?"status-label-last":""),e.xp6(2),e.Oqu(t.label),e.xp6(1),e.Q6J("ngClass",e.kEZ(4,yn,!t.skipColor&&(t.alwaysNegative||o.format.isNegative(t.amount)),!t.skipColor&&!t.alwaysNegative&&o.format.isPositive(t.amount),i)),e.xp6(1),e.Q6J("ngIf",t.amount)}}function bn(n,a){if(1&n&&(e.TgZ(0,"div",1),e.YNc(1,mn,1,0,"hr",2),e.TgZ(2,"div",3),e.YNc(3,fn,2,4,"div",4),e.YNc(4,_n,5,2,"ng-container",5),e.YNc(5,hn,1,0,"hr",5),e.YNc(6,xn,6,8,"ng-container",6),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.showSeparator),e.xp6(2),e.Q6J("ngIf",t.showAccount),e.xp6(1),e.Q6J("ngIf",t.account.user&&t.showUser),e.xp6(1),e.Q6J("ngIf",t.showAccount||t.account.user&&t.showUser),e.xp6(1),e.Q6J("ngForOf",t.indicators$.value)}}let vn=(()=>{class n extends q.H{constructor(t){super(t),this.mode="current",this._showAccount=!1,this._showUser=!1,this._showSeparator=!1,this.indicators$=new y.X(null)}get showAccount(){return this._showAccount}set showAccount(t){this._showAccount=(0,h.Iw)(t)}get showUser(){return this._showUser}set showUser(t){this._showUser=(0,h.Iw)(t)}get showSeparator(){return this._showSeparator}set showSeparator(t){this._showSeparator=(0,h.Iw)(t)}ngOnInit(){this.updateIndicators()}get status(){return this.account.status}get currency(){return this.account.currency}updateIndicators(){const t=[],i=this.status,o=(r,l,_=!1,g=!1)=>{r&&t.push({label:l,amount:r,alwaysNegative:!this.format.isZero(r)&&_,skipColor:g})};if("current"===this.mode)o(i.balance,this.i18n.account.balance),i.availableBalance!==i.balance&&o(i.availableBalance,this.i18n.account.availableBalance),i.reservedAmount&&!this.format.isZero(i.reservedAmount)&&o(i.reservedAmount,this.i18n.account.reservedAmount,!0),i.creditLimit&&!this.format.isZero(i.creditLimit)&&o(i.creditLimit,this.i18n.account.negativeLimit,!1,!0),i.upperCreditLimit&&!this.format.isZero(i.upperCreditLimit)&&o(i.upperCreditLimit,this.i18n.account.positiveLimit,!1,!0);else{if(this.layout.gtxxs&&null!=i.balanceAtBegin&&o(i.balanceAtBegin,this.i18n.account.balanceOn(this.format.formatAsDate(i.beginDate))),this.layout.gtxxs&&null!=i.balanceAtEnd&&o(i.balanceAtEnd,this.i18n.account.balanceOn(this.format.formatAsDate(i.endDate))),null!=i.incoming&&i.incoming.sum&&o(i.incoming.sum,this.i18n.account.totalIncome),null!=i.outgoing&&i.outgoing.sum){let r=i.outgoing.sum;this.format.isZero(r)||(r="-"+r),o(r,this.i18n.account.totalOutflow)}null!=i.netInflow&&o(i.netInflow,this.i18n.account.netInflow)}this.indicators$.next(t)}ngOnChanges(t){(t.mode||t.account||t.showAccount)&&this.updateIndicators()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["account-status-view"]],inputs:{account:"account",mode:"mode",showAccount:"showAccount",showUser:"showUser",showSeparator:"showSeparator"},features:[e.qOj,e.TTD],decls:2,vars:3,consts:[["class","container mw-100 px-0",4,"ngIf"],[1,"container","mw-100","px-0"],["class","mt-0",4,"ngIf"],[1,"row","no-gutters"],["class","status-label col-12",3,"ngClass",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mt-0"],[1,"status-label","col-12",3,"ngClass"],[1,"status-label","col-6","col-md-3","mb-0"],[1,"status-label","col-6","col-md-9","mb-0"],[3,"user"],[1,"status-label","col-6","col-sm-3",3,"ngClass"],[1,"ellipsis"],[1,"status-value","col-6","col-sm-3",3,"ngClass"]],template:function(t,i){if(1&t&&(e.YNc(0,bn,7,5,"div",0),e.ALo(1,"async")),2&t){let o;e.Q6J("ngIf",(null==(o=e.lcZ(1,1,i.indicators$))?null:o.length)>0)}},directives:[u.O5,u.mk,Q.F,u.sg],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var ne=m(3812),D=m(8687),R=m(1441),V=m(629),Y=m(1015),Pe=m(867),ve=m(1873),E=m(3030);function Tn(n,a){1&n&&e.GkF(0)}function wn(n,a){1&n&&e._UZ(0,"div",15)}function Cn(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",15)(2,"label-value",16),e._UZ(3,"user-link",17),e.qZA()(),e.YNc(4,wn,1,0,"div",12),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.account.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function An(n,a){if(1&n&&e._UZ(0,"field-option",20),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t)("text",t.name)}}function Zn(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"single-selection-field",18),e.YNc(2,An,1,3,"field-option",19),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.general.period),e.xp6(1),e.Q6J("ngForOf",t.data.preselectedPeriods)}}function Pn(n,a){if(1&n&&e._UZ(0,"field-option",20),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t.id)("text",t.name)}}function qn(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"multi-selection-field",21),e.YNc(2,Pn,1,3,"field-option",19),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.account.transferFilter),e.xp6(1),e.Q6J("ngForOf",t.data.transferFilters)}}function Sn(n,a){1&n&&e._UZ(0,"div",15)}function Qn(n,a){if(1&n&&e.YNc(0,Sn,1,0,"div",12),2&n){const t=e.oxw(3);e.Q6J("ngIf",t.layout.gtsm$)}}function Un(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"date-field",22),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.general.beginDate)("minDate",t.data.archivingDate)}}function Nn(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"date-field",23),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.general.endDate)("minDate",t.data.archivingDate)}}function In(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"input-field",36),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.description)}}function Jn(n,a){if(1&n&&e._UZ(0,"field-option",39),2&n){const t=a.$implicit,i=e.oxw(5);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function Ln(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"multi-selection-field",37),e.YNc(2,Jn,1,5,"field-option",38),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function kn(n,a){if(1&n&&e._UZ(0,"field-option",42),2&n){const t=a.$implicit;e.Q6J("id",t.id)("internalName",t.internalName)("value",t.internalName)("text",t.name)}}function Fn(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"multi-selection-field",40),e.YNc(2,kn,1,4,"field-option",41),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.transaction.channel),e.xp6(1),e.Q6J("ngForOf",t.data.channels)}}function On(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"input-field",43),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("mask",t.data.transactionNumberMask)("label",t.i18n.transaction.number)}}function Dn(n,a){if(1&n&&e._UZ(0,"field-option",46),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.display)}}function Rn(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"single-selection-field",44),e.YNc(2,Dn,1,2,"field-option",45),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.operator)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.data.operators)}}function Vn(n,a){if(1&n&&e._UZ(0,"field-option",49),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)("internalName",t.internalName)("id",t.id)}}function Yn(n,a){if(1&n&&(e.TgZ(0,"div",15)(1,"single-selection-field",47),e.YNc(2,Vn,1,4,"field-option",48),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(4);e.xp6(1),e.Q6J("formControl",i.statusForm.get(t.id))("label",t.name)("emptyOption",i.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.statuses)}}function En(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"custom-field-filter",50),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(4);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function $n(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",15),e._UZ(2,"decimal-field",24),e.qZA(),e.TgZ(3,"div",15),e._UZ(4,"decimal-field",25),e.qZA(),e.YNc(5,In,2,1,"div",12),e.TgZ(6,"div",15)(7,"single-selection-field",26),e._UZ(8,"field-option",27)(9,"field-option",28),e.qZA()(),e.YNc(10,Ln,3,3,"div",12),e.YNc(11,Fn,3,3,"div",12),e.TgZ(12,"div",15),e._UZ(13,"user-field",29),e.qZA(),e.YNc(14,On,2,2,"div",12),e.YNc(15,Rn,3,3,"div",12),e.YNc(16,Yn,3,4,"div",30),e.YNc(17,En,2,2,"div",30),e.TgZ(18,"div",15)(19,"single-selection-field",31),e._UZ(20,"field-option",32)(21,"field-option",33)(22,"field-option",34)(23,"field-option",35),e.qZA()(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("label",t.i18n.account.minAmount)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),e.xp6(2),e.Q6J("label",t.i18n.account.maxAmount)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),e.xp6(1),e.Q6J("ngIf",t.data.showDescriptionInFilters),e.xp6(2),e.Q6J("label",t.i18n.account.direction)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("text",t.i18n.account.incoming),e.xp6(1),e.Q6J("text",t.i18n.account.outgoing),e.xp6(1),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.channels?null:t.data.channels.length)>1),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("ngIf",t.data.transactionNumberMask),e.xp6(1),e.Q6J("ngIf",(null==t.data.operators?null:t.data.operators.length)>0),e.xp6(1),e.Q6J("ngForOf",t.data.transferStatusFlows),e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch),e.xp6(2),e.Q6J("label",t.i18n.general.orderBy),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.dateDesc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.dateAsc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.amountAsc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.amountDesc)}}const Bn=function(n){return{"border-0":n}};function Hn(n,a){if(1&n&&(e.TgZ(0,"div",10),e.ALo(1,"async"),e.TgZ(2,"div",11),e.YNc(3,Cn,5,3,"ng-container",6),e.YNc(4,Zn,3,2,"div",12),e.YNc(5,qn,3,2,"div",13),e.ALo(6,"async"),e.YNc(7,Qn,1,1,"ng-template",null,14,e.W1O),e.YNc(9,Un,2,2,"div",12),e.ALo(10,"async"),e.YNc(11,Nn,2,2,"div",12),e.ALo(12,"async"),e.YNc(13,$n,24,25,"ng-container",6),e.ALo(14,"async"),e.qZA()()),2&n){const t=e.MAs(8),i=e.oxw(2);let o,r;e.Q6J("formGroup",i.form)("ngClass",e.VKq(19,Bn,e.lcZ(1,9,i.noStatus$))),e.xp6(3),e.Q6J("ngIf",i.data.account.user&&!i.self),e.xp6(1),e.Q6J("ngIf",(null==i.data.preselectedPeriods?null:i.data.preselectedPeriods.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(6,11,i.layout.gtxxs$)&&(null==i.data.transferFilters?null:i.data.transferFilters.length)>0)("ngIfElse",t),e.xp6(4),e.Q6J("ngIf",null==(null==(o=i.form.value||e.lcZ(10,13,i.form.valueChanges))||null==o.preselectedPeriod?null:o.preselectedPeriod.begin)),e.xp6(2),e.Q6J("ngIf",null==(null==(r=i.form.value||e.lcZ(12,15,i.form.valueChanges))||null==r.preselectedPeriod?null:r.preselectedPeriod.end)),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,17,i.layout.gtxxs$))}}function jn(n,a){if(1&n&&(e._UZ(0,"account-status-view",52),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async")),2&n){const t=e.oxw(3);e.Q6J("account",t.status$.value)("mode",e.lcZ(1,5,t.moreFilters$)?"period":"current")("showSeparator",e.lcZ(2,7,t.showForm$))("showAccount",e.lcZ(3,9,t.layout.xxs$)&&t.multipleAccounts)("showUser",!t.self&&!1===e.lcZ(4,11,t.showForm$))}}function Mn(n,a){1&n&&e._UZ(0,"spinner")}function zn(n,a){if(1&n&&(e.ynx(0),e.YNc(1,jn,5,13,"account-status-view",51),e.ALo(2,"async"),e.ALo(3,"async"),e.YNc(4,Mn,1,0,"spinner",6),e.ALo(5,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.status$)&&(e.lcZ(3,4,t.layout.gtxxs$)||0===(null==t.results?null:t.results.page))),e.xp6(3),e.Q6J("ngIf",null===e.lcZ(5,6,t.status$))}}function Gn(n,a){if(1&n&&(e.TgZ(0,"mobile-result",53)(1,"div",54),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",i.avatarImage(t))("avatarIcon",i.avatarIcon(t))("date",t.date)("amount",t.amount)("currency",i.currency),e.xp6(2),e.hij(" ",i.subjectName(t)," ")}}function Wn(n,a){if(1&n&&(e.TgZ(0,"th",60),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.general.description,"")}}function Xn(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.transferStatus,"")}}function Kn(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ei(n,a){if(1&n&&(e.TgZ(0,"a",63),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",i.truncate(t.description,100)," ")}}function ti(n,a){if(1&n&&(e.TgZ(0,"td"),e.YNc(1,ei,2,2,"a",65),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.description)}}function ni(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.statuses(t)," ")}}function ii(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",66),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)}}const oi=function(n,a){return{positive:n,negative:a}};function ai(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",61),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(2,"td",56),e._UZ(3,"avatar",62),e.qZA(),e.TgZ(4,"td")(5,"a",63),e._uU(6),e.ALo(7,"date"),e.qZA()(),e.TgZ(8,"td")(9,"a",63),e._uU(10),e.qZA()(),e.YNc(11,ti,2,1,"td",6),e.ALo(12,"async"),e.YNc(13,ni,2,1,"td",6),e.YNc(14,ii,2,4,"td",58),e.TgZ(15,"td",59)(16,"a",64),e._uU(17),e.ALo(18,"currency"),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",i.avatarImage(t))("icon",i.avatarIcon(t)),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",e.lcZ(7,12,t.date)," "),e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",i.subjectName(t)," "),e.xp6(1),e.Q6J("ngIf",i.data.showDescriptionInList&&e.lcZ(12,14,i.layout.gtsm$)),e.xp6(2),e.Q6J("ngIf",(null==i.data.transferStatusFlows?null:i.data.transferStatusFlows.length)>0),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(2),e.Q6J("routerLink",i.path(t))("ngClass",e.WLB(20,oi,i.format.isPositive(t.amount),i.format.isNegative(t.amount))),e.xp6(1),e.hij(" ",e.Dn7(18,16,t.amount,i.currency,!0)," ")}}function ri(n,a){if(1&n&&(e.TgZ(0,"table",55)(1,"thead"),e._UZ(2,"th",56),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.YNc(7,Wn,2,1,"th",57),e.ALo(8,"async"),e.YNc(9,Xn,2,1,"th",6),e.YNc(10,Kn,2,1,"th",58),e.TgZ(11,"th",59),e._uU(12),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,ai,19,23,"ng-container",58),e.ALo(15,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.transaction.fromTo),e.xp6(1),e.Q6J("ngIf",t.data.showDescriptionInList&&e.lcZ(8,7,t.layout.gtsm$)),e.xp6(2),e.Q6J("ngIf",(null==t.data.transferStatusFlows?null:t.data.transferStatusFlows.length)>0),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(15,9,t.results$))?null:i.results)}}function si(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Hn,15,21,"div",5),e.ALo(4,"async"),e.YNc(5,zn,6,8,"ng-container",6),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"results-layout",7),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(8,"async"),e.YNc(9,Gn,3,6,"mobile-result",8),e.YNc(10,ri,16,11,"table",9),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",e.lcZ(1,8,t.layout.xxs$)?t.i18n.account.mobileTitle.account:t.title)("headingActions",e.lcZ(2,10,t.headingActions$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(4,12,t.showForm$)),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(6,14,t.noStatus$)),e.xp6(2),e.Q6J("results",e.lcZ(8,16,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}function ci(n,a){1&n&&e._UZ(0,"spinner",67)}let li=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.accountsService=i,this.bankingHelper=o,this.truncate=h.$G,this.status$=new y.X(null),this.noStatus$=new y.X(!1),this.showForm$=new y.X(!1)}get type(){return null==this.data?null:this.data.account.type}get number(){return null==this.data?null:this.data.account.number}get currency(){return null==this.data?null:this.data.account.currency}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}get transferFilters(){return null==this.data?null:this.data.transferFilters}get title(){const t=this.type;if(null==t)return this.i18n.account.mobileTitle.account;const i=this.layout.ltsm?null:this.number;return null==i?t.name:t.name+" - "+i}getFormControlNames(){return["transferFilters","preselectedPeriod","periodBegin","periodEnd","minAmount","maxAmount","transactionNumber","direction","user","by","groups","channels","description","orderBy","customFields"]}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.params;this.ownerParam=t.owner,this.typeParam=t.type,this.self=this.authHelper.isSelf(this.ownerParam),this.multipleAccounts=this.accountTypes.length>1,this.stateManager.cache("data",this.accountsService.getAccountHistoryDataByOwnerAndType({owner:this.ownerParam,accountType:this.typeParam})).subscribe(i=>this.data=i)}prepareForm(t){this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields)),this.bankingHelper.preProcessPreselectedPeriods(t,this.form),this.statusForm=new s.cw({});for(const i of t.transferStatusFlows||[])this.statusForm.addControl(i.id,new s.NI(null));this.form.addControl("statuses",this.statusForm)}onDataInitialized(t){super.onDataInitialized(t),this.exportActions=this.exportHelper.headingActions(t.exportFormats,i=>this.accountsService.exportAccountHistory$Response(Object.assign({format:i.internalName},this.toSearchParams(this.form.value)))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateShowForm(t))),this.addSub(this.moreFilters$.subscribe(()=>this.updateShowForm(t))),this.updateShowForm(t)}updateShowForm(t){this.showForm$.next(this.layout.xxs&&!(0,h.cS)(t.preselectedPeriods)||this.moreFilters)}toSearchParams(t){const i=t,o=t.statuses;return i.datePeriod=this.bankingHelper.resolveDatePeriod(t),i.amountRange=b.S.rangeFilter(t.minAmount,t.maxAmount),i.fields=[],i.owner=this.ownerParam,i.accountType=this.typeParam,i.statuses=Object.values(o),i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i}doSearch(t){const i=this.accountsService.searchAccountHistory$Response(t),o=this.accountsService.getAccountStatusByOwnerAndType(Object.assign(Object.assign({},t),{fields:["status"]}));return(0,pn.D)([i,o]).pipe((0,c.U)(r=>{const[l,_]=r,g=Object.assign(Object.assign({},this.data.account),{status:null==_?void 0:_.status});return null==g.status?(this.noStatus$.next(!0),this.moreFilters=!0,this.headingActions=this.exportActions):this.headingActions=[this.moreFiltersAction,...this.exportActions],this.status$.next(g),l}))}get accountTypes(){return(((this.login.auth||{}).permissions||{}).banking.accounts.filter(i=>!1!==i.visible)||[]).map(i=>i.account.type)}subjectName(t){var i;return null!==(i=t.relatedName)&&void 0!==i?i:this.bankingHelper.subjectName(t.relatedAccount)}path(t){return["/banking","transfer",this.data.account.id,this.bankingHelper.transactionNumberOrId(t)]}avatarIcon(t){return"user"===t.relatedAccount.kind?x.l.PersonCircle:x.l.Briefcase}avatarImage(t){return t.image?t.image:"user"===t.relatedAccount.kind?t.relatedAccount.user.image:null}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return t=>this.path(t)}resolveMenu(t){const i=new v.oX(v.v2.ACCOUNT_HISTORY,{accountType:t.account.type});return t.account.kind===ot.S.SYSTEM?i:this.menu.userMenu(t.account.user,i)}statuses(t){if(0===Object.keys(t.statuses||{}).length)return"";const o=[];for(const r of this.data.transferStatusFlows){const l=t.statuses[r.id]||t.statuses[r.internalName];if(l){const _=r.statuses.find(g=>[g.id,g.internalName].includes(l));_&&o.push(_.name)}}return o.join(", ")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(yt.i),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["account-history"]],features:[e.qOj],decls:8,vars:7,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],["class","filters-form",3,"formGroup","ngClass",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form",3,"formGroup","ngClass"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf","ngIfElse"],["noTransferFilters",""],[1,"col-12","col-md-6"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["formControlName","transferFilters",3,"label"],["formControlName","periodBegin","maxDate","todayEnd","fieldSize","full",3,"label","minDate"],["formControlName","periodEnd","maxDate","todayEnd","fieldSize","full",3,"label","minDate"],["formControlName","minAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["formControlName","maxAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["formControlName","user",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["type","text","formControlName","description",3,"label"],["hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["formControlName","transactionNumber",3,"mask","label"],["formControlName","by",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"formControl","label","emptyOption"],[3,"value","text","internalName","id",4,"ngFor","ngForOf"],[3,"value","text","internalName","id"],[3,"field","formControl"],[3,"account","mode","showSeparator","showAccount","showUser",4,"ngIf"],[3,"account","mode","showSeparator","showAccount","showUser"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","40%",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"amount"],["width","40%"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink","ngClass"],[3,"routerLink",4,"ngIf"],[3,"fields","plainText","fieldName","object"],[1,"p-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Tn,1,0,"ng-container",1),e.qZA(),e.YNc(4,si,11,18,"ng-template",null,2,e.W1O),e.YNc(6,ci,1,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(5);e.Q6J("ready",e.lcZ(1,3,i.noStatus$)||e.lcZ(2,5,i.status$)),e.xp6(3),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,u.mk,C.t,Q.F,O.f,s.JJ,s.u,u.sg,J.s,be.x,j.Q,B.U,F.q,te.l,fe.h,s.oH,Ze.L,vn,ne.O,D.D,R.E,V.t,Y.p,Pe.A,ce.yS,ve.x],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();var Jt=m(6897),ui=m(1086),at=m(1321);function pi(n,a){if(1&n&&e._UZ(0,"user-info",8),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function mi(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"single-selection-field",14),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.general.currency)("fieldOptions",t.currencyOptions)}}function di(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"boolean-field",15),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.account.nonZeroBalance)}}function fi(n,a){if(1&n&&(e.TgZ(0,"div",9)(1,"div",10)(2,"div",11),e._UZ(3,"input-field",12),e.qZA(),e.YNc(4,mi,2,3,"div",13),e.YNc(5,di,2,1,"div",13),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.general.keywords),e.xp6(1),e.Q6J("ngIf",t.currencyOptions.length>1),e.xp6(1),e.Q6J("ngIf",t.anyHasBalance)}}function _i(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",16)(2,"div")(3,"div",17),e._uU(4),e.qZA(),e.TgZ(5,"div",18),e._uU(6),e.ALo(7,"currency"),e.qZA()()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(4),e.Oqu(t.type.name),e.xp6(2),e.AsE(" ",i.i18n.account.balance,": ",e.xi3(7,3,t.status.balance,t.currency),"")}}function hi(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",22),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(3);return _.router.navigate(_.path(l.type)),o.stopPropagation()}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",20),e._uU(4),e.ALo(5,"currency"),e.qZA()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.type.name),e.xp6(2),e.hij(" ",e.xi3(5,2,t.status.balance,t.currency),"")}}function gi(n,a){if(1&n&&(e.TgZ(0,"table",19)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th",20),e._uU(5),e.qZA()(),e.TgZ(6,"tbody"),e.YNc(7,hi,6,5,"tr",21),e.ALo(8,"async"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.account.account),e.xp6(2),e.Oqu(t.i18n.account.balance),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,3,t.results$).results)}}function yi(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.YNc(2,pi,1,1,"user-info",3),e.YNc(3,fi,6,4,"div",4),e.qZA(),e.TgZ(4,"results-layout",5),e.ALo(5,"async"),e.YNc(6,_i,8,6,"mobile-result",6),e.YNc(7,gi,9,5,"table",7),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode",!t.self||t.showFilters?"filters":"emptyFilters")("heading",t.i18n.account.title.accountsSummary)("mobileHeading",t.i18n.account.mobileTitle.accountsSummary),e.xp6(1),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("ngIf",t.showFilters),e.xp6(1),e.Q6J("results",e.lcZ(5,7,t.results$))("toLink",t.toLink)}}let bi=(()=>{class n extends ae.t{constructor(t,i){super(t),this.accountsService=i}getFormControlNames(){return["keywords","currency","nonZeroBalance"]}doSearch(t){var i=this.data.accounts.filter(o=>{var r,l,_;const g=null===(l=null===(r=(0,h.US)(t.keywords))||void 0===r?void 0:r.trim())||void 0===l?void 0:l.toLowerCase();return!(!(0,h.cS)(g)&&![o.currency.name,o.currency.symbol,o.type.name].find(S=>{var I;return null===(I=(0,h.US)(S))||void 0===I?void 0:I.toLowerCase().includes(g)})||t.currency&&o.currency.id!==t.currency||t.nonZeroBalance&&(!(null===(_=o.status)||void 0===_?void 0:_.balance)||this.format.isZero(o.status.balance)))});return(0,ui.of)(new Jt.x(i).toHttpResponse())}toSearchParams(t){return t}ngOnInit(){super.ngOnInit(),this.owner=this.route.snapshot.params.owner,this.addSub(this.accountsService.getOwnerAccountsListData({owner:this.owner}).subscribe(t=>this.data=t))}onDataInitialized(t){var i,o,r;super.onDataInitialized(t),this.self=this.authHelper.isSelfOrOwner(t.user),this.showFilters=(null===(i=t.accounts)||void 0===i?void 0:i.length)>=11;const l=[],_=new Set;null===(o=t.accounts)||void 0===o||o.forEach(g=>{_.has(g.currency.id)||l.push(g.currency)}),l.sort((g,P)=>g.name.localeCompare(P.name)),this.currencyOptions=l.map(g=>({value:g.id,id:g.id,internalName:g.internalName,text:g.name})),this.anyHasBalance=!!(null===(r=t.accounts)||void 0===r?void 0:r.find(g=>{var P;return null!=(null===(P=g.status)||void 0===P?void 0:P.balance)}))}path(t){return["/banking",this.owner,"account",t.id]}get toLink(){return t=>this.path(t.type)}resolveMenu(){return b.S.SYSTEM===this.owner||b.S.SELF===this.owner?v.v2.ACCOUNTS_SUMMARY:this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(yt.i))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-accounts"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading"],[3,"user",4,"ngIf"],["class","filters-form filters-form-separator border-bottom",3,"formGroup",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","currency",3,"emptyOption","label","fieldOptions"],["labelPosition","side","formControlName","nonZeroBalance",3,"label"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,yi,8,9,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,oe.M,s.JL,s.sg,F.q,s.JJ,s.u,O.f,at.M,D.D,R.E,V.t,Y.p,u.sg],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var _e=m(2462),vi=m(3931),Me=m(8473),Ti=m(2868),wi=m(957),Ci=m(1112),Ai=m(6168);function Zi(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",3),e._uU(2),e.qZA(),e.TgZ(3,"div",4),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"div",5),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",6),e._uU(10),e.ALo(11,"currency"),e.qZA(),e.TgZ(12,"div",3),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"div",3),e._uU(16),e.qZA(),e.TgZ(17,"div",4),e._uU(18),e.ALo(19,"currency"),e.qZA(),e.TgZ(20,"div",5),e._uU(21),e.ALo(22,"currency"),e.qZA(),e.TgZ(23,"div",6),e._uU(24),e.ALo(25,"currency"),e.qZA(),e.TgZ(26,"div",3),e._uU(27),e.ALo(28,"currency"),e.qZA(),e.TgZ(29,"div",3),e._uU(30),e.qZA(),e.TgZ(31,"div",4),e._uU(32),e.qZA(),e.TgZ(33,"div",5),e._uU(34),e.qZA(),e.TgZ(35,"div",6),e._uU(36),e.qZA(),e.TgZ(37,"div",3),e._uU(38),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij(" ",t.i18n.account.userBalances.balancesSum," "),e.xp6(2),e.hij(" ",e.xi3(5,15,t.summary.low.sum,t.currency)," "),e.xp6(3),e.hij(" ",e.xi3(8,18,t.summary.medium.sum,t.currency)," "),e.xp6(3),e.hij(" ",e.xi3(11,21,t.summary.high.sum,t.currency)," "),e.xp6(3),e.hij(" ",t.totalSum(e.xi3(14,24,t.summary.total.sum,t.currency))," "),e.xp6(3),e.hij(" ",t.i18n.account.userBalances.balancesAverage," "),e.xp6(2),e.hij(" ",e.xi3(19,27,t.summary.low.average,t.currency)," "),e.xp6(3),e.hij(" ",e.xi3(22,30,t.summary.medium.average,t.currency)," "),e.xp6(3),e.hij(" ",e.xi3(25,33,t.summary.high.average,t.currency)," "),e.xp6(3),e.hij(" ",t.totalSum(e.xi3(28,36,t.summary.total.average,t.currency))," "),e.xp6(3),e.hij(" ",t.i18n.account.userBalances.balancesCount," "),e.xp6(2),e.hij(" ",t.summary.low.count," "),e.xp6(2),e.hij(" ",t.summary.medium.count," "),e.xp6(2),e.hij(" ",t.summary.high.count," "),e.xp6(2),e.hij(" ",t.totalSum(t.summary.total.count)," ")}}function Pi(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",7),e._uU(2),e.qZA(),e.TgZ(3,"div",8),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"div",7),e._uU(7),e.qZA(),e.TgZ(8,"div",8),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA(),e.TgZ(13,"div",8),e._uU(14),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij(" ",t.i18n.account.userBalances.balancesSum," "),e.xp6(2),e.hij(" ",e.xi3(5,6,t.summary.total.sum,t.currency)," "),e.xp6(3),e.hij(" ",t.i18n.account.userBalances.balancesAverage," "),e.xp6(2),e.hij(" ",e.xi3(10,9,t.summary.total.average,t.currency)," "),e.xp6(3),e.hij(" ",t.i18n.account.userBalances.balancesCount," "),e.xp6(2),e.hij(" ",t.summary.total.count," ")}}let qi=(()=>{class n extends q.H{constructor(t){super(t),this.hasYellowRange$=new y.X(!1)}get summary(){return this.summary$.value}ngOnInit(){this.summary$.subscribe(t=>this.hasYellowRange$.next(!!t.low))}totalSum(t){return this.i18n.account.userBalances.total+": "+t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["balances-summary"]],inputs:{summary$:"summary$",currency:"currency"},features:[e.qOj],decls:6,vars:6,consts:[[1,"mt-0","mb-0"],[1,"row","no-gutters","my-3"],[4,"ngIf"],[1,"col-12","col-sm-3"],[1,"col-12","col-sm-2","low-balance"],[1,"col-12","col-sm-2","medium-balance"],[1,"col-12","col-sm-2","high-balance"],[1,"col-6","col-sm-3"],[1,"col-6","col-sm-9"]],template:function(t,i){1&t&&(e._UZ(0,"hr",0),e.TgZ(1,"div",1),e.YNc(2,Zi,39,39,"ng-container",2),e.ALo(3,"async"),e.YNc(4,Pi,15,12,"ng-container",2),e.ALo(5,"async"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",e.lcZ(3,2,i.hasYellowRange$)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(5,4,i.hasYellowRange$)))},directives:[u.O5],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var Si=m(9244),Qi=m(6333);function Ui(n,a){1&n&&e.GkF(0)}function Ni(n,a){if(1&n&&e._UZ(0,"field-option",20),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t.id)("internalName",t.internalName)("text",t.name)}}function Ii(n,a){if(1&n&&e._UZ(0,"basic-profile-field-filter",22),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.field))}}function Ji(n,a){if(1&n&&e._UZ(0,"custom-field-filter",22),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.internalName))}}function Li(n,a){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,Ii,1,2,"basic-profile-field-filter",21),e.YNc(2,Ji,1,2,"custom-field-filter",21),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",!t.id),e.xp6(1),e.Q6J("ngIf",t.id)}}function ki(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"distance-selection-field",39),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("data",t.data.searchByDistanceData)("label",t.i18n.general.distanceFilter)}}function Fi(n,a){if(1&n&&e._UZ(0,"field-option",42),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function Oi(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"multi-selection-field",40),e.YNc(2,Fi,1,5,"field-option",41),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function Di(n,a){if(1&n&&e._UZ(0,"field-option",45),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function Ri(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"multi-selection-field",43),e.YNc(2,Di,1,4,"field-option",44),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.assignedProducts),e.xp6(1),e.Q6J("ngForOf",t.data.products)}}function Vi(n,a){if(1&n&&e._UZ(0,"field-option",45),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function Yi(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"multi-selection-field",46),e.YNc(2,Vi,1,4,"field-option",44),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.acceptedAgreements),e.xp6(1),e.Q6J("ngForOf",t.data.agreements)}}function Ei(n,a){if(1&n&&e._UZ(0,"field-option",45),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function $i(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"multi-selection-field",47),e.YNc(2,Ei,1,4,"field-option",44),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.notAcceptedAgreements),e.xp6(1),e.Q6J("ngForOf",t.data.agreements)}}function Bi(n,a){if(1&n&&e._UZ(0,"basic-profile-field-filter",22),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.field))}}function Hi(n,a){if(1&n&&e._UZ(0,"custom-field-filter",22),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.internalName))}}function ji(n,a){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,Bi,1,2,"basic-profile-field-filter",21),e.YNc(2,Hi,1,2,"custom-field-filter",21),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",!t.id),e.xp6(1),e.Q6J("ngIf",t.id)}}function Mi(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",23),e.TgZ(2,"div",7),e._UZ(3,"decimal-field",24),e.qZA(),e.TgZ(4,"div",7),e._UZ(5,"decimal-field",25),e.qZA(),e.TgZ(6,"div",7),e._UZ(7,"decimal-field",26),e.qZA(),e.TgZ(8,"div",7),e._UZ(9,"decimal-field",27),e.qZA(),e.YNc(10,ki,2,2,"div",28),e.YNc(11,Oi,3,3,"div",28),e.YNc(12,Ri,3,3,"div",28),e.YNc(13,Yi,3,3,"div",28),e.YNc(14,$i,3,3,"div",28),e.TgZ(15,"div",29)(16,"div",7),e._UZ(17,"date-field",30),e.qZA(),e.TgZ(18,"div",7),e._UZ(19,"date-field",31),e.qZA()(),e.TgZ(20,"div",29)(21,"div",7),e._UZ(22,"date-field",32),e.qZA(),e.TgZ(23,"div",7),e._UZ(24,"date-field",33),e.qZA()(),e.TgZ(25,"div",29)(26,"div",7),e._UZ(27,"date-field",34),e.qZA(),e.TgZ(28,"div",7),e._UZ(29,"date-field",35),e.qZA()(),e.TgZ(30,"div",29)(31,"div",7),e._UZ(32,"date-field",36),e.qZA(),e.TgZ(33,"div",7),e._UZ(34,"date-field",37),e.qZA()(),e.TgZ(35,"div",7),e._UZ(36,"user-field",38),e.qZA(),e.YNc(37,ji,3,2,"div",10),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("label",t.i18n.account.userBalances.minBalance)("scale",t.currencyDecimalDigits()),e.xp6(2),e.Q6J("label",t.i18n.account.userBalances.maxBalance)("scale",t.currencyDecimalDigits()),e.xp6(2),e.Q6J("label",t.i18n.account.userBalances.fromYellowBalance)("scale",0),e.xp6(2),e.Q6J("label",t.i18n.account.userBalances.toYellowBalance)("scale",0),e.xp6(1),e.Q6J("ngIf",t.data.searchByDistanceData),e.xp6(1),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.products?null:t.data.products.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.agreements?null:t.data.agreements.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.agreements?null:t.data.agreements.length)>1),e.xp6(3),e.Q6J("label",t.i18n.user.creationBegin),e.xp6(2),e.Q6J("label",t.i18n.user.creationEnd),e.xp6(3),e.Q6J("label",t.i18n.user.beginUserActivationDate),e.xp6(2),e.Q6J("label",t.i18n.user.endUserActivationDate),e.xp6(3),e.Q6J("label",t.i18n.user.beginLastLoginDate),e.xp6(2),e.Q6J("label",t.i18n.user.endLastLoginDate),e.xp6(3),e.Q6J("label",t.i18n.account.userBalances.beginNegativeSince),e.xp6(2),e.Q6J("label",t.i18n.account.userBalances.endNegativeSince),e.xp6(2),e.Q6J("label",t.i18n.general.usersOfBroker)("filters",t.userSearchFilters()),e.xp6(1),e.Q6J("ngForOf",t.fieldsInAdvancedSearch)}}function zi(n,a){if(1&n&&(e.TgZ(0,"div",48)(1,"single-selection-field",49),e._UZ(2,"field-option",50)(3,"field-option",51)(4,"field-option",52)(5,"field-option",53),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formControl",t.form.get("orderBy"))("display",t.i18n.general.orderBy),e.xp6(1),e.Q6J("text",t.i18n.account.userBalances.orderBy.alphabeticallyDesc),e.xp6(1),e.Q6J("text",t.i18n.account.userBalances.orderBy.alphabeticallyAsc),e.xp6(1),e.Q6J("text",t.i18n.account.userBalances.orderBy.balanceDesc),e.xp6(1),e.Q6J("text",t.i18n.account.userBalances.orderBy.balanceAsc)}}function Gi(n,a){if(1&n&&(e._UZ(0,"balances-summary",54),e.ALo(1,"async")),2&n){const t=e.oxw(2);e.Q6J("summary$",t.summary$)("currency",e.lcZ(1,2,t.currency$))}}function Wi(n,a){1&n&&e._UZ(0,"spinner")}function Xi(n,a){if(1&n&&(e.TgZ(0,"mobile-result",55)(1,"div",56)(2,"div",57),e._uU(3),e.qZA(),e.TgZ(4,"div",58),e._uU(5),e.ALo(6,"currency"),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",t.image)("avatarIcon",i.SvgIcon.Person),e.xp6(3),e.hij(" ",t.display," "),e.xp6(2),e.hij(" ",e.xi3(6,4,t.balance,i.findCurrency())," ")}}function Ki(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.account.number)}}function eo(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.account.userBalances.negativeSince,"")}}function to(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.accountNumber," ")}}function no(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.negativeSince),"")}}function io(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",63),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(2,"td",60),e._UZ(3,"avatar",64),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.YNc(6,to,2,1,"td",11),e.ALo(7,"async"),e.YNc(8,no,3,3,"td",11),e.ALo(9,"async"),e.TgZ(10,"td",61),e._uU(11),e.ALo(12,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",t.image)("icon",i.SvgIcon.Person),e.xp6(2),e.Oqu(t.display),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,6,i.showAccountNumber$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,8,i.showNegativeSince$)),e.xp6(3),e.hij(" ",e.xi3(12,10,t.balance,i.findCurrency())," ")}}function oo(n,a){if(1&n&&(e.TgZ(0,"table",59)(1,"thead"),e._UZ(2,"th",60),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.YNc(5,Ki,2,1,"th",11),e.ALo(6,"async"),e.YNc(7,eo,2,1,"th",11),e.ALo(8,"async"),e.TgZ(9,"th",61),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,io,13,13,"ng-container",62),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.general.user),e.xp6(1),e.Q6J("ngIf",e.lcZ(6,5,t.showAccountNumber$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,7,t.showNegativeSince$)),e.xp6(3),e.Oqu(t.i18n.account.balance),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(13,9,t.results$))?null:i.results)}}function ao(n,a){if(1&n&&(e.TgZ(0,"map-result",65)(1,"div",66),e._uU(2),e.qZA(),e.TgZ(3,"div",66),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("image",t.image)("address",t.address),e.xp6(2),e.hij(" ",t.display,""),e.xp6(2),e.hij(" ",e.xi3(5,4,t.balance,i.findCurrency()),"")}}function ro(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7)(5,"single-selection-field",8),e.YNc(6,Ni,1,4,"field-option",9),e.qZA()(),e.YNc(7,Li,3,2,"div",10),e.YNc(8,Mi,38,24,"ng-container",11),e.ALo(9,"async"),e.qZA()(),e.TgZ(10,"div",6)(11,"div",12),e._UZ(12,"result-type-field",13),e.ALo(13,"async"),e.qZA(),e.YNc(14,zi,6,6,"div",14),e.ALo(15,"async"),e.qZA(),e.ynx(16),e.YNc(17,Gi,2,4,"balances-summary",15),e.ALo(18,"async"),e.YNc(19,Wi,1,0,"spinner",11),e.ALo(20,"async"),e.BQk(),e.qZA(),e.TgZ(21,"results-layout",16),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(22,"async"),e.YNc(23,Xi,7,7,"mobile-result",17),e.YNc(24,oo,14,11,"table",18),e.YNc(25,ao,6,7,"map-result",19),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.account.userBalances.title)("mobileHeading",t.i18n.account.userBalances.mobileTitle)("headingActions",e.lcZ(1,18,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.account.account),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes),e.xp6(1),e.Q6J("ngForOf",t.fieldsInBasicSearch),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,20,t.moreFilters$)),e.xp6(4),e.Q6J("allowedResultTypes",e.lcZ(13,22,t.allowedResultTypes$))("formControl",t.resultTypeControl),e.xp6(2),e.Q6J("ngIf","map"!==e.lcZ(15,24,t.resultType$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(18,26,t.summary$)),e.xp6(2),e.Q6J("ngIf",null===e.lcZ(20,28,t.summary$)),e.xp6(2),e.Q6J("resultType",t.resultType)("results",e.lcZ(22,30,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)("toAddress",t.toAddress)}}function so(n,a){1&n&&e._UZ(0,"spinner",67)}let co=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.accountsService=i,this.bankingHelper=o,this.summary$=new y.X(null),this.currency$=new y.X(null),this.customFieldsInSearch=[],this.basicFieldsInSearch=[],this.fieldsInBasicSearch=[],this.fieldsInAdvancedSearch=[],this.showAccountNumber$=new y.X(!1),this.showNegativeSince$=new y.X(!1)}getFormControlNames(){return["accountType","minMediumRange","maxMediumRange","minBalance","maxBalance","orderBy","groups","distanceFilter","brokers","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","customValues","endLastLoginPeriod","beginNegativeSincePeriod","endNegativeSincePeriod","notAcceptedAgreements","acceptedAgreements","products"]}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.accountsService.getUserBalancesData()).subscribe(i=>this.data=i),this.allowedResultTypes=(((this.login.auth||{}).permissions||{}).users||{}).map?[Me.X.LIST,Me.X.MAP]:[Me.X.LIST]}prepareForm(t){t.fieldsInBasicSearch.forEach(i=>{var o=t.customFields.find(r=>r.internalName===i);o?this.customFieldsInSearch.push(o):(o=t.basicFields.find(r=>r.field===i),this.basicFieldsInSearch.push(o)),this.fieldsInBasicSearch.push(o)}),t.fieldsInAdvancedSearch.forEach(i=>{var o=t.customFields.find(r=>r.internalName===i);o?this.customFieldsInSearch.push(o):(o=t.basicFields.find(r=>r.field===i),this.basicFieldsInSearch.push(o)),this.fieldsInAdvancedSearch.push(o)}),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(this.basicFieldsInSearch,this.customFieldsInSearch,t.query.profileFields))}onDataInitialized(t){super.onDataInitialized(t);const i=this.moreFiltersAction;i.breakpoint=null,this.headingActions=[i],this.exportHelper.headingActions(t.exportFormats,r=>this.accountsService.exportUsersWithBalances$Response(Object.assign({format:r.internalName},this.toSearchParams(this.form.value)))).forEach(r=>this.headingActions.push(r)),this.bankingHelper.preProcessPreselectedPeriods(t,this.form),this.addSub(this.form.controls.accountType.valueChanges.subscribe(r=>{const l=this.data.accountTypes.find(_=>_.id===r);this.updateYellowRange(l),this.currency$.next(l.currency)}));const o=t.accountTypes[0];this.currency$.next(o.currency),this.updateYellowRange(o)}onBeforeRender(t){const i=(null==t?void 0:t.results)||[];this.showAccountNumber$.next(!!i.find(o=>o.accountNumber)),this.showNegativeSince$.next(!!i.find(o=>o.negativeSince))}onResultTypeChanged(t,i){super.onResultTypeChanged(t,i),this.resetPage()}updateYellowRange(t){null!=t.defaultMediumBalanceRange?(this.form.controls.minMediumRange.patchValue(t.defaultMediumBalanceRange.min),this.form.controls.maxMediumRange.patchValue(t.defaultMediumBalanceRange.max)):(this.form.controls.minMediumRange.patchValue(null),this.form.controls.maxMediumRange.patchValue(null))}userSearchFilters(){return{roles:[_e.g.BROKER]}}mapBalance(t){return this.i18n.account.balance+": "+t}toAddress(t){return t.address}getInitialResultType(){return Me.X.LIST}toSearchParams(t){const i=t;i.ignoreProfileFieldsInList=!0,i.activationPeriod=b.S.dateRangeFilter(t.beginActivationPeriod,t.endActivationPeriod),i.creationPeriod=b.S.dateRangeFilter(t.beginCreationPeriod,t.endCreationPeriod),i.lastLoginPeriod=b.S.dateRangeFilter(t.beginLastLoginPeriod,t.endLastLoginPeriod),i.negativeSincePeriod=b.S.dateRangeFilter(t.beginNegativeSincePeriod,t.endNegativeSincePeriod),i.balanceRange=b.S.rangeFilter(t.minBalance,t.maxBalance),null!=t.minMediumRange&&null!=t.maxMediumRange&&(i.mediumBalanceRange=[t.minMediumRange,t.maxMediumRange]),i.addressResult=this.resultType===Me.X.MAP?vi.s.ALL:null,i.profileFields=this.fieldHelper.toProfileFieldsFilter(t.profileFields);const o=t.distanceFilter;return o&&(i.maxDistance=o.maxDistance,i.latitude=o.latitude,i.longitude=o.longitude),i.fields=[],i}doSearch(t){return this.accountsService.searchUsersWithBalances$Response(t).pipe((0,Ti.b)(()=>{this.addSub(this.accountsService.getUserBalancesSummary(t).subscribe(i=>this.summary$.next(i)))}))}findCurrency(){const t=this.form.controls.accountType.value;return t?this.data.accountTypes.find(i=>i.id===t||i.internalName===t).currency:this.currency$.value}currencyDecimalDigits(){const t=this.findCurrency();return t?t.decimalDigits:2}currencyPrefix(){const t=this.findCurrency();return t?t.prefix:null}currencySuffix(){const t=this.findCurrency();return t?t.suffix:null}path(t){return["/users",t.id,"profile"]}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return t=>this.path(t)}resolveMenu(){return v.v2.USER_BALANCES_OVERVIEW}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(yt.i),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-user-balances"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12","col-md-6"],["formControlName","accountType",3,"label"],[3,"id","value","internalName","text",4,"ngFor","ngForOf"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12","col-md-9","col-xs-5"],[3,"allowedResultTypes","formControl"],["class","col-12 col-md-3 col-xs-7",4,"ngIf"],[3,"summary$","currency",4,"ngIf"],[3,"resultType","results","toLink","rendering$","toAddress","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"image","address",4,"resultInfoWindow"],[3,"id","value","internalName","text"],[3,"field","formControl",4,"ngIf"],[3,"field","formControl"],[1,"w-100"],["formControlName","minBalance","fieldSize","full","allowNegative","",3,"label","scale"],["formControlName","maxBalance","fieldSize","full","allowNegative","",3,"label","scale"],["formControlName","minMediumRange","fieldSize","full",3,"label","scale"],["formControlName","maxMediumRange","fieldSize","full",3,"label","scale"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],["formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","brokers",3,"label","filters"],["formControlName","distanceFilter",3,"data","label"],["hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["formControlName","acceptedAgreements",3,"emptyLabel","label"],["formControlName","notAcceptedAgreements",3,"emptyLabel","label"],[1,"col-12","col-md-3","col-xs-7"],[3,"formControl","display"],["value","alphabeticallyDesc",3,"text"],["value","alphabeticallyAsc",3,"text"],["value","balanceDesc",3,"text"],["value","balanceAsc",3,"text"],[3,"summary$","currency"],[3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main","row"],[1,"col-6","align-text-start"],[1,"col-6","align-text-end","amount"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"image","address"],[1,"font-weight-bold"],[1,"p-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ui,1,0,"ng-container",1),e.qZA(),e.YNc(3,ro,26,32,"ng-template",null,2,e.W1O),e.YNc(5,so,1,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,O.f,s.JJ,s.u,u.sg,J.s,wi.z,s.oH,Ze.L,B.U,Ci.r,be.x,j.Q,te.l,Ai.P,qi,ne.O,D.D,R.E,V.t,Y.p,Pe.A,Si.d,Qi.$],pipes:[u.Ov,w.H,E.u],encapsulation:2,changeDetection:0}),n})();var U=m(871),ze=m(6526);let rt=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getDataForUserBalanceLimits$Response(t,i){const o=new d.c(this.rootUrl,n.GetDataForUserBalanceLimitsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getDataForUserBalanceLimits(t,i){return this.getDataForUserBalanceLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}getAccountBalanceLimits$Response(t,i){const o=new d.c(this.rootUrl,n.GetAccountBalanceLimitsPath,"get");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getAccountBalanceLimits(t,i){return this.getAccountBalanceLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}setAccountBalanceLimits$Response(t,i){const o=new d.c(this.rootUrl,n.SetAccountBalanceLimitsPath,"put");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setAccountBalanceLimits(t,i){return this.setAccountBalanceLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}getAccountBalanceLimitsData$Response(t,i){const o=new d.c(this.rootUrl,n.GetAccountBalanceLimitsDataPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getAccountBalanceLimitsData(t,i){return this.getAccountBalanceLimitsData$Response(t,i).pipe((0,c.U)(o=>o.body))}searchAccountBalanceLimits$Response(t,i){const o=new d.c(this.rootUrl,n.SearchAccountBalanceLimitsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accountType",t.accountType,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("currency",t.currency,{}),o.query("customLimit",t.customLimit,{}),o.query("customLimitRange",t.customLimitRange,{}),o.query("customUpperLimit",t.customUpperLimit,{}),o.query("customUpperLimitRange",t.customUpperLimitRange,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchAccountBalanceLimits(t,i){return this.searchAccountBalanceLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}exportAccountBalanceLimits$Response(t,i){const o=new d.c(this.rootUrl,n.ExportAccountBalanceLimitsPath,"get");return t&&(o.path("format",t.format,{}),o.query("accountType",t.accountType,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("currency",t.currency,{}),o.query("customLimit",t.customLimit,{}),o.query("customLimitRange",t.customLimitRange,{}),o.query("customUpperLimit",t.customUpperLimit,{}),o.query("customUpperLimitRange",t.customUpperLimitRange,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportAccountBalanceLimits(t,i){return this.exportAccountBalanceLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetDataForUserBalanceLimitsPath="/{user}/accounts/data-for-balance-limits",n.GetAccountBalanceLimitsPath="/{user}/accounts/{accountType}/balance-limits",n.SetAccountBalanceLimitsPath="/{user}/accounts/{accountType}/balance-limits",n.GetAccountBalanceLimitsDataPath="/accounts/data-for-balance-limits",n.SearchAccountBalanceLimitsPath="/accounts/balance-limits",n.ExportAccountBalanceLimitsPath="/accounts/balance-limits/export/{format}",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Te=m(1030);function lo(n,a){if(1&n&&(e.ynx(0,4),e.TgZ(1,"label-value",5),e._UZ(2,"user-link",6),e.qZA(),e.TgZ(3,"label-value",7),e._uU(4),e.qZA(),e.TgZ(5,"h2",8),e._uU(6),e.qZA(),e._UZ(7,"single-selection-field",9)(8,"decimal-field",10),e.ALo(9,"async"),e.ALo(10,"async"),e.TgZ(11,"label-value",11),e.ALo(12,"async"),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"h2",8),e._uU(16),e.qZA(),e._UZ(17,"single-selection-field",12)(18,"decimal-field",13),e.ALo(19,"async"),e.ALo(20,"async"),e.ALo(21,"async"),e.ALo(22,"async"),e.TgZ(23,"label-value",11),e.ALo(24,"async"),e._uU(25),e.ALo(26,"currency"),e.qZA(),e._UZ(27,"hr")(28,"textarea-field",14),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.account.account),e.xp6(1),e.hij(" ",t.data.account.type.name," "),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.negativeLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.negativeModeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(9,30,t.isDefaultCreditLimit$))("required",!e.lcZ(10,32,t.isDefaultCreditLimit$))("label",t.i18n.account.balanceLimits.negativeLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(12,34,t.isDefaultCreditLimit$))("label",t.i18n.account.balanceLimits.negativeLimit),e.xp6(2),e.hij(" ",e.xi3(14,36,t.data.defaultCreditLimit?t.data.defaultCreditLimit:0,t.data.account.currency)," "),e.xp6(3),e.Oqu(t.i18n.account.balanceLimits.positiveLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.positiveModeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(19,39,t.isDefaultUpperCreditLimit$)||e.lcZ(20,41,t.isUnlimitedUpperCreditLimit$))("required",!(e.lcZ(21,43,t.isDefaultUpperCreditLimit$)||e.lcZ(22,45,t.isUnlimitedUpperCreditLimit$)))("label",t.i18n.account.balanceLimits.positiveLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(5),e.Q6J("hidden",!e.lcZ(24,47,t.isDefaultUpperCreditLimit$))("label",t.i18n.account.balanceLimits.positiveLimit),e.xp6(2),e.hij(" ",t.data.defaultUpperCreditLimit?e.xi3(26,49,t.data.defaultUpperCreditLimit,t.data.account.currency):t.i18n.account.limits.unlimited," "),e.xp6(3),e.Q6J("label",t.i18n.general.comments)}}let uo=(()=>{class n extends $.y{constructor(t,i){super(t),this.balanceLimitsService=i,this.isDefaultCreditLimit$=new y.X(null),this.isDefaultUpperCreditLimit$=new y.X(null),this.isUnlimitedUpperCreditLimit$=new y.X(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(t=>this.data=t))}get positiveModeOptions(){const t=[{value:"default",text:this.i18n.account.limits.productDefault}];return t.push({value:"personalized",text:this.i18n.account.limits.personalized}),t.push({value:"unlimited",text:this.i18n.account.limits.unlimited}),t}get negativeModeOptions(){const t=[{value:"default",text:this.i18n.account.limits.productDefault}];return t.push({value:"personalized",text:this.i18n.account.limits.personalized}),t}onDataInitialized(t){super.onDataInitialized(t);const i=t.customCreditLimit?"personalized":"default",o=t.customUpperCreditLimit?t.upperCreditLimit?"personalized":"unlimited":"default";this.form=this.formBuilder.group({creditLimitMode:i,creditLimit:t.creditLimit,upperCreditLimitMode:o,upperCreditLimit:t.upperCreditLimit,comment:null}),this.formControl("creditLimitMode").valueChanges.subscribe(r=>this.onCreditLimitModeChange(r)),this.formControl("upperCreditLimitMode").valueChanges.subscribe(r=>this.onUpperCreditLimitModeChange(r)),this.isDefaultCreditLimit$.next("default"===i),this.isDefaultUpperCreditLimit$.next("default"===o),this.isUnlimitedUpperCreditLimit$.next("unlimited"===o)}onCreditLimitModeChange(t){this.isDefaultCreditLimit$.next("default"===t)}onUpperCreditLimitModeChange(t){this.isDefaultUpperCreditLimit$.next("default"===t),this.isUnlimitedUpperCreditLimit$.next("unlimited"===t)}save(){if(!(0,h.pt)(this.form))return;const t=(0,ze.Z)(this.form.value);t.customCreditLimit="default"!==t.creditLimitMode,t.customCreditLimit||delete t.creditLimit,t.customUpperCreditLimit="default"!==t.upperCreditLimitMode,("unlimited"===t.upperCreditLimitMode||!t.customUpperCreditLimit)&&delete t.upperCreditLimit,delete t.creditLimitMode,delete t.upperCreditLimitMode,this.data.confirmationPasswordInput?this.confirmation.confirm({title:this.i18n.general.confirm,message:this.i18n.account.balanceLimits.confirm,createDeviceConfirmation:this.balanceLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:i=>this.doSave(t,i.confirmationPassword)}):this.doSave(t)}doSave(t,i){this.addSub(this.balanceLimitsService.setAccountBalanceLimits({user:this.user,accountType:this.accountType,confirmationPassword:i,body:t}).subscribe(()=>{this.notification.snackBar(this.i18n.account.balanceLimits.saved),this.reload()}))}balanceLimitsDeviceConfirmation(){return()=>({type:U.l.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(t){return this.form.get(t)}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-account-balance-limits"]],features:[e.qOj],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],["labelPosition","side","formControlName","creditLimitMode",3,"label","fieldOptions"],["formControlName","creditLimit","negative","",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","upperCreditLimitMode",3,"label","fieldOptions"],["formControlName","upperCreditLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.ALo(3,"async"),e.YNc(4,lo,29,52,"ng-container",2),e.TgZ(5,"actions")(6,"action-button",3),e.NdJ("action",function(){return i.save()}),e.ALo(7,"async"),e.qZA()()()()),2&t&&(e.Q6J("ready",e.lcZ(1,7,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.account.balanceLimits.title.edit)("mobileHeading",i.i18n.account.balanceLimits.mobileTitle.edit)("headingActions",e.lcZ(3,9,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",i.data),e.xp6(2),e.Q6J("disabled",e.lcZ(7,11,i.requesting$))("label",i.i18n.general.save))},directives:[A.w,Z.Y,u.O5,s.JL,s.sg,C.t,Q.F,O.f,s.JJ,s.u,B.U,s.Q7,Te.u,L.h,k.x],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function po(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result",7),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(2);return _.router.navigate(_.path(l.account.type)),o.stopPropagation()}),e.TgZ(1,"div",8)(2,"div",9)(3,"label-value",10),e._uU(4),e.qZA(),e.TgZ(5,"label-value",10),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"label-value",10),e._uU(9),e.ALo(10,"currency"),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.account.account),e.xp6(1),e.hij(" ",t.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.balanceLimits.negative),e.xp6(1),e.hij(" ",e.xi3(7,6,t.creditLimit,t.account.currency)," "),e.xp6(2),e.Q6J("label",i.i18n.account.balanceLimits.positive),e.xp6(1),e.hij(" ",t.upperCreditLimit?e.xi3(10,9,t.upperCreditLimit,t.account.currency):i.i18n.account.limits.unlimited," ")}}function mo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",7),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(3);return _.router.navigate(_.path(l.account.type)),o.stopPropagation()}),e.TgZ(1,"td",13),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.account.type.name),e.xp6(2),e.Oqu(e.xi3(5,3,t.creditLimit,t.account.currency)),e.xp6(3),e.hij(" ",t.upperCreditLimit?e.xi3(8,6,t.upperCreditLimit,t.account.currency):i.i18n.account.limits.unlimited," ")}}function fo(n,a){if(1&n&&(e.TgZ(0,"table",11)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA()(),e.TgZ(8,"tbody"),e.YNc(9,mo,9,9,"tr",12),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.account.account),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.negativeLimit),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.positiveLimit),e.xp6(2),e.Q6J("ngForOf",t.data.accountLimits)}}function _o(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e._UZ(3,"user-info",3),e.qZA(),e.TgZ(4,"results-layout",4),e.YNc(5,po,11,12,"mobile-result",5),e.YNc(6,fo,10,4,"table",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode","normal")("heading",t.i18n.account.balanceLimits.title.list)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.list)("headingActions",e.lcZ(2,6,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.accountLimits)}}let ho=(()=>{class n extends $.y{constructor(t,i){super(t),this.balanceLimitsService=i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.balanceLimitsService.getDataForUserBalanceLimits({user:this.user}).subscribe(t=>{1===t.accountLimits.length?this.router.navigate(this.path(t.accountLimits[0].account.type),{replaceUrl:!0}):this.data=t}))}path(t){return["/banking",this.user,"account-balance-limits",t.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-accounts-balance-limits"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","20%"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,_o,7,8,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,oe.M,D.D,R.E,V.t,C.t,Y.p,u.sg],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function go(n,a){1&n&&e.GkF(0)}function yo(n,a){if(1&n&&e._UZ(0,"field-option",14),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function xo(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",12),e.YNc(2,yo,1,5,"field-option",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function bo(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function vo(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",15),e.YNc(2,bo,1,2,"field-option",16),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.currency)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.currencies)}}function To(n,a){if(1&n&&e._UZ(0,"field-option",31),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t.id)("text",t.name)}}function wo(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",29),e.YNc(2,To,1,3,"field-option",30),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.account.account)("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("ngForOf",t.accountTypes())}}function Co(n,a){if(1&n&&(e.ynx(0),e.YNc(1,wo,3,3,"div",6),e.TgZ(2,"div",11),e._UZ(3,"single-selection-field",18),e.qZA(),e._UZ(4,"div",19),e.ALo(5,"async"),e.TgZ(6,"div",20),e.ALo(7,"async"),e._UZ(8,"decimal-field",21),e.qZA(),e.TgZ(9,"div",20),e.ALo(10,"async"),e._UZ(11,"decimal-field",22),e.qZA(),e.TgZ(12,"div",11),e._UZ(13,"single-selection-field",23),e.qZA(),e._UZ(14,"div",19),e.ALo(15,"async"),e.TgZ(16,"div",20),e.ALo(17,"async"),e._UZ(18,"decimal-field",24),e.qZA(),e.TgZ(19,"div",20),e.ALo(20,"async"),e._UZ(21,"decimal-field",25),e.qZA(),e.TgZ(22,"div",11),e._UZ(23,"user-field",26),e.qZA(),e.TgZ(24,"div",11),e._UZ(25,"user-field",27),e.qZA(),e.TgZ(26,"div",11),e._UZ(27,"user-field",28),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.balanceLimits.personalizedNegativeLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(5,37,t.isCustomLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(7,39,t.isCustomLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.balanceLimits.fromNegativeLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(10,41,t.isCustomLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.balanceLimits.toNegativeLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.balanceLimits.personalizedPositiveLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(15,43,t.isCustomUpperLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(17,45,t.isCustomUpperLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.balanceLimits.fromPositiveLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(20,47,t.isCustomUpperLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.balanceLimits.toPositiveLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("label",t.i18n.general.user)("allowContacts",!1),e.xp6(2),e.Q6J("label",t.i18n.general.usersOfBroker)("filters",t.userSearchFilters(!0))("allowContacts",!1),e.xp6(2),e.Q6J("label",t.i18n.general.changedBy)("filters",t.userSearchFilters(!1))("allowContacts",!1)}}function Ao(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result",32),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(2);return _.router.navigate(_.view(l)),o.stopPropagation()}),e.TgZ(1,"div",33)(2,"div",34)(3,"label-value",35),e._uU(4),e.qZA(),e.TgZ(5,"label-value",35),e._uU(6),e.qZA(),e.TgZ(7,"label-value",35),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"label-value",35),e._uU(11),e.ALo(12,"currency"),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.user),e.xp6(1),e.hij(" ",t.user.display," "),e.xp6(1),e.Q6J("label",i.i18n.account.account),e.xp6(1),e.hij(" ",t.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.balanceLimits.negative),e.xp6(1),e.hij(" ",t.customCreditLimit?e.xi3(9,8,t.creditLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.balanceLimits.positive),e.xp6(1),e.hij(" ",t.customUpperCreditLimit?t.upperCreditLimit?e.xi3(12,11,t.upperCreditLimit,t.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," ")}}function Zo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",32),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(3);return _.router.navigate(_.view(l)),o.stopPropagation()}),e.TgZ(1,"td",38),e._uU(2),e.qZA(),e.TgZ(3,"td",38),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"currency"),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.user.display),e.xp6(2),e.Oqu(t.account.type.name),e.xp6(2),e.hij(" ",t.customCreditLimit?e.xi3(7,4,t.creditLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customUpperCreditLimit?t.upperCreditLimit?e.xi3(10,7,t.upperCreditLimit,t.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," ")}}function Po(n,a){if(1&n&&(e.TgZ(0,"table",36)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,Zo,11,10,"tr",37),e.ALo(12,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.user),e.xp6(2),e.Oqu(t.i18n.account.account),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.negativeLimit),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.positiveLimit),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(12,5,t.results$))?null:i.results)}}function qo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,xo,3,2,"div",6),e.YNc(5,vo,3,3,"div",6),e.YNc(6,Co,28,49,"ng-container",7),e.ALo(7,"async"),e.qZA()()(),e.TgZ(8,"results-layout",8),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(9,"async"),e.YNc(10,Ao,13,14,"mobile-result",9),e.YNc(11,Po,13,7,"table",10),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.account.balanceLimits.title.overview)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.overview)("headingActions",e.lcZ(1,9,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.currencies?null:t.currencies.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,11,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(9,13,t.results$))("rendering$",t.rendering$)}}let So=(()=>{class n extends ae.t{constructor(t,i){super(t),this.balanceLimitsService=i,this.isCustomLimit$=new y.X(!1),this.isCustomUpperLimit$=new y.X(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","by","currency","customLimit","limitFrom","limitTo","customUpperLimit","upperLimitFrom","upperLimitTo","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.balanceLimitsService.getAccountBalanceLimitsData().subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),(t.accountTypes||[]).forEach(i=>this.currencies.push(i.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customUpperLimit").valueChanges.subscribe(i=>this.isCustomUpperLimit$.next("yes"===i)),this.form.get("customLimit").valueChanges.subscribe(i=>this.isCustomLimit$.next("yes"===i)),this.addSub(this.form.controls.currency.valueChanges.subscribe(i=>this.updateAccountTypes(i))),this.headingActions=[this.moreFiltersAction]}doSearch(t){return this.balanceLimitsService.searchAccountBalanceLimits$Response(t)}toSearchParams(t){const i=t;return this.isCustomLimit$.value?(i.customLimit=!0,i.customLimitRange=b.S.rangeFilter(t.limitFrom,t.limitTo)):i.customLimit=!t.customLimit&&null,this.isCustomUpperLimit$.value?(i.customUpperLimit=!0,i.customUpperLimitRange=b.S.rangeFilter(t.upperLimitFrom,t.upperLimitTo)):i.customUpperLimit=!t.customUpperLimit&&null,t.broker&&(i.brokers=[t.broker]),i}get customLimitOptions(){const t=[{value:"yes",text:this.i18n.general.yes}];return t.push({value:"no",text:this.i18n.general.no}),t}userSearchFilters(t){const i={roles:[_e.g.BROKER]};return t||i.roles.push(_e.g.ADMINISTRATOR),i}updateAccountTypes(t){const i=this.form.controls.accountType.value;t&&i&&this.data.accountTypes.find(o=>o.id===i).currency.id!==t&&this.form.controls.accountType.setValue(null)}accountTypes(){const t=this.findCurrency(!1),i=this.data.accountTypes||[];return t?i.filter(o=>o.currency.id===t.id):i}findCurrency(t){if(this.singleCurrency)return this.singleCurrency;const i=this.form.controls.currency.value;if(i)return this.currencies.find(r=>r.id===i);const o=this.form.controls.accountType.value;return t&&o?this.data.accountTypes.find(r=>r.id===o).currency:null}currencyDecimalDigits(){const t=this.findCurrency(!0);return t?t.decimalDigits:2}currencyPrefix(){const t=this.findCurrency(!0);return t?t.prefix:null}currencySuffix(){const t=this.findCurrency(!0);return t?t.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(t){return["/banking",t.user.id,"account-balance-limits",t.account.type.id]}resolveMenu(){return new v.oX(v.v2.ACCOUNT_BALANCE_LIMITS_OVERVIEW)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-balance-limits-overview"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","customLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","limitFrom","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","limitTo","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","customUpperLimit",3,"fieldOptions","emptyOption","label"],["formControlName","upperLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","upperLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","user",3,"label","allowContacts"],["formControlName","broker",3,"label","filters","allowContacts"],["formControlName","by",3,"label","filters","allowContacts"],["formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","25%"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,go,1,0,"ng-container",1),e.qZA(),e.YNc(3,qo,12,15,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,be.x,s.JJ,s.u,u.sg,J.s,O.f,B.U,te.l,D.D,R.E,V.t,C.t,Y.p],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var T=m(5466);function Qo(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",5),e._UZ(2,"user-link",6),e.qZA(),e.TgZ(3,"label-value",7),e._uU(4),e.qZA(),e.TgZ(5,"h2",8),e._uU(6),e.qZA(),e.TgZ(7,"label-value",7),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"label-value",7),e._uU(11),e.qZA(),e.TgZ(12,"h2",8),e._uU(13),e.qZA(),e.TgZ(14,"label-value",7),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"label-value",7),e._uU(18),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.account.account),e.xp6(1),e.hij(" ",t.data.account.type.name," "),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.negativeLimit),e.xp6(1),e.Q6J("label",t.i18n.account.balanceLimits.negativeLimit),e.xp6(1),e.hij(" ",e.xi3(9,14,t.data.creditLimit,t.data.account.currency)," "),e.xp6(2),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.data.customCreditLimit?t.i18n.account.limits.personalized:t.i18n.account.limits.productDefault," "),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.positiveLimit),e.xp6(1),e.Q6J("label",t.i18n.account.balanceLimits.positiveLimit),e.xp6(1),e.hij(" ",t.data.upperCreditLimit?e.xi3(16,17,t.data.upperCreditLimit,t.data.account.currency):t.i18n.account.limits.unlimited," "),e.xp6(2),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.upperCreditLimitMode()," ")}}function Uo(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Qo,19,20,"ng-container",4),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.account.balanceLimits.title.view)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.view)("headingActions",e.lcZ(1,4,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.data)}}function No(n,a){if(1&n&&(e.TgZ(0,"label-value",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.general.comments),e.xp6(1),e.hij(" ",t.comment," ")}}function Io(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",13)(2,"div",14)(3,"label-value",15),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"label-value",15),e._uU(7),e.qZA(),e.TgZ(8,"label-value",15),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"label-value",15),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.YNc(14,No,2,2,"label-value",16),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,9,t.date)," "),e.xp6(2),e.Q6J("label",i.i18n.general.performedBy),e.xp6(1),e.hij(" ",t.by.display," "),e.xp6(1),e.Q6J("label",i.i18n.account.balanceLimits.negative),e.xp6(1),e.hij(" ",t.customCreditLimit?e.xi3(10,11,t.creditLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.balanceLimits.positive),e.xp6(1),e.hij(" ",t.customUpperCreditLimit?t.upperCreditLimit?e.xi3(13,14,t.upperCreditLimit,i.data.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("ngIf",t.comment)}}function Jo(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,5,t.date)),e.xp6(3),e.Oqu(t.by.display),e.xp6(2),e.hij(" ",t.customCreditLimit?e.xi3(8,7,t.creditLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customUpperCreditLimit?t.upperCreditLimit?e.xi3(11,10,t.upperCreditLimit,i.data.account.currency):i.i18n.account.limits.unlimited:i.i18n.account.limits.productDefault," "),e.xp6(3),e.Oqu(t.comment)}}function Lo(n,a){if(1&n&&(e.TgZ(0,"table",17)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.qZA()(),e.TgZ(12,"tbody"),e.YNc(13,Jo,14,13,"tr",18),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.negative),e.xp6(2),e.Oqu(t.i18n.account.balanceLimits.positive),e.xp6(2),e.Oqu(t.i18n.general.comments),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function ko(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",9),e.ALo(2,"async"),e._UZ(3,"user-info",6),e.qZA(),e.TgZ(4,"results-layout",10),e.YNc(5,Io,15,17,"mobile-result",11),e.YNc(6,Lo,14,6,"table",12),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode","empty")("heading",t.i18n.account.balanceLimits.title.history)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.history)("headingActions",e.lcZ(2,6,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)}}let Fo=(()=>{class n extends $.y{constructor(t,i){super(t),this.balanceLimitsService=i,this.step$=new y.X("details")}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),this.detailsHeadingActions=[],t.editable&&this.detailsHeadingActions.push(new T.Yu(x.l.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.detailsHeadingActions.push(new T.Yu(x.l.Clock,this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=[],t.editable&&this.historyHeadingActions.push(new T.Yu(x.l.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.historyHeadingActions.push(new T.Yu(x.l.ArrowLeft,this.i18n.general.details,()=>this.showView()))}upperCreditLimitMode(){return this.data.upperCreditLimit?this.data.customUpperCreditLimit?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault:this.data.customUpperCreditLimit?this.i18n.account.limits.unlimited:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-balance-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-account-balance-limits"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table",4,"resultTable"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],["labelPosition","sideForced",3,"label",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Uo,3,6,"page-content",1),e.YNc(4,ko,7,8,"ng-container",2),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","details"),e.xp6(1),e.Q6J("ngSwitchCase","history"))},directives:[A.w,u.RF,u.n9,Z.Y,u.O5,C.t,Q.F,oe.M,D.D,R.E,V.t,Y.p,u.sg],pipes:[u.Ov,w.H,E.u],encapsulation:2,changeDetection:0}),n})();var st=m(3126),Ge=m(3531),Le=m(7224);let xt=(()=>{class n extends K.b{constructor(t,i){super(t,i)}dataForPerformExternalPayment$Response(t,i){const o=new d.c(this.rootUrl,n.DataForPerformExternalPaymentPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}dataForPerformExternalPayment(t,i){return this.dataForPerformExternalPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}performExternalPayment$Response(t,i){const o=new d.c(this.rootUrl,n.PerformExternalPaymentPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("owner",t.owner,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}performExternalPayment(t,i){return this.performExternalPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}previewExternalPayment$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewExternalPaymentPath,"post");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewExternalPayment(t,i){return this.previewExternalPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelExternalPayment$Response(t,i){const o=new d.c(this.rootUrl,n.CancelExternalPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelExternalPayment(t,i){return this.cancelExternalPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.DataForPerformExternalPaymentPath="/{owner}/external-payments/data-for-perform",n.PerformExternalPaymentPath="/{owner}/external-payments",n.PreviewExternalPaymentPath="/{owner}/external-payments/preview",n.CancelExternalPaymentPath="/external-payments/{key}/cancel",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Oo=m(5350),le=m(3553),ue=m(5778),we=m(13),M=m(8134),bt=m(3455),qe=m(5739),z=m(8361),Se=m(1602);const Do=["toUser"],Ro=["amount"];function Vo(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._UZ(1,"user-link",14),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.toSystem?t.i18n.transaction.receiver:t.i18n.transaction.fromUser),e.xp6(1),e.Q6J("user",t.fromUser)}}const Yo=function(n,a,t){return{positive:n,negative:a,"text-right":t}};function Eo(n,a){if(1&n&&(e.TgZ(0,"label-value",16),e.ALo(1,"async"),e.TgZ(2,"div",17),e.ALo(3,"async"),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",e.lcZ(1,3,t.accountBalanceLabel$)),e.xp6(2),e.Q6J("ngClass",e.kEZ(10,Yo,t.format.isPositive(t.singleAccount.status.balance),t.format.isNegative(t.singleAccount.status.balance),e.lcZ(3,5,t.layout.ltsm$))),e.xp6(2),e.hij(" ",e.xi3(5,7,t.singleAccount.status.balance,t.singleAccount.currency)," ")}}function $o(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Eo,6,14,"label-value",15),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.singleAccount.status)}}function Bo(n,a){1&n&&e._UZ(0,"br")}function Ho(n,a){1&n&&e._uU(0," - ")}function jo(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Bo,1,0,"br",2),e.ALo(2,"async"),e.YNc(3,Ho,1,0,"ng-template",null,27,e.W1O),e._uU(5),e.BQk()),2&n){const t=e.MAs(4),i=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,o.layout.ltsm$))("ngIfElse",t),e.xp6(4),e.hij(" ",i.number," ")}}const Mo=function(n,a){return{positive:n,negative:a}};function zo(n,a){if(1&n&&(e.TgZ(0,"div",28),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngClass",e.WLB(5,Mo,i.format.isPositive(t.status.balance),i.format.isNegative(t.status.balance))),e.xp6(1),e.hij(" ",e.xi3(2,2,t.status.balance,t.currency)," ")}}function Go(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div")(2,"div",21)(3,"input",22,23),e.NdJ("keyup.enter",function(){return e.CHM(t),e.MAs(4).click()}),e.qZA(),e.TgZ(5,"label",24)(6,"div",25),e._uU(7),e.YNc(8,jo,6,5,"ng-container",12),e.qZA()()()(),e.YNc(9,zo,3,8,"div",26),e.qZA()}if(2&n){const t=a.$implicit;e.xp6(1),e.Tol("col-7 col-sm-8 col-md-5"),e.xp6(2),e.Q6J("id","from_"+t.id)("value",t.type.id),e.xp6(2),e.Q6J("for","from_"+t.id),e.xp6(2),e.hij(" ",t.type.name," "),e.xp6(1),e.Q6J("ngIf",t.number),e.xp6(1),e.Q6J("ngIf",t.status)}}function Wo(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e.YNc(1,Go,10,8,"div",18),e._UZ(2,"field-errors",19),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accounts),e.xp6(1),e.Q6J("control",t.form.get("account"))}}function Xo(n,a){if(1&n&&e._UZ(0,"field-option",32),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function Ko(n,a){if(1&n&&(e.TgZ(0,"radio-group-field",29,30),e.YNc(2,Xo,1,2,"field-option",31),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.receiver),e.xp6(2),e.Q6J("ngForOf",t.data.principalTypes)}}function ea(n,a){if(1&n&&e._UZ(0,"field-option",32),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function ta(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",33,34),e.YNc(2,ea,1,2,"field-option",31),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,2,t.paymentTypes$))}}function na(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.paymentTypeData$.value.fixedAmount,t.paymentTypeData$.value.currency)," ")}}function ia(n,a){if(1&n&&e._UZ(0,"decimal-field",35,36),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)}}function oa(n,a){if(1&n&&e._UZ(0,"custom-field-input",37),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.customValuesControlGetter(t))}}function aa(n,a){if(1&n&&e._UZ(0,"textarea-field",39),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("required","required"===t)("label",i.i18n.general.description)}}function ra(n,a){if(1&n&&(e.ynx(0),e.YNc(1,aa,1,2,"textarea-field",38),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf","disabled"!==t)}}const sa=[le.n.FORBIDDEN,le.n.UNAUTHORIZED,le.n.NOT_FOUND];let ca=(()=>{class n extends q.H{constructor(t,i,o,r){super(t),this.bankingHelper=i,this.externalPaymentsService=o,this.authHelper=r,this.availablePaymentTypes=new e.vpe,this.accountBalanceLabel$=new y.X(null),this.toPrincipalType$=new y.X(null),this.firstPaymentTypeUpdate=!0,this.paymentTypes$=new y.X(null)}ngOnInit(){super.ngOnInit(),this.ownerParam=this.route.snapshot.params.owner,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.setFetchedPaymentTypes(this.data),this.toPrincipalType$.next(this.data.principalTypes[0]),this.addSub(this.form.get("account").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(i=>this.fetchPaymentTypeData(i))),this.addSub(this.form.get("toPrincipalType").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(i=>{var o;return this.toPrincipalType$.next(null===(o=this.data)||void 0===o?void 0:o.principalTypes.find(r=>r.id===i))})),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}adjustPaymentTypes(){const t=this.form.value;if(0===(t.subject||"").trim().length)return;const o=this.fetchedPaymentTypes||[];(0,h.cS)(o)&&this.notification.error(this.i18n.transaction.noTypes);const r=o.filter(g=>g.from.id===t.account);let l=this.form.value.type,_=null;(0,h.cS)(r)?_={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(r),r.find(g=>g.id===l)||(l=r[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:l}),this.form.get("account").setErrors(_),this.form.get("account").markAsTouched(),(0,h.cS)(l)||this.fetchPaymentTypeData(l),this.availablePaymentTypes.emit(r)}setFetchedPaymentTypes(t){this.userField&&(this.userField.user=t.toUser),this.fetchedPaymentTypes=t.paymentTypes;const i=t.paymentTypeData;i&&this.dataCache.set(i.id,i),this.adjustPaymentTypes()}fetchPaymentTypeData(t){if((0,h.cS)(this.form.value.subject)||(0,h.cS)(t))return;const o=this.dataCache.get(t);o?this.setPaymentTypeData(o):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(r=>{this.addSub(this.externalPaymentsService.dataForPerformExternalPayment({owner:this.ownerParam,type:t,fields:["paymentTypeData"]}).subscribe(l=>{this.setPaymentTypeData(l.paymentTypeData)},l=>{sa.includes(l.status)||r(l)}))}))}setPaymentTypeData(t){((this.paymentTypeData$.value||{}).id||null)!==((t||{}).id||null)&&(t&&(this.dataCache.set(t.id,t),t.fixedAmount&&this.form.patchValue({amount:t.fixedAmount}),this.firstPaymentTypeUpdate?this.firstPaymentTypeUpdate=!1:(0,h.T_)(this.amountField)),this.paymentTypeData$.next(t))}get singleAccount(){const t=this.data.accounts||[];return 1===t.length?t[0]:null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(xt),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["external-payment-step-form"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Do,5),e.Gf(Ro,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.userField=o.first),e.iGM(o=e.CRH())&&(i.amountField=o.first)}},inputs:{data:"data",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",toSystem:"toSystem",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[e.qOj],decls:22,vars:27,consts:[[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleAccounts",""],["formControlName","toPrincipalType",3,"label",4,"ngIf"],["required","","kind","field",3,"label"],["formControlName","toPrincipalValue",3,"placeholder","mask"],["toPrincipalValue",""],["formControlName","type","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],[3,"field","formControl",4,"ngFor","ngForOf"],[4,"ngIf"],["kind","fieldView",3,"label"],[3,"user"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],["class","\n            col-5 col-sm-4 col-md-7\n            pl-2\n            text-right text-xs-left\n            font-weight-bold\n          ",3,"ngClass",4,"ngIf"],["separator",""],[1,"col-5","col-sm-4","col-md-7","pl-2","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["formControlName","toPrincipalType",3,"label"],["toPrincipalType",""],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type","required","",3,"label"],["type",""],["focused","","formControlName","amount","required","",3,"label","scale","prefix","suffix"],["amount",""],[3,"field","formControl"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,Vo,2,2,"label-value",1),e.YNc(2,$o,2,1,"ng-container",2),e.YNc(3,Wo,3,3,"ng-template",null,3,e.W1O),e.YNc(5,Ko,3,2,"radio-group-field",4),e.TgZ(6,"label-value",5),e.ALo(7,"async"),e._UZ(8,"input-field",6,7),e.ALo(10,"async"),e.ALo(11,"async"),e.qZA(),e.YNc(12,ta,4,4,"single-selection-field",8),e.ALo(13,"async"),e.YNc(14,na,3,5,"label-value",9),e.ALo(15,"async"),e.YNc(16,ia,2,4,"ng-template",null,10,e.W1O),e.YNc(18,oa,1,2,"custom-field-input",11),e.ALo(19,"async"),e.YNc(20,ra,2,1,"ng-container",12),e.ALo(21,"async"),e.BQk()),2&t){const o=e.MAs(4),r=e.MAs(17);let l,_,g,P,S,I,Ae;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.fromUser&&!i.fromSelf),e.xp6(1),e.Q6J("ngIf",i.singleAccount)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",i.data.principalTypes.length>1),e.xp6(1),e.Q6J("label",null==(l=e.lcZ(7,13,i.toPrincipalType$))?null:l.name),e.xp6(2),e.Q6J("placeholder",null==(_=e.lcZ(10,15,i.toPrincipalType$))?null:_.example)("mask",null==(g=e.lcZ(11,17,i.toPrincipalType$))?null:g.mask),e.xp6(4),e.Q6J("ngIf",(null==(P=e.lcZ(13,19,i.paymentTypes$))?null:P.length)>1),e.xp6(2),e.Q6J("ngIf",null==(S=e.lcZ(15,21,i.paymentTypeData$))?null:S.fixedAmount)("ngIfElse",r),e.xp6(4),e.Q6J("ngForOf",null==(I=e.lcZ(19,23,i.paymentTypeData$))?null:I.customFields),e.xp6(2),e.Q6J("ngIf",(null==(Ae=e.lcZ(21,25,i.paymentTypeData$))?null:Ae.descriptionAvailability)||"disabled")}},directives:[s.JL,s.sg,u.O5,C.t,Q.F,u.mk,u.sg,s._,s.Fj,s.JJ,s.u,bt.e,qe.Y,J.s,F.q,fe.h,O.f,s.Q7,B.U,z.A,Se.G,s.oH,Te.u],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var Ye=m(2089),Qe=m(5178),he=m(244);function la(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._UZ(1,"user-link",6),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromUser),e.xp6(1),e.Q6J("user",t.fromUser)}}function ua(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.preview.fromAccount.type.name,"\n")}}function pa(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.hij(" ",t.preview.paymentType.name,"\n")}}function ma(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.preview.mainAmount,t.preview.currency),"\n")}}function da(n,a){if(1&n&&(e.TgZ(0,"div",8)(1,"div",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij("",t.fee.name,":"),e.xp6(2),e.Oqu(e.xi3(5,2,t.amount,i.preview.currency))}}function fa(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e.YNc(1,da,6,5,"div",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.appliedFees),e.xp6(1),e.Q6J("ngForOf",t.fees)}}function _a(n,a){1&n&&e._UZ(0,"custom-field-value",11),2&n&&e.Q6J("fieldValue",a.$implicit)}function ha(n,a){if(1&n&&e._UZ(0,"label-value",12),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("value",t.preview.payment.description)}}function ga(n,a){1&n&&e._UZ(0,"hr")}function ya(n,a){1&n&&e._UZ(0,"hr")}function xa(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ya,1,0,"hr",4),e.ALo(2,"async"),e.TgZ(3,"div",13),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.layout.gtxxs$)),e.xp6(3),e.Oqu(t.preview.confirmationMessage)}}function ba(n,a){1&n&&e._UZ(0,"hr")}function va(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,ba,1,0,"hr",4),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",14),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.form.get("confirmationPassword"))("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}let Ta=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.bankingHelper=i,this.authHelper=o,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===ot.S.SYSTEM,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,this.createDeviceConfirmation=()=>({type:U.l.PERFORM_EXTERNAL_PAYMENT,from:b.S.accountOwner(this.preview.fromAccount),paymentType:this.preview.paymentType.id,amount:this.preview.payment.amount,toPrincipal:this.preview.payment.toPrincipalValue}),this.preview.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["external-payment-step-confirm"]],inputs:{preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:16,vars:19,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],[3,"user"],["class","row no-gutters align-items-end",4,"ngFor","ngForOf"],[1,"row","no-gutters","align-items-end"],[1,"col-3"],[1,"col","pl-1"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"break-nl"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"]],template:function(t,i){1&t&&(e.YNc(0,la,2,2,"label-value",0),e.YNc(1,ua,2,2,"label-value",0),e.TgZ(2,"label-value",1),e._uU(3),e.qZA(),e.YNc(4,pa,2,2,"label-value",0),e.YNc(5,ma,3,5,"label-value",0),e.YNc(6,fa,2,2,"label-value",0),e.YNc(7,_a,1,1,"custom-field-value",2),e.YNc(8,ha,1,2,"label-value",3),e.YNc(9,ga,1,0,"hr",4),e.ALo(10,"async"),e.TgZ(11,"label-value",5),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.YNc(14,xa,5,4,"ng-container",4),e.YNc(15,va,4,6,"ng-container",4)),2&t&&(e.Q6J("ngIf",!i.fromSelf&&i.fromUser),e.xp6(1),e.Q6J("ngIf",i.fromSystem),e.xp6(1),e.Q6J("label",null==i.preview.toPrincipalType?null:i.preview.toPrincipalType.name),e.xp6(1),e.hij(" ",i.preview.payment.toPrincipalValue,"\n"),e.xp6(1),e.Q6J("ngIf",i.showPaymentType),e.xp6(1),e.Q6J("ngIf",null!=i.preview.mainAmount&&i.preview.totalAmount!==i.preview.mainAmount),e.xp6(1),e.Q6J("ngIf",(null==i.fees?null:i.fees.length)>0),e.xp6(1),e.Q6J("ngForOf",i.preview.customValues),e.xp6(1),e.Q6J("ngIf",i.preview.payment.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(10,14,i.layout.gtxxs$)),e.xp6(2),e.Q6J("label",i.i18n.transaction.totalAmount),e.xp6(1),e.hij(" ",e.xi3(13,16,i.preview.totalAmount,i.preview.currency),"\n"),e.xp6(2),e.Q6J("ngIf",(i.preview.confirmationMessage||"").length>0),e.xp6(1),e.Q6J("ngIf",i.preview.confirmationPasswordInput))},directives:[u.O5,C.t,Q.F,u.sg,Qe.W,he.y,z.A,s.JJ,s.oH],pipes:[w.H,u.Ov],encapsulation:2,changeDetection:0}),n})();function wa(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"alert",5),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("mode",e.lcZ(1,4,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(3),e.Oqu(t.generalError)}}function Ca(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"external-payment-step-form",6),e.NdJ("availablePaymentTypes",function(o){return e.CHM(t),e.oxw().availablePaymentTypes=o}),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"actions",7)(5,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().toConfirm()}),e.ALo(6,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("mode",e.lcZ(1,10,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.data)("form",t.form)("currency",e.lcZ(3,12,t.currency$))("paymentTypeData$",t.paymentTypeData$)("customValuesControlGetter",t.customValuesControlGetter),e.xp6(3),e.Q6J("disabled",e.lcZ(6,14,t.requesting$))("label",t.i18n.general.next)}}function Aa(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).perform()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function Za(n,a){1&n&&e._uU(0,"\xa0")}const Pa=function(){return[]};function qa(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",9),e.ALo(1,"async"),e.TgZ(2,"external-payment-step-confirm",10),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().perform(o)}),e.qZA(),e.TgZ(3,"actions",7),e.YNc(4,Aa,2,4,"action-button",11),e.ALo(5,"async"),e.YNc(6,Za,1,0,"ng-template",null,12,e.W1O),e.TgZ(8,"action-button",13),e.NdJ("action",function(){return e.CHM(t),e.oxw().backToForm()}),e.qZA()()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.transaction.title.paymentConfirmation)("mobileHeading",i.i18n.transaction.mobileTitle.paymentConfirmation)("mode",e.lcZ(1,9,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("preview",i.preview)("confirmationPassword",i.confirmationPassword)("showPaymentType",(i.availablePaymentTypes||e.DdM(13,Pa)).length>1),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,11,i.showSubmit$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.general.previous)}}function Sa(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let Qa=(()=>{class n extends $.y{constructor(t,i,o){super(t),this.bankingHelper=i,this.externalPaymentsService=o,this.steps=["error","form","confirm"],this.step$=new y.X(null),this.currency$=new y.X(null),this.showSubmit$=new y.X(!0),this.paymentTypeData$=new y.X(null),this.customValuesControls=new Map}get step(){return this.step$.value}set step(t){this.step$.next(t)}get currency(){return this.currency$.value}set currency(t){this.currency$.next(t)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(t){this.paymentTypeData$.next(t),this.updatePaymentTypeData(t)}get generalError(){return this._generalError}ngOnInit(){super.ngOnInit(),this.ownerParam=this.route.snapshot.params.owner,this.fromSelf=this.authHelper.isSelf(this.ownerParam),this.fromSystem=this.authHelper.isSystem(this.ownerParam),this.fromSystem?(this.title=this.i18n.transaction.title.externalPaymentFromSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.externalPaymentFromSystem):(this.title=this.i18n.transaction.title.externalPaymentFromUser,this.mobileTitle=this.i18n.transaction.mobileTitle.externalPaymentFromUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.externalPaymentsService.dataForPerformExternalPayment({owner:this.ownerParam}).subscribe(i=>this.data=i)),this.addSub(this.form.get("account").valueChanges.subscribe(i=>this.updateCurrency(this.data,i))),this.addSub(this.paymentTypeData$.subscribe(i=>{(null==this.lastPaymentTypeData||!(0,Ge.Z)(this.lastPaymentTypeData,i))&&this.adjustForm(i),this.lastPaymentTypeData=i}))}buildForm(){return this.formBuilder.group({account:null,subject:[this.ownerParam,s.kI.required],type:[null,s.kI.required],amount:[null,s.kI.required],toPrincipalType:[null,s.kI.required],toPrincipalValue:[null,s.kI.required],description:null})}updateCurrency(t,i){let o=null;!(0,h.cS)(i)&&t&&t.accounts&&(o=t.accounts.find(r=>r.type.id===i)),this.currency=o?o.currency:null}adjustForm(t){const i=this.form.get("description");(t||{}).descriptionAvailability===st.e.REQUIRED?i.setValidators(s.kI.required):(0,h.bR)(i)}onDataInitialized(t){var i;if((0,h.cS)(t.accounts))this.step="error",this._generalError=this.bankingHelper.noAccountForPaymentErrorMessage();else if((0,h.cS)(t.principalTypes))this.step="error",this._generalError=this.i18n.transaction.noExternalPaymentPrincipalTypes;else{this.step="form";const o=t.accounts[0].type.id;this.form.patchValue({account:o,toPrincipalType:null===(i=t.principalTypes[0])||void 0===i?void 0:i.id},{emitEvent:!1}),this.updateCurrency(t,o)}}updatePaymentTypeData(t){const i=this.form.get("amount");t&&t.fixedAmount?(i.setValue(t.fixedAmount),i.disable()):i.disabled&&i.enable()}backToForm(){this.step="form"}toConfirm(){const t={},i=this.paymentTypeData;if(i&&i.customFields)for(const o of i.customFields)t[o.internalName]=this.customValuesControlGetter(o);this.form.setControl("customValues",new s.cw(t)),(0,h.pt)(this.form)&&this.addSub(this.externalPaymentsService.previewExternalPayment({owner:this.ownerParam,body:this.form.value}).subscribe(o=>{this.preview=o,this.step="confirm",this.canConfirm=this.authHelper.canConfirm(o.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(o.confirmationPasswordInput)),this.confirmationPassword.setValidators(o.confirmationPasswordInput?s.kI.required:null),(0,h.SM)()}))}perform(t){if(t&&this.confirmationPassword.setValue(t),!(0,h.pt)(this.confirmationPassword))return;const i={},o=this.paymentTypeData;if(o&&o.customFields)for(const r of o.customFields)i[r.internalName]=this.customValuesControlGetter(r);this.form.setControl("customValues",new s.cw(i)),(0,h.pt)(this.form)&&this.externalPaymentsService.performExternalPayment({owner:this.ownerParam,body:this.form.value,confirmationPassword:this.confirmationPassword.value}).pipe((0,Le.P)()).subscribe(r=>{this.router.navigate(["/banking","transaction",this.bankingHelper.transactionNumberOrId(r)],{state:{url:this.router.url}})})}locateControl(t){return(0,h.xB)(this.form,t)}get customValuesControlGetter(){return t=>{const i=t.internalName;let o=this.customValuesControls.get(i);return null==o&&(o=this.formBuilder.control(t.defaultValue,t.required?s.kI.required:null),this.customValuesControls.set(i,o)),o}}resolveMenu(t){return this.fromSystem?v.v2.EXTERNAL_PAYMENTS:this.menu.userMenu(t.fromUser,v.v2.EXTERNAL_PAYMENTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(xt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["external-payment"]],features:[e.qOj],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],["type","danger"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"preview","confirmationPassword","showPaymentType","showSubmit","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],["outline","",3,"label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,wa,4,6,"page-content",1),e.YNc(4,Ca,7,16,"page-content",1),e.YNc(5,qa,9,14,"page-content",2),e.YNc(6,Sa,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","error"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,Z.Y,Oo.wx,ca,L.h,k.x,Ta,u.O5,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})(),ct=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getDataForUserPaymentLimits$Response(t,i){const o=new d.c(this.rootUrl,n.GetDataForUserPaymentLimitsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getDataForUserPaymentLimits(t,i){return this.getDataForUserPaymentLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}getAccountPaymentLimits$Response(t,i){const o=new d.c(this.rootUrl,n.GetAccountPaymentLimitsPath,"get");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getAccountPaymentLimits(t,i){return this.getAccountPaymentLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}setAccountPaymentLimits$Response(t,i){const o=new d.c(this.rootUrl,n.SetAccountPaymentLimitsPath,"put");return t&&(o.path("user",t.user,{}),o.path("accountType",t.accountType,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setAccountPaymentLimits(t,i){return this.setAccountPaymentLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}getAccountPaymentLimitsData$Response(t,i){const o=new d.c(this.rootUrl,n.GetAccountPaymentLimitsDataPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getAccountPaymentLimitsData(t,i){return this.getAccountPaymentLimitsData$Response(t,i).pipe((0,c.U)(o=>o.body))}searchAccountPaymentLimits$Response(t,i){const o=new d.c(this.rootUrl,n.SearchAccountPaymentLimitsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accountType",t.accountType,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("currency",t.currency,{}),o.query("customAmountLimit",t.customAmountLimit,{}),o.query("customAmountLimitRange",t.customAmountLimitRange,{}),o.query("customAmountPerDayLimit",t.customAmountPerDayLimit,{}),o.query("customAmountPerDayLimitRange",t.customAmountPerDayLimitRange,{}),o.query("customAmountPerMonthLimit",t.customAmountPerMonthLimit,{}),o.query("customAmountPerMonthLimitRange",t.customAmountPerMonthLimitRange,{}),o.query("customAmountPerWeekLimit",t.customAmountPerWeekLimit,{}),o.query("customAmountPerWeekLimitRange",t.customAmountPerWeekLimitRange,{}),o.query("customAmountPerYearLimit",t.customAmountPerYearLimit,{}),o.query("customAmountPerYearLimitRange",t.customAmountPerYearLimitRange,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchAccountPaymentLimits(t,i){return this.searchAccountPaymentLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}exportAccountPaymentLimits$Response(t,i){const o=new d.c(this.rootUrl,n.ExportAccountPaymentLimitsPath,"get");return t&&(o.path("format",t.format,{}),o.query("accountType",t.accountType,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("currency",t.currency,{}),o.query("customAmountLimit",t.customAmountLimit,{}),o.query("customAmountLimitRange",t.customAmountLimitRange,{}),o.query("customAmountPerDayLimit",t.customAmountPerDayLimit,{}),o.query("customAmountPerDayLimitRange",t.customAmountPerDayLimitRange,{}),o.query("customAmountPerMonthLimit",t.customAmountPerMonthLimit,{}),o.query("customAmountPerMonthLimitRange",t.customAmountPerMonthLimitRange,{}),o.query("customAmountPerWeekLimit",t.customAmountPerWeekLimit,{}),o.query("customAmountPerWeekLimitRange",t.customAmountPerWeekLimitRange,{}),o.query("customAmountPerYearLimit",t.customAmountPerYearLimit,{}),o.query("customAmountPerYearLimitRange",t.customAmountPerYearLimitRange,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportAccountPaymentLimits(t,i){return this.exportAccountPaymentLimits$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetDataForUserPaymentLimitsPath="/{user}/accounts/data-for-payment-limits",n.GetAccountPaymentLimitsPath="/{user}/accounts/{accountType}/payment-limits",n.SetAccountPaymentLimitsPath="/{user}/accounts/{accountType}/payment-limits",n.GetAccountPaymentLimitsDataPath="/accounts/data-for-payment-limits",n.SearchAccountPaymentLimitsPath="/accounts/payment-limits",n.ExportAccountPaymentLimitsPath="/accounts/payment-limits/export/{format}",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ua(n,a){if(1&n&&(e.ynx(0,4),e.TgZ(1,"label-value",5),e._UZ(2,"user-link",6),e.qZA(),e.TgZ(3,"label-value",7),e._uU(4),e.qZA(),e.TgZ(5,"h2",8),e._uU(6),e.qZA(),e._UZ(7,"single-selection-field",9)(8,"decimal-field",10),e.ALo(9,"async"),e.ALo(10,"async"),e.TgZ(11,"label-value",11),e.ALo(12,"async"),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"h2",8),e._uU(16),e.qZA(),e._UZ(17,"single-selection-field",12)(18,"decimal-field",13),e.ALo(19,"async"),e.ALo(20,"async"),e.TgZ(21,"label-value",11),e.ALo(22,"async"),e._uU(23),e.ALo(24,"currency"),e.qZA(),e.TgZ(25,"h2",8),e._uU(26),e.qZA(),e._UZ(27,"single-selection-field",14)(28,"decimal-field",15),e.ALo(29,"async"),e.ALo(30,"async"),e.TgZ(31,"label-value",11),e.ALo(32,"async"),e._uU(33),e.ALo(34,"currency"),e.qZA(),e.TgZ(35,"h2",8),e._uU(36),e.qZA(),e._UZ(37,"single-selection-field",16)(38,"decimal-field",17),e.ALo(39,"async"),e.ALo(40,"async"),e.TgZ(41,"label-value",11),e.ALo(42,"async"),e._uU(43),e.ALo(44,"currency"),e.qZA(),e.TgZ(45,"h2",8),e._uU(46),e.qZA(),e._UZ(47,"single-selection-field",18)(48,"decimal-field",19),e.ALo(49,"async"),e.ALo(50,"async"),e.TgZ(51,"label-value",11),e.ALo(52,"async"),e._uU(53),e.ALo(54,"currency"),e.qZA(),e._UZ(55,"hr")(56,"textarea-field",20),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.account.account),e.xp6(1),e.hij(" ",t.data.account.type.name," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.modeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(9,66,t.isDefaultPaymentLimit$))("required",!e.lcZ(10,68,t.isDefaultPaymentLimit$))("label",t.i18n.account.paymentLimits.paymentLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(12,70,t.isDefaultPaymentLimit$))("label",t.i18n.account.paymentLimits.paymentLimit),e.xp6(2),e.hij(" ",e.xi3(14,72,t.data.productAmountLimit?t.data.productAmountLimit:0,t.data.account.currency)," "),e.xp6(3),e.Oqu(t.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.modeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(19,75,t.isDefaultDailyLimit$))("required",!e.lcZ(20,77,t.isDefaultDailyLimit$))("label",t.i18n.account.paymentLimits.dailyLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(22,79,t.isDefaultDailyLimit$))("label",t.i18n.account.paymentLimits.dailyLimit),e.xp6(2),e.hij(" ",e.xi3(24,81,t.data.productAmountPerDayLimit?t.data.productAmountPerDayLimit:0,t.data.account.currency)," "),e.xp6(3),e.Oqu(t.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.modeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(29,84,t.isDefaultWeeklyLimit$))("required",!e.lcZ(30,86,t.isDefaultWeeklyLimit$))("label",t.i18n.account.paymentLimits.weeklyLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(32,88,t.isDefaultWeeklyLimit$))("label",t.i18n.account.paymentLimits.weeklyLimit),e.xp6(2),e.hij(" ",e.xi3(34,90,t.data.productAmountPerWeekLimit?t.data.productAmountPerWeekLimit:0,t.data.account.currency)," "),e.xp6(3),e.Oqu(t.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.modeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(39,93,t.isDefaultMonthlyLimit$))("required",!e.lcZ(40,95,t.isDefaultMonthlyLimit$))("label",t.i18n.account.paymentLimits.monthlyLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(42,97,t.isDefaultMonthlyLimit$))("label",t.i18n.account.paymentLimits.monthlyLimit),e.xp6(2),e.hij(" ",e.xi3(44,99,t.data.productAmountPerMonthLimit?t.data.productAmountPerMonthLimit:0,t.data.account.currency)," "),e.xp6(3),e.Oqu(t.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode)("fieldOptions",t.modeOptions),e.xp6(1),e.Q6J("hidden",e.lcZ(49,102,t.isDefaultYearlyLimit$))("required",!e.lcZ(50,104,t.isDefaultYearlyLimit$))("label",t.i18n.account.paymentLimits.yearlyLimit)("scale",t.data.account.currency.decimalDigits)("prefix",t.data.account.currency.prefix)("suffix",t.data.account.currency.suffix),e.xp6(3),e.Q6J("hidden",!e.lcZ(52,106,t.isDefaultYearlyLimit$))("label",t.i18n.account.paymentLimits.yearlyLimit),e.xp6(2),e.hij(" ",e.xi3(54,108,t.data.productAmountPerYearLimit?t.data.productAmountPerYearLimit:0,t.data.account.currency)," "),e.xp6(3),e.Q6J("label",t.i18n.general.comments)}}let Na=(()=>{class n extends $.y{constructor(t,i){super(t),this.paymentLimitsService=i,this.isDefaultPaymentLimit$=new y.X(null),this.isDefaultDailyLimit$=new y.X(null),this.isDefaultWeeklyLimit$=new y.X(null),this.isDefaultMonthlyLimit$=new y.X(null),this.isDefaultYearlyLimit$=new y.X(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(t=>this.data=t))}get modeOptions(){const t=[{value:"default",text:this.i18n.account.limits.productDefault}];return t.push({value:"personalized",text:this.i18n.account.limits.personalized}),t}mode(t){return t?"personalized":"default"}onDataInitialized(t){super.onDataInitialized(t);const i=this.mode(t.customAmountLimit),o=this.mode(t.customAmountPerDayLimit),r=this.mode(t.customAmountPerWeekLimit),l=this.mode(t.customAmountPerMonthLimit),_=this.mode(t.customAmountPerYearLimit);this.form=this.formBuilder.group({paymentLimitMode:i,amountLimit:t.amountLimit,dailyLimitMode:o,amountPerDayLimit:t.amountPerDayLimit,weeklyLimitMode:r,amountPerWeekLimit:t.amountPerWeekLimit,monthlyLimitMode:l,amountPerMonthLimit:t.amountPerMonthLimit,yearlyLimitMode:_,amountPerYearLimit:t.amountPerYearLimit,comment:null}),this.formControl("paymentLimitMode").valueChanges.subscribe(g=>this.isDefaultPaymentLimit$.next("default"===g)),this.isDefaultPaymentLimit$.next("default"===i),this.formControl("dailyLimitMode").valueChanges.subscribe(g=>this.isDefaultDailyLimit$.next("default"===g)),this.isDefaultDailyLimit$.next("default"===o),this.formControl("weeklyLimitMode").valueChanges.subscribe(g=>this.isDefaultWeeklyLimit$.next("default"===g)),this.isDefaultWeeklyLimit$.next("default"===r),this.formControl("monthlyLimitMode").valueChanges.subscribe(g=>this.isDefaultMonthlyLimit$.next("default"===g)),this.isDefaultMonthlyLimit$.next("default"===l),this.formControl("yearlyLimitMode").valueChanges.subscribe(g=>this.isDefaultYearlyLimit$.next("default"===g)),this.isDefaultYearlyLimit$.next("default"===_)}save(){if(!(0,h.pt)(this.form))return;const t=(0,ze.Z)(this.form.value);t.customAmountLimit="default"!==t.paymentLimitMode,t.customAmountLimit||delete t.amountLimit,t.customAmountPerDayLimit="default"!==t.dailyLimitMode,t.customAmountPerDayLimit||delete t.amountPerDayLimit,t.customAmountPerWeekLimit="default"!==t.weeklyLimitMode,t.customAmountPerWeekLimit||delete t.amountPerWeekLimit,t.customAmountPerMonthLimit="default"!==t.monthlyLimitMode,t.customAmountPerMonthLimit||delete t.amountPerMonthLimit,t.customAmountPerYearLimit="default"!==t.yearlyLimitMode,t.customAmountPerYearLimit||delete t.amountPerYearLimit,delete t.creditLimitMode,delete t.upperCreditLimitMode,this.data.confirmationPasswordInput?this.confirmation.confirm({title:this.i18n.general.confirm,message:this.i18n.account.paymentLimits.confirm,createDeviceConfirmation:this.paymentLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:i=>this.doSave(t,i.confirmationPassword)}):this.doSave(t)}doSave(t,i){this.addSub(this.paymentLimitsService.setAccountPaymentLimits({user:this.user,accountType:this.accountType,confirmationPassword:i,body:t}).subscribe(()=>{this.notification.snackBar(this.i18n.account.paymentLimits.saved),this.reload()}))}paymentLimitsDeviceConfirmation(){return()=>({type:U.l.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(t){return this.form.get(t)}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ct))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-account-payment-limits"]],features:[e.qOj],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],["labelPosition","side","formControlName","paymentLimitMode",3,"label","fieldOptions"],["formControlName","amountLimit",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","dailyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerDayLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","weeklyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerWeekLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","monthlyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerMonthLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","yearlyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerYearLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.ALo(3,"async"),e.YNc(4,Ua,57,111,"ng-container",2),e.TgZ(5,"actions")(6,"action-button",3),e.NdJ("action",function(){return i.save()}),e.ALo(7,"async"),e.qZA()()()()),2&t&&(e.Q6J("ready",e.lcZ(1,7,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.account.paymentLimits.title.edit)("mobileHeading",i.i18n.account.paymentLimits.mobileTitle.edit)("headingActions",e.lcZ(3,9,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",i.data),e.xp6(2),e.Q6J("disabled",e.lcZ(7,11,i.requesting$))("label",i.i18n.general.save))},directives:[A.w,Z.Y,u.O5,s.JL,s.sg,C.t,Q.F,O.f,s.JJ,s.u,B.U,s.Q7,Te.u,L.h,k.x],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function Ia(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result",7),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(2);return _.router.navigate(_.path(l.account.type)),o.stopPropagation()}),e.TgZ(1,"div",8)(2,"div",9)(3,"label-value",10),e._uU(4),e.qZA(),e.TgZ(5,"label-value",10),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"label-value",10),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"label-value",10),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"label-value",10),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"label-value",10),e._uU(18),e.ALo(19,"currency"),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.account.account),e.xp6(1),e.hij(" ",t.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.hij(" ",t.amountLimit?e.xi3(7,12,t.amountLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.hij(" ",t.amountPerDayLimit?e.xi3(10,15,t.amountPerDayLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.hij(" ",t.amountPerWeekLimit?e.xi3(13,18,t.amountPerWeekLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.hij(" ",t.amountPerMonthLimit?e.xi3(16,21,t.amountPerMonthLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.hij(" ",t.amountPerYearLimit?e.xi3(19,24,t.amountPerYearLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," ")}}function Ja(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",7),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(3);return _.router.navigate(_.path(l.account.type)),o.stopPropagation()}),e.TgZ(1,"td",13),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"currency"),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.account.type.name),e.xp6(2),e.hij(" ",t.amountLimit?e.xi3(5,6,t.amountLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(3),e.hij(" ",t.amountPerDayLimit?e.xi3(8,9,t.amountPerDayLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(3),e.hij(" ",t.amountPerWeekLimit?e.xi3(11,12,t.amountPerWeekLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(3),e.hij(" ",t.amountPerMonthLimit?e.xi3(14,15,t.amountPerMonthLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," "),e.xp6(3),e.hij(" ",t.amountPerYearLimit?e.xi3(17,18,t.amountPerYearLimit,t.account.currency):i.i18n.account.paymentLimits.definedInPaymentType," ")}}function La(n,a){if(1&n&&(e.TgZ(0,"table",11)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.qZA()(),e.TgZ(14,"tbody"),e.YNc(15,Ja,18,21,"tr",12),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.account.account),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.paymentLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.dailyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.weeklyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.monthlyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.yearlyLimit),e.xp6(2),e.Q6J("ngForOf",t.data.accountLimits)}}function ka(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e._UZ(3,"user-info",3),e.qZA(),e.TgZ(4,"results-layout",4),e.YNc(5,Ia,20,27,"mobile-result",5),e.YNc(6,La,16,7,"table",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode","normal")("heading",t.i18n.account.paymentLimits.title.list)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.list)("headingActions",e.lcZ(2,6,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.accountLimits)}}let Fa=(()=>{class n extends $.y{constructor(t,i){super(t),this.paymentLimitsService=i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.paymentLimitsService.getDataForUserPaymentLimits({user:this.user}).subscribe(t=>{1===t.accountLimits.length?this.router.navigate(this.path(t.accountLimits[0].account.type),{replaceUrl:!0}):this.data=t}))}path(t){return["/banking",this.user,"account-payment-limits",t.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ct))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-accounts-payment-limits"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","20%"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,ka,7,8,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,oe.M,D.D,R.E,V.t,C.t,Y.p,u.sg],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function Oa(n,a){1&n&&e.GkF(0)}function Da(n,a){if(1&n&&e._UZ(0,"field-option",14),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function Ra(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",12),e.YNc(2,Da,1,5,"field-option",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function Va(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function Ya(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",15),e.YNc(2,Va,1,2,"field-option",16),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.currency)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.currencies)}}function Ea(n,a){if(1&n&&e._UZ(0,"field-option",40),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t.id)("text",t.name)}}function $a(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",38),e.YNc(2,Ea,1,3,"field-option",39),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.account.account)("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("ngForOf",t.accountTypes())}}function Ba(n,a){if(1&n&&(e.ynx(0),e.YNc(1,$a,3,3,"div",6),e.TgZ(2,"div",11),e._UZ(3,"single-selection-field",18),e.qZA(),e._UZ(4,"div",19),e.ALo(5,"async"),e.TgZ(6,"div",20),e.ALo(7,"async"),e._UZ(8,"decimal-field",21),e.qZA(),e.TgZ(9,"div",20),e.ALo(10,"async"),e._UZ(11,"decimal-field",22),e.qZA(),e.TgZ(12,"div",11),e._UZ(13,"single-selection-field",23),e.qZA(),e._UZ(14,"div",19),e.ALo(15,"async"),e.TgZ(16,"div",20),e.ALo(17,"async"),e._UZ(18,"decimal-field",24),e.qZA(),e.TgZ(19,"div",20),e.ALo(20,"async"),e._UZ(21,"decimal-field",25),e.qZA(),e.TgZ(22,"div",11),e._UZ(23,"single-selection-field",26),e.qZA(),e._UZ(24,"div",19),e.ALo(25,"async"),e.TgZ(26,"div",20),e.ALo(27,"async"),e._UZ(28,"decimal-field",27),e.qZA(),e.TgZ(29,"div",20),e.ALo(30,"async"),e._UZ(31,"decimal-field",28),e.qZA(),e.TgZ(32,"div",11),e._UZ(33,"single-selection-field",29),e.qZA(),e._UZ(34,"div",19),e.ALo(35,"async"),e.TgZ(36,"div",20),e.ALo(37,"async"),e._UZ(38,"decimal-field",30),e.qZA(),e.TgZ(39,"div",20),e.ALo(40,"async"),e._UZ(41,"decimal-field",31),e.qZA(),e.TgZ(42,"div",11),e._UZ(43,"single-selection-field",32),e.qZA(),e._UZ(44,"div",19),e.ALo(45,"async"),e.TgZ(46,"div",20),e.ALo(47,"async"),e._UZ(48,"decimal-field",33),e.qZA(),e.TgZ(49,"div",20),e.ALo(50,"async"),e._UZ(51,"decimal-field",34),e.qZA(),e.TgZ(52,"div",11),e._UZ(53,"user-field",35),e.qZA(),e.TgZ(54,"div",11),e._UZ(55,"user-field",36),e.qZA(),e.TgZ(56,"div",11),e._UZ(57,"user-field",37),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.paymentLimits.personalizedPaymentLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(5,79,t.isCustomPaymentLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(7,81,t.isCustomPaymentLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.fromPaymentLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(10,83,t.isCustomPaymentLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.toPaymentLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.paymentLimits.personalizedDailyLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(15,85,t.isCustomDailyLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(17,87,t.isCustomDailyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.fromDailyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(20,89,t.isCustomDailyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.toDailyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.paymentLimits.personalizedWeeklyLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(25,91,t.isCustomWeeklyLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(27,93,t.isCustomWeeklyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.fromWeeklyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(30,95,t.isCustomWeeklyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.toWeeklyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.paymentLimits.personalizedMonthlyLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(35,97,t.isCustomMonthlyLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(37,99,t.isCustomMonthlyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.fromMonthlyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(40,101,t.isCustomMonthlyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.toMonthlyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("fieldOptions",t.customLimitOptions)("emptyOption",t.i18n.general.all)("label",t.i18n.account.paymentLimits.personalizedYearlyLimit),e.xp6(1),e.Q6J("hidden",!e.lcZ(45,103,t.isCustomYearlyLimit$)),e.xp6(2),e.Q6J("hidden",!e.lcZ(47,105,t.isCustomYearlyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.fromYearlyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(1),e.Q6J("hidden",!e.lcZ(50,107,t.isCustomYearlyLimit$)),e.xp6(2),e.Q6J("label",t.i18n.account.paymentLimits.toYearlyLimit)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("label",t.i18n.general.user)("allowContacts",!1),e.xp6(2),e.Q6J("label",t.i18n.general.usersOfBroker)("filters",t.userSearchFilters(!0))("allowContacts",!1),e.xp6(2),e.Q6J("label",t.i18n.general.changedBy)("filters",t.userSearchFilters(!1))("allowContacts",!1)}}function Ha(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result",41),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(2);return _.router.navigate(_.view(l)),o.stopPropagation()}),e.TgZ(1,"div",42)(2,"div",43)(3,"label-value",44),e._uU(4),e.qZA(),e.TgZ(5,"label-value",44),e._uU(6),e.qZA(),e.TgZ(7,"label-value",44),e._uU(8),e.ALo(9,"currency"),e.qZA(),e.TgZ(10,"label-value",44),e._uU(11),e.ALo(12,"currency"),e.qZA(),e.TgZ(13,"label-value",44),e._uU(14),e.ALo(15,"currency"),e.qZA(),e.TgZ(16,"label-value",44),e._uU(17),e.ALo(18,"currency"),e.qZA(),e.TgZ(19,"label-value",44),e._uU(20),e.ALo(21,"currency"),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.user),e.xp6(1),e.hij(" ",t.user.display," "),e.xp6(1),e.Q6J("label",i.i18n.account.account),e.xp6(1),e.hij(" ",t.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.hij(" ",t.customAmountLimit?e.xi3(9,14,t.amountLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.hij(" ",t.customAmountPerDayLimit?e.xi3(12,17,t.amountPerDayLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.hij(" ",t.customAmountPerWeekLimit?e.xi3(15,20,t.amountPerWeekLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.hij(" ",t.customAmountPerMonthLimit?e.xi3(18,23,t.amountPerMonthLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.hij(" ",t.customAmountPerYearLimit?e.xi3(21,26,t.amountPerYearLimit,t.account.currency):i.i18n.account.limits.productDefault," ")}}function ja(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",41),e.NdJ("click",function(o){const l=e.CHM(t).$implicit,_=e.oxw(3);return _.router.navigate(_.view(l)),o.stopPropagation()}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"currency"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.ALo(19,"currency"),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.user.display),e.xp6(2),e.Oqu(t.account.type.name),e.xp6(2),e.hij(" ",t.customAmountLimit?e.xi3(7,7,t.amountLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerDayLimit?e.xi3(10,10,t.amountPerDayLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerWeekLimit?e.xi3(13,13,t.amountPerWeekLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerMonthLimit?e.xi3(16,16,t.amountPerMonthLimit,t.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerYearLimit?e.xi3(19,19,t.amountPerYearLimit,t.account.currency):i.i18n.account.limits.productDefault," ")}}function Ma(n,a){if(1&n&&(e.TgZ(0,"table",45)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.qZA(),e.TgZ(14,"th"),e._uU(15),e.qZA()(),e.TgZ(16,"tbody"),e.YNc(17,ja,20,22,"tr",46),e.ALo(18,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.user),e.xp6(2),e.Oqu(t.i18n.account.account),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.paymentLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.dailyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.weeklyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.monthlyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.yearlyLimit),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(18,8,t.results$))?null:i.results)}}function za(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,Ra,3,2,"div",6),e.YNc(5,Ya,3,3,"div",6),e.YNc(6,Ba,58,109,"ng-container",7),e.ALo(7,"async"),e.qZA()()(),e.TgZ(8,"results-layout",8),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(9,"async"),e.YNc(10,Ha,22,29,"mobile-result",9),e.YNc(11,Ma,19,10,"table",10),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.account.paymentLimits.title.overview)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.overview)("headingActions",e.lcZ(1,9,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.currencies?null:t.currencies.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,11,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(9,13,t.results$))("rendering$",t.rendering$)}}let Ga=(()=>{class n extends ae.t{constructor(t,i){super(t),this.paymentLimitsService=i,this.isCustomPaymentLimit$=new y.X(!1),this.isCustomDailyLimit$=new y.X(!1),this.isCustomWeeklyLimit$=new y.X(!1),this.isCustomMonthlyLimit$=new y.X(!1),this.isCustomYearlyLimit$=new y.X(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","by","currency","customAmountLimit","paymentLimitFrom","paymentLimitTo","dailyLimitFrom","dailyLimitTo","customAmountPerDayLimit","customAmountPerWeekLimit","weeklyLimitFrom","weeklyLimitTo","customAmountPerMonthLimit","monthlyLimitFrom","monthlyLimitTo","yearlyLimitFrom","yearlyLimitTo","customAmountPerYearLimit","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.paymentLimitsService.getAccountPaymentLimitsData().subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),(t.accountTypes||[]).forEach(i=>this.currencies.push(i.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customAmountLimit").valueChanges.subscribe(i=>this.isCustomPaymentLimit$.next("yes"===i)),this.form.get("customAmountPerDayLimit").valueChanges.subscribe(i=>this.isCustomDailyLimit$.next("yes"===i)),this.form.get("customAmountPerWeekLimit").valueChanges.subscribe(i=>this.isCustomWeeklyLimit$.next("yes"===i)),this.form.get("customAmountPerMonthLimit").valueChanges.subscribe(i=>this.isCustomMonthlyLimit$.next("yes"===i)),this.form.get("customAmountPerYearLimit").valueChanges.subscribe(i=>this.isCustomYearlyLimit$.next("yes"===i)),this.addSub(this.form.controls.currency.valueChanges.subscribe(i=>this.updateAccountTypes(i))),this.headingActions=[this.moreFiltersAction]}doSearch(t){return this.paymentLimitsService.searchAccountPaymentLimits$Response(t)}toSearchParams(t){const i=t;return this.isCustomPaymentLimit$.value?(i.customAmountLimit=!0,i.customAmountLimitRange=b.S.rangeFilter(t.paymentLimitFrom,t.paymentLimitTo)):i.customAmountLimit=!t.customAmountLimit&&null,this.isCustomDailyLimit$.value?(i.customAmountPerDayLimit=!0,i.customAmountPerDayLimitRange=b.S.rangeFilter(t.dailyLimitFrom,t.dailyLimitTo)):i.customAmountPerDayLimit=!t.customAmountPerDayLimit&&null,this.isCustomWeeklyLimit$.value?(i.customAmountPerWeekLimit=!0,i.customAmountPerWeekLimitRange=b.S.rangeFilter(t.weeklyLimitFrom,t.weeklyLimitTo)):i.customAmountPerWeekLimit=!t.customAmountPerWeekLimit&&null,this.isCustomMonthlyLimit$.value?(i.customAmountPerMonthLimit=!0,i.customAmountPerMonthLimitRange=b.S.rangeFilter(t.monthlyLimitFrom,t.monthlyLimitTo)):i.customAmountPerMonthLimit=!t.customAmountPerMonthLimit&&null,this.isCustomYearlyLimit$.value?(i.customAmountPerYearLimit=!0,i.customAmountPerYearLimitRange=b.S.rangeFilter(t.yearlyLimitFrom,t.yearlyLimitTo)):i.customAmountPerYearLimit=!t.customAmountPerYearLimit&&null,t.broker&&(i.brokers=[t.broker]),i}get customLimitOptions(){const t=[{value:"yes",text:this.i18n.general.yes}];return t.push({value:"no",text:this.i18n.general.no}),t}userSearchFilters(t){const i={roles:[_e.g.BROKER]};return t||i.roles.push(_e.g.ADMINISTRATOR),i}updateAccountTypes(t){const i=this.form.controls.accountType.value;t&&i&&this.data.accountTypes.find(o=>o.id===i).currency.id!==t&&this.form.controls.accountType.setValue(null)}accountTypes(){const t=this.findCurrency(!1),i=this.data.accountTypes||[];return t?i.filter(o=>o.currency.id===t.id):i}findCurrency(t){if(this.singleCurrency)return this.singleCurrency;const i=this.form.controls.currency.value;if(i)return this.currencies.find(r=>r.id===i);const o=this.form.controls.accountType.value;return t&&o?this.data.accountTypes.find(r=>r.id===o).currency:null}currencyDecimalDigits(){const t=this.findCurrency(!0);return t?t.decimalDigits:2}currencyPrefix(){const t=this.findCurrency(!0);return t?t.prefix:null}currencySuffix(){const t=this.findCurrency(!0);return t?t.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(t){return["/banking",t.user.id,"account-payment-limits",t.account.type.id]}resolveMenu(){return new v.oX(v.v2.ACCOUNT_PAYMENT_LIMITS_OVERVIEW)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ct))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-payment-limits-overview"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","customAmountLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","paymentLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","paymentLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","customAmountPerDayLimit",3,"fieldOptions","emptyOption","label"],["formControlName","dailyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","dailyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","customAmountPerWeekLimit",3,"fieldOptions","emptyOption","label"],["formControlName","weeklyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","weeklyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","customAmountPerMonthLimit",3,"fieldOptions","emptyOption","label"],["formControlName","monthlyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","monthlyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","customAmountPerYearLimit",3,"fieldOptions","emptyOption","label"],["formControlName","yearlyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","yearlyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","user",3,"label","allowContacts"],["formControlName","broker",3,"label","filters","allowContacts"],["formControlName","by",3,"label","filters","allowContacts"],["formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Oa,1,0,"ng-container",1),e.qZA(),e.YNc(3,za,12,15,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,be.x,s.JJ,s.u,u.sg,J.s,O.f,B.U,te.l,D.D,R.E,V.t,C.t,Y.p],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function Wa(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",5),e._UZ(2,"user-link",6),e.qZA(),e.TgZ(3,"label-value",7),e._uU(4),e.qZA(),e.TgZ(5,"h2",8),e._uU(6),e.qZA(),e.TgZ(7,"label-value",7),e._uU(8),e.qZA(),e.TgZ(9,"label-value",7),e._uU(10),e.qZA(),e.TgZ(11,"h2",8),e._uU(12),e.qZA(),e.TgZ(13,"label-value",7),e._uU(14),e.qZA(),e.TgZ(15,"label-value",7),e._uU(16),e.qZA(),e.TgZ(17,"h2",8),e._uU(18),e.qZA(),e.TgZ(19,"label-value",7),e._uU(20),e.qZA(),e.TgZ(21,"label-value",7),e._uU(22),e.qZA(),e.TgZ(23,"h2",8),e._uU(24),e.qZA(),e.TgZ(25,"label-value",7),e._uU(26),e.qZA(),e.TgZ(27,"label-value",7),e._uU(28),e.qZA(),e.TgZ(29,"h2",8),e._uU(30),e.qZA(),e.TgZ(31,"label-value",7),e._uU(32),e.qZA(),e.TgZ(33,"label-value",7),e._uU(34),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.account.account),e.xp6(1),e.hij(" ",t.data.account.type.name," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.Q6J("label",t.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.hij(" ",t.amountLimitValue()," "),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.limitMode(t.data.customAmountLimit)," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.hij(" ",t.amountPerDayLimitValue()," "),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.limitMode(t.data.customAmountPerDayLimit)," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.hij(" ",t.amountPerWeekLimitValue()," "),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.limitMode(t.data.customAmountPerWeekLimit)," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.hij(" ",t.amountPerMonthLimitValue()," "),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.limitMode(t.data.customAmountPerMonthLimit)," "),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.Q6J("label",t.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.hij(" ",t.amountPerYearLimitValue()," "),e.xp6(1),e.Q6J("label",t.i18n.account.limits.mode),e.xp6(1),e.hij(" ",t.limitMode(t.data.customAmountPerYearLimit)," ")}}function Xa(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Wa,35,29,"ng-container",4),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.account.paymentLimits.title.view)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.view)("headingActions",e.lcZ(1,4,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.data)}}function Ka(n,a){if(1&n&&(e.TgZ(0,"label-value",15),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.general.comments),e.xp6(1),e.hij(" ",t.comment," ")}}function er(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",13)(2,"div",14)(3,"label-value",15),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"label-value",15),e._uU(7),e.qZA(),e.TgZ(8,"label-value",15),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"label-value",15),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"label-value",15),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"label-value",15),e._uU(18),e.ALo(19,"currency"),e.qZA(),e.TgZ(20,"label-value",15),e._uU(21),e.ALo(22,"currency"),e.qZA(),e.YNc(23,Ka,2,2,"label-value",16),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,15,t.date)," "),e.xp6(2),e.Q6J("label",i.i18n.general.performedBy),e.xp6(1),e.hij(" ",t.by.display," "),e.xp6(1),e.Q6J("label",i.i18n.account.paymentLimits.paymentLimit),e.xp6(1),e.hij(" ",t.customAmountLimit?e.xi3(10,17,t.amountLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.dailyLimit),e.xp6(1),e.hij(" ",t.customAmountPerDayLimit?e.xi3(13,20,t.amountPerDayLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.weeklyLimit),e.xp6(1),e.hij(" ",t.customAmountPerWeekLimit?e.xi3(16,23,t.amountPerWeekLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.monthlyLimit),e.xp6(1),e.hij(" ",t.customAmountPerMonthLimit?e.xi3(19,26,t.amountPerMonthLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("label",i.i18n.account.paymentLimits.yearlyLimit),e.xp6(1),e.hij(" ",t.customAmountPerYearLimit?e.xi3(22,29,t.amountPerYearLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(2),e.Q6J("ngIf",t.comment)}}function tr(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"currency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"currency"),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.ALo(20,"currency"),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,8,t.date)),e.xp6(3),e.Oqu(t.by.display),e.xp6(2),e.hij(" ",t.customAmountLimit?e.xi3(8,10,t.amountLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerDayLimit?e.xi3(11,13,t.amountPerDayLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerWeekLimit?e.xi3(14,16,t.amountPerWeekLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerMonthLimit?e.xi3(17,19,t.amountPerMonthLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.hij(" ",t.customAmountPerYearLimit?e.xi3(20,22,t.amountPerYearLimit,i.data.account.currency):i.i18n.account.limits.productDefault," "),e.xp6(3),e.Oqu(t.comment)}}function nr(n,a){if(1&n&&(e.TgZ(0,"table",17)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.qZA(),e.TgZ(14,"th"),e._uU(15),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.qZA()(),e.TgZ(18,"tbody"),e.YNc(19,tr,23,25,"tr",18),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.paymentLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.dailyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.weeklyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.monthlyLimit),e.xp6(2),e.Oqu(t.i18n.account.paymentLimits.yearlyLimit),e.xp6(2),e.Oqu(t.i18n.general.comments),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function ir(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",9),e.ALo(2,"async"),e._UZ(3,"user-info",6),e.qZA(),e.TgZ(4,"results-layout",10),e.YNc(5,er,24,32,"mobile-result",11),e.YNc(6,nr,20,9,"table",12),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode","empty")("heading",t.i18n.account.paymentLimits.title.history)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.history)("headingActions",e.lcZ(2,6,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)}}let or=(()=>{class n extends $.y{constructor(t,i){super(t),this.paymentLimitsService=i,this.step$=new y.X("details")}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),this.detailsHeadingActions=[],t.editable&&this.detailsHeadingActions.push(new T.Yu(x.l.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.detailsHeadingActions.push(new T.Yu(x.l.Clock,this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=[],t.editable&&this.historyHeadingActions.push(new T.Yu(x.l.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.historyHeadingActions.push(new T.Yu(x.l.ArrowLeft,this.i18n.general.details,()=>this.showView()))}amountLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountLimit,this.data.amountLimit,this.data.productAmountLimit)}amountPerDayLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerDayLimit,this.data.amountPerDayLimit,this.data.productAmountPerDayLimit)}amountPerWeekLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerWeekLimit,this.data.amountPerWeekLimit,this.data.productAmountPerWeekLimit)}amountPerMonthLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerMonthLimit,this.data.amountPerMonthLimit,this.data.productAmountPerMonthLimit)}amountPerYearLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerYearLimit,this.data.amountPerYearLimit,this.data.productAmountPerYearLimit)}resolveAmountLimitValue(t,i,o){return t?this.format.formatAsCurrency(this.data.account.currency,i,!1):o?this.format.formatAsCurrency(this.data.account.currency,o,!1):this.i18n.account.paymentLimits.definedInPaymentType}limitMode(t){return t?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-payment-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ct))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-account-payment-limits"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table",4,"resultTable"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],["labelPosition","sideForced",3,"label",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Xa,3,6,"page-content",1),e.YNc(4,ir,7,8,"ng-container",2),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","details"),e.xp6(1),e.Q6J("ngSwitchCase","history"))},directives:[A.w,u.RF,u.n9,Z.Y,u.O5,C.t,Q.F,oe.M,D.D,R.E,V.t,Y.p,u.sg],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();var H=(()=>{return(n=H||(H={})).DIRECT="direct",n.RECURRING="recurring",n.SCHEDULED="scheduled",H;var n})(),vt=m(8351);let Lt=(()=>{class n extends K.b{constructor(t,i){super(t,i)}dataForPerformPayment$Response(t,i){const o=new d.c(this.rootUrl,n.DataForPerformPaymentPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("to",t.to,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}dataForPerformPayment(t,i){return this.dataForPerformPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}performPayment$Response(t,i){const o=new d.c(this.rootUrl,n.PerformPaymentPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("owner",t.owner,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}performPayment(t,i){return this.performPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}previewPayment$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewPaymentPath,"post");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewPayment(t,i){return this.previewPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}calculatePerformPaymentInstallments$Response(t,i){const o=new d.c(this.rootUrl,n.CalculatePerformPaymentInstallmentsPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("to",t.to,{}),o.query("count",t.count,{}),o.query("amount",t.amount,{}),o.query("currency",t.currency,{}),o.query("type",t.type,{}),o.query("firstDate",t.firstDate,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}calculatePerformPaymentInstallments(t,i){return this.calculatePerformPaymentInstallments$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.DataForPerformPaymentPath="/{owner}/payments/data-for-perform",n.PerformPaymentPath="/{owner}/payments",n.PreviewPaymentPath="/{owner}/payments/preview",n.CalculatePerformPaymentInstallmentsPath="/{owner}/payments/installments",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var kt=m(3152),Tt=m(9697),wt=m(7582);const ar=["toUser"],rr=["amount"];function sr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromUser),e.xp6(1),e.Q6J("user",t.fromUser)}}function cr(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",24),e._uU(2,"\xa0-\xa0"),e.qZA(),e.TgZ(3,"div",25),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij("",t.number," ")}}function lr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"input",20,21),e.NdJ("keyup.enter",function(){return e.CHM(t),e.MAs(4).click()}),e.qZA(),e.TgZ(5,"label",22)(6,"div",23)(7,"div",24),e._uU(8),e.qZA(),e.YNc(9,cr,5,1,"ng-container",2),e.qZA()()()()()}if(2&n){const t=a.$implicit;e.xp6(3),e.Q6J("id","from_"+t.id)("value",t.type.id),e.xp6(2),e.Q6J("for","from_"+t.id),e.xp6(3),e.Oqu(t.type.name),e.xp6(1),e.Q6J("ngIf",t.number)}}function ur(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",14),e.YNc(2,lr,10,5,"div",15),e._UZ(3,"field-errors",16),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.pos?t.i18n.transaction.toAccount:t.i18n.transaction.fromAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accounts),e.xp6(1),e.Q6J("control",t.form.get("account"))}}const pr=function(n,a,t){return{positive:n,negative:a,"text-right":t}};function mr(n,a){if(1&n&&(e.TgZ(0,"label-value",27)(1,"div",28),e.ALo(2,"async"),e._uU(3),e.ALo(4,"currency"),e.qZA()()),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("label",i.i18n.account.balance),e.xp6(1),e.Q6J("ngClass",e.kEZ(8,pr,i.format.isPositive(t.status.balance),i.format.isNegative(t.status.balance),e.lcZ(2,3,i.layout.ltsm$))),e.xp6(2),e.hij(" ",e.xi3(4,5,t.status.balance,t.currency)," ")}}function dr(n,a){if(1&n&&(e.TgZ(0,"label-value",27),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("label",i.i18n.account.availableBalance),e.xp6(1),e.hij(" ",e.xi3(2,2,t.status.availableBalance,t.currency)," ")}}function fr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,mr,5,12,"label-value",26),e.YNc(2,dr,3,5,"label-value",26),e.BQk()),2&n){const t=a.ngIf,i=e.oxw();e.xp6(1),e.Q6J("ngIf",null==t.status?null:t.status.balance),e.xp6(1),e.Q6J("ngIf",(null==t.status?null:t.status.availableBalance)&&!i.format.sameNumbers(t.status.balance,t.status.availableBalance))}}function _r(n,a){if(1&n&&e._UZ(0,"field-option",34),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.display)}}function hr(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",32),e.YNc(1,_r,1,2,"field-option",33),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.data.allowedUsers)}}const gr=function(n){return{usersToExclude:n}};function yr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"user-field",35,36),e.NdJ("selected",function(o){e.CHM(t);const r=e.oxw(2);return o?r.setFocus(r.amountField):null}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("autoSearch",!t.allowPrincipal)("filters",e.VKq(9,gr,t.usersToExclude))("allowSelf",t.allowSelf)("allowContacts",t.allowContacts)("allowSearch",t.allowSearch)("allowPrincipal",t.allowPrincipal)("allowQrCode",t.allowQrCode)("principalTypes",t.data.principalTypes)("allowLocate",t.data.allowAutocomplete)}}function xr(n,a){if(1&n&&(e.TgZ(0,"label-value",29),e.YNc(1,hr,2,1,"single-selection-field",30),e.YNc(2,yr,2,11,"ng-template",null,31,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("label",i.pos?i.i18n.transaction.fromUser:i.i18n.transaction.toUser),e.xp6(1),e.Q6J("ngIf",i.fixedUsersList)("ngIfElse",t)}}function br(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.toUser),e.xp6(1),e.Q6J("user",t.toUser)}}function vr(n,a){if(1&n&&e._UZ(0,"field-option",34),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function Tr(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",37,38),e.YNc(2,vr,1,2,"field-option",33),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,2,t.paymentTypes$))}}function wr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.paymentTypeData$.value.fixedAmount,t.paymentTypeData$.value.currency)," ")}}function Cr(n,a){if(1&n&&e._UZ(0,"decimal-field",39,40),2&n){const t=e.oxw();e.Q6J("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)}}function Ar(n,a){if(1&n&&e._UZ(0,"custom-field-input",41),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.customValuesControlGetter(t))}}function Zr(n,a){if(1&n&&e._UZ(0,"field-option",47),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingSingle)}}function Pr(n,a){if(1&n&&e._UZ(0,"field-option",48),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingInstallments)}}function qr(n,a){if(1&n&&e._UZ(0,"field-option",49),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingRecurring)}}function Sr(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",42),e._UZ(1,"field-option",43),e.YNc(2,Zr,1,1,"field-option",44),e.YNc(3,Pr,1,1,"field-option",45),e.YNc(4,qr,1,1,"field-option",46),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.scheduling),e.xp6(1),e.Q6J("text",t.i18n.transaction.schedulingDirect),e.xp6(1),e.Q6J("ngIf",(null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.maxInstallments)>0),e.xp6(1),e.Q6J("ngIf",(null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.maxInstallments)>1),e.xp6(1),e.Q6J("ngIf",null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.allowsRecurringPayments)}}function Qr(n,a){if(1&n&&e._UZ(0,"date-field",50),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.dueDate)}}function Ur(n,a){if(1&n&&e._UZ(0,"date-field",50),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.firstInstallmentDate)}}function Nr(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"input-field",51),e.TgZ(2,"radio-group-field",52),e._UZ(3,"field-option",34)(4,"field-option",34),e.qZA(),e.YNc(5,Ur,1,1,"date-field",53),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.installmentsCount),e.xp6(1),e.Q6J("label",t.i18n.transaction.firstInstallment),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.general.now),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.general.futureDate),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.firstInstallmentIsNow)}}function Ir(n,a){if(1&n&&e._UZ(0,"date-field",59),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.firstOccurrenceDate)}}function Jr(n,a){if(1&n&&e._UZ(0,"input-field",60),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrencesCount)}}function Lr(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"radio-group-field",54),e._UZ(2,"field-option",34)(3,"field-option",34),e.qZA(),e.YNc(4,Ir,1,1,"date-field",55),e.TgZ(5,"radio-group-field",56),e._UZ(6,"field-option",34)(7,"field-option",34),e.qZA(),e.YNc(8,Jr,1,1,"input-field",57),e._UZ(9,"time-interval-field",58),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.firstOccurrence),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.general.now),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.general.futureDate),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.firstOccurrenceIsNow),e.xp6(1),e.Q6J("label",t.i18n.transaction.repeatUntil),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.transaction.repeatUntilManual),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.transaction.repeatUntilFixed),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.repeatUntilCanceled),e.xp6(1),e.Q6J("label",t.i18n.transaction.occurrenceInterval)}}function kr(n,a){if(1&n&&e._UZ(0,"textarea-field",62),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("required","required"===t)("label",i.i18n.general.description)}}function Fr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,kr,1,2,"textarea-field",61),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf","disabled"!==t)}}const Ft=[le.n.FORBIDDEN,le.n.UNAUTHORIZED,le.n.NOT_FOUND];let Or=(()=>{class n extends q.H{constructor(t,i,o,r,l){super(t),this.bankingHelper=i,this.paymentsService=o,this.posService=r,this.authHelper=l,this.setFocus=h.T_,this.availablePaymentTypes=new e.vpe,this.fixedDestination=!1,this.account$=new y.X(null),this.paymentTypes$=new y.X(null),this.allowSelf=!1}ngOnInit(){var t;super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.toSelf=this.authHelper.isSelf(this.toUser),this.usersToExclude=[],this.fromUser&&this.usersToExclude.push(this.fromUser.id),this.allowSelf=!this.fromSelf,(this.fixedDestination||(null===(t=this.form.value)||void 0===t?void 0:t.type))&&this.setFetchedPaymentTypes(this.data),this.account$.next(this.data.accounts[0]),this.addSub(this.form.controls.account.valueChanges.subscribe(o=>{const r=this.data.accounts.find(l=>l.type.id===o);this.account$.next(r)})),this.createSubscriptions()}createSubscriptions(){this.fixedDestination||(this.subjectChangeSubscription=this.form.get("subject").valueChanges.pipe((0,we.b)(b.S.DEBOUNCE_TIME),(0,ue.x)((t,i)=>b.S.locatorEquals(t,i))).subscribe(()=>this.fetchPaymentTypes())),this.accountChangeSubscription=this.form.get("account").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes()),this.typeChangeSubscription=this.form.get("type").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(t=>this.fetchPaymentTypeData(t))}removeSubscriptions(){this.subjectChangeSubscription&&this.subjectChangeSubscription.unsubscribe(),this.accountChangeSubscription.unsubscribe(),this.typeChangeSubscription.unsubscribe()}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null,this.paymentTypes$.next(null);const i=b.S.escapeNumeric(this.form.value.subject);""!==i&&this.errorHandler.requestWithCustomErrorHandler(o=>{let r;r=this.pos?this.posService.dataForReceivePayment({from:i,fields:["fromUser","paymentTypes","paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:i,fields:["toUser","paymentTypes","paymentTypeData"]}),r.pipe((0,Le.P)()).subscribe(l=>{this.data.paymentTypes=l.paymentTypes,this.setFetchedPaymentTypes(l)},l=>{if(this.allowPrincipal&&this.userField&&l.status===le.n.NOT_FOUND){let _=l.error;if("string"==typeof _)try{_=JSON.parse(_)}catch(P){_={}}const g=_.entityType;if(!(0,h.OW)(g)&&g.endsWith("User"))return void this.userField.search()}Ft.includes(l.status)||o(l)})})}adjustPaymentTypes(){const t=this.form.value;if(0===(t.subject||"").trim().length)return;const o=this.fetchedPaymentTypes||[];(0,h.cS)(o)&&this.notification.error(this.i18n.transaction.noTypes);const r=o.filter(g=>g.from.id===t.account);let l=this.form.value.type,_=null;(0,h.cS)(r)?_={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(r),r.find(g=>g.id===l)||(l=r[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:l}),this.form.get("account").setErrors(_),this.form.get("account").markAsTouched(),(0,h.cS)(l)||this.fetchPaymentTypeData(l),this.availablePaymentTypes.emit(r)}setFetchedPaymentTypes(t){this.userField&&(this.userField.user=this.pos?t.fromUser:t.toUser),this.fetchedPaymentTypes=t.paymentTypes;const i=t.paymentTypeData;i&&this.dataCache.set(i.id,i),this.adjustPaymentTypes()}fetchPaymentTypeData(t){const i=this.form.value;if((0,h.cS)(i.subject)||(0,h.cS)(t))return;const o=this.dataCache.get(t);o?this.setPaymentTypeData(o):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(r=>{let l;l=this.pos?this.posService.dataForReceivePayment({from:i.subject,type:t,fields:["paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:i.subject,type:t,fields:["paymentTypeData"]}),l.pipe((0,Le.P)()).subscribe(_=>{this.setPaymentTypeData(_.paymentTypeData)},_=>{Ft.includes(_.status)||r(_)})}))}setPaymentTypeData(t){((this.paymentTypeData$.value||{}).id||null)!==((t||{}).id||null)&&(t&&(this.dataCache.set(t.id,t),(0,h.T_)(this.amountField),t.fixedAmount&&this.form.patchValue({amount:t.fixedAmount})),this.paymentTypeData$.next(t))}get fixedUsersList(){return!(0,h.cS)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!(0,h.cS)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const t=this.data.accounts||[];return 1===t.length?t[0]:null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(Lt),e.Y36(kt.J),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["payment-step-form"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ar,5),e.Gf(rr,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.userField=o.first),e.iGM(o=e.CRH())&&(i.amountField=o.first)}},inputs:{data:"data",pos:"pos",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[e.qOj],decls:24,vars:30,consts:[[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],[4,"ngIf"],["kind","field","required","",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngSwitchCase"],[4,"ngSwitchCase"],["kind","fieldView",3,"label"],[3,"user"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"col"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],[1,"d-inline-block"],[1,"d-inline-block","text-nowrap"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowSelf","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","allowLocate","selected"],["toUser",""],["formControlName","type","required","",3,"label"],["type",""],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsNow",3,"label"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","firstOccurrenceIsNow",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","occurrenceInterval","required","",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,sr,2,2,"label-value",1),e.YNc(2,ur,4,3,"ng-container",2),e.YNc(3,fr,3,2,"ng-container",2),e.ALo(4,"async"),e.YNc(5,xr,4,3,"label-value",3),e.YNc(6,br,2,2,"label-value",1),e.YNc(7,Tr,4,4,"single-selection-field",4),e.ALo(8,"async"),e.YNc(9,wr,3,5,"label-value",5),e.ALo(10,"async"),e.YNc(11,Cr,2,5,"ng-template",null,6,e.W1O),e.YNc(13,Ar,1,2,"custom-field-input",7),e.ALo(14,"async"),e.YNc(15,Sr,5,5,"single-selection-field",8),e.ALo(16,"async"),e.ALo(17,"async"),e.ynx(18,9),e.YNc(19,Qr,1,1,"date-field",10),e.YNc(20,Nr,6,7,"ng-container",11),e.YNc(21,Lr,10,13,"ng-container",11),e.BQk(),e.YNc(22,Fr,2,1,"ng-container",2),e.ALo(23,"async"),e.BQk()),2&t){const o=e.MAs(12);let r,l,_,g,P;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.fromUser&&!i.fromSelf),e.xp6(1),e.Q6J("ngIf",!i.singleAccount),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,16,i.account$)),e.xp6(2),e.Q6J("ngIf",!i.fixedDestination),e.xp6(1),e.Q6J("ngIf",i.fixedDestination&&i.toUser&&!i.toSelf),e.xp6(1),e.Q6J("ngIf",(null==(r=e.lcZ(8,18,i.paymentTypes$))?null:r.length)>1),e.xp6(2),e.Q6J("ngIf",null==(l=e.lcZ(10,20,i.paymentTypeData$))?null:l.fixedAmount)("ngIfElse",o),e.xp6(4),e.Q6J("ngForOf",null==(_=e.lcZ(14,22,i.paymentTypeData$))?null:_.customFields),e.xp6(2),e.Q6J("ngIf",(null==(g=e.lcZ(16,24,i.paymentTypeData$))?null:g.allowsRecurringPayments)||(null==(g=e.lcZ(17,26,i.paymentTypeData$))?null:g.maxInstallments)>0),e.xp6(3),e.Q6J("ngSwitch",i.form.value.scheduling),e.xp6(1),e.Q6J("ngSwitchCase","futureDate"),e.xp6(1),e.Q6J("ngSwitchCase","scheduled"),e.xp6(1),e.Q6J("ngSwitchCase","recurring"),e.xp6(1),e.Q6J("ngIf",(null==(P=e.lcZ(23,28,i.paymentTypeData$))?null:P.descriptionAvailability)||"disabled")}},directives:[s.JL,s.sg,u.O5,C.t,Q.F,u.sg,s._,s.Fj,s.JJ,s.u,bt.e,u.mk,O.f,z.A,J.s,te.l,s.Q7,B.U,Se.G,s.oH,u.RF,u.n9,j.Q,F.q,Tt.X,qe.Y,wt.e,Te.u],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var Ee=m(2525);function Dr(n,a){if(1&n&&(e.TgZ(0,"notification",11),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.i18n.transaction.requiresAuthorization,"\n")}}function Rr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.performedBy),e.xp6(1),e.Q6J("user",t.preview.fromOperator)}}function Vr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.receivedBy),e.xp6(1),e.Q6J("user",t.preview.toOperator)}}function Yr(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",12),e._uU(2),e.qZA(),e.TgZ(3,"label-value",12),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.preview.fromAccount.type.name," "),e.xp6(1),e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.preview.toAccount.type.name," ")}}function Er(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",14),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.from),e.xp6(1),e.Q6J("user",t.fromUser)("hideLink",t.fromSelf)("hideIcon",t.fromSelf)("display",t.preview.payment.fromName)}}function $r(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.fromUser),e.xp6(1),e.Q6J("user",t.fromUser)}}function Br(n,a){if(1&n&&(e.ynx(0),e.YNc(1,$r,2,2,"label-value",1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.fromSelf)}}function Hr(n,a){if(1&n&&e.YNc(0,Br,2,1,"ng-container",15),2&n){const t=e.oxw(),i=e.MAs(8);e.Q6J("ngIf",t.fromUser)("ngIfElse",i)}}function jr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.preview.fromAccount.type.name," ")}}function Mr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",16),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.to),e.xp6(1),e.Q6J("user",t.toUser)("display",t.preview.payment.toName)}}function zr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.toUser),e.xp6(1),e.Q6J("user",t.toUser)}}function Gr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,zr,2,2,"label-value",3),e.BQk()),2&n){const t=e.oxw(2),i=e.MAs(13);e.xp6(1),e.Q6J("ngIf",t.toUser)("ngIfElse",i)}}function Wr(n,a){if(1&n&&e.YNc(0,Gr,2,2,"ng-container",2),2&n){const t=e.oxw();e.Q6J("ngIf",!(t.fromSelf&&t.toSelf))}}function Xr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.preview.toAccount.type.name," ")}}function Kr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.hij(" ",t.preview.paymentType.name,"\n")}}function es(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.preview.mainAmount,t.preview.currency),"\n")}}function ts(n,a){if(1&n&&(e.TgZ(0,"div",18)(1,"div",19),e._uU(2),e.qZA(),e.TgZ(3,"div",20),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij("",t.fee.name,":"),e.xp6(2),e.Oqu(e.xi3(5,2,t.amount,i.preview.currency))}}function ns(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e.YNc(1,ts,6,5,"div",17),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.appliedFees),e.xp6(1),e.Q6J("ngForOf",t.fees)}}function is(n,a){1&n&&e._UZ(0,"custom-field-value",21),2&n&&e.Q6J("fieldValue",a.$implicit)}function os(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.dueDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.preview.installments[0].dueDate),"\n")}}function as(n,a){if(1&n&&(e.TgZ(0,"thead")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th",24),e._uU(6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(2),e.Oqu(t.i18n.transaction.dueDate),e.xp6(2),e.Oqu(t.i18n.transaction.amount)}}function rs(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",24),e._uU(7),e.ALo(8,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij(" ",t.number," "),e.xp6(2),e.hij(" ",e.lcZ(5,3,t.dueDate)," "),e.xp6(3),e.hij(" ",e.xi3(8,5,t.mainAmount,i.preview.currency)," ")}}function ss(n,a){if(1&n&&(e.TgZ(0,"label-value",12)(1,"table",22),e.YNc(2,as,7,3,"thead",2),e.ALo(3,"async"),e.TgZ(4,"tbody"),e.YNc(5,rs,9,8,"tr",23),e.qZA()()()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.installments),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,3,t.layout.gtxs$)),e.xp6(3),e.Q6J("ngForOf",t.preview.installments)}}function cs(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentNowManual," ")}}function ls(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentNowFixed(t.preview.payment.occurrencesCount)," ")}}function us(n,a){if(1&n&&(e.ynx(0),e.YNc(1,cs,2,1,"ng-container",2),e.YNc(2,ls,2,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.preview.payment.occurrencesCount),e.xp6(1),e.Q6J("ngIf",null!=t.preview.payment.occurrencesCount)}}function ps(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentDateManual(e.lcZ(2,1,t.preview.payment.firstOccurrenceDate))," ")}}const ms=function(n,a){return{date:n,count:a}};function ds(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentDateFixed(e.WLB(3,ms,e.lcZ(2,1,t.preview.payment.firstOccurrenceDate),t.preview.payment.occurrencesCount))," ")}}function fs(n,a){if(1&n&&(e.YNc(0,ps,3,3,"ng-container",2),e.YNc(1,ds,3,6,"ng-container",2)),2&n){const t=e.oxw(2);e.Q6J("ngIf",null==t.preview.payment.occurrencesCount),e.xp6(1),e.Q6J("ngIf",null!=t.preview.payment.occurrencesCount)}}function _s(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e.YNc(1,us,3,2,"ng-container",15),e.YNc(2,fs,2,2,"ng-template",null,25,e.W1O),e.ynx(4),e._UZ(5,"br"),e._uU(6),e.BQk(),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("label",i.i18n.transaction.recurringPayment),e.xp6(1),e.Q6J("ngIf",null==i.preview.payment.firstOccurrenceDate)("ngIfElse",t),e.xp6(5),e.hij(" ",i.i18n.transaction.recurringPaymentOccurrenceInterval(i.format.formatTimeInterval(i.preview.payment.occurrenceInterval))," ")}}function hs(n,a){if(1&n&&e._UZ(0,"label-value",26),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("value",t.preview.payment.description)}}function gs(n,a){1&n&&e._UZ(0,"hr")}function ys(n,a){1&n&&e._UZ(0,"hr")}function xs(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ys,1,0,"hr",2),e.ALo(2,"async"),e.TgZ(3,"div",27),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.layout.gtxxs$)),e.xp6(3),e.Oqu(t.preview.confirmationMessage)}}function bs(n,a){1&n&&e._UZ(0,"hr")}function vs(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,bs,1,0,"hr",2),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",28),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,6,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.form.get("confirmationPassword"))("pos",t.pos)("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)("paymentPreview",t.preview)}}let Ts=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.bankingHelper=i,this.authHelper=o,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,(0,h.cS)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>this.pos?this.preview.payment:{type:U.l.PERFORM_PAYMENT,from:b.S.accountOwner(this.preview.fromAccount),to:b.S.accountOwner(this.preview.toAccount),paymentType:this.preview.paymentType.id,amount:this.preview.payment.amount},this.preview.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["payment-step-confirm"]],inputs:{pos:"pos",preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:29,vars:26,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"label",4,"ngIf","ngIfElse"],["fromUserTemplate",""],["fromSystemTemplate",""],["toUserTemplate",""],["toSystemTemplate",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[1,"totalAmount",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[3,"user","hideLink","hideIcon","display"],[4,"ngIf","ngIfElse"],[3,"user","display"],["class","row no-gutters align-items-end",4,"ngFor","ngForOf"],[1,"row","no-gutters","align-items-end"],[1,"col-3"],[1,"col","pl-1"],[3,"fieldValue"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[1,"text-right"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],["focused","",3,"formControl","pos","passwordInput","createDeviceConfirmation","paymentPreview","showSubmit","confirmed"]],template:function(t,i){if(1&t&&(e.YNc(0,Dr,2,1,"notification",0),e.YNc(1,Rr,2,2,"label-value",1),e.YNc(2,Vr,2,2,"label-value",1),e.YNc(3,Yr,5,4,"ng-container",2),e.YNc(4,Er,2,5,"label-value",3),e.YNc(5,Hr,1,2,"ng-template",null,4,e.W1O),e.YNc(7,jr,2,2,"ng-template",null,5,e.W1O),e.YNc(9,Mr,2,3,"label-value",3),e.YNc(10,Wr,1,1,"ng-template",null,6,e.W1O),e.YNc(12,Xr,2,2,"ng-template",null,7,e.W1O),e.YNc(14,Kr,2,2,"label-value",1),e.YNc(15,es,3,5,"label-value",1),e.YNc(16,ns,2,2,"label-value",1),e.YNc(17,is,1,1,"custom-field-value",8),e.YNc(18,os,3,4,"label-value",1),e.YNc(19,ss,6,5,"label-value",1),e.YNc(20,_s,7,4,"label-value",1),e.YNc(21,hs,1,2,"label-value",9),e.YNc(22,gs,1,0,"hr",2),e.ALo(23,"async"),e.TgZ(24,"label-value",10),e._uU(25),e.ALo(26,"currency"),e.qZA(),e.YNc(27,xs,5,4,"ng-container",2),e.YNc(28,vs,4,8,"ng-container",2)),2&t){const o=e.MAs(6),r=e.MAs(11);e.Q6J("ngIf",i.preview.pendingAuthorization),e.xp6(1),e.Q6J("ngIf",i.preview.fromOperator),e.xp6(1),e.Q6J("ngIf",i.preview.toOperator),e.xp6(1),e.Q6J("ngIf",i.fromSelf&&i.toSelf),e.xp6(1),e.Q6J("ngIf",i.preview.payment.fromName)("ngIfElse",o),e.xp6(5),e.Q6J("ngIf",i.preview.payment.toName)("ngIfElse",r),e.xp6(5),e.Q6J("ngIf",i.showPaymentType),e.xp6(1),e.Q6J("ngIf",null!=i.preview.mainAmount&&i.preview.totalAmount!==i.preview.mainAmount),e.xp6(1),e.Q6J("ngIf",(null==i.fees?null:i.fees.length)>0),e.xp6(1),e.Q6J("ngForOf",i.preview.customValues),e.xp6(1),e.Q6J("ngIf",1===(null==i.preview.installments?null:i.preview.installments.length)),e.xp6(1),e.Q6J("ngIf",(null==i.preview.installments?null:i.preview.installments.length)>1),e.xp6(1),e.Q6J("ngIf","recurring"===i.preview.payment.scheduling),e.xp6(1),e.Q6J("ngIf",i.preview.payment.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(23,21,i.layout.gtxxs$)),e.xp6(2),e.Q6J("label",i.i18n.transaction.totalAmount),e.xp6(1),e.hij(" ",e.xi3(26,23,i.preview.totalAmount,i.preview.currency),"\n"),e.xp6(2),e.Q6J("ngIf",(i.preview.confirmationMessage||"").length>0),e.xp6(1),e.Q6J("ngIf",i.preview.confirmationPasswordInput)}},directives:[u.O5,Ee.c,C.t,Q.F,u.sg,Qe.W,he.y,z.A,s.JJ,s.oH],pipes:[w.H,E.u,u.Ov],encapsulation:2,changeDetection:0}),n})();const ws=["paymentStepForm"];function Cs(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"payment-step-form",5,6),e.NdJ("availablePaymentTypes",function(o){return e.CHM(t),e.oxw().availablePaymentTypes=o}),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"actions",7)(6,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().toConfirm()}),e.ALo(7,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("mode",e.lcZ(1,11,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.data)("pos",t.pos)("form",t.form)("currency",e.lcZ(4,13,t.currency$))("paymentTypeData$",t.paymentTypeData$)("customValuesControlGetter",t.customValuesControlGetter),e.xp6(4),e.Q6J("disabled",e.lcZ(7,15,t.requesting$))("label",t.i18n.general.next)}}function As(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).perform()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function Zs(n,a){1&n&&e._uU(0,"\xa0")}const Ps=function(){return[]};function qs(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",9),e.ALo(1,"async"),e.TgZ(2,"payment-step-confirm",10),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().perform(o)}),e.qZA(),e.TgZ(3,"actions",7),e.YNc(4,As,2,4,"action-button",11),e.ALo(5,"async"),e.YNc(6,Zs,1,0,"ng-template",null,12,e.W1O),e.TgZ(8,"action-button",13),e.NdJ("action",function(){return e.CHM(t),e.oxw().backToForm()}),e.qZA()()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.transaction.title.paymentConfirmation)("mobileHeading",i.i18n.transaction.mobileTitle.paymentConfirmation)("mode",e.lcZ(1,10,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("pos",i.pos)("preview",i.preview)("confirmationPassword",i.confirmationPassword)("showPaymentType",(i.availablePaymentTypes||e.DdM(14,Ps)).length>1),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,12,i.showSubmit$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.general.previous)}}function Ss(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}const Qs=n=>{const a=n.parent;if(a){const t=a.get("scheduling").value,i=a.get("firstInstallmentIsNow").value;if((0,h.cS)(n.value)&&("futureDate"===t||t===H.SCHEDULED&&!i))return{required:!0}}return null},Us=n=>{const a=n.parent;if(a){const t=a.get("scheduling").value,i=a.get("repeatUntilCanceled").value;if(t===H.RECURRING&&!i){const o=parseInt(n.value,10);return isNaN(o)?{required:!0}:s.kI.min(2)(n)}}return null},Ns=n=>{const a=n.parent;if(a){const t=a.get("scheduling").value,i=a.get("firstOccurrenceIsNow").value;if((0,h.cS)(n.value)&&t===H.RECURRING&&!i)return{required:!0}}return null};let Ct=(()=>{class n extends $.y{constructor(t,i,o,r,l){super(t),this.bankingHelper=i,this.paymentsService=o,this.posService=r,this.changeDetector=l,this.steps=["form","confirm"],this.step$=new y.X(null),this.currency$=new y.X(null),this.paymentTypeData$=new y.X(null),this.customValuesControls=new Map,this.showSubmit$=new y.X(!0)}get step(){return this.step$.value}set step(t){this.step$.next(t)}get currency(){return this.currency$.value}set currency(t){this.currency$.next(t)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(t){this.paymentTypeData$.next(t),this.updatePaymentTypeData(t)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;this.pos="pos"===t.url[t.url.length-1].path,this.pos||(this.fromParam=t.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=t.params.to,this.toSelf=null!=this.toParam&&this.dataForFrontendHolder.auth.role!=_e.g.ADMINISTRATOR&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam)),this.pos?(this.title=this.i18n.transaction.title.pos,this.mobileTitle=this.i18n.transaction.mobileTitle.pos):this.fromSystem?this.toSystem?(this.title=this.i18n.transaction.title.paymentSystemToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToSystem):(this.title=this.i18n.transaction.title.paymentSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToUser):this.toSelf?(this.title=this.i18n.transaction.title.paymentToSelf,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSelf):this.toSystem?(this.title=this.i18n.transaction.title.paymentToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSystem):(this.title=this.i18n.transaction.title.paymentToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.pos?this.posService.dataForReceivePayment({}).subscribe(i=>this.data=i):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:this.toParam}).subscribe(i=>this.data=i)),this.addSub(this.form.get("account").valueChanges.subscribe(i=>this.updateCurrency(this.data,i))),this.addSub(this.paymentTypeData$.subscribe(i=>{(null==this.lastPaymentTypeData||!(0,Ge.Z)(this.lastPaymentTypeData,i))&&this.adjustForm(i),this.lastPaymentTypeData=i})),this.addSub(this.form.valueChanges.subscribe(i=>this.adjustFormValidators(i)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.pos?null:this.toParam,s.kI.required],type:[null,s.kI.required],amount:[null,s.kI.required],description:null,scheduling:[H.DIRECT,s.kI.required],installmentsCount:null,firstInstallmentIsNow:!0,firstInstallmentDate:[null,Qs],repeatUntilCanceled:!0,occurrencesCount:[null,Us],firstOccurrenceIsNow:!0,firstOccurrenceDate:[null,Ns],occurrenceInterval:[{amount:1,field:vt.O.MONTHS},s.kI.required]})}updateCurrency(t,i){let o=null;!(0,h.cS)(i)&&t&&t.accounts&&(o=t.accounts.find(r=>r.type.id===i)),this.currency=o?o.currency:null}adjustForm(t){const i=this.form.get("description");(t||{}).descriptionAvailability===st.e.REQUIRED?i.setValidators(s.kI.required):(0,h.bR)(i)}adjustFormValidators(t){if(this.lastValue&&(0,Ge.Z)(this.lastValue,t))return;this.lastValue=t;const i=this.form.get("firstInstallmentDate");"futureDate"===t.scheduling||t.scheduling===H.SCHEDULED&&!t.firstInstallmentIsNow?i.setValidators(s.kI.required):(0,h.bR)(i);const o=this.form.get("installmentsCount");t.scheduling===H.SCHEDULED?o.setValidators(s.kI.compose([s.kI.required,s.kI.min(2)])):(0,h.bR)(o);const r=this.form.get("occurrencesCount"),l=this.form.get("firstOccurrenceDate");t.scheduling===H.RECURRING?(t.repeatUntilCanceled?(0,h.bR)(r):r.setValidators(s.kI.compose([s.kI.required,s.kI.min(2)])),t.firstOccurrenceIsNow?(0,h.bR)(l):l.setValidators(s.kI.required)):((0,h.bR)(r),(0,h.bR)(l)),this.changeDetector.detectChanges()}onDataInitialized(t){if((0,h.cS)(t.accounts))this.notification.error(this.bankingHelper.noAccountForPaymentErrorMessage());else{this.step="form";const i=t.accounts[0].type.id;this.form.patchValue({account:i},{emitEvent:!1}),this.updateCurrency(t,i)}}updatePaymentTypeData(t){const i=this.form.get("amount");t&&t.fixedAmount?(i.setValue(t.fixedAmount),i.disable()):i.disabled&&i.enable()}backToForm(){this.step="form"}toConfirm(){this.paymentStepForm.removeSubscriptions();const t={},i=this.paymentTypeData;if(i&&i.customFields)for(const o of i.customFields)t[o.internalName]=this.customValuesControlGetter(o);this.form.setControl("customValues",new s.cw(t)),(0,h.pt)(this.form)?this.addSub(this.confirmDataRequest().subscribe(o=>{this.preview=o,this.preview.skipConfirmation?this.perform():(this.step="confirm",this.canConfirm=this.authHelper.canConfirm(o.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(o.confirmationPasswordInput,null,this.pos)),this.confirmationPassword.setValidators(o.confirmationPasswordInput?s.kI.required:null),(0,h.SM)())})):this.paymentStepForm.createSubscriptions()}perform(t){if(t&&this.confirmationPassword.setValue(t),!(0,h.pt)(this.confirmationPassword))return;let i;i=this.pos?this.posService.receivePayment({body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}):this.paymentsService.performPayment({owner:this.fromParam,body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}),i.pipe((0,Le.P)()).subscribe(o=>{this.router.navigate(["/banking","transaction",this.bankingHelper.transactionNumberOrId(o)],{state:{url:this.router.url}})})}confirmDataRequest(){const t=(0,ze.Z)(this.form.value),i=t;switch(t.scheduling){case"futureDate":i.scheduling=H.SCHEDULED,i.installmentsCount=1;break;case H.SCHEDULED:t.firstInstallmentIsNow&&(i.firstInstallmentDate=null);break;case H.RECURRING:t.repeatUntilCanceled&&(i.occurrencesCount=null),t.firstOccurrenceIsNow&&(i.firstOccurrenceDate=null)}return delete t.firstInstallmentIsNow,delete t.repeatUntilCanceled,delete t.firstOccurrenceIsNow,this.pos?this.posService.previewReceivePayment({body:i}):this.paymentsService.previewPayment({owner:this.fromParam,body:i})}locateControl(t){return(0,h.xB)(this.form,t)}get customValuesControlGetter(){return t=>{const i=t.internalName;let o=this.customValuesControls.get(i);return null==o&&(o=this.formBuilder.control(t.defaultValue,t.required?s.kI.required:null),this.customValuesControls.set(i,o)),o}}resolveMenu(t){return this.pos?v.v2.POS:this.fromSystem?this.toSystem?v.v2.PAYMENT_TO_SYSTEM:v.v2.PAYMENT_TO_USER:this.menu.userMenu(t.fromUser,this.toSystem?v.v2.PAYMENT_TO_SYSTEM:this.toSelf?v.v2.PAYMENT_TO_SELF:v.v2.PAYMENT_TO_USER)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(Lt),e.Y36(kt.J),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["payment"]],viewQuery:function(t,i){if(1&t&&e.Gf(ws,5),2&t){let o;e.iGM(o=e.CRH())&&(i.paymentStepForm=o.first)}},features:[e.qOj],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","pos","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["paymentStepForm",""],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"pos","preview","confirmationPassword","showPaymentType","showSubmit","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],["outline","",3,"label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,Cs,8,17,"page-content",1),e.YNc(4,qs,9,15,"page-content",2),e.YNc(5,Ss,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,Z.Y,Or,L.h,k.x,Ts,u.O5,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})(),We=(()=>{class n extends K.b{constructor(t,i){super(t,i)}dataForSendPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.DataForSendPaymentRequestPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("to",t.to,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}dataForSendPaymentRequest(t,i){return this.dataForSendPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}sendPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.SendPaymentRequestPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("owner",t.owner,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}sendPaymentRequest(t,i){return this.sendPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}acceptPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.AcceptPaymentRequestPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}acceptPaymentRequest(t,i){return this.acceptPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}reschedulePaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.ReschedulePaymentRequestPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}reschedulePaymentRequest(t,i){return this.reschedulePaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}previewPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewPaymentRequestPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewPaymentRequest(t,i){return this.previewPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}changePaymentRequestExpirationDate$Response(t,i){const o=new d.c(this.rootUrl,n.ChangePaymentRequestExpirationDatePath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changePaymentRequestExpirationDate(t,i){return this.changePaymentRequestExpirationDate$Response(t,i).pipe((0,c.U)(o=>o.body))}rejectPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.RejectPaymentRequestPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}rejectPaymentRequest(t,i){return this.rejectPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelPaymentRequest$Response(t,i){const o=new d.c(this.rootUrl,n.CancelPaymentRequestPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelPaymentRequest(t,i){return this.cancelPaymentRequest$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.DataForSendPaymentRequestPath="/{owner}/payment-requests/data-for-send",n.SendPaymentRequestPath="/{owner}/payment-requests",n.AcceptPaymentRequestPath="/payment-requests/{key}/accept",n.ReschedulePaymentRequestPath="/payment-requests/{key}/reschedule",n.PreviewPaymentRequestPath="/payment-requests/{key}/preview",n.ChangePaymentRequestExpirationDatePath="/payment-requests/{key}/change-expiration",n.RejectPaymentRequestPath="/payment-requests/{key}/reject",n.CancelPaymentRequestPath="/payment-requests/{key}/cancel",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ue=(()=>{return(n=Ue||(Ue={})).ACCEPT="accept",n.CANCEL="cancel",n.CHANGE_EXPIRATION="changeExpiration",n.DENY="deny",n.RESCHEDULE="reschedule",Ue;var n})(),pe=(()=>{return(n=pe||(pe={}))[n.NOW=0]="NOW",n[n.DATE=1]="DATE",n[n.EXPIRY=2]="EXPIRY",pe;var n})(),Xe=m(8397);function Is(n,a){if(1&n&&(e.TgZ(0,"notification",12),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.i18n.transaction.requiresAuthorization,"\n")}}function Js(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._UZ(1,"user-link",14),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromUser),e.xp6(1),e.Q6J("user",t.fromUser)}}function Ls(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.preview.fromAccount.type.name,"\n")}}function ks(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._UZ(1,"user-link",14),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.toUser),e.xp6(1),e.Q6J("user",t.toUser)}}function Fs(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.preview.toAccount.type.name,"\n")}}function Os(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.hij(" ",t.preview.paymentType.name,"\n")}}function Ds(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.preview.mainAmount,t.preview.currency),"\n")}}function Rs(n,a){if(1&n&&(e.TgZ(0,"div",16)(1,"div",17),e._uU(2),e.qZA(),e.TgZ(3,"div",18),e._uU(4),e.ALo(5,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij("",t.fee.name,":"),e.xp6(2),e.Oqu(e.xi3(5,2,t.amount,i.preview.currency))}}function Vs(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,Rs,6,5,"div",15),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.appliedFees),e.xp6(1),e.Q6J("ngForOf",t.fees)}}function Ys(n,a){1&n&&e._UZ(0,"custom-field-value",19),2&n&&e.Q6J("fieldValue",a.$implicit)}function Es(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.dueDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.preview.installments[0].dueDate),"\n")}}function $s(n,a){if(1&n&&(e.TgZ(0,"thead")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th",22),e._uU(6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(2),e.Oqu(t.i18n.transaction.dueDate),e.xp6(2),e.Oqu(t.i18n.transaction.amount)}}function Bs(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",22),e._uU(7),e.ALo(8,"currency"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij(" ",t.number," "),e.xp6(2),e.hij(" ",e.lcZ(5,3,t.dueDate)," "),e.xp6(3),e.hij(" ",e.xi3(8,5,t.mainAmount,i.preview.currency)," ")}}function Hs(n,a){if(1&n&&(e.TgZ(0,"label-value",13)(1,"table",20),e.YNc(2,$s,7,3,"thead",4),e.ALo(3,"async"),e.TgZ(4,"tbody"),e.YNc(5,Bs,9,8,"tr",21),e.qZA()()()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.installments),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,3,t.layout.gtxs$)),e.xp6(3),e.Q6J("ngForOf",t.preview.installments)}}function js(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentNowManual," ")}}function Ms(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentNowFixed(t.preview.payment.occurrencesCount)," ")}}function zs(n,a){if(1&n&&(e.ynx(0),e.YNc(1,js,2,1,"ng-container",4),e.YNc(2,Ms,2,1,"ng-container",4),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.preview.payment.occurrencesCount),e.xp6(1),e.Q6J("ngIf",null!=t.preview.payment.occurrencesCount)}}function Gs(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentDateManual(e.lcZ(2,1,t.preview.payment.firstOccurrenceDate))," ")}}const Ws=function(n,a){return{date:n,count:a}};function Xs(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.recurringPaymentDateFixed(e.WLB(3,Ws,e.lcZ(2,1,t.preview.payment.firstOccurrenceDate),t.preview.payment.occurrencesCount))," ")}}function Ks(n,a){if(1&n&&(e.YNc(0,Gs,3,3,"ng-container",4),e.YNc(1,Xs,3,6,"ng-container",4)),2&n){const t=e.oxw(2);e.Q6J("ngIf",null==t.preview.payment.occurrencesCount),e.xp6(1),e.Q6J("ngIf",null!=t.preview.payment.occurrencesCount)}}function ec(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrenceInterval),e.xp6(1),e.hij(" ",t.format.formatTimeInterval(t.preview.payment.occurrenceInterval)," ")}}function tc(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,zs,3,2,"ng-container",23),e.YNc(2,Ks,2,2,"ng-template",null,24,e.W1O),e.YNc(4,ec,2,2,"label-value",1),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("label",i.i18n.transaction.recurringPayment),e.xp6(1),e.Q6J("ngIf",null==i.preview.payment.firstOccurrenceDate)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",i.preview.payment.occurrenceInterval)}}function nc(n,a){if(1&n&&e._UZ(0,"label-value",25),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("value",t.preview.payment.description)}}function ic(n,a){1&n&&e._UZ(0,"hr")}function oc(n,a){1&n&&e._UZ(0,"hr")}function ac(n,a){if(1&n&&(e.ynx(0),e.YNc(1,oc,1,0,"hr",4),e.ALo(2,"async"),e.TgZ(3,"div",26),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.layout.gtxxs$)),e.xp6(3),e.Oqu(t.preview.confirmationMessage)}}function rc(n,a){1&n&&e._UZ(0,"hr")}function sc(n,a){if(1&n&&e._UZ(0,"date-field",27),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.processDate)("maxDate",t.preview.paymentRequest.expirationDate)("tooltip",t.i18n.transaction.processDateTooltip)}}function cc(n,a){1&n&&e._UZ(0,"hr")}function lc(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,cc,1,0,"hr",4),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",28),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,t.layout.gtxxs$)),e.xp6(2),e.Q6J("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}let uc=(()=>{class n extends q.H{constructor(t,i){super(t),this.authHelper=i,this.PaymentRequestScheduledTo=pe,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===ot.S.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===ot.S.SYSTEM,this.scheduleTo=new s.NI(pe.NOW),this.addSub(this.scheduleTo.valueChanges.subscribe(t=>{t===pe.DATE?this.form.controls.processDate.setValidators(s.kI.required):this.form.controls.processDate.clearValidators(),this.form.patchValue({processDate:t===pe.EXPIRY?this.preview.paymentRequest.expirationDate:null})})),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,(0,h.cS)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>({type:U.l.MANAGE_PAYMENT_REQUEST,transaction:this.transaction,paymentRequestAction:Ue.ACCEPT}),this.preview.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["accept-payment-request-confirm"]],inputs:{form:"form",preview:"preview",transaction:"transaction",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:33,vars:43,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],[3,"formGroup"],["kind","fieldView",3,"label"],[3,"label","formControl"],[3,"value","text"],["formControlName","processDate","minDate","tomorrow",3,"label","maxDate","tooltip",4,"ngIf"],["formControlName","comments",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],["class","row no-gutters align-items-end",4,"ngFor","ngForOf"],[1,"row","no-gutters","align-items-end"],[1,"col-3"],[1,"col","pl-1"],[3,"fieldValue"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],["formControlName","processDate","minDate","tomorrow",3,"label","maxDate","tooltip"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","showSubmit","confirmed"]],template:function(t,i){1&t&&(e.YNc(0,Is,2,1,"notification",0),e.YNc(1,Js,2,2,"label-value",1),e.YNc(2,Ls,2,2,"label-value",1),e.YNc(3,ks,2,2,"label-value",1),e.YNc(4,Fs,2,2,"label-value",1),e.YNc(5,Os,2,2,"label-value",1),e.YNc(6,Ds,3,5,"label-value",1),e.YNc(7,Vs,2,2,"label-value",1),e.YNc(8,Ys,1,1,"custom-field-value",2),e.YNc(9,Es,3,4,"label-value",1),e.YNc(10,Hs,6,5,"label-value",1),e.YNc(11,tc,5,4,"label-value",1),e.YNc(12,nc,1,2,"label-value",3),e.YNc(13,ic,1,0,"hr",4),e.ALo(14,"async"),e.TgZ(15,"label-value",5),e._uU(16),e.ALo(17,"currency"),e.qZA(),e.YNc(18,ac,5,4,"ng-container",4),e.ynx(19,6),e.YNc(20,rc,1,0,"hr",4),e.ALo(21,"async"),e.TgZ(22,"label-value",7),e._uU(23),e.ALo(24,"date"),e.qZA(),e.TgZ(25,"single-selection-field",8),e._UZ(26,"field-option",9)(27,"field-option",9)(28,"field-option",9),e.qZA(),e.YNc(29,sc,1,3,"date-field",10),e.ALo(30,"async"),e._UZ(31,"textarea-field",11),e.YNc(32,lc,4,5,"ng-container",4),e.BQk()),2&t&&(e.Q6J("ngIf",i.preview.pendingAuthorization),e.xp6(1),e.Q6J("ngIf",!i.fromSelf&&i.fromUser),e.xp6(1),e.Q6J("ngIf",i.fromSystem),e.xp6(1),e.Q6J("ngIf",i.toUser),e.xp6(1),e.Q6J("ngIf",i.toSystem),e.xp6(1),e.Q6J("ngIf",i.showPaymentType),e.xp6(1),e.Q6J("ngIf",null!=i.preview.mainAmount&&i.preview.totalAmount!==i.preview.mainAmount),e.xp6(1),e.Q6J("ngIf",(null==i.fees?null:i.fees.length)>0),e.xp6(1),e.Q6J("ngForOf",i.preview.customValues),e.xp6(1),e.Q6J("ngIf",1===(null==i.preview.installments?null:i.preview.installments.length)),e.xp6(1),e.Q6J("ngIf",(null==i.preview.installments?null:i.preview.installments.length)>1),e.xp6(1),e.Q6J("ngIf","recurring"===i.preview.payment.scheduling),e.xp6(1),e.Q6J("ngIf",i.preview.payment.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(14,32,i.layout.gtxxs$)),e.xp6(2),e.Q6J("label",i.i18n.transaction.totalAmount),e.xp6(1),e.hij(" ",e.xi3(17,34,i.preview.totalAmount,i.preview.currency),"\n"),e.xp6(2),e.Q6J("ngIf",(i.preview.confirmationMessage||"").length>0),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",e.lcZ(21,37,i.layout.gtxxs$)),e.xp6(2),e.Q6J("label",i.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(24,39,i.preview.paymentRequest.expirationDate)," "),e.xp6(2),e.Q6J("label",i.i18n.transaction.scheduling)("formControl",i.scheduleTo),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.NOW)("text",i.i18n.transaction.paymentRequestSchedulingNow),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.DATE)("text",i.i18n.transaction.paymentRequestSchedulingDate),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.EXPIRY)("text",i.i18n.transaction.paymentRequestSchedulingExpiration(i.format.formatAsDate(i.preview.paymentRequest.expirationDate))),e.xp6(1),e.Q6J("ngIf",e.lcZ(30,41,i.scheduleTo.valueChanges)===i.PaymentRequestScheduledTo.DATE),e.xp6(2),e.Q6J("label",i.i18n.general.comments),e.xp6(1),e.Q6J("ngIf",i.preview.confirmationPasswordInput))},directives:[u.O5,Ee.c,C.t,Q.F,u.sg,Qe.W,s.JL,s.sg,O.f,s.JJ,s.oH,J.s,j.Q,s.u,Xe.i9,Te.u,he.y,z.A],pipes:[w.H,E.u,u.Ov],encapsulation:2,changeDetection:0}),n})();function pc(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",7),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).perform()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function mc(n,a){1&n&&e._uU(0,"\xa0")}function dc(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"accept-payment-request-confirm",3),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().perform(o)}),e.qZA(),e.TgZ(3,"actions",4),e.YNc(4,pc,2,4,"action-button",5),e.ALo(5,"async"),e.YNc(6,mc,1,0,"ng-template",null,6,e.W1O),e.qZA()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.transaction.title.paymentConfirmation)("mobileHeading",i.i18n.transaction.mobileTitle.paymentConfirmation)("mode",e.lcZ(1,10,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("transaction",i.transactionKey)("preview",i.data)("confirmationPassword",i.confirmationPassword)("form",i.form)("showPaymentType",!0),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,12,i.showSubmit$))("ngIfElse",t)}}let fc=(()=>{class n extends $.y{constructor(t,i,o){super(t),this.bankingHelper=i,this.paymentRequestsService=o,this.empty=h.cS,this.showSubmit$=new y.X(!0)}ngOnInit(){super.ngOnInit(),this.transactionKey=this.route.snapshot.params.key,this.addSub(this.paymentRequestsService.previewPaymentRequest({key:this.transactionKey}).subscribe(t=>this.data=t))}onDataInitialized(t){this.form=this.formBuilder.group({processDate:null,comments:null}),this.confirmationPassword=this.formBuilder.control(null),this.canConfirm=this.authHelper.canConfirm(t.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput)),this.confirmationPassword.setValidators(t.confirmationPasswordInput?s.kI.required:null)}perform(t){if(!(0,h.pt)(this.form)||!(0,h.pt)(this.confirmationPassword))return;t&&this.confirmationPassword.setValue(t);const i=(0,ze.Z)(this.form.value);this.addSub(this.paymentRequestsService.acceptPaymentRequest({key:this.transactionKey,confirmationPassword:this.confirmationPassword.value,body:i}).subscribe(o=>{const r=this.form.value.processDate?this.transactionKey:this.bankingHelper.transactionNumberOrId(o);this.router.navigate(["/banking","transaction",r],{replaceUrl:!0,state:{showDoneMessage:!0}})}))}locateControl(t){return(0,h.xB)(this.form,t)}resolveMenu(){return v.v2.PAYMENT_REQUESTS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(We))},n.\u0275cmp=e.Xpm({type:n,selectors:[["accept-payment-request"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","mode",4,"ngIf"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"transaction","preview","confirmationPassword","form","showPaymentType","showSubmit","confirmed"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,dc,8,14,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,uc,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var Ke=(()=>{return(n=Ke||(Ke={})).DIRECT="direct",n.RECURRING="recurring",n.SCHEDULED="scheduled",Ke;var n})();const _c=["toUser"],hc=["amount"];function gc(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.sender),e.xp6(1),e.Q6J("user",t.fromUser)}}function yc(n,a){1&n&&e._UZ(0,"br")}function xc(n,a){1&n&&e._uU(0," - ")}function bc(n,a){if(1&n&&(e.ynx(0),e.YNc(1,yc,1,0,"br",23),e.ALo(2,"async"),e.YNc(3,xc,1,0,"ng-template",null,24,e.W1O),e._uU(5),e.BQk()),2&n){const t=e.MAs(4),i=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,o.layout.ltsm$))("ngIfElse",t),e.xp6(4),e.hij(" ",i.number," ")}}function vc(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"input",19,20),e.NdJ("keyup.enter",function(){return e.CHM(t),e.MAs(3).click()}),e.qZA(),e.TgZ(4,"label",21)(5,"div",22),e._uU(6),e.YNc(7,bc,6,5,"ng-container",2),e.qZA()()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Q6J("id","from_"+t.id)("value",t.type.id),e.xp6(2),e.Q6J("for","from_"+t.id),e.xp6(2),e.hij(" ",t.type.name," "),e.xp6(1),e.Q6J("ngIf",t.number)}}function Tc(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",14),e.YNc(2,vc,8,5,"div",15),e._UZ(3,"field-errors",16),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accounts),e.xp6(1),e.Q6J("control",t.form.get("account"))}}function wc(n,a){if(1&n&&e._UZ(0,"field-option",30),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.display)}}function Cc(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",28),e.YNc(1,wc,1,2,"field-option",29),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.data.allowedUsers)}}const Ac=function(n){return[n]},Zc=function(n){return{usersToExclude:n}};function Pc(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"user-field",31,32),e.NdJ("selected",function(o){e.CHM(t);const r=e.oxw(2);return o?r.setFocus(r.amountField):null}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("autoSearch",!t.allowPrincipal)("filters",e.VKq(9,Zc,t.fromUser&&!t.fromSelf?e.VKq(7,Ac,t.fromParam):null))("allowContacts",t.allowContacts)("allowSearch",t.allowSearch)("allowPrincipal",t.allowPrincipal)("allowQrCode",t.allowQrCode)("principalTypes",t.data.principalTypes)}}function qc(n,a){if(1&n&&(e.TgZ(0,"label-value",25),e.YNc(1,Cc,2,1,"single-selection-field",26),e.YNc(2,Pc,2,11,"ng-template",null,27,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("label",i.i18n.transaction.receiver),e.xp6(1),e.Q6J("ngIf",i.fixedUsersList)("ngIfElse",t)}}function Sc(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.receiver),e.xp6(1),e.Q6J("user",t.toUser)}}function Qc(n,a){if(1&n&&e._UZ(0,"field-option",30),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function Uc(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",33,34),e.YNc(2,Qc,1,2,"field-option",29),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,2,t.paymentTypes$))}}function Nc(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.paymentTypeData$.value.fixedAmount,t.paymentTypeData$.value.currency)," ")}}function Ic(n,a){if(1&n&&e._UZ(0,"decimal-field",35,36),2&n){const t=e.oxw();e.Q6J("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)}}function Jc(n,a){if(1&n&&e._UZ(0,"date-field",37),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.expirationDate)}}function Lc(n,a){if(1&n&&e._UZ(0,"custom-field-input",38),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.customValuesControlGetter(t))}}function kc(n,a){if(1&n&&e._UZ(0,"field-option",44),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingSingle)}}function Fc(n,a){if(1&n&&e._UZ(0,"field-option",45),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingInstallments)}}function Oc(n,a){if(1&n&&e._UZ(0,"field-option",46),2&n){const t=e.oxw(2);e.Q6J("text",t.i18n.transaction.schedulingRecurring)}}function Dc(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",39),e._UZ(1,"field-option",40),e.YNc(2,kc,1,1,"field-option",41),e.YNc(3,Fc,1,1,"field-option",42),e.YNc(4,Oc,1,1,"field-option",43),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.scheduling),e.xp6(1),e.Q6J("text",t.i18n.transaction.schedulingDirect),e.xp6(1),e.Q6J("ngIf",(null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.maxInstallments)>0),e.xp6(1),e.Q6J("ngIf",(null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.maxInstallments)>1),e.xp6(1),e.Q6J("ngIf",null==t.paymentTypeData$.value?null:t.paymentTypeData$.value.allowsRecurringPayments)}}function Rc(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"input-field",47)(2,"boolean-field",48),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.installmentsCount),e.xp6(1),e.Q6J("label",t.i18n.transaction.firstInstallmentIsImmediate)}}function Vc(n,a){if(1&n&&e._UZ(0,"input-field",53),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrencesCount)}}function Yc(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"radio-group-field",49),e._UZ(2,"field-option",30)(3,"field-option",30),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"radio-group-field",50),e._UZ(6,"field-option",30)(7,"field-option",30),e.qZA(),e.YNc(8,Vc,1,1,"input-field",51),e._UZ(9,"time-interval-field",52),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.firstOccurrence),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.transaction.firstOccurrenceImmediate),e.xp6(1),e.Q6J("value",!1)("text",e.lcZ(4,12,t.firstOccurrenceAfterIntervalLabel$)),e.xp6(2),e.Q6J("label",t.i18n.transaction.repeatUntil),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.transaction.repeatUntilManual),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.transaction.repeatUntilFixed),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.repeatUntilCanceled),e.xp6(1),e.Q6J("label",t.i18n.transaction.occurrenceInterval)}}function Ec(n,a){if(1&n&&e._UZ(0,"textarea-field",55),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("required","required"===t)("label",i.i18n.general.description)}}function $c(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ec,1,2,"textarea-field",54),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf","disabled"!==t)}}const Ot=[le.n.FORBIDDEN,le.n.UNAUTHORIZED,le.n.NOT_FOUND];let Bc=(()=>{class n extends q.H{constructor(t,i,o,r){super(t),this.bankingHelper=i,this.paymentRequestsService=o,this.authHelper=r,this.setFocus=h.T_,this.availablePaymentTypes=new e.vpe,this.accountBalanceLabel$=new y.X(null),this.firstOccurrenceAfterIntervalLabel$=new y.X(""),this.fixedDestination=!1,this.paymentTypes$=new y.X(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.firstOccurrenceAfterIntervalLabel$.next(this.firstOccurrenceAfterIntervalLabel()),this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe((0,ue.x)(),(0,we.b)(b.S.DEBOUNCE_TIME)).subscribe(i=>this.fetchPaymentTypeData(i))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.addSub(this.form.get("occurrenceInterval").valueChanges.subscribe(i=>{this.firstOccurrenceAfterIntervalLabel$.next(this.firstOccurrenceAfterIntervalLabel(i));const o=this.form.get("firstOccurrenceIsImmediate");o.setValue(o.value)})),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const i=b.S.escapeNumeric(this.form.value.subject);""!==i&&this.errorHandler.requestWithCustomErrorHandler(o=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:i,fields:["toUser","paymentTypes","paymentTypeData"]}).subscribe(r=>{this.setFetchedPaymentTypes(r)},r=>{if(this.allowPrincipal&&this.userField&&r.status===le.n.NOT_FOUND){let l=r.error;if("string"==typeof l)try{l=JSON.parse(l)}catch(g){l={}}const _=l.entityType;if(!(0,h.OW)(_)&&_.endsWith("User"))return void this.userField.search()}Ot.includes(r.status)||o(r)}))})}adjustPaymentTypes(){const t=this.form.value;if(0===(t.subject||"").trim().length)return;const o=this.fetchedPaymentTypes||[];(0,h.cS)(o)&&this.notification.error(this.i18n.transaction.noTypes);const r=o.filter(g=>g.to.id===t.account);let l=this.form.value.type,_=null;(0,h.cS)(r)?_={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(r),r.find(g=>g.id===l)||(l=r[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:l}),this.form.get("account").setErrors(_),this.form.get("account").markAsTouched(),(0,h.cS)(l)||this.fetchPaymentTypeData(l),this.availablePaymentTypes.emit(r)}setFetchedPaymentTypes(t){this.userField&&(this.userField.user=t.toUser),this.fetchedPaymentTypes=t.paymentTypes;const i=t.paymentTypeData;i&&this.dataCache.set(i.id,i),this.adjustPaymentTypes()}fetchPaymentTypeData(t){const i=this.form.value;if((0,h.cS)(i.subject)||(0,h.cS)(t))return;const o=this.dataCache.get(t);o?this.setPaymentTypeData(o):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(r=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:i.subject,type:t,fields:["paymentTypeData"]}).subscribe(l=>{this.setPaymentTypeData(l.paymentTypeData)},l=>{Ot.includes(l.status)||r(l)}))}))}firstOccurrenceAfterIntervalLabel(t){var i,o;return t=null!==(o=null!=t?t:null===(i=this.form.get("occurrenceInterval"))||void 0===i?void 0:i.value)&&void 0!==o?o:{amount:1,field:vt.O.MONTHS},this.i18n.transaction.firstOccurrenceAfterInterval(this.format.formatTimeInterval(t))}setPaymentTypeData(t){((this.paymentTypeData$.value||{}).id||null)!==((t||{}).id||null)&&(t&&(this.dataCache.set(t.id,t),(0,h.T_)(this.amountField),t.fixedAmount&&this.form.patchValue({amount:t.fixedAmount})),this.paymentTypeData$.next(t))}get fixedUsersList(){return!(0,h.cS)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!(0,h.cS)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const t=this.data.accounts||[];return 1===t.length?t[0]:null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(We),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["request-payment-form"]],viewQuery:function(t,i){if(1&t&&(e.Gf(_c,5),e.Gf(hc,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.userField=o.first),e.iGM(o=e.CRH())&&(i.amountField=o.first)}},inputs:{data:"data",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",toSystem:"toSystem",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[e.qOj],decls:23,vars:29,consts:[[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],[4,"ngIf"],["kind","field","required","",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["kind","fieldView",3,"label"],[3,"user"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],[4,"ngIf","ngIfElse"],["separator",""],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["formControlName","type","required","",3,"label"],["type",""],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsImmediate",3,"label"],["asColumn","","formControlName","firstOccurrenceIsImmediate",3,"label"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","occurrenceInterval","required","",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,gc,2,2,"label-value",1),e.YNc(2,Tc,4,3,"ng-container",2),e.YNc(3,qc,4,3,"label-value",3),e.YNc(4,Sc,2,2,"label-value",1),e.YNc(5,Uc,4,4,"single-selection-field",4),e.ALo(6,"async"),e.YNc(7,Nc,3,5,"label-value",5),e.ALo(8,"async"),e.YNc(9,Ic,2,5,"ng-template",null,6,e.W1O),e.YNc(11,Jc,1,1,"date-field",7),e.ALo(12,"async"),e.YNc(13,Lc,1,2,"custom-field-input",8),e.ALo(14,"async"),e.YNc(15,Dc,5,5,"single-selection-field",9),e.ALo(16,"async"),e.ALo(17,"async"),e.ynx(18,10),e.YNc(19,Rc,3,2,"ng-container",11),e.YNc(20,Yc,10,14,"ng-container",11),e.BQk(),e.YNc(21,$c,2,1,"ng-container",2),e.ALo(22,"async"),e.BQk()),2&t){const o=e.MAs(10);let r,l,_,g,P,S;e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.fromUser&&!i.fromSelf),e.xp6(1),e.Q6J("ngIf",!i.singleAccount),e.xp6(1),e.Q6J("ngIf",!i.fixedDestination),e.xp6(1),e.Q6J("ngIf",i.fixedDestination&&i.toUser),e.xp6(1),e.Q6J("ngIf",(null==(r=e.lcZ(6,15,i.paymentTypes$))?null:r.length)>1),e.xp6(2),e.Q6J("ngIf",null==(l=e.lcZ(8,17,i.paymentTypeData$))?null:l.fixedAmount)("ngIfElse",o),e.xp6(4),e.Q6J("ngIf",!(null!=(_=e.lcZ(12,19,i.paymentTypeData$))&&_.hideExpirationDate)),e.xp6(2),e.Q6J("ngForOf",null==(g=e.lcZ(14,21,i.paymentTypeData$))?null:g.customFields),e.xp6(2),e.Q6J("ngIf",(null==(P=e.lcZ(16,23,i.paymentTypeData$))?null:P.allowsRecurringPayments)||(null==(P=e.lcZ(17,25,i.paymentTypeData$))?null:P.maxInstallments)>0),e.xp6(3),e.Q6J("ngSwitch",i.form.value.scheduling),e.xp6(1),e.Q6J("ngSwitchCase","scheduled"),e.xp6(1),e.Q6J("ngSwitchCase","recurring"),e.xp6(1),e.Q6J("ngIf",(null==(S=e.lcZ(22,27,i.paymentTypeData$))?null:S.descriptionAvailability)||"disabled")}},directives:[s.JL,s.sg,u.O5,C.t,Q.F,u.sg,s._,s.Fj,s.JJ,s.u,bt.e,O.f,z.A,J.s,te.l,s.Q7,B.U,j.Q,Se.G,s.oH,u.RF,u.n9,F.q,Tt.X,at.M,qe.Y,wt.e,Te.u],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function Hc(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"request-payment-form",3),e.NdJ("availablePaymentTypes",function(o){return e.CHM(t),e.oxw().availablePaymentTypes=o}),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"actions",4)(5,"action-button",5),e.NdJ("action",function(){return e.CHM(t),e.oxw().perform()}),e.ALo(6,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("mode",e.lcZ(1,11,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.data)("form",t.form)("currency",e.lcZ(3,13,t.currency$))("paymentTypeData$",t.paymentTypeData$)("toSystem",t.toSystem)("customValuesControlGetter",t.customValuesControlGetter),e.xp6(3),e.Q6J("disabled",e.lcZ(6,15,t.requesting$))("label",t.i18n.general.confirm)}}const jc=n=>{const a=n.parent;if(a){const t=a.get("scheduling").value,i=a.get("repeatUntilCanceled").value;if(t===H.RECURRING&&!i){const o=parseInt(n.value,10);return isNaN(o)?{required:!0}:s.kI.min(2)(n)}}return null};let Dt=(()=>{class n extends $.y{constructor(t,i,o,r){super(t),this.bankingHelper=i,this.paymentRequestsService=o,this.changeDetector=r,this.currency$=new y.X(null),this.paymentTypeData$=new y.X(null),this.customValuesControls=new Map}get currency(){return this.currency$.value}set currency(t){this.currency$.next(t)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(t){this.paymentTypeData$.next(t),this.updatePaymentTypeData(t)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;this.fromParam=t.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=t.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam),this.fromSystem?(this.title=this.i18n.transaction.title.paymentRequestSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestSystemToUser):this.toSystem?(this.title=this.i18n.transaction.title.paymentRequestToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToSystem):(this.title=this.i18n.transaction.title.paymentRequestToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToUser),this.form=this.buildForm(),this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:this.toParam}).subscribe(i=>this.data=i)),this.addSub(this.form.get("account").valueChanges.subscribe(i=>this.updateCurrency(this.data,i))),this.addSub(this.paymentTypeData$.subscribe(i=>{(null==this.lastPaymentTypeData||!(0,Ge.Z)(this.lastPaymentTypeData,i))&&this.adjustForm(i),this.lastPaymentTypeData=i})),this.addSub(this.form.valueChanges.subscribe(i=>this.adjustFormValidators(i)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.toParam,s.kI.required],type:[null,s.kI.required],amount:[null,s.kI.required],expirationDate:[null,s.kI.required],description:null,scheduling:[H.DIRECT,s.kI.required],installmentsCount:null,firstInstallmentIsImmediate:!1,repeatUntilCanceled:!0,occurrencesCount:[null,jc],firstOccurrenceIsImmediate:!1,occurrenceInterval:[{amount:1,field:vt.O.MONTHS},s.kI.required]})}updateCurrency(t,i){let o=null;!(0,h.cS)(i)&&t&&t.accounts&&(o=t.accounts.find(r=>r.type.id===i)),this.currency=o?o.currency:null}adjustForm(t){const i=this.form.get("description");(t||{}).descriptionAvailability===st.e.REQUIRED?i.setValidators(s.kI.required):(0,h.bR)(i),(t||{}).defaultExpirationDate&&this.form.get("expirationDate").setValue(t.defaultExpirationDate)}adjustFormValidators(t){if(this.lastValue&&(0,Ge.Z)(this.lastValue,t))return;this.lastValue=t;const i=this.form.get("installmentsCount");t.scheduling===H.SCHEDULED?i.setValidators(s.kI.compose([s.kI.required,s.kI.min(2)])):(0,h.bR)(i);const o=this.form.get("occurrencesCount");t.scheduling===H.RECURRING?t.repeatUntilCanceled?(0,h.bR)(o):o.setValidators(s.kI.compose([s.kI.required,s.kI.min(2)])):(0,h.bR)(o),this.changeDetector.detectChanges()}onDataInitialized(t){if((0,h.cS)(t.accounts))this.notification.error(this.bankingHelper.noAccountForPaymentErrorMessage());else{const i=t.accounts[0].type.id;this.form.patchValue({account:i},{emitEvent:!1}),this.updateCurrency(t,i)}}updatePaymentTypeData(t){const i=this.form.get("amount");t&&t.fixedAmount?(i.setValue(t.fixedAmount),i.disable()):i.disabled&&i.enable()}perform(){const t={},i=this.paymentTypeData;if(i&&i.customFields)for(const o of i.customFields)t[o.internalName]=this.customValuesControlGetter(o);this.form.setControl("customValues",new s.cw(t)),(0,h.pt)(this.form)&&this.confirmation.confirm({title:this.i18n.general.confirm,message:this.i18n.transaction.confirmPaymentRequest,callback:()=>this.paymentRequestsService.sendPaymentRequest({owner:this.fromParam,body:this.confirmDataRequest()}).pipe((0,Le.P)()).subscribe(o=>{this.router.navigate(["/banking","transaction",this.bankingHelper.transactionNumberOrId(o)],{state:{url:this.router.url}})})})}confirmDataRequest(){const t=(0,ze.Z)(this.form.value),i=t;switch(t.scheduling){case"futureDate":i.scheduling=Ke.SCHEDULED,i.installmentsCount=1;break;case Ke.RECURRING:t.repeatUntilCanceled&&(i.occurrencesCount=null)}return i.expirationDate=b.S.shiftToDayEnd(i.expirationDate),delete t.firstInstallmentIsNow,delete t.repeatUntilCanceled,delete t.firstOccurrenceIsNow,i}locateControl(t){return(0,h.xB)(this.form,t)}get customValuesControlGetter(){return t=>{const i=t.internalName;let o=this.customValuesControls.get(i);return null==o&&(o=this.formBuilder.control(t.defaultValue,t.required?s.kI.required:null),this.customValuesControls.set(i,o)),o}}resolveMenu(t){return this.fromSystem?v.v2.PAYMENT_REQUESTS:this.menu.userMenu(t.fromUser,v.v2.PAYMENT_REQUESTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(We),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["request-payment"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","mode",4,"ngIf"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","currency","paymentTypeData$","toSystem","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Hc,7,17,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,Bc,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var Rt=m(8796);let Mc=(()=>{class n extends K.b{constructor(t,i){super(t,i)}dataForNewTicket$Response(t,i){const o=new d.c(this.rootUrl,n.DataForNewTicketPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("type",t.type,{}),o.query("payer",t.payer,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}dataForNewTicket(t,i){return this.dataForNewTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}newTicket$Response(t,i){const o=new d.c(this.rootUrl,n.NewTicketPath,"post");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}newTicket(t,i){return this.newTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}viewTicket$Response(t,i){const o=new d.c(this.rootUrl,n.ViewTicketPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("ticket",t.ticket,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}viewTicket(t,i){return this.viewTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}getTicketQrCode$Response(t,i){const o=new d.c(this.rootUrl,n.GetTicketQrCodePath,"get");return t&&(o.path("ticket",t.ticket,{}),o.query("size",t.size,{})),this.http.request(o.build({responseType:"blob",accept:"image/png",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getTicketQrCode(t,i){return this.getTicketQrCode$Response(t,i).pipe((0,c.U)(o=>o.body))}previewTicket$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewTicketPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("ticket",t.ticket,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewTicket(t,i){return this.previewTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelTicket$Response(t,i){const o=new d.c(this.rootUrl,n.CancelTicketPath,"post");return t&&o.path("ticket",t.ticket,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelTicket(t,i){return this.cancelTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}approveTicket$Response(t,i){const o=new d.c(this.rootUrl,n.ApproveTicketPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{}),o.path("ticket",t.ticket,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}approveTicket(t,i){return this.approveTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}processTicket$Response(t,i){const o=new d.c(this.rootUrl,n.ProcessTicketPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("ticket",t.ticket,{}),o.query("orderId",t.orderId,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}processTicket(t,i){return this.processTicket$Response(t,i).pipe((0,c.U)(o=>o.body))}dataForNewTicketDeprecated$Response(t,i){const o=new d.c(this.rootUrl,n.DataForNewTicketDeprecatedPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("type",t.type,{}),o.query("payer",t.payer,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}dataForNewTicketDeprecated(t,i){return this.dataForNewTicketDeprecated$Response(t,i).pipe((0,c.U)(o=>o.body))}newTicketDeprecated$Response(t,i){const o=new d.c(this.rootUrl,n.NewTicketDeprecatedPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}newTicketDeprecated(t,i){return this.newTicketDeprecated$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.DataForNewTicketPath="/{user}/tickets/data-for-new",n.NewTicketPath="/{user}/tickets",n.ViewTicketPath="/tickets/{ticket}",n.GetTicketQrCodePath="/tickets/{ticket}/qr-code",n.PreviewTicketPath="/tickets/{ticket}/preview",n.CancelTicketPath="/tickets/{ticket}/cancel",n.ApproveTicketPath="/tickets/{ticket}/approve",n.ProcessTicketPath="/tickets/{ticket}/process",n.DataForNewTicketDeprecatedPath="/tickets/data-for-new",n.NewTicketDeprecatedPath="/tickets",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var zc=m(7247);const Gc=["amount"];function Wc(n,a){if(1&n&&e._UZ(0,"field-option",9),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.type.name)}}function Xc(n,a){if(1&n&&(e.TgZ(0,"radio-group-field",7),e.YNc(1,Wc,1,2,"field-option",8),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accounts)}}function Kc(n,a){if(1&n&&e._UZ(0,"field-option",9),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function el(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",10),e.YNc(1,Kc,1,2,"field-option",8),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.Q6J("ngForOf",t.transferTypes)}}function tl(n,a){if(1&n&&(e.TgZ(0,"label-value",11),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.typeData.fixedAmount,t.currency)," ")}}function nl(n,a){if(1&n&&e._UZ(0,"decimal-field",12),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)("scale",null==t.currency?null:t.currency.decimalDigits)}}function il(n,a){if(1&n&&e._UZ(0,"custom-field-input",14),2&n){const t=a.$implicit;e.Q6J("formControlName",t.internalName)("field",t)}}function ol(n,a){if(1&n&&(e.ynx(0,0),e.YNc(1,il,1,2,"custom-field-input",13),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form.controls.customValues),e.xp6(1),e.Q6J("ngForOf",t.typeData.customFields)}}function al(n,a){if(1&n&&e._UZ(0,"textarea-field",15),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("required","required"===(null==t.typeData?null:t.typeData.descriptionAvailability))}}let rl=(()=>{class n extends q.H{constructor(t){super(t)}get singleAccount(){return 1===this.data.accounts.length}get currency(){return null==this.typeData?null:this.typeData.currency}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["receive-qr-payment-step-form"]],viewQuery:function(t,i){if(1&t&&e.Gf(Gc,7),2&t){let o;e.iGM(o=e.CRH())&&(i.amountField=o.first)}},inputs:{data:"data",form:"form",transferTypes:"transferTypes",type:"type",typeData:"typeData"},features:[e.qOj],decls:8,vars:7,consts:[[3,"formGroup"],["formControlName","account","required","","asColumn","",3,"label",4,"ngIf"],["formControlName","type",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],[3,"formGroup",4,"ngIf"],["formControlName","description",3,"label","required",4,"ngIf"],["formControlName","account","required","","asColumn","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type",3,"label"],["kind","fieldView",3,"label"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],[3,"formControlName","field",4,"ngFor","ngForOf"],[3,"formControlName","field"],["formControlName","description",3,"label","required"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,Xc,2,2,"radio-group-field",1),e.YNc(2,el,2,2,"single-selection-field",2),e.YNc(3,tl,3,5,"label-value",3),e.YNc(4,nl,1,4,"ng-template",null,4,e.W1O),e.YNc(6,ol,2,2,"ng-container",5),e.YNc(7,al,1,2,"textarea-field",6),e.BQk()),2&t){const o=e.MAs(5);e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",!i.singleAccount),e.xp6(1),e.Q6J("ngIf",(null==i.transferTypes?null:i.transferTypes.length)>1),e.xp6(1),e.Q6J("ngIf",null==i.typeData?null:i.typeData.fixedAmount)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",(null==i.typeData||null==i.typeData.customFields?null:i.typeData.customFields.length)>0),e.xp6(1),e.Q6J("ngIf","disabled"!==(null==i.typeData?null:i.typeData.descriptionAvailability))}},directives:[s.JL,s.sg,u.O5,qe.Y,s.JJ,s.u,s.Q7,u.sg,J.s,O.f,C.t,B.U,z.A,Se.G,Te.u],pipes:[w.H],encapsulation:2,changeDetection:0}),n})();var Vt=m(2208),lt=m(70),Yt=m(3317);function sl(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).copyUrl()}),e._UZ(1,"icon",11),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("tooltip",t.i18n.general.copyToClipboard),e.xp6(1),e.Q6J("icon",t.SvgIcon.Clipboard)}}function cl(n,a){if(1&n&&(e.TgZ(0,"label-value",3)(1,"div",8),e._uU(2),e.qZA(),e.YNc(3,sl,2,2,"button",9),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.ticketShareUrl),e.xp6(2),e.Oqu(t.ticket.approveUrl)}}let ll=(()=>{class n extends q.H{constructor(t){super(t),this.supportsShare=(0,h.pF)()}copyUrl(){(0,h.vQ)(this.ticket.approveUrl),this.notification.snackBar(this.i18n.general.copyToClipboardDone)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["receive-qr-payment-step-pending"]],inputs:{ticket:"ticket",qrCodeUrl:"qrCodeUrl"},features:[e.qOj],decls:10,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"mb-3",3,"src"],[3,"label","value"],[3,"label"],[1,"d-flex","flex-row"],[1,"flex-grow-1"],["bootstrap","","size","1.5rem"],[3,"label",4,"ngIf"],[1,"w-100"],["class","btn btn-icon","type","button",3,"tooltip","click",4,"extraCell"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"img",1),e.ALo(2,"trust"),e.qZA(),e._UZ(3,"label-value",2),e.TgZ(4,"label-value",3)(5,"div",4)(6,"div",5),e._uU(7),e.qZA(),e._UZ(8,"spinner",6),e.qZA()(),e.YNc(9,cl,4,2,"label-value",7)),2&t&&(e.xp6(1),e.Q6J("src",e.xi3(2,6,i.qrCodeUrl,"url"),e.LSH),e.xp6(2),e.Q6J("label",i.i18n.transaction.amount)("value",i.format.formatAsCurrency(i.ticket.currency,i.ticket.amount)),e.xp6(1),e.Q6J("label",i.i18n.general.status),e.xp6(3),e.Oqu(i.i18n.transaction.receiveQrPaymentPendingConfirmation),e.xp6(2),e.Q6J("ngIf",!i.supportsShare))},directives:[C.t,ne.O,u.O5,Vt.j,Xe.i9,lt.o],pipes:[Yt.a],encapsulation:2,changeDetection:0}),n})();function ul(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e._UZ(2,"receive-qr-payment-step-form",5),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.TgZ(6,"actions",6)(7,"action-button",7),e.NdJ("action",function(){return e.CHM(t),e.oxw().toPending()}),e.ALo(8,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.transaction.title.receiveQrPayment)("mobileHeading",t.i18n.transaction.mobileTitle.receiveQrPayment)("mode",e.lcZ(1,10,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.data)("form",t.form)("transferTypes",e.lcZ(3,12,t.paymentTypes$))("type",e.lcZ(4,14,t.paymentType$))("typeData",e.lcZ(5,16,t.paymentTypeData$)),e.xp6(5),e.Q6J("disabled",e.lcZ(8,18,t.requesting$))("label",t.i18n.transaction.receiveQrPaymentGenerateQrCode)}}function pl(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",13),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).share()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.share)("disabled",e.lcZ(1,2,t.requesting$))}}function ml(n,a){1&n&&e._UZ(0,"span")}function dl(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",8),e.ALo(1,"async"),e._UZ(2,"receive-qr-payment-step-pending",9),e.ALo(3,"async"),e.ALo(4,"async"),e.TgZ(5,"actions",6),e.YNc(6,pl,2,4,"action-button",10),e.YNc(7,ml,1,0,"ng-template",null,11,e.W1O),e.TgZ(9,"action-button",12),e.NdJ("action",function(){return e.CHM(t),e.oxw().reload()}),e.qZA()()()}if(2&n){const t=e.MAs(8),i=e.oxw();e.Q6J("heading",i.i18n.transaction.title.receiveQrPayment)("mobileHeading",i.i18n.transaction.mobileTitle.receiveQrPayment)("mode",e.lcZ(1,8,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ticket",e.lcZ(3,10,i.ticket$))("qrCodeUrl",e.lcZ(4,12,i.qrCodeUrl$)),e.xp6(4),e.Q6J("ngIf",i.supportsShare)("ngIfElse",t),e.xp6(3),e.Q6J("label",i.i18n.transaction.receiveQrPaymentGenerateNewQrCode)}}function fl(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let _l=(()=>{class n extends $.y{constructor(t,i,o,r){super(t),this.ticketsService=i,this.pushNotifications=o,this.bankingHelper=r,this.step$=new y.X(null),this.ticket$=new y.X(null),this.paymentTypes$=new y.X([]),this.paymentType$=new y.X(null),this.paymentTypeData$=new y.X(null),this.paymentTypeDataCache=new Map,this.qrCodeUrl$=new y.X(null),this.supportsShare=(0,h.pF)()}ngOnInit(){super.ngOnInit(),this.addSub(this.ticketsService.dataForNewTicket({user:b.S.SELF}).subscribe(t=>this.data=t)),this.addSub(this.step$.subscribe(t=>this.onStepChanged(t)))}ngOnDestroy(){super.ngOnDestroy(),this.unsubscribePush(),this.destroyQrCode()}onDataInitialized(t){(0,h.cS)(t.accounts)||(0,h.cS)(t.paymentTypes)?this.notification.error(this.bankingHelper.noAccountForPaymentErrorMessage()):(this.form=this.formBuilder.group({account:[null,s.kI.required],type:[null,s.kI.required],amount:[null,s.kI.required],description:null}),this.paymentTypeDataCache.set(t.paymentTypes[0].id,t.paymentTypeData),this.addSub(this.form.controls.type.valueChanges.pipe((0,ue.x)()).subscribe(i=>this.onPaymentTypeChange(i))),this.addSub(this.form.controls.account.valueChanges.pipe((0,ue.x)()).subscribe(i=>this.onAccountChange(i,t))),this.form.patchValue({account:t.accounts[0].id}),this.step$.next("form"))}onAccountChange(t,i){const o=i.accounts.find(l=>l.id===t),r=o?i.paymentTypes.filter(l=>l.to.id===o.type.id):[];this.paymentTypes$.next(r),this.form.patchValue({type:0===r.length?null:r[0].id})}onPaymentTypeChange(t){const i=(this.paymentTypes$.value||[]).find(l=>l.id===t);if(!i)return void this.notification.error(this.i18n.transaction.noTypes);const o=l=>{(this.paymentType$.value||{}).id!==t&&(this.paymentTypeDataCache.set(t,l),this.paymentType$.next(i),this.paymentTypeData$.next(l),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(l.customFields)),this.form.controls.type.setValidators(l.descriptionAvailability===st.e.REQUIRED?s.kI.required:null),(null==l?void 0:l.fixedAmount)&&this.form.patchValue({amount:l.fixedAmount}))},r=this.paymentTypeDataCache.get(t);r?o(r):this.addSub(this.ticketsService.dataForNewTicket({user:b.S.SELF,type:t}).subscribe(l=>{o(l.paymentTypeData)}))}toPending(){!(0,h.pt)(this.form)||this.addSub(this.ticketsService.newTicket({user:b.S.SELF,body:this.form.value}).subscribe(t=>{this.ticket$.next(t),this.addSub(this.ticketsService.getTicketQrCode({ticket:t.ticketNumber,size:Rt.r.MEDIUM}).subscribe(i=>{this.qrCodeUrl$.next(URL.createObjectURL(i))})),this.step$.next("pending")}))}onStepChanged(t){"pending"===t?this.pushSub=this.pushNotifications.ticket$.subscribe(i=>{const o=this.ticket$.value;o&&o.id===i.id&&this.router.navigate(["/banking","transaction",this.bankingHelper.transactionNumberOrId(i.transaction)],{state:{url:this.router.url}})}):(this.unsubscribePush(),this.destroyQrCode())}unsubscribePush(){this.pushSub&&(this.pushSub.unsubscribe(),this.pushSub=null)}destroyQrCode(){this.qrCodeUrl$.value&&(URL.revokeObjectURL(this.qrCodeUrl$.value),this.qrCodeUrl$.next(null))}share(){const t=this.ticket$.value;navigator.share&&navigator.share({url:t.approveUrl,title:this.i18n.transaction.ticketShareTitle,text:this.i18n.transaction.ticketShareText({user:t.to.user.display,amount:this.format.formatAsCurrency(t.currency,t.amount)})})}resolveMenu(){return v.v2.RECEIVE_QR_PAYMENT}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Mc),e.Y36(zc.Z),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["receive-qr-payment"]],features:[e.qOj],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","transferTypes","type","typeData"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[3,"ticket","qrCodeUrl"],[3,"label","disabled","action",4,"ngIf","ngIfElse"],["empty",""],["outline","",3,"label","action"],[3,"label","disabled","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,ul,9,20,"page-content",1),e.YNc(4,dl,10,14,"page-content",2),e.YNc(5,fl,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","pending"))},directives:[A.w,u.RF,u.n9,Z.Y,rl,L.h,k.x,ll,u.O5,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var ke=(()=>{return(n=ke||(ke={})).BLOCK="block",n.CANCEL="cancel",n.MODIFY="modify",n.UNBLOCK="unblock",ke;var n})();let Et=(()=>{class n extends K.b{constructor(t,i){super(t,i)}cancelRecurringPayment$Response(t,i){const o=new d.c(this.rootUrl,n.CancelRecurringPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelRecurringPayment(t,i){return this.cancelRecurringPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}modifyRecurringPayment$Response(t,i){const o=new d.c(this.rootUrl,n.ModifyRecurringPaymentPath,"put");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}modifyRecurringPayment(t,i){return this.modifyRecurringPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}blockRecurringPayment$Response(t,i){const o=new d.c(this.rootUrl,n.BlockRecurringPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}blockRecurringPayment(t,i){return this.blockRecurringPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}unblockRecurringPayment$Response(t,i){const o=new d.c(this.rootUrl,n.UnblockRecurringPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}unblockRecurringPayment(t,i){return this.unblockRecurringPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}getRecurringPaymentDataForEdit$Response(t,i){const o=new d.c(this.rootUrl,n.GetRecurringPaymentDataForEditPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getRecurringPaymentDataForEdit(t,i){return this.getRecurringPaymentDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.CancelRecurringPaymentPath="/recurring-payments/{key}/cancel",n.ModifyRecurringPaymentPath="/recurring-payments/{key}/modify",n.BlockRecurringPaymentPath="/recurring-payments/{key}/block",n.UnblockRecurringPaymentPath="/recurring-payments/{key}/unblock",n.GetRecurringPaymentDataForEditPath="/recurring-payments/{key}/data-for-edit",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hl(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.number),e.xp6(1),e.hij(" ",t.transaction.transactionNumber," ")}}function gl(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw(3);e.Q6J("user",t.transaction.from.user)}}function yl(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(3);e.hij(" ",t.transaction.from.type.name," ")}}function xl(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e.YNc(1,gl,1,1,"user-link",14),e.YNc(2,yl,1,1,"ng-template",null,15,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw(2);e.Q6J("label",i.i18n.transaction.from),e.xp6(1),e.Q6J("ngIf",i.transaction.from.user)("ngIfElse",t)}}function bl(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.transaction.from.number," ")}}function vl(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw(3);e.Q6J("user",t.transaction.to.user)}}function Tl(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(3);e.hij(" ",t.transaction.to.type.name," ")}}function wl(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e.YNc(1,vl,1,1,"user-link",14),e.YNc(2,Tl,1,1,"ng-template",null,17,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw(2);e.Q6J("label",i.i18n.transaction.to),e.xp6(1),e.Q6J("ngIf",i.transaction.to.user)("ngIfElse",t)}}function Cl(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.transaction.to.number," ")}}function Al(n,a){if(1&n&&e._UZ(0,"date-field",18),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.firstOccurrenceDate)}}function Zl(n,a){if(1&n&&e._UZ(0,"input-field",19),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrencesCount)}}function Pl(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,hl,2,2,"label-value",3),e.TgZ(4,"label-value",4),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.YNc(7,xl,4,3,"label-value",3),e.YNc(8,bl,2,2,"label-value",3),e.YNc(9,wl,4,3,"label-value",3),e.YNc(10,Cl,2,2,"label-value",3),e.TgZ(11,"label-value",4),e._uU(12),e.qZA(),e._UZ(13,"hr"),e.ynx(14,5),e.TgZ(15,"radio-group-field",6),e._UZ(16,"field-option",7)(17,"field-option",7),e.qZA(),e.YNc(18,Al,1,1,"date-field",8),e.TgZ(19,"radio-group-field",9),e._UZ(20,"field-option",7)(21,"field-option",7),e.qZA(),e.YNc(22,Zl,1,1,"input-field",10),e._UZ(23,"time-interval-field",11),e.BQk(),e.TgZ(24,"actions",12)(25,"action-button",13),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(26,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.transaction.title.editRecurringPayment)("mobileHeading",t.i18n.transaction.mobileTitle.editRecurringPayment)("headingActions",e.lcZ(2,28,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.transaction.transactionNumber),e.xp6(1),e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(6,30,t.transaction.amount,t.transaction.currency)," "),e.xp6(2),e.Q6J("ngIf",t.transaction.from),e.xp6(1),e.Q6J("ngIf",null==t.transaction.from?null:t.transaction.from.number),e.xp6(1),e.Q6J("ngIf",t.transaction.to),e.xp6(1),e.Q6J("ngIf",null==t.transaction.to?null:t.transaction.to.number),e.xp6(1),e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.hij(" ",t.transaction.type.name," "),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.transaction.firstOccurrence),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.general.now),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.general.futureDate),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.firstOccurrenceIsNow),e.xp6(1),e.Q6J("label",t.i18n.transaction.repeatUntil),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.transaction.repeatUntilManual),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.transaction.repeatUntilFixed),e.xp6(1),e.Q6J("ngIf",!1===t.form.value.repeatUntilCanceled),e.xp6(1),e.Q6J("label",t.i18n.transaction.occurrenceInterval),e.xp6(2),e.Q6J("disabled",e.lcZ(26,33,t.requesting$))("label",t.i18n.general.submit)}}const ql=n=>{const a=n.parent;if(a&&!a.get("repeatUntilCanceled").value){const i=parseInt(n.value,10);return isNaN(i)?{required:!0}:s.kI.min(2)(n)}return null},Sl=n=>{const a=n.parent;if(a){const t=a.get("firstOccurrenceIsNow").value;if((0,h.cS)(n.value)&&!t)return{required:!0}}return null};let Ql=(()=>{class n extends $.y{constructor(t,i){super(t),this.recurringPaymentService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.recurringPaymentService.getRecurringPaymentDataForEdit({key:this.id}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.form=this.formBuilder.group({occurrencesCount:[t.recurringPayment.occurrencesCount,ql],firstOccurrenceIsNow:null===t.recurringPayment.firstOccurrenceDate,firstOccurrenceDate:[t.recurringPayment.firstOccurrenceDate,Sl],repeatUntilCanceled:null===t.recurringPayment.occurrencesCount,occurrenceInterval:[t.recurringPayment.occurrenceInterval,s.kI.required],version:t.recurringPayment.version})}save(){if(!(0,h.pt)(this.form))return;const t=this.form.value;this.form.controls.firstOccurrenceIsNow.value&&(t.firstOccurrenceDate=null),this.form.controls.repeatUntilCanceled.value&&(t.occurrencesCount=null),this.confirmation.confirm({title:this.i18n.general.confirm,createDeviceConfirmation:this.recurringDeviceConfirmation(ke.MODIFY),passwordInput:this.data.confirmationPasswordInput,callback:i=>{this.addSub(this.recurringPaymentService.modifyRecurringPayment({key:this.id,confirmationPassword:i.confirmationPassword,body:t}).subscribe(()=>{this.notification.snackBar(this.i18n.transaction.editRecurringDone),history.back()}))}})}recurringDeviceConfirmation(t){return()=>({type:U.l.MANAGE_RECURRING_PAYMENT,transaction:this.id,recurringPaymentAction:t})}get transaction(){return this.data.originalRecurringPayment}resolveMenu(t){return this.menu.accountMenu(t.originalRecurringPayment.from,t.originalRecurringPayment.to)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Et))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-recurring-payment"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"label",4,"ngIf"],[3,"label"],[3,"formGroup"],["formControlName","firstOccurrenceIsNow",3,"label"],[3,"value","text"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["fieldSize","small","formControlName","occurrenceInterval","required","",3,"label"],["forceRow",""],[3,"disabled","label","action"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],[3,"user"],["toSystem",""],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Pl,27,35,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,C.t,Q.F,s.JL,s.sg,qe.Y,s.JJ,s.u,J.s,j.Q,s.Q7,F.q,Tt.X,wt.e,L.h,k.x],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();var ut=m(2068);let At=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getInstallmentsDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetInstallmentsDataForSearchPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getInstallmentsDataForSearch(t,i){return this.getInstallmentsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchInstallments$Response(t,i){const o=new d.c(this.rootUrl,n.SearchInstallmentsPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("accountTypes",t.accountTypes,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("direction",t.direction,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchInstallments(t,i){return this.searchInstallments$Response(t,i).pipe((0,c.U)(o=>o.body))}exportInstallments$Response(t,i){const o=new d.c(this.rootUrl,n.ExportInstallmentsPath,"get");return t&&(o.path("owner",t.owner,{}),o.path("format",t.format,{}),o.query("accessClients",t.accessClients,{}),o.query("accountTypes",t.accountTypes,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("direction",t.direction,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportInstallments(t,i){return this.exportInstallments$Response(t,i).pipe((0,c.U)(o=>o.body))}getInstallmentsOverviewDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetInstallmentsOverviewDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getInstallmentsOverviewDataForSearch(t,i){return this.getInstallmentsOverviewDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchInstallmentsOverview$Response(t,i){const o=new d.c(this.rootUrl,n.SearchInstallmentsOverviewPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchInstallmentsOverview(t,i){return this.searchInstallmentsOverview$Response(t,i).pipe((0,c.U)(o=>o.body))}exportInstallmentsOverview$Response(t,i){const o=new d.c(this.rootUrl,n.ExportInstallmentsOverviewPath,"get");return t&&(o.path("format",t.format,{}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportInstallmentsOverview(t,i){return this.exportInstallmentsOverview$Response(t,i).pipe((0,c.U)(o=>o.body))}processInstallment$Response(t,i){const o=new d.c(this.rootUrl,n.ProcessInstallmentPath,"post");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}processInstallment(t,i){return this.processInstallment$Response(t,i).pipe((0,c.U)(o=>o.body))}settleInstallment$Response(t,i){const o=new d.c(this.rootUrl,n.SettleInstallmentPath,"post");return t&&(o.path("key",t.key,{}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}settleInstallment(t,i){return this.settleInstallment$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetInstallmentsDataForSearchPath="/{owner}/installments/data-for-search",n.SearchInstallmentsPath="/{owner}/installments",n.ExportInstallmentsPath="/{owner}/installments/export/{format}",n.GetInstallmentsOverviewDataForSearchPath="/installments/data-for-search",n.SearchInstallmentsOverviewPath="/installments",n.ExportInstallmentsOverviewPath="/installments/export/{format}",n.ProcessInstallmentPath="/installments/{key}/process",n.SettleInstallmentPath="/installments/{key}/settle",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ul(n,a){1&n&&e.GkF(0)}function Nl(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function Il(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function Jl(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",10)(3,"single-selection-field",14),e.YNc(4,Nl,1,4,"field-option",15),e.qZA()(),e.TgZ(5,"div",10)(6,"single-selection-field",16),e.YNc(7,Il,1,4,"field-option",15),e.qZA()(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.transaction.fromAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes),e.xp6(2),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.transaction.toAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes)}}function Ll(n,a){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"input-field",24),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("mask",t.transactionNumberPattern)("label",t.i18n.transaction.number)}}function kl(n,a){if(1&n&&e._UZ(0,"field-option",27),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t)("text",t.name)}}function Fl(n,a){if(1&n&&(e.TgZ(0,"div",10)(1,"single-selection-field",25),e.YNc(2,kl,1,3,"field-option",26),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.general.period),e.xp6(1),e.Q6J("ngForOf",t.data.preselectedPeriods)}}function Ol(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",13),e.TgZ(2,"div",10),e._UZ(3,"date-field",28),e.qZA(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("label",t.i18n.general.beginDate)}}function Dl(n,a){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"date-field",29),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.endDate)}}function Rl(n,a){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"custom-field-filter",30),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(4);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function Vl(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ll,2,2,"div",18),e.TgZ(2,"div",10),e._UZ(3,"user-field",19),e.qZA(),e.ynx(4),e.YNc(5,Fl,3,3,"div",18),e.YNc(6,Ol,4,1,"ng-container",12),e.YNc(7,Dl,2,1,"div",18),e.BQk(),e.YNc(8,Rl,2,2,"div",20),e.TgZ(9,"div",10)(10,"single-selection-field",21),e._UZ(11,"field-option",22)(12,"field-option",23),e.qZA()(),e.BQk()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.hasTransactionNumber),e.xp6(2),e.Q6J("label",i.i18n.general.user),e.xp6(2),e.Q6J("ngIf",(null==i.data.preselectedPeriods?null:i.data.preselectedPeriods.length)>0),e.xp6(1),e.Q6J("ngIf",t.preselectedPeriod&&!(null!=t.preselectedPeriod&&t.preselectedPeriod.begin)),e.xp6(1),e.Q6J("ngIf",t.preselectedPeriod&&!(null!=t.preselectedPeriod&&t.preselectedPeriod.end)),e.xp6(1),e.Q6J("ngForOf",i.fieldsInSearch),e.xp6(2),e.Q6J("label",i.i18n.general.orderBy),e.xp6(1),e.Q6J("text",i.i18n.transaction.orderBy.dueDateDesc),e.xp6(1),e.Q6J("text",i.i18n.transaction.orderBy.dueDateAsc)}}function Yl(n,a){if(1&n&&(e.TgZ(0,"page-content",7),e.ALo(1,"async"),e.TgZ(2,"div",8)(3,"div",9)(4,"div",10),e._UZ(5,"single-selection-field",11),e.qZA(),e.YNc(6,Jl,8,6,"ng-container",12),e.YNc(7,Vl,13,9,"ng-container",12),e.ALo(8,"async"),e.qZA()()()),2&n){const t=e.oxw(2);e.Q6J("heading",t.i18n.transaction.title.scheduled)("mobileHeading",t.i18n.transaction.mobileTitle.scheduled)("headingActions",e.lcZ(1,8,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions),e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,10,t.moreFilters$))}}function El(n,a){if(1&n&&(e.TgZ(0,"mobile-result",31)(1,"div",32),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.date)("amount",t.amount)("avatarImage",i.bankingHelper.avatarImage(t.transaction.related))("avatarIcon",i.bankingHelper.avatarIcon(t.transaction.related))("currency",i.currencies.get(t.currency)),e.xp6(2),e.hij(" ",i.bankingHelper.subjectName(t.transaction.related)," ")}}function $l(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Bl(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",37),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)("customValues",i.transaction.customValues)}}function Hl(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",36),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.bankingHelper.transactionPath(r.transaction))}),e.TgZ(2,"td"),e._uU(3),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.YNc(11,Bl,2,5,"td",34),e.TgZ(12,"td",35),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,6,t.dueDate)),e.xp6(3),e.Oqu(i.bankingHelper.subjectName(t.transaction.from)),e.xp6(2),e.Oqu(i.bankingHelper.subjectName(t.transaction.to)),e.xp6(2),e.Oqu(i.number(t)),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(2),e.hij(" ",e.xi3(14,8,t.amount,i.currencies.get(t.transaction.currency))," ")}}function jl(n,a){if(1&n&&(e.TgZ(0,"table",33)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.YNc(10,$l,2,1,"th",34),e.TgZ(11,"th",35),e._uU(12),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,Hl,15,11,"ng-container",34),e.ALo(15,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.transaction.dueDate),e.xp6(2),e.Oqu(t.i18n.transaction.from),e.xp6(2),e.Oqu(t.i18n.transaction.to),e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(15,7,t.results$))?null:i.results)}}function Ml(n,a){if(1&n){const t=e.EpF();e.YNc(0,Yl,9,12,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"results-layout",4),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(3,"async"),e.YNc(4,El,3,6,"mobile-result",5),e.YNc(5,jl,16,9,"table",6),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngIf",t.form.value||e.lcZ(1,4,t.form.valueChanges)),e.xp6(2),e.Q6J("results",e.lcZ(3,6,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let zl=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.installmentsService=i,this.bankingHelper=o,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.installmentsService.getInstallmentsOverviewDataForSearch({fields:["accountTypes","preselectedPeriods","query","fieldsInBasicSearch","fieldsInList","customFields","archivingDate"]})).subscribe(t=>this.data=t)}prepareForm(t){this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields))}onDataInitialized(t){super.onDataInitialized(t),(t.accountTypes||[]).forEach(o=>{const r=o.currency;this.currencies.set(r.id,r),(0,h.cS)(r.internalName)||this.currencies.set(r.internalName,r)});const i=(t.accountTypes||[]).map(o=>{var r;return null===(r=o.currency)||void 0===r?void 0:r.transactionNumberPattern}).filter(o=>o).reduce((o,r)=>o.includes(r)?o:[...o,r],[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","fromAccountType","toAccountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber","customFields","orderBy"]}getInitialFormValue(t){const i=super.getInitialFormValue(t);return i.status=ut.K.SCHEDULED,i}get statusOptions(){return Object.values(ut.K).map(i=>({value:i,text:this.apiI18n.installmentStatus(i)}))}toSearchParams(t){const i=t;return i.accountTypes=t.accountType?[t.accountType]:null,i.transferFilters=t.transferFilter?[t.transferFilter]:null,i.datePeriod=this.bankingHelper.resolveDatePeriod(t),i.statuses=[t.status],i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return v.v2.SCHEDULED_PAYMENTS_OVERVIEW}doSearch(t){return this.installmentsService.searchInstallmentsOverview$Response(t)}get toLink(){return t=>this.bankingHelper.transactionPath(t.transaction)}number(t){return t.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:t.number,total:t.totalInstallments}):String(t.number)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(At),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-installments"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","status",3,"label","fieldOptions"],[4,"ngIf"],[1,"w-100","d-none","d-sm-block"],["formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["class","col-12 col-md-6",4,"ngIf"],["formControlName","user",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["formControlName","transactionNumber",3,"mask","label"],["formControlName","preselectedPeriod",3,"emptyOption","label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],[3,"field","formControl"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"amount"],[3,"click"],[3,"fields","plainText","fieldName","object","customValues"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ul,1,0,"ng-container",1),e.qZA(),e.YNc(3,Ml,6,8,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,O.f,s.JJ,s.u,u.sg,J.s,F.q,fe.h,te.l,j.Q,Ze.L,s.oH,D.D,R.E,V.t,Y.p,ve.x],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();function Gl(n,a){1&n&&e.GkF(0)}function Wl(n,a){1&n&&e._UZ(0,"div",7)}function Xl(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",7)(2,"label-value",13),e._UZ(3,"user-link",14),e.qZA()(),e.YNc(4,Wl,1,0,"div",9),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function Kl(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function eu(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"single-selection-field",15),e.YNc(2,Kl,1,2,"field-option",16),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.transaction.account)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes)}}function tu(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"input-field",28),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("mask",t.transactionNumberPattern)("label",t.i18n.transaction.number)}}function nu(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"custom-field-filter",29),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function iu(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",7)(2,"single-selection-field",18),e._UZ(3,"field-option",19)(4,"field-option",20),e.qZA()(),e.YNc(5,tu,2,2,"div",9),e.TgZ(6,"div",7),e._UZ(7,"date-field",21),e.qZA(),e.TgZ(8,"div",7),e._UZ(9,"date-field",22),e.qZA(),e.TgZ(10,"div",7),e._UZ(11,"user-field",23),e.qZA(),e.YNc(12,nu,2,2,"div",24),e.TgZ(13,"div",7)(14,"single-selection-field",25),e._UZ(15,"field-option",26)(16,"field-option",27),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.account.direction)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("text",t.i18n.account.incoming),e.xp6(1),e.Q6J("text",t.i18n.account.outgoing),e.xp6(1),e.Q6J("ngIf",t.hasTransactionNumber),e.xp6(2),e.Q6J("label",t.i18n.general.beginDate),e.xp6(2),e.Q6J("label",t.i18n.general.endDate),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch),e.xp6(2),e.Q6J("label",t.i18n.general.orderBy),e.xp6(1),e.Q6J("text",t.i18n.transaction.orderBy.dueDateDesc),e.xp6(1),e.Q6J("text",t.i18n.transaction.orderBy.dueDateAsc)}}function ou(n,a){if(1&n&&(e.TgZ(0,"mobile-result",30)(1,"div",31),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.date)("amount",t.amount)("avatarImage",i.bankingHelper.avatarImage(t.transaction.related))("avatarIcon",i.bankingHelper.avatarIcon(t.transaction.related))("currency",i.currencies.get(t.currency)),e.xp6(2),e.hij(" ",i.bankingHelper.subjectName(t.transaction.related)," ")}}function au(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ru(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",42),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)("customValues",i.transaction.customValues)}}const su=function(n){return{"pb-0":n}},cu=function(n,a){return{positive:n,negative:a}};function lu(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",36),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.bankingHelper.transactionPath(r.transaction))}),e.TgZ(2,"td",37),e.ALo(3,"async"),e._UZ(4,"avatar",38),e.qZA(),e.TgZ(5,"td")(6,"a",39),e._uU(7),e.ALo(8,"date"),e.qZA()(),e.TgZ(9,"td")(10,"a",39),e._uU(11),e.qZA()(),e.TgZ(12,"td")(13,"a",40),e._uU(14),e.qZA()(),e.YNc(15,ru,2,5,"td",34),e.TgZ(16,"td",35)(17,"a",41),e._uU(18),e.ALo(19,"currency"),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("ngClass",e.VKq(21,su,e.lcZ(3,13,i.layout.xxs$))),e.xp6(2),e.Q6J("image",i.bankingHelper.avatarImage(t.transaction.related))("icon",i.bankingHelper.avatarIcon(t.transaction.related)),e.xp6(2),e.Q6J("routerLink",i.bankingHelper.transactionPath(t.transaction)),e.xp6(1),e.hij(" ",e.lcZ(8,15,t.dueDate)," "),e.xp6(3),e.Q6J("routerLink",i.bankingHelper.transactionPath(t.transaction)),e.xp6(1),e.hij(" ",i.bankingHelper.subjectName(t.transaction.related)," "),e.xp6(2),e.Q6J("routerLink",i.bankingHelper.transactionPath(t.transaction)),e.xp6(1),e.hij(" ",i.number(t)," "),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(2),e.Q6J("routerLink",i.bankingHelper.transactionPath(t.transaction))("ngClass",e.WLB(23,cu,i.format.isPositive(t.amount),i.format.isNegative(t.amount))),e.xp6(1),e.hij(" ",e.Dn7(19,17,t.amount,i.currencies.get(t.transaction.currency),!0)," ")}}function uu(n,a){if(1&n&&(e.TgZ(0,"table",32)(1,"thead"),e._UZ(2,"th",33),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.YNc(9,au,2,1,"th",34),e.TgZ(10,"th",35),e._uU(11),e.qZA()(),e.TgZ(12,"tbody"),e.YNc(13,lu,20,26,"ng-container",34),e.ALo(14,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.transaction.dueDate),e.xp6(2),e.Oqu(t.i18n.transaction.fromTo),e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(14,6,t.results$))?null:i.results)}}function pu(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,Xl,5,3,"ng-container",6),e.TgZ(5,"div",7),e._UZ(6,"single-selection-field",8),e.qZA(),e.YNc(7,eu,3,3,"div",9),e.YNc(8,iu,17,12,"ng-container",6),e.ALo(9,"async"),e.qZA()()(),e.TgZ(10,"results-layout",10),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(11,"async"),e.YNc(12,ou,3,6,"mobile-result",11),e.YNc(13,uu,15,8,"table",12),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.transaction.title.scheduled)("mobileHeading",t.i18n.transaction.mobileTitle.scheduled)("headingActions",e.lcZ(1,12,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(2),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions),e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,14,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(11,16,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let mu=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.installmentsService=i,this.bankingHelper=o,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.self=this.authHelper.isSelf(this.param),this.stateManager.cache("data",this.installmentsService.getInstallmentsDataForSearch({owner:this.param,fields:["user","accountTypes","query","fieldsInBasicSearch","fieldsInList","customFields","archivingDate"]})).subscribe(i=>this.data=i)}prepareForm(t){this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields))}onDataInitialized(t){super.onDataInitialized(t),(t.accountTypes||[]).forEach(o=>{const r=o.currency;this.currencies.set(r.id,r),(0,h.cS)(r.internalName)||this.currencies.set(r.internalName,r)});const i=(t.accountTypes||[]).map(o=>{var r;return null===(r=o.currency)||void 0===r?void 0:r.transactionNumberPattern}).filter(o=>o).reduce((o,r)=>o.includes(r)?o:[...o,r],[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","accountType","transferFilter","user","periodBegin","periodEnd","direction","transactionNumber","customFields","orderBy"]}getInitialFormValue(t){const i=super.getInitialFormValue(t);return i.status=ut.K.SCHEDULED,i}get statusOptions(){return Object.values(ut.K).map(i=>({value:i,text:this.apiI18n.installmentStatus(i)}))}toSearchParams(t){const i=t;return i.owner=this.param,i.accountTypes=t.accountType?[t.accountType]:null,i.transferFilters=t.transferFilter?[t.transferFilter]:null,i.datePeriod=this.bankingHelper.resolveDatePeriod(t),i.statuses=[t.status],i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.SCHEDULED_PAYMENTS)}doSearch(t){return this.installmentsService.searchInstallments$Response(t)}get toLink(){return t=>this.bankingHelper.transactionPath(t.transaction)}number(t){return t.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:t.number,total:t.totalInstallments}):String(t.number)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(At),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-owner-installments"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["formControlName","periodBegin","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["formControlName","periodEnd","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["formControlName","user",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["formControlName","transactionNumber",3,"mask","label"],["labelPosition","side",3,"field","formControl"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"amount"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[3,"routerLink","ngClass"],[3,"fields","plainText","fieldName","object","customValues"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Gl,1,0,"ng-container",1),e.qZA(),e.YNc(3,pu,14,18,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,C.t,Q.F,O.f,s.JJ,s.u,u.sg,J.s,F.q,fe.h,j.Q,te.l,Ze.L,s.oH,D.D,R.E,V.t,Y.p,u.mk,Pe.A,ce.yS,ve.x],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();var Ne=m(8402),Fe=m(9338),et=m(4565),$t=m(2356),G=m(4266);let pt=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getTransactionsDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetTransactionsDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("owner",t.owner,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getTransactionsDataForSearch(t,i){return this.getTransactionsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchTransactions$Response(t,i){const o=new d.c(this.rootUrl,n.SearchTransactionsPath,"get");return t&&(o.path("owner",t.owner,{}),o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("accountTypes",t.accountTypes,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationRoles",t.authorizationRoles,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("direction",t.direction,{}),o.query("excludedIds",t.excludedIds,{}),o.query("externalPaymentExpiration",t.externalPaymentExpiration,{}),o.query("externalPaymentStatuses",t.externalPaymentStatuses,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("paymentRequestExpiration",t.paymentRequestExpiration,{}),o.query("paymentRequestStatuses",t.paymentRequestStatuses,{}),o.query("recurringPaymentStatuses",t.recurringPaymentStatuses,{}),o.query("scheduledPaymentStatuses",t.scheduledPaymentStatuses,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("ticketExpiration",t.ticketExpiration,{}),o.query("ticketStatuses",t.ticketStatuses,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchTransactions(t,i){return this.searchTransactions$Response(t,i).pipe((0,c.U)(o=>o.body))}exportTransactions$Response(t,i){const o=new d.c(this.rootUrl,n.ExportTransactionsPath,"get");return t&&(o.path("owner",t.owner,{}),o.path("format",t.format,{}),o.query("accessClients",t.accessClients,{}),o.query("accountTypes",t.accountTypes,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationRoles",t.authorizationRoles,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("direction",t.direction,{}),o.query("excludedIds",t.excludedIds,{}),o.query("externalPaymentExpiration",t.externalPaymentExpiration,{}),o.query("externalPaymentStatuses",t.externalPaymentStatuses,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("paymentRequestExpiration",t.paymentRequestExpiration,{}),o.query("paymentRequestStatuses",t.paymentRequestStatuses,{}),o.query("recurringPaymentStatuses",t.recurringPaymentStatuses,{}),o.query("scheduledPaymentStatuses",t.scheduledPaymentStatuses,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("ticketExpiration",t.ticketExpiration,{}),o.query("ticketStatuses",t.ticketStatuses,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportTransactions(t,i){return this.exportTransactions$Response(t,i).pipe((0,c.U)(o=>o.body))}getTransactionsOverviewDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetTransactionsOverviewDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("pendingMyAuthorization",t.pendingMyAuthorization,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getTransactionsOverviewDataForSearch(t,i){return this.getTransactionsOverviewDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchTransactionsOverview$Response(t,i){const o=new d.c(this.rootUrl,n.SearchTransactionsOverviewPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationRoles",t.authorizationRoles,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("externalPaymentExpiration",t.externalPaymentExpiration,{}),o.query("externalPaymentStatuses",t.externalPaymentStatuses,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("paymentRequestExpiration",t.paymentRequestExpiration,{}),o.query("paymentRequestStatuses",t.paymentRequestStatuses,{}),o.query("pendingMyAuthorization",t.pendingMyAuthorization,{}),o.query("recurringPaymentStatuses",t.recurringPaymentStatuses,{}),o.query("scheduledPaymentStatuses",t.scheduledPaymentStatuses,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("ticketExpiration",t.ticketExpiration,{}),o.query("ticketStatuses",t.ticketStatuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchTransactionsOverview(t,i){return this.searchTransactionsOverview$Response(t,i).pipe((0,c.U)(o=>o.body))}exportTransactionsOverview$Response(t,i){const o=new d.c(this.rootUrl,n.ExportTransactionsOverviewPath,"get");return t&&(o.path("format",t.format,{}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("authorizationPerformedBy",t.authorizationPerformedBy,{}),o.query("authorizationRoles",t.authorizationRoles,{}),o.query("authorizationStatuses",t.authorizationStatuses,{}),o.query("authorized",t.authorized,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("creationTypes",t.creationTypes,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("externalPaymentExpiration",t.externalPaymentExpiration,{}),o.query("externalPaymentStatuses",t.externalPaymentStatuses,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("paymentRequestExpiration",t.paymentRequestExpiration,{}),o.query("paymentRequestStatuses",t.paymentRequestStatuses,{}),o.query("pendingMyAuthorization",t.pendingMyAuthorization,{}),o.query("recurringPaymentStatuses",t.recurringPaymentStatuses,{}),o.query("scheduledPaymentStatuses",t.scheduledPaymentStatuses,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("ticketExpiration",t.ticketExpiration,{}),o.query("ticketStatuses",t.ticketStatuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportTransactionsOverview(t,i){return this.exportTransactionsOverview$Response(t,i).pipe((0,c.U)(o=>o.body))}viewTransaction$Response(t,i){const o=new d.c(this.rootUrl,n.ViewTransactionPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}viewTransaction(t,i){return this.viewTransaction$Response(t,i).pipe((0,c.U)(o=>o.body))}exportTransaction$Response(t,i){const o=new d.c(this.rootUrl,n.ExportTransactionPath,"get");return t&&(o.path("key",t.key,{}),o.path("format",t.format,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportTransaction(t,i){return this.exportTransaction$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetTransactionsDataForSearchPath="/{owner}/transactions/data-for-search",n.SearchTransactionsPath="/{owner}/transactions",n.ExportTransactionsPath="/{owner}/transactions/export/{format}",n.GetTransactionsOverviewDataForSearchPath="/transactions/data-for-search",n.SearchTransactionsOverviewPath="/transactions",n.ExportTransactionsOverviewPath="/transactions/export/{format}",n.ViewTransactionPath="/transactions/{key}",n.ExportTransactionPath="/transactions/{key}/export/{format}",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function du(n,a){1&n&&e.GkF(0)}function fu(n,a){1&n&&e._UZ(0,"div",7)}function _u(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",7)(2,"label-value",13),e._UZ(3,"user-link",14),e.qZA()(),e.YNc(4,fu,1,0,"div",9),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function hu(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"single-selection-field",15),e._UZ(2,"field-option",16)(3,"field-option",17),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.transaction.direction)("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("text",t.i18n.transaction.sent),e.xp6(1),e.Q6J("text",t.i18n.transaction.received)}}function gu(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"input-field",20),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("mask",t.transactionNumberPattern)("label",t.i18n.transaction.number)}}function yu(n,a){if(1&n&&e._UZ(0,"field-option",23),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function xu(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"single-selection-field",21),e.YNc(2,yu,1,2,"field-option",22),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.transaction.account)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes)}}function bu(n,a){if(1&n&&e._UZ(0,"field-option",26),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t)("text",t.name)}}function vu(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"single-selection-field",24),e.YNc(2,bu,1,3,"field-option",25),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.general.period),e.xp6(1),e.Q6J("ngForOf",t.data.preselectedPeriods)}}function Tu(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",27),e.TgZ(2,"div",7),e._UZ(3,"date-field",28),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("label",t.i18n.general.beginDate)}}function wu(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"date-field",29),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.general.endDate)}}function Cu(n,a){if(1&n&&e._UZ(0,"field-option",32),2&n){const t=a.$implicit;e.Q6J("value",t)("id",t.id)("text",t.name)}}function Au(n,a){if(1&n&&(e.TgZ(0,"div",7)(1,"single-selection-field",30),e.YNc(2,Cu,1,3,"field-option",31),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.account.transferFilter)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.transferFilters$.value)}}function Zu(n,a){if(1&n&&(e.TgZ(0,"div",7),e._UZ(1,"custom-field-filter",33),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function Pu(n,a){if(1&n&&(e.ynx(0),e.YNc(1,gu,2,2,"div",9),e.YNc(2,xu,3,3,"div",9),e.YNc(3,vu,3,2,"div",9),e.YNc(4,Tu,4,1,"ng-container",6),e.ALo(5,"async"),e.YNc(6,wu,2,1,"div",9),e.ALo(7,"async"),e.YNc(8,Au,3,3,"div",9),e.ALo(9,"async"),e.TgZ(10,"div",7),e._UZ(11,"user-field",18),e.qZA(),e.YNc(12,Zu,2,2,"div",19),e.BQk()),2&n){const t=e.oxw(2);let i,o;e.xp6(1),e.Q6J("ngIf",t.hasTransactionNumber),e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(1),e.Q6J("ngIf",t.usePreselectedPeriods&&(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>0),e.xp6(1),e.Q6J("ngIf",!t.usePreselectedPeriods||null==(null==(i=t.form.value||e.lcZ(5,8,t.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.begin)),e.xp6(2),e.Q6J("ngIf",!t.usePreselectedPeriods||null==(null==(o=t.form.value||e.lcZ(7,10,t.form.valueChanges))||null==o.preselectedPeriod?null:o.preselectedPeriod.end)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,12,t.transferFilters$).length>0),e.xp6(3),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch)}}function qu(n,a){if(1&n&&(e.TgZ(0,"mobile-result",34)(1,"div",35),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",i.bankingHelper.avatarImage(t.related))("avatarIcon",i.bankingHelper.avatarIcon(t.related))("date",t.date)("amount",t.amount)("currency",i.currencies.get(t.currency)),e.xp6(2),e.hij(" ",i.isTicket()&&i.hasTransactionNumber?t.transactionNumber:i.bankingHelper.subjectName(t.related)," ")}}function Su(n,a){1&n&&e._UZ(0,"th",40)}function Qu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.transaction.number)}}function Uu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.isExternalPayment()?t.i18n.transaction.to:t.i18n.transaction.fromTo)}}function Nu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij("",t.i18n.transaction.senderOrReceiver," ")}}function Iu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.status)}}function Ju(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij("",t.i18n.transaction.scheduling," ")}}function Lu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ku(n,a){if(1&n&&(e.TgZ(0,"td",40),e._UZ(1,"avatar",43),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("image",i.bankingHelper.avatarImage(t.related))("icon",i.bankingHelper.avatarIcon(t.related))}}function Fu(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.transactionNumber)}}function Ou(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.isExternalPayment()?t.toPrincipalValue:i.bankingHelper.subjectName(t.related)," ")}}function Du(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.apiI18n.transactionStatus(t)," ")}}function Ru(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.bankingHelper.scheduling(t)," ")}}function Vu(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",44),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)}}const Yu=function(n,a,t){return{"pb-0":n,positive:a,negative:t}};function Eu(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",41),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.bankingHelper.transactionPath(r))}),e.YNc(2,ku,2,2,"td",37),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.YNc(6,Fu,2,1,"td",6),e.YNc(7,Ou,2,1,"td",6),e.YNc(8,Du,2,1,"td",6),e.YNc(9,Ru,2,1,"td",6),e.YNc(10,Vu,2,4,"td",38),e.TgZ(11,"td",42),e.ALo(12,"async"),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!i.isExternalPayment()&&!i.isTicket()),e.xp6(2),e.hij(" ",e.lcZ(5,9,t.date)," "),e.xp6(2),e.Q6J("ngIf",i.isTicket()&&i.hasTransactionNumber),e.xp6(1),e.Q6J("ngIf",!i.isPaymentRequest()&&!i.isTicket()),e.xp6(1),e.Q6J("ngIf",i.isPaymentRequest()||i.isExternalPayment()||i.isTicket()),e.xp6(1),e.Q6J("ngIf",!i.isExternalPayment()&&!i.isTicket()),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(1),e.Q6J("ngClass",e.kEZ(17,Yu,e.lcZ(12,11,i.layout.xxs$),i.format.isPositive(t.amount),i.format.isNegative(t.amount))),e.xp6(2),e.hij(" ",e.Dn7(14,13,t.amount,i.currencies.get(t.currency),!0)," ")}}function $u(n,a){if(1&n&&(e.TgZ(0,"table",36)(1,"thead"),e.YNc(2,Su,1,0,"th",37),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.YNc(5,Qu,2,1,"th",6),e.YNc(6,Uu,2,1,"th",6),e.YNc(7,Nu,2,1,"th",6),e.YNc(8,Iu,2,1,"th",6),e.YNc(9,Ju,2,1,"th",6),e.YNc(10,Lu,2,1,"th",38),e.TgZ(11,"th",39),e._uU(12),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,Eu,15,21,"ng-container",38),e.ALo(15,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(2),e.Q6J("ngIf",!t.isExternalPayment()&&!t.isTicket()),e.xp6(2),e.Oqu(t.i18n.general.date),e.xp6(1),e.Q6J("ngIf",t.isTicket()&&t.hasTransactionNumber),e.xp6(1),e.Q6J("ngIf",!t.isPaymentRequest()&&!t.isTicket()),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()||t.isExternalPayment()||t.isTicket()),e.xp6(1),e.Q6J("ngIf",!t.isExternalPayment()&&!t.isTicket()),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(15,10,t.results$))?null:i.results)}}function Bu(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,_u,5,3,"ng-container",6),e.TgZ(5,"div",7),e._UZ(6,"single-selection-field",8),e.qZA(),e.YNc(7,hu,4,4,"div",9),e.YNc(8,Pu,13,14,"ng-container",6),e.ALo(9,"async"),e.qZA()()(),e.TgZ(10,"results-layout",10),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(11,"async"),e.YNc(12,qu,3,6,"mobile-result",11),e.YNc(13,$u,16,12,"table",12),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",e.lcZ(1,13,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(2),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,15,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(11,17,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let mt=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.transactionsService=i,this.bankingHelper=o,this.transferFilters$=new y.X([]),this.currencies=new Map,this.usePreselectedPeriods=!1}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;switch(this.kind=t.data.kind,this.param=t.params.owner,this.self=this.authHelper.isSelf(this.param),this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations,this.usePreselectedPeriods=!0;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequests,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequests;break;case"external-payment":this.heading=this.i18n.transaction.title.externalPayments,this.mobileHeading=this.i18n.transaction.mobileTitle.externalPayments;break;case"ticket":this.heading=this.i18n.transaction.title.tickets,this.mobileHeading=this.i18n.transaction.mobileTitle.tickets}this.stateManager.cache("data",this.transactionsService.getTransactionsDataForSearch({owner:this.param,fields:["user","userPermissions","accountTypes","visibleKinds","transferFilters","fieldsInBasicSearch","fieldsInList","customFields","archivingDate",...this.usePreselectedPeriods?["preselectedPeriods"]:[],"query"]})).subscribe(i=>this.data=i),this.addSub(this.form.get("accountType").valueChanges.subscribe(i=>{this.form.patchValue({transferFilter:null},{emitEvent:!1});const o=this.data.transferFilters.filter(r=>r.accountType.id===i);this.transferFilters$.next(o)}))}prepareForm(t){this.bankingHelper.preProcessPreselectedPeriods(t,this.form),this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields))}onDataInitialized(t){var i,o,r,l,_,g,P,S,I;super.onDataInitialized(t),(t.accountTypes||[]).forEach(de=>{const Je=de.currency;this.currencies.set(Je.id,Je),(0,h.cS)(Je.internalName)||this.currencies.set(Je.internalName,Je)});const Ae=Array.from(this.currencies.values()).map(de=>de.transactionNumberPattern).filter(de=>de).reduce((de,Je)=>de.includes(Je)?de:[...de,Je],[]);this.hasTransactionNumber=Ae.length>0,this.transactionNumberPattern=1===Ae.length?Ae[0]:null;const X=[this.moreFiltersAction],ie=(null===(o=null===(i=this.dataForFrontendHolder.auth)||void 0===i?void 0:i.permissions)||void 0===o?void 0:o.banking)||{},se=t.userPermissions||{};this.isPaymentRequest()?this.param===b.S.SYSTEM?(null===(r=null==ie?void 0:ie.paymentRequests)||void 0===r?void 0:r.sendToUser)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestAsSelfToUser,()=>this.sendPaymentRequest(b.S.SYSTEM),!0)):this.self?((null===(l=null==ie?void 0:ie.paymentRequests)||void 0===l?void 0:l.sendToUser)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestAsSelfToUser,()=>this.sendPaymentRequest(b.S.SELF),!0)),(null===(_=null==ie?void 0:ie.paymentRequests)||void 0===_?void 0:_.sendToSystem)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestAsSelfToSystem,()=>this.sendPaymentRequest(b.S.SELF,b.S.SYSTEM),!0))):((null===(g=null==se?void 0:se.paymentRequests)||void 0===g?void 0:g.sendFromSystem)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestFromSystemToUser,()=>this.sendPaymentRequest(b.S.SYSTEM,this.param),!0)),(null===(P=null==se?void 0:se.paymentRequests)||void 0===P?void 0:P.sendAsUserToUser)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestAsUserToUser,()=>this.sendPaymentRequest(this.param),!0)),(null===(S=null==se?void 0:se.paymentRequests)||void 0===S?void 0:S.sendAsUserToSystem)&&X.push(new T.Yu(x.l.Wallet2ArrowLeft,this.i18n.transaction.sendPaymentRequestAsUserToSystem,()=>this.sendPaymentRequest(this.param,b.S.SYSTEM),!0))):this.isExternalPayment()&&((null===(I=null==ie?void 0:ie.externalPayments)||void 0===I?void 0:I.perform)||(null==se?void 0:se.externalPayments.performAsSelf))&&X.push(new T.Yu(x.l.Wallet2ArrowUpRight,this.i18n.transaction.payExternalUser,()=>this.payExternalUser(),!0)),X.push(...this.exportHelper.headingActions(t.exportFormats,de=>this.transactionsService.exportTransactions$Response(Object.assign({format:de.internalName},this.toSearchParams(this.form.value))))),this.headingActions=X}isPaymentRequest(){return"payment-request"===this.kind}isExternalPayment(){return"external-payment"===this.kind}isTicket(){return"ticket"===this.kind}doSearch(t){return this.transactionsService.searchTransactions$Response(t)}sendPaymentRequest(t,i){const o=["/banking",t,"payment-request"];i&&o.push(i),this.router.navigate(o)}payExternalUser(){this.router.navigate(["/banking",this.param,"external-payment"])}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber","customFields"]}getInitialFormValue(t){const i=super.getInitialFormValue(t);switch(this.kind){case"authorized":i.status=Ne.s.PENDING;break;case"payment-request":i.status=Fe.W.OPEN;break;case"external-payment":i.status=et.f.PENDING;break;case"ticket":i.status=$t.j.OPEN}return i}get statusOptions(){switch(this.kind){case"authorized":return Object.values(Ne.s).map(t=>({value:t,text:this.apiI18n.authorizationStatus(t)}));case"payment-request":return Object.values(Fe.W).map(t=>({value:t,text:this.apiI18n.paymentRequestStatus(t)}));case"external-payment":return Object.values(et.f).map(t=>({value:t,text:this.apiI18n.externalPaymentStatus(t)}));case"ticket":return Object.values($t.j).map(t=>({value:t,text:this.apiI18n.ticketStatus(t)}))}}toSearchParams(t){const i=t;switch(i.owner=this.param,i.accountTypes=t.accountType?[t.accountType]:null,i.transferFilters=t.transferFilter?[t.transferFilter]:null,i.datePeriod=this.bankingHelper.resolveDatePeriod(t),i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),this.kind){case"authorized":i.authorizationStatuses=[t.status],i.authorized=!0;break;case"payment-request":i.paymentRequestStatuses=[t.status],i.kinds=[G.w.PAYMENT_REQUEST];break;case"external-payment":i.externalPaymentStatuses=[t.status],i.kinds=[G.w.EXTERNAL_PAYMENT];break;case"ticket":i.ticketStatuses=[t.status],i.kinds=[G.w.TICKET]}return i}resolveMenu(t){let i;switch(this.kind){case"authorized":i=v.v2.AUTHORIZED_PAYMENTS;break;case"payment-request":i=v.v2.PAYMENT_REQUESTS;break;case"external-payment":i=v.v2.EXTERNAL_PAYMENTS;break;case"ticket":i=v.v2.TICKETS}return this.menu.userMenu(t.user,i)}get toLink(){return t=>this.bankingHelper.transactionPath(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(pt),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-owner-transactions"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","status",3,"label","fieldOptions","emptyOption"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["formControlName","user",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["formControlName","transactionNumber",3,"mask","label"],["formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[1,"w-100","d-none","d-sm-block"],["formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","transferFilter",3,"label","emptyOption"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],[3,"field","formControl"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],["class","avatar",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"amount"],[1,"avatar"],[3,"click"],[1,"amount",3,"ngClass"],[3,"image","icon"],[3,"fields","plainText","fieldName","object"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,du,1,0,"ng-container",1),e.qZA(),e.YNc(3,Bu,14,19,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,C.t,Q.F,O.f,s.JJ,s.u,J.s,F.q,fe.h,u.sg,j.Q,te.l,Ze.L,s.oH,D.D,R.E,V.t,Y.p,Pe.A,ve.x,u.mk],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();function Hu(n,a){1&n&&e.GkF(0)}function ju(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"single-selection-field",12),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyOption",t.i18n.general.notApplied)}}function Mu(n,a){if(1&n&&e._UZ(0,"field-option",15),2&n){const t=a.$implicit;e.Q6J("value",t.id)("id",t.id)("internalName",t.internalName)("text",t.name)}}function zu(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",13),e.YNc(2,Mu,1,4,"field-option",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.transaction.authorizationRoles),e.xp6(1),e.Q6J("ngForOf",t.data.authorizationRoles)}}function Gu(n,a){if(1&n&&e._UZ(0,"field-option",18),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function Wu(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",16),e.YNc(2,Gu,1,2,"field-option",17),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.currency)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.currencies)}}function Xu(n,a){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t)("text",t.name)}}function Ku(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",19),e.YNc(2,Xu,1,3,"field-option",20),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.period),e.xp6(1),e.Q6J("ngForOf",t.data.preselectedPeriods)}}function ep(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",22),e.TgZ(2,"div",11),e._UZ(3,"date-field",23),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("label",t.i18n.general.beginDate)}}function tp(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"date-field",24),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.endDate)}}function np(n,a){if(1&n&&e._UZ(0,"field-option",28),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function ip(n,a){if(1&n&&e._UZ(0,"field-option",28),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function op(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"single-selection-field",29),e.YNc(2,ip,1,4,"field-option",27),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.transaction.toAccount),e.xp6(1),e.Q6J("ngForOf",t.accountTypes())}}function ap(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",22),e.TgZ(2,"div",11)(3,"single-selection-field",26),e.YNc(4,np,1,4,"field-option",27),e.qZA()(),e.YNc(5,op,3,3,"div",6),e.BQk()),2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.isExternalPayment()?t.i18n.transaction.account:t.i18n.transaction.fromAccount),e.xp6(1),e.Q6J("ngForOf",t.accountTypes()),e.xp6(1),e.Q6J("ngIf",!t.isExternalPayment())}}function rp(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"input-field",30),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("mask",t.transactionNumberPattern)("label",t.i18n.transaction.number)}}function sp(n,a){if(1&n&&e._UZ(0,"field-option",33),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)("category",t.from.name)}}function cp(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",31),e.YNc(2,sp,1,5,"field-option",32),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.account.transferFilter),e.xp6(1),e.Q6J("ngForOf",t.data.authorizablePaymentTypes)}}function lp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",11),e._UZ(2,"date-field",34),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"date-field",35),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("label",t.i18n.general.expirationBeginDate),e.xp6(2),e.Q6J("label",t.i18n.general.expirationEndDate)}}function up(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"user-field",36),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.transaction.actionPerformedBy)}}function pp(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"custom-field-filter",38),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(4);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function mp(n,a){if(1&n&&(e.ynx(0),e.YNc(1,pp,2,2,"div",37),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch)}}function dp(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ap,6,4,"ng-container",7),e.YNc(2,rp,2,2,"div",6),e.YNc(3,cp,3,3,"div",6),e.YNc(4,lp,5,2,"ng-container",7),e.TgZ(5,"div",11),e._UZ(6,"user-field",25),e.qZA(),e.YNc(7,up,2,1,"div",6),e.YNc(8,mp,2,1,"ng-container",7),e.ALo(9,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(t.isAuthorized()||t.isPaymentRequest()||t.isExternalPayment())&&(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(1),e.Q6J("ngIf",!t.isMyAuth()&&t.hasTransactionNumber),e.xp6(1),e.Q6J("ngIf",t.isMyAuth()&&(null==t.data.authorizablePaymentTypes?null:t.data.authorizablePaymentTypes.length)>0),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()||t.isExternalPayment()),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("ngIf",t.isAuthorized()),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,7,t.moreFilters$))}}const fp=function(n,a){return{from:n,to:a}};function _p(n,a){if(1&n&&(e.TgZ(0,"mobile-result",39)(1,"div",40),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.date)("amount",t.amount)("currency",i.currenciesByKey.get(t.currency)),e.xp6(2),e.hij(" ",i.i18n.transaction.fromToText(e.WLB(4,fp,i.bankingHelper.subjectName(i.isPaymentRequest()?t.to:t.from),i.bankingHelper.subjectName(i.isPaymentRequest()?t.from:t.to)))," ")}}function hp(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij("",t.i18n.transaction.scheduling," ")}}function gp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.YNc(5,hp,2,1,"th",7),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.i18n.transaction.from),e.xp6(2),e.Oqu(t.i18n.transaction.to),e.xp6(1),e.Q6J("ngIf",!t.isExternalPayment())}}function yp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.i18n.transaction.number),e.xp6(2),e.Oqu(t.i18n.transaction.sender),e.xp6(2),e.Oqu(t.i18n.transaction.receiver)}}function xp(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.status)}}function bp(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.expirationDate)}}function vp(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Tp(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",45),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",t.transactionNumber," ")}}function wp(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.toPrincipalValue," ")}}function Cp(n,a){if(1&n&&(e.TgZ(0,"a",45),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",i.bankingHelper.subjectName(i.isPaymentRequest()?t.from:t.to)," ")}}function Ap(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",48),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",i.apiI18n.transactionStatus(t)," ")}}function Zp(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",45),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",e.lcZ(3,2,t.expirationDate)," ")}}function Pp(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",48),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",i.bankingHelper.scheduling(t)," ")}}function qp(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",49),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)}}const Sp=function(n){return{"pb-0":n}};function Qp(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",44),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.bankingHelper.transactionPath(r))}),e.TgZ(2,"td")(3,"a",45),e._uU(4),e.ALo(5,"date"),e.qZA()(),e.YNc(6,Tp,3,2,"td",7),e.TgZ(7,"td")(8,"a",45),e._uU(9),e.qZA()(),e.TgZ(10,"td"),e.YNc(11,wp,2,1,"div",7),e.YNc(12,Cp,2,2,"a",46),e.qZA(),e.YNc(13,Ap,3,2,"td",7),e.YNc(14,Zp,4,4,"td",7),e.YNc(15,Pp,3,2,"td",7),e.YNc(16,qp,2,4,"td",42),e.TgZ(17,"td",47),e.ALo(18,"async"),e.TgZ(19,"a",45),e._uU(20),e.ALo(21,"currency"),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",e.lcZ(5,14,t.date)," "),e.xp6(2),e.Q6J("ngIf",i.isPaymentRequest()),e.xp6(2),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",i.bankingHelper.subjectName(i.isPaymentRequest()?t.to:t.from)," "),e.xp6(2),e.Q6J("ngIf",i.isExternalPayment()),e.xp6(1),e.Q6J("ngIf",!i.isExternalPayment()),e.xp6(1),e.Q6J("ngIf",i.isPaymentRequest()||i.isExternalPayment()),e.xp6(1),e.Q6J("ngIf",i.isPaymentRequest()),e.xp6(1),e.Q6J("ngIf",!i.isPaymentRequest()&&!i.isExternalPayment()),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(1),e.Q6J("ngClass",e.VKq(21,Sp,e.lcZ(18,16,i.layout.xxs$))),e.xp6(2),e.Q6J("routerLink",i.bankingHelper.transactionPath(t)),e.xp6(1),e.hij(" ",e.xi3(21,18,t.amount,i.currenciesByKey.get(t.currency))," ")}}function Up(n,a){if(1&n&&(e.TgZ(0,"table",41)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.YNc(4,gp,6,3,"ng-container",7),e.YNc(5,yp,7,3,"ng-container",7),e.YNc(6,xp,2,1,"th",7),e.YNc(7,bp,2,1,"th",7),e.YNc(8,vp,2,1,"th",42),e.TgZ(9,"th",43),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,Qp,22,23,"ng-container",42),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(1),e.Q6J("ngIf",!t.isPaymentRequest()),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()||t.isExternalPayment()),e.xp6(1),e.Q6J("ngIf",t.isPaymentRequest()),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(13,8,t.results$))?null:i.results)}}function Np(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,ju,2,3,"div",6),e.YNc(5,zu,3,2,"div",6),e.YNc(6,Wu,3,3,"div",6),e.YNc(7,Ku,3,2,"div",6),e.YNc(8,ep,4,1,"ng-container",7),e.ALo(9,"async"),e.YNc(10,tp,2,1,"div",6),e.ALo(11,"async"),e.YNc(12,dp,10,9,"ng-container",7),e.ALo(13,"async"),e.qZA()()(),e.TgZ(14,"results-layout",8),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(15,"async"),e.YNc(16,_p,3,7,"mobile-result",9),e.YNc(17,Up,14,10,"table",10),e.qZA()}if(2&n){const t=e.oxw();let i,o;e.Q6J("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",e.lcZ(1,14,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",(null==t.statusOptions?null:t.statusOptions.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.authorizationRoles?null:t.data.authorizationRoles.length)>0),e.xp6(1),e.Q6J("ngIf",!t.isMyAuth()&&(null==t.currencies?null:t.currencies.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>0),e.xp6(1),e.Q6J("ngIf",null==(null==(i=t.form.value||e.lcZ(9,16,t.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.begin)),e.xp6(2),e.Q6J("ngIf",null==(null==(o=t.form.value||e.lcZ(11,18,t.form.valueChanges))||null==o.preselectedPeriod?null:o.preselectedPeriod.end)),e.xp6(2),e.Q6J("ngIf",e.lcZ(13,20,t.moreFilters$)||t.isMyAuth()),e.xp6(2),e.Q6J("results",e.lcZ(15,22,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let tt=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.transactionsService=i,this.bankingHelper=o,this.currenciesByKey=new Map}ngOnInit(){switch(super.ngOnInit(),this.kind=this.route.snapshot.data.kind,this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations;break;case"myAuth":this.heading=this.i18n.transaction.title.pendingMyAuthorization,this.mobileHeading=this.i18n.transaction.mobileTitle.pendingMyAuthorization;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequestsOverview,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequestsOverview;break;case"external-payment":this.heading=this.i18n.transaction.title.externalPaymentsOverview,this.mobileHeading=this.i18n.transaction.mobileTitle.externalPaymentsOverview}this.stateManager.cache("data",this.transactionsService.getTransactionsOverviewDataForSearch({fields:["user","accountTypes","preselectedPeriods","query","fieldsInBasicSearch","fieldsInList","customFields","archivingDate",..."authorized"===this.kind?["authorizationRoles"]:[]],pendingMyAuthorization:"myAuth"===this.kind})).subscribe(i=>this.data=i)}prepareForm(t){this.bankingHelper.preProcessPreselectedPeriods(t,this.form),this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields))}onDataInitialized(t){var i;super.onDataInitialized(t),this.currencies=[...new Set(t.accountTypes.map(r=>r.currency))],this.currencies.sort((r,l)=>r.name.localeCompare(l.name)),this.currenciesByKey=new Map,this.currencies.forEach(r=>this.currenciesByKey.set(b.S.internalNameOrId(r),r));const o=this.currencies.map(r=>r.transactionNumberPattern).filter(r=>r).reduce((r,l)=>r.includes(l)?r:[...r,l],[]);this.hasTransactionNumber=o.length>0,this.transactionNumberPattern=1===o.length?o[0]:null,this.addSub(this.form.controls.currency.valueChanges.subscribe(r=>this.updateAccountTypes(r))),this.headingActions=[...!this.isMyAuth()||(null===(i=this.fieldsInSearch)||void 0===i?void 0:i.length)>0?[this.moreFiltersAction]:[],...this.exportHelper.headingActions(t.exportFormats,r=>this.transactionsService.exportTransactionsOverview$Response(Object.assign({format:r.internalName},this.toSearchParams(this.form.value))))]}updateAccountTypes(t){var i,o;const r=this.form.controls.fromAccountTypes.value,l=this.form.controls.toAccountTypes.value;t&&r&&this.form.controls.fromAccountTypes.setValue((null===(i=this.data.accountTypes.find(_=>_.id===r).currency)||void 0===i?void 0:i.id)===t?r:null),t&&l&&this.form.controls.toAccountTypes.setValue((null===(o=this.data.accountTypes.find(_=>_.id===l).currency)||void 0===o?void 0:o.id)===t?l:null)}doSearch(t){return this.transactionsService.searchTransactionsOverview$Response(t)}getFormControlNames(){return["status","currency","user","preselectedPeriod","periodBegin","periodEnd","transactionNumber","expirationBegin","expirationEnd","transferTypes","authorizationPerformedBy","fromAccountTypes","toAccountTypes","customFields","authorizationRoles"]}getInitialFormValue(t){const i=super.getInitialFormValue(t);switch(this.kind){case"authorized":i.status=Ne.s.PENDING;break;case"payment-request":i.status=Fe.W.OPEN;break;case"external-payment":i.status=et.f.PENDING}return i}get statusOptions(){switch(this.kind){case"authorized":return Object.values(Ne.s).map(i=>({value:i,text:this.apiI18n.authorizationStatus(i)}));case"payment-request":return Object.values(Fe.W).map(i=>({value:i,text:this.apiI18n.paymentRequestStatus(i)}));case"external-payment":return Object.values(et.f).map(i=>({value:i,text:this.apiI18n.externalPaymentStatus(i)}));case"myAuth":return null}}toSearchParams(t){const i=t;switch(i.currencies=t.currency?[t.currency]:[],i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i.datePeriod=this.bankingHelper.resolveDatePeriod(t),this.isPaymentRequest()?i.paymentRequestExpiration=b.S.dateRangeFilter(t.expirationBegin,t.expirationEnd):this.isExternalPayment()&&(i.externalPaymentExpiration=b.S.dateRangeFilter(t.expirationBegin,t.expirationEnd)),this.kind){case"authorized":i.authorizationStatuses=[t.status],i.authorized=!0;break;case"myAuth":i.pendingMyAuthorization=!0;break;case"payment-request":i.paymentRequestStatuses=[t.status],i.kinds=[G.w.PAYMENT_REQUEST];break;case"external-payment":i.externalPaymentStatuses=[t.status],i.kinds=[G.w.EXTERNAL_PAYMENT]}return i}accountTypes(){const t=this.form.controls.currency.value,i=this.data.accountTypes||[];return t?i.filter(o=>o.currency.id===t):i}isPaymentRequest(){return"payment-request"===this.kind}isExternalPayment(){return"external-payment"===this.kind}isMyAuth(){return"myAuth"===this.kind}isAuthorized(){return"authorized"===this.kind}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(t){let i;switch(this.kind){case"authorized":i=this.dataForFrontendHolder.role===_e.g.BROKER?v.v2.BROKER_AUTHORIZED_PAYMENTS_OVERVIEW:v.v2.AUTHORIZED_PAYMENTS_OVERVIEW;break;case"myAuth":i=v.v2.PENDING_MY_AUTHORIZATION;break;case"payment-request":i=v.v2.PAYMENT_REQUESTS_OVERVIEW;break;case"external-payment":i=v.v2.EXTERNAL_PAYMENTS_OVERVIEW}return this.menu.userMenu(t.user,i)}get toLink(){return t=>this.bankingHelper.transactionPath(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(pt),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-transactions-overview"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["formControlName","status",3,"label","fieldOptions","emptyOption"],["formControlName","authorizationRoles",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[1,"w-100","d-none","d-sm-block"],["formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","user",3,"label"],["formControlName","fromAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["formControlName","toAccountTypes",3,"emptyOption","label"],["formControlName","transactionNumber",3,"mask","label"],["formControlName","transferTypes",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["formControlName","expirationBegin","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["formControlName","expirationEnd","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["formControlName","authorizationPerformedBy",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],[3,"field","formControl"],[3,"date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"amount"],[3,"click"],[3,"routerLink"],[3,"routerLink",4,"ngIf"],[1,"amount",3,"ngClass"],[1,"d-inline-block",3,"routerLink"],[3,"fields","plainText","fieldName","object"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Hu,1,0,"ng-container",1),e.qZA(),e.YNc(3,Np,18,24,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,O.f,s.JJ,s.u,be.x,u.sg,J.s,j.Q,F.q,fe.h,te.l,Ze.L,s.oH,D.D,R.E,V.t,Y.p,ce.yS,ve.x,u.mk],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();var nt=m(7300),Ce=m(2754);function Ip(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",5),e._uU(2),e.qZA(),e._UZ(3,"hr"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.transaction.number),e.xp6(1),e.hij(" ",t.transaction.transactionNumber," ")}}function Jp(n,a){1&n&&e._UZ(0,"hr")}function Lp(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._UZ(1,"user-link",8),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.general.performedBy),e.xp6(1),e.Q6J("user",t.by)}}function kp(n,a){if(1&n&&e._UZ(0,"label-value",9),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.general.comments)("value",t.comments)}}function Fp(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Jp,1,0,"hr",3),e.TgZ(2,"label-value",5),e._uU(3),e.qZA(),e.YNc(4,Lp,2,2,"label-value",6),e.TgZ(5,"label-value",5),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.YNc(8,kp,1,2,"label-value",7),e.BQk()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i),e.xp6(1),e.Q6J("label",o.i18n.general.action),e.xp6(1),e.hij(" ",o.actionLabel(t)," "),e.xp6(1),e.Q6J("ngIf",t.by),e.xp6(1),e.Q6J("label",o.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(7,7,t.date)," "),e.xp6(2),e.Q6J("ngIf",t.comments)}}function Op(n,a){if(1&n&&(e.TgZ(0,"page-content",2),e.YNc(1,Ip,4,2,"ng-container",3),e.YNc(2,Fp,9,9,"ng-container",4),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.transaction.title.authorizationHistory)("mobileHeading",t.i18n.transaction.mobileTitle.authorizationHistory),e.xp6(1),e.Q6J("ngIf",t.transaction.transactionNumber),e.xp6(1),e.Q6J("ngForOf",t.transaction.authorizations)}}let Dp=(()=>{class n extends nt.k{constructor(t,i){super(t),this.transactionsService=i}get transaction(){return this.data}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.paramMap.get("key");this.addSub(this.transactionsService.viewTransaction({key:t,fields:["transactionNumber","date","amount","kind","type","from","to","authorizations"]}).subscribe(i=>{this.data=i}))}actionLabel(t){return this.apiI18n.authorizationAction(t.action)}resolveMenu(t){return this.menu.accountMenu(t.from,t.to)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(pt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-authorization-history"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],[3,"user"],["valueFormat","break",3,"label","value"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Op,3,4,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,C.t,u.sg,Q.F],pipes:[u.Ov,Ce.i],encapsulation:2,changeDetection:0}),n})();var Oe=(()=>{return(n=Oe||(Oe={})).BOTH="both",n.FROM="from",n.NONE="none",n.TO="to",Oe;var n})(),it=(()=>{return(n=it||(it={})).LEVEL="level",n.OPERATOR="operator",it;var n})(),W=m(7610),$e=(()=>{return(n=$e||($e={})).AUTHORIZE="authorize",n.CANCEL="cancel",n.DENY="deny",$e;var n})(),De=(()=>{return(n=De||(De={})).BLOCK="block",n.CANCEL="cancel",n.SETTLE="settle",n.UNBLOCK="unblock",De;var n})(),dt=(()=>((dt||(dt={})).CANCEL="cancel",dt))(),Be=(()=>{return(n=Be||(Be={})).PROCESS="process",n.SETTLE="settle",Be;var n})(),ft=(()=>((ft||(ft={})).PROCESS="process",ft))(),He=m(5905);function Rp(n,a){if(1&n&&e._UZ(0,"date-field",10),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.reschedulePaymentRequestRescheduleToDate)}}function Vp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"confirmation-password",11),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("createDeviceConfirmationError",function(){return e.CHM(t),e.oxw().hide()})("confirmed",function(o){return e.CHM(t),e.oxw().confirm(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("createDeviceConfirmation",t.createDeviceConfirmation)("passwordInput",t.transaction.confirmationPasswordInput)}}function Yp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",12),e.NdJ("action",function(){return e.CHM(t),e.oxw().confirm()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.submit)}}function Ep(n,a){1&n&&e._uU(0,"\xa0")}let $p=(()=>{class n extends q.H{constructor(t,i,o,r){super(t),this.paymentRequestsService=i,this.authHelper=o,this.modalRef=r,this.PaymentRequestScheduledTo=pe,this.done=new e.vpe,this.showSubmit$=new y.X(!0)}ngOnInit(){super.ngOnInit(),this.rescheduleTo=new s.NI(pe.EXPIRY),this.form=this.formBuilder.group({processDate:null,comments:null}),this.addSub(this.rescheduleTo.valueChanges.subscribe(t=>{t===pe.DATE?this.form.controls.processDate.setValidators(s.kI.required):this.form.controls.processDate.clearValidators(),this.form.patchValue({processDate:t===pe.EXPIRY?this.transaction.expirationDate:null})})),this.transaction.confirmationPasswordInput&&this.form.setControl("confirmationPassword",this.formBuilder.control(null,s.kI.required)),this.canConfirm=this.authHelper.canConfirm(this.transaction.confirmationPasswordInput)}confirm(t){if(t&&this.form.patchValue({confirmationPassword:t}),!(0,h.pt)(this.form))return;const i=this.form.value,o=i;t=i.confirmationPassword,delete i.confirmationPassword,this.addSub(this.paymentRequestsService.reschedulePaymentRequest({key:this.transaction.id,body:o,confirmationPassword:t}).subscribe(()=>{this.done.emit(),this.hide()}))}hide(){this.modalRef.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(We),e.Y36(M.N),e.Y36(He.UZ))},n.\u0275cmp=e.Xpm({type:n,selectors:[["reschedule-payment-request-dialog"]],inputs:{createDeviceConfirmation:"createDeviceConfirmation",transaction:"transaction"},outputs:{done:"done"},features:[e.qOj],decls:17,vars:20,consts:[[3,"formGroup"],["labelPosition","above",3,"label","formControl"],[3,"value","text"],["required","","formControlName","processDate","labelPosition","above",3,"label",4,"ngIf"],["formControlName","comments","labelPosition","above",3,"label"],["formControlName","confirmationPassword",3,"createDeviceConfirmation","passwordInput","showSubmit","createDeviceConfirmationError","confirmed",4,"ngIf"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["blank",""],["outline","",3,"label","action"],["required","","formControlName","processDate","labelPosition","above",3,"label"],["formControlName","confirmationPassword",3,"createDeviceConfirmation","passwordInput","showSubmit","createDeviceConfirmationError","confirmed"],[3,"disabled","label","action"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.ynx(2,0),e.TgZ(3,"single-selection-field",1),e._UZ(4,"field-option",2)(5,"field-option",2)(6,"field-option",2),e.qZA(),e.YNc(7,Rp,1,1,"date-field",3),e.ALo(8,"async"),e._UZ(9,"textarea-field",4),e.YNc(10,Vp,1,2,"confirmation-password",5),e.TgZ(11,"actions",6),e.YNc(12,Yp,2,4,"action-button",7),e.ALo(13,"async"),e.YNc(14,Ep,1,0,"ng-template",null,8,e.W1O),e.TgZ(16,"action-button",9),e.NdJ("action",function(){return i.hide()}),e.qZA()(),e.BQk()),2&t){const o=e.MAs(15);e.xp6(1),e.Oqu(i.i18n.transaction.reschedulePaymentRequest),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("label",i.i18n.transaction.reschedulePaymentRequestRescheduleTo)("formControl",i.rescheduleTo),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.NOW)("text",i.i18n.transaction.paymentRequestSchedulingNow),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.DATE)("text",i.i18n.transaction.paymentRequestSchedulingDate),e.xp6(1),e.Q6J("value",i.PaymentRequestScheduledTo.EXPIRY)("text",i.i18n.transaction.paymentRequestSchedulingExpiration(i.format.formatAsDate(i.transaction.expirationDate))),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,16,i.rescheduleTo.valueChanges)===i.PaymentRequestScheduledTo.DATE),e.xp6(2),e.Q6J("label",i.i18n.general.comments),e.xp6(1),e.Q6J("ngIf",i.transaction.confirmationPasswordInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(13,18,i.showSubmit$))("ngIfElse",o),e.xp6(4),e.Q6J("label",i.i18n.general.cancel)}},directives:[s.JL,s.sg,O.f,s.JJ,s.oH,J.s,u.O5,j.Q,s.Q7,s.u,Te.u,he.y,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})(),Bp=(()=>{class n extends K.b{constructor(t,i){super(t,i)}authorizePendingPayment$Response(t,i){const o=new d.c(this.rootUrl,n.AuthorizePendingPaymentPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}authorizePendingPayment(t,i){return this.authorizePendingPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}denyPendingPayment$Response(t,i){const o=new d.c(this.rootUrl,n.DenyPendingPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}denyPendingPayment(t,i){return this.denyPendingPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelPendingPayment$Response(t,i){const o=new d.c(this.rootUrl,n.CancelPendingPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelPendingPayment(t,i){return this.cancelPendingPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.AuthorizePendingPaymentPath="/pending-payments/{key}/authorize",n.DenyPendingPaymentPath="/pending-payments/{key}/deny",n.CancelPendingPaymentPath="/pending-payments/{key}/cancel",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Hp=(()=>{class n extends K.b{constructor(t,i){super(t,i)}blockScheduledPayment$Response(t,i){const o=new d.c(this.rootUrl,n.BlockScheduledPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}blockScheduledPayment(t,i){return this.blockScheduledPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}unblockScheduledPayment$Response(t,i){const o=new d.c(this.rootUrl,n.UnblockScheduledPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}unblockScheduledPayment(t,i){return this.unblockScheduledPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelScheduledPayment$Response(t,i){const o=new d.c(this.rootUrl,n.CancelScheduledPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelScheduledPayment(t,i){return this.cancelScheduledPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}settleScheduledPayment$Response(t,i){const o=new d.c(this.rootUrl,n.SettleScheduledPaymentPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}settleScheduledPayment(t,i){return this.settleScheduledPayment$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.BlockScheduledPaymentPath="/scheduled-payments/{key}/block",n.UnblockScheduledPaymentPath="/scheduled-payments/{key}/unblock",n.CancelScheduledPaymentPath="/scheduled-payments/{key}/cancel",n.SettleScheduledPaymentPath="/scheduled-payments/{key}/settle-remaining",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Bt=m(3032);let Zt=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getTransferDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetTransferDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getTransferDataForSearch(t,i){return this.getTransferDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchTransfers$Response(t,i){const o=new d.c(this.rootUrl,n.SearchTransfersPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("chargedBack",t.chargedBack,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchTransfers(t,i){return this.searchTransfers$Response(t,i).pipe((0,c.U)(o=>o.body))}searchTransfersSummary$Response(t,i){const o=new d.c(this.rootUrl,n.SearchTransfersSummaryPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("chargedBack",t.chargedBack,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchTransfersSummary(t,i){return this.searchTransfersSummary$Response(t,i).pipe((0,c.U)(o=>o.body))}exportTransfers$Response(t,i){const o=new d.c(this.rootUrl,n.ExportTransfersPath,"get");return t&&(o.path("format",t.format,{}),o.query("accessClients",t.accessClients,{}),o.query("amountRange",t.amountRange,{}),o.query("brokers",t.brokers,{}),o.query("by",t.by,{}),o.query("channels",t.channels,{}),o.query("chargedBack",t.chargedBack,{}),o.query("currencies",t.currencies,{}),o.query("customFields",t.customFields,{}),o.query("datePeriod",t.datePeriod,{}),o.query("excludedIds",t.excludedIds,{}),o.query("fromAccountTypes",t.fromAccountTypes,{}),o.query("fromCurrentAccessClient",t.fromCurrentAccessClient,{}),o.query("groups",t.groups,{}),o.query("includeGeneratedByAccessClient",t.includeGeneratedByAccessClient,{}),o.query("kinds",t.kinds,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("toAccountTypes",t.toAccountTypes,{}),o.query("transactionNumber",t.transactionNumber,{}),o.query("transferFilters",t.transferFilters,{}),o.query("transferTypes",t.transferTypes,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportTransfers(t,i){return this.exportTransfers$Response(t,i).pipe((0,c.U)(o=>o.body))}viewTransfer$Response(t,i){const o=new d.c(this.rootUrl,n.ViewTransferPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}viewTransfer(t,i){return this.viewTransfer$Response(t,i).pipe((0,c.U)(o=>o.body))}exportTransfer$Response(t,i){const o=new d.c(this.rootUrl,n.ExportTransferPath,"get");return t&&(o.path("key",t.key,{}),o.path("format",t.format,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportTransfer(t,i){return this.exportTransfer$Response(t,i).pipe((0,c.U)(o=>o.body))}chargebackTransfer$Response(t,i){const o=new d.c(this.rootUrl,n.ChargebackTransferPath,"post");return t&&(o.path("key",t.key,{}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}chargebackTransfer(t,i){return this.chargebackTransfer$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetTransferDataForSearchPath="/transfers/data-for-search",n.SearchTransfersPath="/transfers",n.SearchTransfersSummaryPath="/transfers/summary",n.ExportTransfersPath="/transfers/export/{format}",n.ViewTransferPath="/transfers/{key}",n.ExportTransferPath="/transfers/{key}/export/{format}",n.ChargebackTransferPath="/transfers/{key}/chargeback",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ht=m(7055),me=m(7769),re=m(4068),Re=m(852),jp=m(2274),Pt=m(3961);function Mp(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.sentToEmail),e.xp6(1),e.hij(" ",t.voucher.email,"\n")}}function zp(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.voucher.amount,t.voucher.type.configuration.currency),"\n")}}function Gp(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.balance),e.xp6(1),e.hij(" ",e.xi3(2,2,t.voucher.balance,t.voucher.type.configuration.currency),"\n")}}function Wp(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.status),e.xp6(1),e.hij(" ",t.apiI18n.voucherStatus(t.voucher.status),"\n")}}function Xp(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.voucher.expirationDate),"\n")}}let Kp=(()=>{class n extends q.H{constructor(t){super(t),this.VoucherCreationTypeEnum=re.t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-details"]],inputs:{voucher:"voucher"},features:[e.qOj],decls:9,vars:9,consts:[[3,"label"],[3,"label",4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA(),e.TgZ(2,"label-value",0),e._uU(3),e.qZA(),e.YNc(4,Mp,2,2,"label-value",1),e.YNc(5,zp,3,5,"label-value",1),e.YNc(6,Gp,3,5,"label-value",1),e.YNc(7,Wp,2,2,"label-value",1),e.YNc(8,Xp,3,4,"label-value",1)),2&t&&(e.Q6J("label",i.i18n.voucher.voucher),e.xp6(1),e.hij(" ",i.voucher.type.voucherTitle,"\n"),e.xp6(1),e.Q6J("label",i.i18n.voucher.token),e.xp6(1),e.hij(" ",i.voucher.token,"\n"),e.xp6(1),e.Q6J("ngIf",i.voucher.creationType===i.VoucherCreationTypeEnum.SENT),e.xp6(1),e.Q6J("ngIf",i.voucher.amount),e.xp6(1),e.Q6J("ngIf",i.voucher.balance),e.xp6(1),e.Q6J("ngIf",i.voucher.status),e.xp6(1),e.Q6J("ngIf","open"===i.voucher.status))},directives:[C.t,u.O5],pipes:[w.H,Ce.i],encapsulation:2,changeDetection:0}),n})();function em(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.number),e.xp6(1),e.hij(" ",t.transfer.transactionNumber,"\n")}}function tm(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("value",t.transfer.description||(null==t.transfer.transaction?null:t.transfer.transaction.description))}}let nm=(()=>{class n extends q.H{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["transfer-simple-details"]],inputs:{transfer:"transfer"},features:[e.qOj],decls:14,vars:17,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"account"],["valueFormat","break",3,"label","value",4,"ngIf"],["valueFormat","break",3,"label","value"]],template:function(t,i){1&t&&(e.YNc(0,em,2,2,"label-value",0),e.TgZ(1,"label-value",1),e._uU(2),e.ALo(3,"dateTime"),e.qZA(),e.TgZ(4,"label-value",1),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.TgZ(7,"label-value",1),e._UZ(8,"user-link",2),e.qZA(),e.TgZ(9,"label-value",1),e._UZ(10,"user-link",2),e.qZA(),e.TgZ(11,"label-value",1),e._uU(12),e.qZA(),e.YNc(13,tm,1,2,"label-value",3)),2&t&&(e.Q6J("ngIf",i.transfer.transactionNumber),e.xp6(1),e.Q6J("label",i.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(3,12,i.transfer.date),"\n"),e.xp6(2),e.Q6J("label",i.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(6,14,i.transfer.amount,i.transfer.currency),"\n"),e.xp6(2),e.Q6J("label",i.i18n.transaction.from),e.xp6(1),e.Q6J("account",i.transfer.from),e.xp6(1),e.Q6J("label",i.i18n.transaction.to),e.xp6(1),e.Q6J("account",i.transfer.to),e.xp6(1),e.Q6J("label",i.i18n.transaction.type),e.xp6(1),e.hij(" ",i.transfer.type.name,"\n"),e.xp6(1),e.Q6J("ngIf",i.transfer.description||(null==i.transfer.transaction?null:i.transfer.transaction.description)))},directives:[u.O5,C.t,Q.F],pipes:[Ce.i,w.H],encapsulation:2,changeDetection:0}),n})();function im(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._UZ(1,"user-link",9),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.performedBy),e.xp6(1),e.Q6J("user",t.transfer.transaction.by)}}function om(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._UZ(1,"user-link",9),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.receivedBy),e.xp6(1),e.Q6J("user",t.transfer.transaction.receivedBy)}}function am(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-link",10),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("account",t.transfer.from)("display",t.transfer.transaction.fromName)}}function rm(n,a){if(1&n&&e._UZ(0,"user-link",11),2&n){const t=e.oxw();e.Q6J("account",t.transfer.from)}}function sm(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-link",10),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("account",t.transfer.to)("display",t.transfer.transaction.toName)}}function cm(n,a){if(1&n&&e._UZ(0,"user-link",11),2&n){const t=e.oxw();e.Q6J("account",t.transfer.to)}}function lm(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.transferkind.accountFee),e.xp6(1),e.hij(" ",t.transfer.accountFee.name,"\n")}}function um(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.transferkind.transferFee),e.xp6(1),e.hij(" ",t.transfer.transferFee.name,"\n")}}const pm=function(n){return["/banking","vouchers","view",n]};function mm(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",0)(2,"maybe-link",12),e._uU(3),e.qZA()(),e._UZ(4,"label-value",13),e.BQk()),2&n){const t=a.ngIf,i=e.oxw();e.xp6(1),e.Q6J("label",t.kind===i.VoucherTransactionKind.REDEEM?i.i18n.transaction.voucherRedeemed:i.i18n.transaction.voucherToppedUp),e.xp6(1),e.Q6J("link",t.voucherId?e.VKq(5,pm,t.voucherId):null),e.xp6(1),e.hij(" ",t.token," "),e.xp6(1),e.Q6J("label",i.i18n.voucher.voucher)("value",t.type.voucherTitle)}}function dm(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.channel),e.xp6(1),e.hij(" ",t.transfer.transaction.channel.name,"\n")}}function fm(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.number),e.xp6(1),e.hij(" ",t.transfer.transactionNumber,"\n")}}function _m(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("label",t.flow.name),e.xp6(1),e.hij(" ",t.name,"\n")}}function hm(n,a){1&n&&e._UZ(0,"custom-field-value",14),2&n&&e.Q6J("fieldValue",a.$implicit)}function gm(n,a){if(1&n&&e._UZ(0,"label-value",15),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.description)("value",t.transfer.description||(null==t.transfer.transaction?null:t.transfer.transaction.description))}}function ym(n,a){if(1&n&&(e.TgZ(0,"label-value",0)(1,"a",16),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.chargedBackBy),e.xp6(1),e.Q6J("routerLink",t.path(t.transfer.chargedBackBy)),e.xp6(1),e.hij(" ",t.transfer.chargedBackBy.display," ")}}function xm(n,a){if(1&n&&(e.TgZ(0,"label-value",0)(1,"a",16),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.chargebackOf),e.xp6(1),e.Q6J("routerLink",t.path(t.transfer.chargebackOf)),e.xp6(1),e.hij(" ",t.transfer.chargebackOf.display," ")}}function bm(n,a){if(1&n&&e._UZ(0,"label-value",15),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.authorizationComments)("value",t.lastAuthComment)}}function vm(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",20),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).addReceiverToContacts()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.doneAddReceiverToContacts)}}function Tm(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"actions",17)(2,"action-button",18),e.NdJ("action",function(){return e.CHM(t),e.oxw().navigateToPerformNew()}),e.qZA(),e.YNc(3,vm,1,1,"action-button",19),e.ALo(4,"async"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("label",t.i18n.transaction.doneNew),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,2,t.canAddReceiverToContacts$))}}function wm(n,a){if(1&n&&(e.TgZ(0,"h2",24),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.layout.gtxs$)?t.i18n.transaction.title.boughtVoucher:t.i18n.transaction.mobileTitle.boughtVoucher)}}function Cm(n,a){if(1&n&&(e.TgZ(0,"h2",24),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.layout.gtxs$)?t.i18n.transaction.title.sentVoucher:t.i18n.transaction.mobileTitle.sentVoucher)}}function Am(n,a){if(1&n&&(e.ynx(0),e.YNc(1,wm,3,3,"h2",21),e.YNc(2,Cm,3,3,"h2",21),e._UZ(3,"voucher-details",22),e.TgZ(4,"actions")(5,"a",23),e._uU(6),e.qZA()(),e.BQk()),2&n){const t=a.ngIf,i=e.oxw();e.xp6(1),e.Q6J("ngIf",t.creationType===i.VoucherCreationTypeEnum.BOUGHT),e.xp6(1),e.Q6J("ngIf",t.creationType===i.VoucherCreationTypeEnum.SENT),e.xp6(1),e.Q6J("voucher",i.transfer.transaction.boughtVouchers[0]),e.xp6(2),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",i.i18n.transaction.viewThisVoucher," ")}}function Zm(n,a){if(1&n&&(e.TgZ(0,"mobile-result",29)(1,"div",30),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("amount",t.amount)("currency",i.transfer.currency)("amountColor",!1),e.xp6(2),e.hij(" ",t.token," ")}}function Pm(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij("",t.i18n.general.expirationDate," ")}}function qm(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",16),e._uU(2),e.ALo(3,"dateTime"),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",e.lcZ(3,2,t.expirationDate)," ")}}function Sm(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",34),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.voucherPath(r))}),e.TgZ(1,"td")(2,"a",16),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"a",16),e._uU(6),e.qZA()(),e.YNc(7,qm,4,4,"td",5),e.TgZ(8,"td",32)(9,"a",16),e._uU(10),e.ALo(11,"currency"),e.qZA()(),e.TgZ(12,"td",32)(13,"a",16),e._uU(14),e.ALo(15,"currency"),e.qZA()()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("tooltip",t.description),e.xp6(2),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",t.token," "),e.xp6(2),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",i.apiI18n.voucherStatus(t.status)," "),e.xp6(1),e.Q6J("ngIf",i.hasVoucherExpirationDate),e.xp6(2),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",e.xi3(11,10,t.amount,i.transfer.currency)," "),e.xp6(3),e.Q6J("routerLink",i.voucherPath(t)),e.xp6(1),e.hij(" ",e.xi3(15,13,t.balance,i.transfer.currency)," ")}}function Qm(n,a){if(1&n&&(e.TgZ(0,"table",31)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.YNc(6,Pm,2,1,"th",5),e.TgZ(7,"th",32),e._uU(8),e.qZA(),e.TgZ(9,"th",32),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,Sm,16,16,"tr",33),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.voucher.token),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(1),e.Q6J("ngIf",t.hasVoucherExpirationDate),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Oqu(t.i18n.voucher.balance),e.xp6(2),e.Q6J("ngForOf",t.transfer.transaction.boughtVouchers)}}function Um(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",25),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"results-layout",26),e.YNc(5,Zm,3,4,"mobile-result",27),e.YNc(6,Qm,13,6,"table",28),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,3,t.layout.gtxs$)?t.i18n.transaction.title.boughtVouchers:t.i18n.transaction.mobileTitle.boughtVouchers),e.xp6(2),e.Q6J("results",t.transfer.transaction.boughtVouchers)("toLink",t.toVoucherLink)}}function Nm(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",24),e._uU(2),e.ALo(3,"async"),e.qZA(),e._UZ(4,"transfer-simple-details",35),e.TgZ(5,"actions")(6,"a",23),e._uU(7),e.qZA()(),e.BQk()),2&n){const t=a.ngIf,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,i.layout.gtxs$)?i.i18n.transaction.title.parentTransfer:i.i18n.transaction.mobileTitle.parentTransfer),e.xp6(2),e.Q6J("transfer",t),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",i.i18n.transaction.viewThisTransfer," ")}}function Im(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",24),e._uU(2),e.ALo(3,"async"),e.qZA(),e._UZ(4,"transfer-simple-details",35),e.TgZ(5,"actions")(6,"a",23),e._uU(7),e.qZA()(),e.BQk()),2&n){const t=a.ngIf,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,4,i.layout.gtxs$)?i.i18n.transaction.title.childTransfer:i.i18n.transaction.mobileTitle.childTransfer),e.xp6(2),e.Q6J("transfer",t),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",i.i18n.transaction.viewThisTransfer," ")}}function Jm(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"user-link",11),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",i.i18n.transaction.from," "),e.xp6(1),e.Q6J("account",t.from)}}function Lm(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.transaction.to,"")}}function km(n,a){if(1&n&&(e.TgZ(0,"mobile-result",37)(1,"div",30),e.YNc(2,Jm,3,2,"div",5),e.TgZ(3,"div"),e.YNc(4,Lm,2,1,"ng-container",5),e._UZ(5,"user-link",11),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.date)("amount",((null==t.from.user?null:t.from.user.id)===(null==i.login.user?null:i.login.user.id)?"-":"")+t.amount)("amountColor",(null==t.from.user?null:t.from.user.id)===(null==i.login.user?null:i.login.user.id))("currency",t.currency),e.xp6(2),e.Q6J("ngIf",(null==t.from.user?null:t.from.user.id)!==(null==i.login.user?null:i.login.user.id)),e.xp6(2),e.Q6J("ngIf",(null==t.from.user?null:t.from.user.id)!==(null==i.login.user?null:i.login.user.id)),e.xp6(1),e.Q6J("account",t.to)}}function Fm(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",34),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(1,"td")(2,"a",16),e._uU(3),e.ALo(4,"date"),e.qZA()(),e.TgZ(5,"td")(6,"a",16),e._UZ(7,"user-link",11),e.qZA()(),e.TgZ(8,"td")(9,"a",16),e._UZ(10,"user-link",11),e.qZA()(),e.TgZ(11,"td",32)(12,"a",16),e._uU(13),e.ALo(14,"currency"),e.qZA()()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("tooltip",t.description),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",e.lcZ(4,9,t.date)," "),e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Q6J("account",t.from),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Q6J("account",t.to),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",e.xi3(14,11,t.amount,t.currency)," ")}}function Om(n,a){if(1&n&&(e.TgZ(0,"table",31)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th",32),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,Fm,15,14,"tr",33),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.transaction.from),e.xp6(2),e.Oqu(t.i18n.transaction.to),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",t.transfer.children)}}function Dm(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",25),e._uU(2),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"results-layout",26),e.YNc(5,km,6,7,"mobile-result",36),e.YNc(6,Om,12,5,"table",28),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,3,t.layout.gtxs$)?t.i18n.transaction.title.childTransfers:t.i18n.transaction.mobileTitle.childTransfers),e.xp6(2),e.Q6J("results",t.transfer.children)("toLink",t.toLink)}}let jt=(()=>{class n extends q.H{constructor(t,i,o,r,l){super(t),this.login=i,this.contactService=o,this.authHelperService=r,this.bankingHelper=l,this.VoucherTransactionKind=me.n,this.VoucherCreationTypeEnum=re.t}ngOnInit(){super.ngOnInit();const t=this.transfer.transaction||{};(0,h.cS)(t.authorizations)||(this.lastAuthComment=t.authorizations[0].comments),this.hasAdditionalData=!(0,h.cS)(this.lastAuthComment)||!!this.transfer.parent||!(0,h.cS)(this.transfer.children),this.canAddReceiverToContacts$=new y.X(this.usersWhichCanAddToContacts===Oe.TO||this.usersWhichCanAddToContacts===Oe.BOTH)}showBy(){var t,i;return(null===(t=this.transfer.transaction)||void 0===t?void 0:t.by)&&(!this.authHelperService.isSelf(this.transfer.transaction.by.id)||!this.authHelperService.isSelf(null===(i=this.transfer.from.user)||void 0===i?void 0:i.id))}path(t){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(t)]}get toLink(){return t=>this.path(t)}voucherPath(t){return(null==t?void 0:t.id)?["/banking","vouchers","view",t.id]:null}showNewPaymentButton(){return history.state.url}navigateToPerformNew(){this.router.navigateByUrl(history.state.url)}addReceiverToContacts(){this.addUserToContacts(this.transfer.to.user)}addUserToContacts(t){this.addSub(this.contactService.createContact({user:b.S.SELF,body:{contact:t.id}}).subscribe(()=>{this.notification.info(this.i18n.transaction.doneUserAddedToContacts(t.display)),this.canAddReceiverToContacts$.next(!1)}))}get toVoucherLink(){return t=>this.voucherPath(t)}get hasVoucherExpirationDate(){var t,i;return!!(null===(i=null===(t=this.transfer.transaction)||void 0===t?void 0:t.boughtVouchers)||void 0===i?void 0:i.find(o=>o.status===Re.v.OPEN))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(jp.r),e.Y36(Bt.P),e.Y36(M.N),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["transfer-details"]],inputs:{transfer:"transfer",headingActions:"headingActions",usersWhichCanAddToContacts:"usersWhichCanAddToContacts"},features:[e.qOj],decls:35,vars:36,consts:[[3,"label"],[3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["fromUser",""],["toUser",""],[4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[3,"user"],[3,"account","display"],[3,"account"],[3,"link"],[3,"label","value"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[3,"routerLink"],["forceRow",""],[3,"label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],["class","mt-4",4,"ngIf"],[3,"voucher"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-4"],[1,"mt-4","mb-0"],[3,"results","toLink"],[3,"amount","currency","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"amount","currency","amountColor"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"tooltip","click",4,"ngFor","ngForOf"],[3,"tooltip","click"],[3,"transfer"],[3,"date","amount","amountColor","currency",4,"mobileResult"],[3,"date","amount","amountColor","currency"]],template:function(t,i){if(1&t&&(e.TgZ(0,"label-value",0),e._uU(1),e.ALo(2,"currency"),e.qZA(),e.YNc(3,im,2,2,"label-value",1),e.YNc(4,om,2,2,"label-value",1),e.TgZ(5,"label-value",0),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.TgZ(8,"label-value",0),e.YNc(9,am,2,2,"ng-container",2),e.YNc(10,rm,1,1,"ng-template",null,3,e.W1O),e.qZA(),e.TgZ(12,"label-value",0),e.YNc(13,sm,2,2,"ng-container",2),e.YNc(14,cm,1,1,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(16,"label-value",0),e._uU(17),e.qZA(),e.YNc(18,lm,2,2,"label-value",1),e.YNc(19,um,2,2,"label-value",1),e.YNc(20,mm,5,7,"ng-container",5),e.YNc(21,dm,2,2,"label-value",1),e.YNc(22,fm,2,2,"label-value",1),e.YNc(23,_m,2,2,"label-value",6),e.YNc(24,hm,1,1,"custom-field-value",7),e.YNc(25,gm,1,2,"label-value",8),e.YNc(26,ym,3,3,"label-value",1),e.YNc(27,xm,3,3,"label-value",1),e.YNc(28,bm,1,2,"label-value",8),e.YNc(29,Tm,5,4,"ng-container",5),e.YNc(30,Am,7,5,"ng-container",5),e.YNc(31,Um,7,5,"ng-container",5),e.YNc(32,Nm,8,6,"ng-container",5),e.YNc(33,Im,8,6,"ng-container",5),e.YNc(34,Dm,7,5,"ng-container",5)),2&t){const o=e.MAs(11),r=e.MAs(15);e.Q6J("label",i.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,31,i.transfer.amount,i.transfer.currency),"\n"),e.xp6(2),e.Q6J("ngIf",i.showBy()),e.xp6(1),e.Q6J("ngIf",null==i.transfer.transaction?null:i.transfer.transaction.receivedBy),e.xp6(1),e.Q6J("label",i.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(7,34,i.transfer.date),"\n"),e.xp6(2),e.Q6J("label",i.i18n.transaction.from),e.xp6(1),e.Q6J("ngIf",null==i.transfer.transaction?null:i.transfer.transaction.fromName)("ngIfElse",o),e.xp6(3),e.Q6J("label",i.i18n.transaction.to),e.xp6(1),e.Q6J("ngIf",null==i.transfer.transaction?null:i.transfer.transaction.toName)("ngIfElse",r),e.xp6(3),e.Q6J("label",i.i18n.transaction.type),e.xp6(1),e.hij(" ",i.transfer.type.name,"\n"),e.xp6(1),e.Q6J("ngIf",i.transfer.accountFee),e.xp6(1),e.Q6J("ngIf",i.transfer.transferFee),e.xp6(1),e.Q6J("ngIf",null==i.transfer.transaction?null:i.transfer.transaction.voucherTransaction),e.xp6(1),e.Q6J("ngIf",null==i.transfer.transaction?null:i.transfer.transaction.channel),e.xp6(1),e.Q6J("ngIf",i.transfer.transactionNumber),e.xp6(1),e.Q6J("ngForOf",i.transfer.statuses),e.xp6(1),e.Q6J("ngForOf",null==i.transfer.transaction?null:i.transfer.transaction.customValues),e.xp6(1),e.Q6J("ngIf",0==(null==i.transfer.transaction||null==i.transfer.transaction.boughtVouchers?null:i.transfer.transaction.boughtVouchers.length)&&(i.transfer.description||(null==i.transfer.transaction?null:i.transfer.transaction.description))),e.xp6(1),e.Q6J("ngIf",i.transfer.chargedBackBy),e.xp6(1),e.Q6J("ngIf",i.transfer.chargebackOf),e.xp6(1),e.Q6J("ngIf",i.lastAuthComment),e.xp6(1),e.Q6J("ngIf",i.showNewPaymentButton()),e.xp6(1),e.Q6J("ngIf",1===(null==i.transfer.transaction||null==i.transfer.transaction.boughtVouchers?null:i.transfer.transaction.boughtVouchers.length)&&i.transfer.transaction.boughtVouchers[0]),e.xp6(1),e.Q6J("ngIf",(null==i.transfer.transaction||null==i.transfer.transaction.boughtVouchers?null:i.transfer.transaction.boughtVouchers.length)>1),e.xp6(1),e.Q6J("ngIf",i.transfer.parent),e.xp6(1),e.Q6J("ngIf",1===(null==i.transfer.children?null:i.transfer.children.length)&&i.transfer.children[0]),e.xp6(1),e.Q6J("ngIf",(null==i.transfer.children?null:i.transfer.children.length)>1)}},directives:[C.t,u.O5,Q.F,Pt.O,u.sg,Qe.W,ce.yS,L.h,k.x,Kp,D.D,R.E,V.t,Y.p,Xe.i9,nm],pipes:[w.H,Ce.i,u.Ov,E.u],encapsulation:2,changeDetection:0}),n})();var Rm=m(947);function Vm(n,a){if(1&n&&(e.TgZ(0,"notification",6)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("type",t.resolveLastPaymentNotificationType())("icon",t.resolveLastPaymentNotificationIcon()),e.xp6(2),e.Oqu(t.resolveLastPaymentNotificationMessage())}}function Ym(n,a){if(1&n&&e._UZ(0,"transfer-details",7),2&n){const t=e.oxw(2);e.Q6J("transfer",t.transaction.transfer)("usersWhichCanAddToContacts",t.transaction.usersWhichCanAddToContacts)}}function Em(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Vm,3,3,"notification",4),e.YNc(3,Ym,1,2,"transfer-details",5),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(4);e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("headingActions",e.lcZ(1,6,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.showDoneMessage()),e.xp6(1),e.Q6J("ngIf",t.transaction.transfer)("ngIfElse",i)}}function $m(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.awaitingAuthorizationBy),e.xp6(1),e.hij(" ",t.authorizer," ")}}function Bm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.totalAmount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.transaction.feesOnAuthorization.totalAmount,t.transaction.currency)," ")}}function Hm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.repeatUntil),e.xp6(1),e.hij(" ",t.transaction.occurrencesCount?t.i18n.transaction.repeatUntilFixed:t.i18n.transaction.repeatUntilManual," ")}}function jm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrencesCount),e.xp6(1),e.hij(" ",t.transaction.occurrencesCount," ")}}function Mm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.occurrenceInterval),e.xp6(1),e.hij(" ",t.format.formatTimeInterval(t.transaction.occurrenceInterval)," ")}}function zm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.nextOccurrence),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.transaction.nextOccurrenceDate)," ")}}function Gm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.dueAmount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.transaction.dueAmount,t.transaction.currency)," ")}}function Wm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.dueDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.transaction.installments[0].dueDate)," ")}}function Xm(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._UZ(1,"user-link",16),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.performedBy),e.xp6(1),e.Q6J("user",t.transaction.by)}}function Km(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._UZ(1,"user-link",16),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.receivedBy),e.xp6(1),e.Q6J("user",t.transaction.receivedBy)}}function ed(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.transaction.expirationDate)," ")}}function td(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.processDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.transaction.processDate)," ")}}function nd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.installmentsCount),e.xp6(1),e.hij(" ",t.transaction.installmentsCount," ")}}function id(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.ALo(2,"boolean"),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.firstInstallmentIsImmediate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.transaction.firstInstallmentIsImmediate)," ")}}function od(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.repeatUntil),e.xp6(1),e.hij(" ",t.transaction.occurrencesCount?t.i18n.transaction.repeatUntilNumberOfOccurrences(t.transaction.occurrencesCount):t.i18n.transaction.repeatUntilManual," ")}}function ad(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.firstOccurrence),e.xp6(1),e.hij(" ",t.transaction.firstOccurrenceIsImmediate?t.i18n.transaction.firstOccurrenceImmediate:t.i18n.transaction.firstOccurrenceAfterInterval(t.format.formatTimeInterval(t.transaction.occurrenceInterval))," ")}}function rd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.occurrenceInterval),e.xp6(1),e.hij(" ",t.format.formatTimeInterval(t.transaction.occurrenceInterval)," ")}}function sd(n,a){if(1&n&&(e.ynx(0),e.YNc(1,nd,2,2,"label-value",9),e.YNc(2,id,3,4,"label-value",9),e.YNc(3,od,2,2,"label-value",9),e.YNc(4,ad,2,2,"label-value",9),e.YNc(5,rd,2,2,"label-value",9),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.transaction.installmentsCount),e.xp6(1),e.Q6J("ngIf",null!=t.transaction.firstInstallmentIsImmediate),e.xp6(1),e.Q6J("ngIf","paymentRequest"===t.transaction.kind&&"recurring"===t.transaction.scheduling),e.xp6(1),e.Q6J("ngIf",null!=t.transaction.firstOccurrenceIsImmediate),e.xp6(1),e.Q6J("ngIf","paymentRequest"===t.transaction.kind&&t.transaction.occurrenceInterval)}}function cd(n,a){1&n&&e.GkF(0)}function ld(n,a){1&n&&e.GkF(0)}function ud(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.isPaymentRequest()?t.i18n.transaction.receiver:t.i18n.transaction.from),e.xp6(1),e.Q6J("user",null==t.transaction.from?null:t.transaction.from.user)("display",t.transaction.fromName)}}function pd(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw(5);e.Q6J("user",t.transaction.from.user)}}function md(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(5);e.hij(" ",t.transaction.from.type.name," ")}}function dd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e.YNc(1,pd,1,1,"user-link",20),e.YNc(2,md,1,1,"ng-template",null,21,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw(4);e.Q6J("label",i.isPaymentRequest()?i.i18n.transaction.receiver:i.i18n.transaction.from),e.xp6(1),e.Q6J("ngIf",i.transaction.from.user)("ngIfElse",t)}}function fd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.transaction.from.number," ")}}function _d(n,a){if(1&n&&(e.YNc(0,dd,4,3,"label-value",9),e.YNc(1,fd,2,2,"label-value",9)),2&n){const t=e.oxw(3);e.Q6J("ngIf",t.transaction.from),e.xp6(1),e.Q6J("ngIf",null==t.transaction.from?null:t.transaction.from.number)}}function hd(n,a){if(1&n&&(e.YNc(0,ud,2,3,"label-value",17),e.YNc(1,_d,2,2,"ng-template",null,18,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.transaction.fromName)("ngIfElse",t)}}function gd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.isPaymentRequest()?t.i18n.transaction.sender:t.i18n.transaction.to),e.xp6(1),e.Q6J("user",null==t.transaction.to?null:t.transaction.to.user)("display",t.transaction.toName)}}function yd(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw(5);e.Q6J("user",t.transaction.to.user)}}function xd(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(5);e.hij(" ",t.transaction.to.type.name," ")}}function bd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e.YNc(1,yd,1,1,"user-link",20),e.YNc(2,xd,1,1,"ng-template",null,23,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw(4);e.Q6J("label",i.isPaymentRequest()?i.i18n.transaction.sender:i.i18n.transaction.to),e.xp6(1),e.Q6J("ngIf",i.transaction.to.user)("ngIfElse",t)}}function vd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.transaction.to.number," ")}}function Td(n,a){if(1&n&&(e.YNc(0,bd,4,3,"label-value",9),e.YNc(1,vd,2,2,"label-value",9)),2&n){const t=e.oxw(3);e.Q6J("ngIf",t.transaction.to),e.xp6(1),e.Q6J("ngIf",null==t.transaction.to?null:t.transaction.to.number)}}function wd(n,a){if(1&n&&(e.YNc(0,gd,2,3,"label-value",17),e.YNc(1,Td,2,2,"ng-template",null,22,e.W1O)),2&n){const t=e.MAs(2),i=e.oxw(2);e.Q6J("ngIf",i.transaction.toName)("ngIfElse",t)}}function Cd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.transaction.toPrincipalType.name),e.xp6(1),e.hij(" ",t.transaction.toPrincipalValue," ")}}function Ad(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.channel),e.xp6(1),e.hij(" ",t.transaction.channel.name," ")}}function Zd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.number),e.xp6(1),e.hij(" ",t.transaction.transactionNumber," ")}}function Pd(n,a){if(1&n&&(e.TgZ(0,"label-value",8)(1,"a",24),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.generatedTransaction),e.xp6(1),e.Q6J("routerLink",t.bankingHelper.transactionPath(t.transaction.transaction)),e.xp6(1),e.hij(" ",t.transaction.transaction.display," ")}}function qd(n,a){1&n&&e._UZ(0,"custom-field-value",25),2&n&&e.Q6J("fieldValue",a.$implicit)}function Sd(n,a){if(1&n&&e._UZ(0,"label-value",26),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.description)("value",t.transaction.description)}}function Qd(n,a){if(1&n&&e._UZ(0,"label-value",26),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.authorizationComments)("value",t.lastAuthComment)}}function Ud(n,a){if(1&n&&e._UZ(0,"label-value",26),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.comments)("value",t.transaction.comments)}}function Nd(n,a){1&n&&e._UZ(0,"th",32)}function Id(n,a){if(1&n&&(e.TgZ(0,"thead")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th",30),e._uU(8),e.qZA(),e.YNc(9,Nd,1,0,"th",31),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(2),e.Oqu(t.i18n.transaction.dueDate),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(1),e.Q6J("ngIf",t.hasActions)}}function Jd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).processInstallment(o)}),e._UZ(1,"icon",41),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("tooltip",t.i18n.transaction.processInstallment),e.xp6(1),e.Q6J("icon",t.SvgIcon.Play)}}const Ld=function(n){return{"ml-2":n}};function kd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).settleInstallment(o)}),e._UZ(1,"icon",41),e.qZA()}if(2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("tooltip",i.i18n.transaction.settleInstallment)("ngClass",e.VKq(3,Ld,t.canProcess)),e.xp6(1),e.Q6J("icon",i.SvgIcon.Check2)}}function Fd(n,a){if(1&n&&(e.TgZ(0,"td",37),e.YNc(1,Jd,2,2,"button",38),e.YNc(2,kd,2,5,"button",39),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.canProcess),e.xp6(1),e.Q6J("ngIf",t.canSettle)}}const Mt=function(n){return{"cursor-pointer":n}};function Od(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.path(r)?l.router.navigate(l.path(r)):null}),e.TgZ(1,"td")(2,"maybe-link",34),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"maybe-link",34),e._uU(6),e.ALo(7,"date"),e.qZA()(),e.TgZ(8,"td")(9,"maybe-link",34),e._uU(10),e.qZA()(),e.TgZ(11,"td",35)(12,"maybe-link",34),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.YNc(15,Fd,3,2,"td",36),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(15,Mt,i.path(t))),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",t.number," "),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",e.lcZ(7,10,t.dueDate)," "),e.xp6(3),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",i.installmentStatus(t.status)," "),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",e.xi3(14,12,t.amount,i.transaction.currency)," "),e.xp6(2),e.Q6J("ngIf",i.hasActions)}}function Dd(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",27),e._uU(2),e.qZA(),e.TgZ(3,"table",28),e.YNc(4,Id,10,5,"thead",10),e.ALo(5,"async"),e.TgZ(6,"tbody"),e.YNc(7,Od,16,17,"tr",29),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.transaction.installments),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,3,t.layout.gtxs$)),e.xp6(3),e.Q6J("ngForOf",t.transaction.installments)}}function Rd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",46),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).addReceiverToContacts()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.transaction.doneAddReceiverToContacts)}}function Vd(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"actions",43)(2,"action-button",44),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).navigateToPerformNew()}),e.qZA(),e.YNc(3,Rd,1,1,"action-button",45),e.ALo(4,"async"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.transaction.doneNew),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,2,t.canAddReceiverToContacts$))}}function Yd(n,a){1&n&&e._UZ(0,"th",32)}function Ed(n,a){if(1&n&&(e.TgZ(0,"thead")(1,"th"),e._uU(2),e.qZA(),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th",35),e._uU(8),e.qZA(),e.YNc(9,Yd,1,0,"th",31),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.Oqu(t.i18n.transaction.installmentNumber),e.xp6(2),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(1),e.Q6J("ngIf",t.hasActions)}}function $d(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).processOccurrence(o)}),e._UZ(1,"icon",41),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("tooltip",t.i18n.transaction.processFailedOccurrence),e.xp6(1),e.Q6J("icon",t.SvgIcon.Play)}}function Bd(n,a){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,$d,2,2,"button",38),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.canProcess)}}function Hd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",33),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.path(r)?l.router.navigate(l.path(r)):null}),e.TgZ(1,"td")(2,"maybe-link",34),e._uU(3),e.qZA()(),e.TgZ(4,"td")(5,"maybe-link",34),e._uU(6),e.ALo(7,"date"),e.qZA()(),e.TgZ(8,"td")(9,"maybe-link",34),e._uU(10),e.qZA()(),e.TgZ(11,"td",35)(12,"maybe-link",34),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.YNc(15,Bd,2,1,"td",31),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(15,Mt,i.path(t))),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",t.number," "),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",e.lcZ(7,10,t.dueDate)," "),e.xp6(3),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",i.installmentStatus(t.status)," "),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",e.xi3(14,12,t.amount,i.transaction.currency)," "),e.xp6(2),e.Q6J("ngIf",i.hasActions)}}function jd(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",27),e._uU(2),e.qZA(),e.TgZ(3,"table",47),e.YNc(4,Ed,10,5,"thead",10),e.ALo(5,"async"),e.TgZ(6,"tbody"),e.YNc(7,Hd,16,17,"tr",29),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.transaction.occurrences," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,3,t.layout.gtxs$)),e.xp6(3),e.Q6J("ngForOf",t.transaction.occurrences)}}function Md(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw().$implicit;e.Q6J("user",t.from.user)}}function zd(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw().$implicit;e.hij(" ",t.from.type.name," ")}}function Gd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.transaction.fromAccount),e.xp6(1),e.hij(" ",t.from.number," ")}}function Wd(n,a){if(1&n&&e._UZ(0,"user-link",16),2&n){const t=e.oxw().$implicit;e.Q6J("user",t.to.user)}}function Xd(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw().$implicit;e.hij(" ",t.to.type.name," ")}}function Kd(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.transaction.toAccount),e.xp6(1),e.hij(" ",t.to.number," ")}}function ef(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"label-value",8),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.TgZ(6,"label-value",8),e._uU(7),e.qZA(),e.TgZ(8,"label-value",8),e.YNc(9,Md,1,1,"user-link",20),e.YNc(10,zd,1,1,"ng-template",null,50,e.W1O),e.qZA(),e.YNc(12,Gd,2,2,"label-value",9),e.TgZ(13,"label-value",8),e.YNc(14,Wd,1,1,"user-link",20),e.YNc(15,Xd,1,1,"ng-template",null,51,e.W1O),e.qZA(),e.YNc(17,Kd,2,2,"label-value",9),e.BQk()),2&n){const t=a.$implicit,i=e.MAs(11),o=e.MAs(16),r=e.oxw(3);e.xp6(2),e.Oqu(t.fee.name),e.xp6(1),e.Q6J("label",r.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(5,13,t.amount,t.currency)," "),e.xp6(2),e.Q6J("label",r.i18n.transaction.type),e.xp6(1),e.hij(" ",t.type.name," "),e.xp6(1),e.Q6J("label",r.i18n.transaction.from),e.xp6(1),e.Q6J("ngIf",t.from.user)("ngIfElse",i),e.xp6(3),e.Q6J("ngIf",null==t.from?null:t.from.number),e.xp6(1),e.Q6J("label",r.i18n.transaction.to),e.xp6(1),e.Q6J("ngIf",t.to.user)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",null==t.to?null:t.to.number)}}function tf(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",48),e._uU(2),e.qZA(),e.YNc(3,ef,18,16,"ng-container",49),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.transaction.feesOnAuthorization," "),e.xp6(1),e.Q6J("ngForOf",t.transaction.feesOnAuthorization.fees)}}const qt=function(){return[]};function nf(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._uU(1),e.qZA(),e.YNc(2,$m,2,2,"label-value",9),e.TgZ(3,"label-value",8),e._uU(4),e.ALo(5,"currency"),e.qZA(),e.YNc(6,Bm,3,5,"label-value",9),e.YNc(7,Hm,2,2,"label-value",9),e.YNc(8,jm,2,2,"label-value",9),e.YNc(9,Mm,2,2,"label-value",9),e.YNc(10,zm,3,4,"label-value",9),e.YNc(11,Gm,3,5,"label-value",9),e.YNc(12,Wm,3,4,"label-value",9),e.YNc(13,Xm,2,2,"label-value",9),e.YNc(14,Km,2,2,"label-value",9),e.TgZ(15,"label-value",8),e._uU(16),e.ALo(17,"dateTime"),e.qZA(),e.YNc(18,ed,3,4,"label-value",9),e.YNc(19,td,3,4,"label-value",9),e.YNc(20,sd,6,5,"ng-container",10),e.YNc(21,cd,1,0,"ng-container",11),e.YNc(22,ld,1,0,"ng-container",11),e.YNc(23,hd,3,2,"ng-template",null,12,e.W1O),e.YNc(25,wd,3,2,"ng-template",null,13,e.W1O),e.YNc(27,Cd,2,2,"label-value",9),e.TgZ(28,"label-value",8),e._uU(29),e.qZA(),e.YNc(30,Ad,2,2,"label-value",9),e.YNc(31,Zd,2,2,"label-value",9),e.YNc(32,Pd,3,3,"label-value",9),e.YNc(33,qd,1,1,"custom-field-value",14),e.YNc(34,Sd,1,2,"label-value",15),e.YNc(35,Qd,1,2,"label-value",15),e.YNc(36,Ud,1,2,"label-value",15),e.YNc(37,Dd,8,5,"ng-container",10),e.YNc(38,Vd,5,4,"ng-container",10),e.YNc(39,jd,8,5,"ng-container",10),e.YNc(40,tf,4,2,"ng-container",10)),2&n){const t=e.MAs(24),i=e.MAs(26),o=e.oxw();e.Q6J("label",o.i18n.general.status),e.xp6(1),e.hij(" ",o.status," "),e.xp6(1),e.Q6J("ngIf","pending"===o.transaction.authorizationStatus),e.xp6(1),e.Q6J("label",o.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(5,35,(null==o.transaction.feesOnAuthorization?null:o.transaction.feesOnAuthorization.mainAmount)||o.transaction.amount,o.transaction.currency)," "),e.xp6(2),e.Q6J("ngIf",o.transaction.feesOnAuthorization&&o.transaction.feesOnAuthorization.mainAmount!=o.transaction.feesOnAuthorization.totalAmount),e.xp6(1),e.Q6J("ngIf","recurringPayment"===o.transaction.kind),e.xp6(1),e.Q6J("ngIf","recurringPayment"===o.transaction.kind&&o.transaction.occurrencesCount),e.xp6(1),e.Q6J("ngIf","recurringPayment"===o.transaction.kind&&o.transaction.occurrenceInterval),e.xp6(1),e.Q6J("ngIf",o.transaction.nextOccurrenceDate),e.xp6(1),e.Q6J("ngIf",o.hasDueAmount),e.xp6(1),e.Q6J("ngIf",1===(o.transaction.installments||e.DdM(40,qt)).length),e.xp6(1),e.Q6J("ngIf",o.transaction.by),e.xp6(1),e.Q6J("ngIf",null==o.transaction?null:o.transaction.receivedBy),e.xp6(1),e.Q6J("label",o.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(17,38,o.transaction.date)," "),e.xp6(2),e.Q6J("ngIf",o.transaction.expirationDate&&!o.transaction.processDate),e.xp6(1),e.Q6J("ngIf",o.transaction.processDate),e.xp6(1),e.Q6J("ngIf","paymentRequest"===o.transaction.kind&&"denied"!==o.transaction.paymentRequestStatus&&"processed"!==o.transaction.paymentRequestStatus),e.xp6(1),e.Q6J("ngTemplateOutlet",o.isPaymentRequest()?i:t),e.xp6(1),e.Q6J("ngTemplateOutlet",o.isPaymentRequest()?t:i),e.xp6(5),e.Q6J("ngIf",o.transaction.toPrincipalType),e.xp6(1),e.Q6J("label",o.i18n.transaction.type),e.xp6(1),e.hij(" ",o.transaction.type.name," "),e.xp6(1),e.Q6J("ngIf",o.transaction.channel),e.xp6(1),e.Q6J("ngIf",o.transaction.transactionNumber),e.xp6(1),e.Q6J("ngIf",o.transaction.transaction),e.xp6(1),e.Q6J("ngForOf",o.transaction.customValues),e.xp6(1),e.Q6J("ngIf",o.transaction.description),e.xp6(1),e.Q6J("ngIf",o.lastAuthComment),e.xp6(1),e.Q6J("ngIf",o.transaction.comments),e.xp6(1),e.Q6J("ngIf",(o.transaction.installments||e.DdM(41,qt)).length>1),e.xp6(1),e.Q6J("ngIf",o.showNewPaymentButton()),e.xp6(1),e.Q6J("ngIf",(o.transaction.occurrences||e.DdM(42,qt)).length>0),e.xp6(1),e.Q6J("ngIf",(null==o.transaction.feesOnAuthorization||null==o.transaction.feesOnAuthorization.fees?null:o.transaction.feesOnAuthorization.fees.length)>0)}}let of=(()=>{class n extends nt.k{constructor(t,i,o,r,l,_,g,P,S,I,Ae,X,ie){super(t),this.transactionsService=i,this.installmentsService=o,this.pendingPaymentsService=r,this.scheduledPaymentsService=l,this.recurringPaymentsService=_,this.paymentRequestsService=g,this.externalPaymentsService=P,this.contactService=S,this.bankingHelper=I,this.transfersService=Ae,this.runOperationHelper=X,this.modal=ie,this.hasDueAmount=!1,this.hasActions=!1}get status(){return this.apiI18n.transactionStatus(this.transaction)}get transaction(){return this.data}get key(){return this.route.snapshot.paramMap.get("key")}ngOnInit(){super.ngOnInit(),this.addSub(this.transactionsService.viewTransaction({key:this.key}).subscribe(t=>{[this.title,this.mobileTitle]=this.titles(t.kind),this.headingActions=this.initActions(t),this.hasDueAmount=t.dueAmount&&!this.format.isZero(t.dueAmount),this.hasActions=!!(t.installments||t.occurrences||[]).find(i=>i.canProcess||i.canSettle),this.data=t,t.transfer&&(t.transfer.transaction=t),(0,h.cS)(t.authorizations)||(this.lastAuthComment=t.authorizations[0].comments),this.canAddReceiverToContacts$=new y.X(t.usersWhichCanAddToContacts===Oe.TO||t.usersWhichCanAddToContacts===Oe.BOTH)}))}initActions(t){var i,o,r,l,_;const g=this.exportHelper.headingActions(t.exportFormats,X=>this.transactionsService.exportTransaction$Response({format:X.internalName,key:t.id})),P=t.authorizationPermissions||{};(0,h.cS)(t.authorizations)||g.push(new T.Yu(x.l.CheckCircle,this.i18n.transaction.viewAuthorizations,()=>this.router.navigate(["/banking","transaction",this.key,"authorization-history"]))),P.authorize&&g.push(new T.Yu(x.l.HandThumbsUp,this.i18n.transaction.authorizePending,()=>this.authorize())),P.deny&&g.push(new T.Yu(x.l.HandThumbsDown,this.i18n.transaction.denyPending,()=>this.deny())),P.cancel&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.cancelAuthorization,()=>this.cancelAuthorization()));const S=t.scheduledPaymentPermissions||{};S.block&&g.push(new T.Yu(x.l.CalendarX,this.i18n.transaction.blockScheduling,()=>this.blockScheduled())),S.unblock&&g.push(new T.Yu(x.l.CalendarCheck,this.i18n.transaction.unblockScheduling,()=>this.unblockScheduled())),S.cancel&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.cancelScheduled,()=>this.cancelScheduled())),S.settle&&g.push(new T.Yu(x.l.Check2All,this.i18n.transaction.settleScheduled,()=>this.settleScheduled())),t.kind===G.w.SCHEDULED_PAYMENT&&1===t.installments.length&&t.installments[0].canProcess&&g.push(new T.Yu(x.l.FilePlay,this.i18n.transaction.processScheduled,()=>this.processScheduled(t.installments[0]))),(null===(i=t.recurringPaymentPermissions)||void 0===i?void 0:i.edit)&&g.push(new T.Yu(x.l.Pencil,this.i18n.transaction.editRecurring,()=>this.editRecurring())),(null===(o=t.recurringPaymentPermissions)||void 0===o?void 0:o.cancel)&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.cancelRecurring,()=>this.cancelRecurring())),(null===(r=t.recurringPaymentPermissions)||void 0===r?void 0:r.block)&&g.push(new T.Yu(x.l.CalendarCheck,this.i18n.transaction.blockRecurring,()=>this.blockRecurring())),(null===(l=t.recurringPaymentPermissions)||void 0===l?void 0:l.unblock)&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.unblockRecurring,()=>this.unblockRecurring()));const I=t.paymentRequestPermissions||{};I.accept&&g.push(new T.Yu(x.l.HandThumbsUp,this.i18n.transaction.acceptPaymentRequest,()=>this.acceptPaymentRequest())),I.reject&&g.push(new T.Yu(x.l.HandThumbsDown,this.i18n.transaction.rejectPaymentRequest,()=>this.rejectPaymentRequest())),I.cancel&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.cancelPaymentRequest,()=>this.cancelPaymentRequest())),I.reschedule&&g.push(new T.Yu(x.l.CalendarEvent,this.i18n.transaction.reschedulePaymentRequest,()=>this.reschedulePaymentRequest())),I.changeExpiration&&g.push(new T.Yu(x.l.CalendarEvent,this.i18n.transaction.changePaymentRequestExpiration,()=>this.changePaymentRequestExpiration())),(t.externalPaymentPermissions||{}).cancel&&g.push(new T.Yu(x.l.XCircle,this.i18n.transaction.cancelExternalPayment,()=>this.cancelExternalPayment())),(null===(_=t.transfer)||void 0===_?void 0:_.canChargeback)&&g.push(new T.Yu(x.l.ArrowCounterclockwise,this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const X of(t.transfer||{}).operations||[])g.push(this.runOperationHelper.headingAction(X,t.transfer.id));return g}get authorizer(){var t,i,o,r=this.transaction.authorizationType;if(null!=r)switch(r){case it.OPERATOR:var l=this.transaction.from;if(null!=l&&l.user)return this.i18n.transaction.awaitingAuthorizationByOperatorOwner(l.user.display);break;case it.LEVEL:var _=this.transaction.authorizationLevelData;if(_.allowPayer&&(null===(t=this.transaction.from)||void 0===t?void 0:t.user))return this.i18n.transaction.awaitingAuthorizationByPayer;if(_.allowReceiver&&(null===(i=this.transaction.to)||void 0===i?void 0:i.user))return this.i18n.transaction.awaitingAuthorizationByReceiver;if(_.allowBroker)return(null===(o=_.brokers)||void 0===o?void 0:o.length)>0?this.i18n.transaction.awaitingAuthorizationByBroker:this.i18n.transaction.awaitingAuthorizationByMissingBroker;if(_.allowAdmin)return this.i18n.transaction.awaitingAuthorizationByAdmin}return""}get authorizationFields(){return[{internalName:"comments",name:this.i18n.general.comments,type:W.L.TEXT}]}authDeviceConfirmation(t){return()=>({type:U.l.MANAGE_AUTHORIZATION,transaction:this.transaction.id,authorizationAction:t})}authorize(){this.confirmation.confirm({title:this.i18n.transaction.authorizePending,labelPosition:"above",customFields:this.authorizationFields,passwordInput:this.transaction.confirmationPasswordInput,createDeviceConfirmation:this.authDeviceConfirmation($e.AUTHORIZE),callback:t=>{this.addSub(this.pendingPaymentsService.authorizePendingPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe(i=>{i?this.notification.warning(this.i18n.transaction.authorizePendingDoneStillPending):this.notification.snackBar(this.i18n.transaction.authorizePendingDone),this.reload()}))}})}deny(){this.confirmation.confirm({title:this.i18n.transaction.denyPending,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation($e.DENY),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.pendingPaymentsService.denyPendingPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.denyPendingDone)))}})}cancelAuthorization(){this.confirmation.confirm({title:this.i18n.transaction.cancelAuthorization,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation($e.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.pendingPaymentsService.cancelPendingPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelAuthorizationDone)))}})}schedDeviceConfirmation(t){return()=>({type:U.l.MANAGE_SCHEDULED_PAYMENT,transaction:this.transaction.id,scheduledPaymentAction:t})}blockScheduled(){this.confirmation.confirm({title:this.i18n.transaction.blockScheduling,message:this.i18n.transaction.blockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(De.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.scheduledPaymentsService.blockScheduledPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.blockSchedulingDone)))}})}unblockScheduled(){this.confirmation.confirm({title:this.i18n.transaction.unblockScheduling,message:this.i18n.transaction.unblockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(De.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.scheduledPaymentsService.unblockScheduledPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.unblockSchedulingDone)))}})}blockRecurring(){this.confirmation.confirm({title:this.i18n.transaction.blockRecurring,message:this.i18n.transaction.blockRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(ke.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.recurringPaymentsService.blockRecurringPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.blockRecurringDone)))}})}unblockRecurring(){this.confirmation.confirm({title:this.i18n.transaction.unblockRecurring,message:this.i18n.transaction.unblockRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(ke.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.recurringPaymentsService.unblockRecurringPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.unblockRecurringDone)))}})}cancelScheduled(){this.confirmation.confirm({title:this.i18n.transaction.cancelScheduled,message:this.i18n.transaction.cancelScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(De.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.scheduledPaymentsService.cancelScheduledPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelScheduledDone)))}})}settleScheduled(){this.confirmation.confirm({title:this.i18n.transaction.settleScheduled,message:this.i18n.transaction.settleScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(De.SETTLE),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.scheduledPaymentsService.settleScheduledPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleScheduledDone)))}})}recurringDeviceConfirmation(t){return()=>({type:U.l.MANAGE_RECURRING_PAYMENT,transaction:this.transaction.id,recurringPaymentAction:t})}cancelRecurring(){this.confirmation.confirm({title:this.i18n.transaction.cancelRecurring,message:this.i18n.transaction.cancelRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(ke.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.recurringPaymentsService.cancelRecurringPayment({key:this.transaction.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelRecurringDone)))}})}editRecurring(){this.router.navigate(["/banking","edit-recurring-payment",this.data.id])}paymentRequestDeviceConfirmation(t){return()=>({type:U.l.MANAGE_PAYMENT_REQUEST,transaction:this.transaction.id,paymentRequestAction:t})}externalPaymentDeviceConfirmation(t){return()=>({type:U.l.MANAGE_EXTERNAL_PAYMENT,transaction:this.transaction.id,externalPaymentAction:t})}cancelPaymentRequest(){this.confirmation.confirm({title:this.i18n.transaction.cancelPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(Ue.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,labelPosition:"above",customFields:[{internalName:"comments",name:this.i18n.general.comments,type:W.L.TEXT}],callback:t=>{this.addSub(this.paymentRequestsService.cancelPaymentRequest({key:this.transaction.id,body:t.customValues.comments,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelPaymentRequestDone)))}})}rejectPaymentRequest(){this.confirmation.confirm({title:this.i18n.transaction.rejectPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(Ue.DENY),passwordInput:this.transaction.confirmationPasswordInput,labelPosition:"above",customFields:[{internalName:"comments",name:this.i18n.general.comments,type:W.L.TEXT}],callback:t=>{this.addSub(this.paymentRequestsService.rejectPaymentRequest({key:this.transaction.id,body:t.customValues.comments,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.rejectPaymentRequestDone)))}})}changePaymentRequestExpiration(){this.confirmation.confirm({title:this.i18n.transaction.changePaymentRequestExpiration,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(Ue.CHANGE_EXPIRATION),passwordInput:this.transaction.confirmationPasswordInput,labelPosition:"above",customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:W.L.DATE,required:!0},{internalName:"comments",defaultValue:this.data.changeExpirationDateComments,name:this.i18n.general.comments,type:W.L.TEXT}],callback:t=>{this.addSub(this.paymentRequestsService.changePaymentRequestExpirationDate({key:this.transaction.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,newExpirationDate:b.S.shiftToDayEnd(t.customValues.expiry)}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.changePaymentRequestExpirationDone)))}})}reschedulePaymentRequest(){const t=this.modal.show($p,{class:"modal-form",initialState:{transaction:this.transaction,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(Ue.RESCHEDULE)}});this.addSub(t.content.done.subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.reschedulePaymentRequestDone)))}acceptPaymentRequest(){this.router.navigate(["/banking","payment-request",this.data.id,"accept"])}cancelExternalPayment(){this.confirmation.confirm({title:this.i18n.transaction.cancelExternalPayment,createDeviceConfirmation:this.externalPaymentDeviceConfirmation(dt.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,labelPosition:"above",customFields:[{internalName:"comments",name:this.i18n.general.comments,type:W.L.TEXT}],callback:t=>{this.addSub(this.externalPaymentsService.cancelExternalPayment({key:this.transaction.id,body:t.customValues.comments,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelExternalPaymentDone)))}})}chargebackDeviceConfirmation(){return()=>({type:U.l.CHARGEBACK,transfer:this.transaction.transfer.id})}chargeback(){this.confirmation.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transaction.transfer.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.chargebackTransferDone)))}})}titles(t){switch(t){case G.w.SCHEDULED_PAYMENT:return[this.i18n.transaction.title.detailsScheduled,this.i18n.transaction.mobileTitle.detailsScheduled];case G.w.RECURRING_PAYMENT:return[this.i18n.transaction.title.detailsRecurring,this.i18n.transaction.mobileTitle.detailsRecurring];case G.w.PAYMENT_REQUEST:return[this.i18n.transaction.title.detailsRequest,this.i18n.transaction.mobileTitle.detailsRequest];case G.w.CHARGEBACK:return[this.i18n.transaction.title.detailsChargeback,this.i18n.transaction.mobileTitle.detailsChargeback];case G.w.TICKET:return[this.i18n.transaction.title.detailsTicket,this.i18n.transaction.mobileTitle.detailsTicket];case G.w.EXTERNAL_PAYMENT:return[this.i18n.transaction.title.detailsExternal,this.i18n.transaction.mobileTitle.detailsExternal];default:return[this.i18n.transaction.title.detailsPayment,this.i18n.transaction.mobileTitle.detailsPayment]}}installmentStatus(t){return this.apiI18n.installmentStatus(t)}path(t){const i=t.transferTransactionNumber||t.transferId;if(i)return["/banking","transfer",i]}installmentDeviceConfirmation(t,i){return()=>({type:U.l.MANAGE_INSTALLMENT,installment:i.id,installmentAction:t})}settleInstallment(t){this.confirmation.confirm({title:this.i18n.transaction.settleInstallment,message:this.i18n.transaction.settleInstallmentMessage(String(t.number)),createDeviceConfirmation:this.installmentDeviceConfirmation(Be.SETTLE,t),passwordInput:this.transaction.confirmationPasswordInput,callback:i=>{this.addSub(this.installmentsService.settleInstallment({key:t.id,confirmationPassword:i.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleInstallmentDone)))}})}isScheduledPayment(){return this.data.kind===G.w.SCHEDULED_PAYMENT}isPaymentRequest(){return this.data.kind===G.w.PAYMENT_REQUEST}isExternalPayment(){return this.data.kind===G.w.EXTERNAL_PAYMENT}processInstallment(t){this.confirmation.confirm({title:this.i18n.transaction.processInstallment,message:this.i18n.transaction.processInstallmentMessage(t.number),createDeviceConfirmation:this.installmentDeviceConfirmation(Be.PROCESS,t),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(t.id,this.i18n.transaction.processInstallmentDone)})}processOccurrence(t){this.confirmation.confirm({title:this.i18n.transaction.processFailedOccurrence,message:this.i18n.transaction.processFailedOccurrenceMessage(t.number),createDeviceConfirmation:this.failedOccurreneceDeviceConfirmation(ft.PROCESS,t),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(t.id,this.i18n.transaction.processFailedOccurrenceDone)})}processScheduled(t){this.confirmation.confirm({title:this.i18n.transaction.processScheduled,message:this.i18n.transaction.processScheduledMessage,createDeviceConfirmation:this.installmentDeviceConfirmation(Be.PROCESS,t),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(t.id,this.i18n.transaction.processScheduledDone)})}processCallback(t,i){return o=>this.addSub(this.installmentsService.processInstallment({key:t,confirmationPassword:o.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(i)))}sendNotificationAndReload(t){this.notification.snackBar(t),this.reload()}failedOccurreneceDeviceConfirmation(t,i){return()=>({type:U.l.MANAGE_FAILED_OCCURRENCE,failedOccurrence:i.id,failedOccurrenceAction:t})}resolveLastPaymentNotificationType(){return this.transaction.authorizationStatus===Ne.s.PENDING?"warning":"info"}resolveLastPaymentNotificationMessage(){return this.transaction.paymentRequestStatus===Fe.W.OPEN?this.i18n.transaction.paymentRequestSent:this.transaction.paymentRequestStatus!==Fe.W.PROCESSED&&this.transaction.paymentRequestStatus!==Fe.W.SCHEDULED||!this.transaction.processDate?this.transaction.externalPaymentStatus===et.f.PENDING?this.i18n.transaction.externalPaymentPerformed:this.transaction.authorizationStatus===Ne.s.PENDING?this.i18n.transaction.pending:this.i18n.transaction.processed:this.i18n.transaction.paymentRequestAcceptScheduled(this.format.formatAsDate(this.transaction.processDate))}resolveLastPaymentNotificationIcon(){return this.transaction.authorizationStatus===Ne.s.PENDING?x.l.Clock:x.l.Check2}showNewPaymentButton(){return history.state.url}showDoneMessage(){return history.state.url||history.state.showDoneMessage}navigateToPerformNew(){this.router.navigateByUrl(history.state.url)}addUserToContacts(t){this.addSub(this.contactService.createContact({user:b.S.SELF,body:{contact:t.id}}).subscribe(()=>{this.notification.info(this.i18n.transaction.doneUserAddedToContacts(t.display)),this.canAddReceiverToContacts$.next(!1)}))}addReceiverToContacts(){this.addUserToContacts(this.transaction.to.user)}resolveMenu(t){return this.menu.accountMenu(t.from,t.to)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(pt),e.Y36(At),e.Y36(Bp),e.Y36(Hp),e.Y36(Et),e.Y36(We),e.Y36(xt),e.Y36(Bt.P),e.Y36(N.J),e.Y36(Zt),e.Y36(Ht.Y),e.Y36(He.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-transaction"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["transactionFields",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],["class","mb-3",3,"type","icon",4,"ngIf"],[3,"transfer","usersWhichCanAddToContacts",4,"ngIf","ngIfElse"],[1,"mb-3",3,"type","icon"],[3,"transfer","usersWhichCanAddToContacts"],[3,"label"],[3,"label",4,"ngIf"],[4,"ngIf"],[4,"ngTemplateOutlet"],["transactionFromOrReceiver",""],["transactionToOrSender",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[3,"user"],[3,"label",4,"ngIf","ngIfElse"],["transactionFrom",""],[3,"user","display"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],["transactionTo",""],["toSystem",""],[3,"routerLink"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"border-0","mt-4"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"amount"],["class","actions",4,"ngIf"],[1,"actions"],[3,"ngClass","click"],[3,"link"],[1,"text-right"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["type","button","class","btn btn-icon align-items-center",3,"tooltip","click",4,"ngIf"],["type","button","class","btn btn-icon align-items-center",3,"tooltip","ngClass","click",4,"ngIf"],["type","button",1,"btn","btn-icon","align-items-center",3,"tooltip","click"],[3,"icon"],["type","button",1,"btn","btn-icon","align-items-center",3,"tooltip","ngClass","click"],["forceRow",""],[3,"label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"table","table-hover","cursor-pointer"],[1,"border-0","mt-4","mb-0"],[4,"ngFor","ngForOf"],["feeFromSystem",""],["feeToSystem",""]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Em,4,8,"page-content",1),e.qZA(),e.YNc(3,nf,41,43,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,Ee.c,jt,C.t,Q.F,u.tP,ce.yS,u.sg,Qe.W,u.mk,Pt.O,Xe.i9,lt.o,L.h,k.x],pipes:[u.Ov,w.H,E.u,Ce.i,Rm.i],encapsulation:2,changeDetection:0}),n})();var _t=(()=>{return(n=_t||(_t={})).AMOUNT_ASC="amountAsc",n.AMOUNT_DESC="amountDesc",n.DATE_ASC="dateAsc",n.DATE_DESC="dateDesc",_t;var n})(),af=m(1750);function rf(n,a){1&n&&e.GkF(0)}function sf(n,a){if(1&n&&e._UZ(0,"field-option",16),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t)("text",t.name)}}function cf(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"single-selection-field",14),e.YNc(2,sf,1,3,"field-option",15),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.period),e.xp6(1),e.Q6J("ngForOf",t.data.preselectedPeriods)}}function lf(n,a){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"date-field",17),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.beginDate)("minDate",t.data.archivingDate)}}function uf(n,a){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"date-field",18),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.endDate)("minDate",t.data.archivingDate)}}function pf(n,a){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function mf(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"multi-selection-field",19),e.YNc(2,pf,1,5,"field-option",20),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function df(n,a){if(1&n&&e._UZ(0,"field-option",24),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function ff(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"single-selection-field",22),e.YNc(2,df,1,2,"field-option",23),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.currency)("emptyOption",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.currencies)}}function _f(n,a){if(1&n&&e._UZ(0,"field-option",42),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function hf(n,a){if(1&n&&e._UZ(0,"field-option",42),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function gf(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",8),e.TgZ(2,"div",13)(3,"single-selection-field",39),e.YNc(4,_f,1,4,"field-option",40),e.qZA()(),e.TgZ(5,"div",13)(6,"single-selection-field",41),e.YNc(7,hf,1,4,"field-option",40),e.qZA()(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.transaction.fromAccount),e.xp6(1),e.Q6J("ngForOf",t.accountTypes()),e.xp6(2),e.Q6J("emptyOption",t.i18n.general.notApplied)("label",t.i18n.transaction.toAccount),e.xp6(1),e.Q6J("ngForOf",t.accountTypes())}}function yf(n,a){if(1&n&&e._UZ(0,"field-option",45),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)("category",i.singleAccount||null==t.accountType?null:t.accountType.name)}}function xf(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"multi-selection-field",43),e.YNc(2,yf,1,5,"field-option",44),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.account.transferFilter),e.xp6(1),e.Q6J("ngForOf",t.transferFilters())}}function bf(n,a){if(1&n&&e._UZ(0,"field-option",48),2&n){const t=a.$implicit;e.Q6J("id",t.id)("internalName",t.internalName)("value",t.internalName)("text",t.name)}}function vf(n,a){if(1&n&&(e.TgZ(0,"div",13)(1,"multi-selection-field",46),e.YNc(2,bf,1,4,"field-option",47),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.transaction.channel),e.xp6(1),e.Q6J("ngForOf",t.data.channels)}}function Tf(n,a){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"input-field",49),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("mask",t.transactionNumberPattern)("label",t.i18n.transaction.number)}}function wf(n,a){if(1&n&&(e.TgZ(0,"div",13),e._UZ(1,"custom-field-filter",50),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function Cf(n,a){if(1&n&&(e.ynx(0),e.YNc(1,gf,8,6,"ng-container",9),e.YNc(2,xf,3,3,"div",7),e.YNc(3,vf,3,3,"div",7),e.TgZ(4,"div",13),e._UZ(5,"decimal-field",25),e.qZA(),e.TgZ(6,"div",13),e._UZ(7,"decimal-field",26),e.qZA(),e.TgZ(8,"div",13),e._UZ(9,"user-field",27),e.qZA(),e.YNc(10,Tf,2,2,"div",7),e.TgZ(11,"div",13),e._UZ(12,"user-field",28),e.qZA(),e.TgZ(13,"div",13),e._UZ(14,"multi-selection-field",29),e.qZA(),e.TgZ(15,"div",13)(16,"single-selection-field",30),e._UZ(17,"field-option",31)(18,"field-option",32),e.qZA()(),e.YNc(19,wf,2,2,"div",33),e.TgZ(20,"div",13)(21,"single-selection-field",34),e._UZ(22,"field-option",35)(23,"field-option",36)(24,"field-option",37)(25,"field-option",38),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>1),e.xp6(1),e.Q6J("ngIf",t.transferFilters().length>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.channels?null:t.data.channels.length)>1),e.xp6(2),e.Q6J("label",t.i18n.account.minAmount)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("label",t.i18n.account.maxAmount)("scale",t.currencyDecimalDigits())("prefix",t.currencyPrefix())("suffix",t.currencySuffix()),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("ngIf",t.hasTransactionNumber),e.xp6(2),e.Q6J("label",t.i18n.general.usersOfBroker)("filters",t.userSearchFilters())("allowContacts",!1),e.xp6(2),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.transaction.transferKinds)("fieldOptions",t.kindOptions),e.xp6(2),e.Q6J("label",t.i18n.transaction.chargedBack)("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("text",t.i18n.general.yes),e.xp6(1),e.Q6J("text",t.i18n.general.no),e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch),e.xp6(2),e.Q6J("label",t.i18n.general.orderBy),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.dateDesc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.dateAsc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.amountAsc),e.xp6(1),e.Q6J("text",t.i18n.account.orderBy.amountDesc)}}const Af=function(n,a){return{from:n,to:a}};function Zf(n,a){if(1&n&&(e.TgZ(0,"mobile-result",51)(1,"div",52),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);let o;e.Q6J("date",t.date)("amount",t.amount)("currency",t.currency),e.xp6(2),e.hij(" ",i.i18n.transaction.fromToText(e.WLB(4,Af,null!==(o=t.fromName)&&void 0!==o?o:i.bankingHelper.ownerName(t.from),null!==(o=t.toName)&&void 0!==o?o:i.bankingHelper.ownerName(t.to))),"")}}function Pf(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function qf(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",58),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("fields",o.fieldsInList)("plainText",!0)("fieldName",t.internalName)("object",i)}}function Sf(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",56),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(2,"td")(3,"a",57),e._uU(4),e.ALo(5,"date"),e.qZA()(),e.TgZ(6,"td")(7,"a",57),e._uU(8),e.qZA()(),e.TgZ(9,"td")(10,"a",57),e._uU(11),e.qZA()(),e.YNc(12,qf,2,4,"td",54),e.TgZ(13,"td",55)(14,"a",57),e._uU(15),e.ALo(16,"currency"),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);let o,r;e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",e.lcZ(5,9,t.date)," "),e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",null!==(o=t.fromName)&&void 0!==o?o:i.bankingHelper.ownerName(t.from)," "),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",null!==(r=t.toName)&&void 0!==r?r:i.bankingHelper.ownerName(t.to)," "),e.xp6(1),e.Q6J("ngForOf",i.fieldsInList),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",e.xi3(16,11,i.format.abs(t.amount),t.currency)," ")}}function Qf(n,a){if(1&n&&(e.TgZ(0,"table",53)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.YNc(8,Pf,2,1,"th",54),e.TgZ(9,"th",55),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,Sf,17,14,"ng-container",54),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.transaction.from),e.xp6(2),e.Oqu(t.i18n.transaction.to),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(13,6,t.results$))?null:i.results)}}function Uf(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"div",5)(3,"div",6),e.YNc(4,cf,3,2,"div",7),e._UZ(5,"div",8),e.YNc(6,lf,2,2,"div",7),e.ALo(7,"async"),e.YNc(8,uf,2,2,"div",7),e.ALo(9,"async"),e.YNc(10,mf,3,3,"div",7),e.YNc(11,ff,3,3,"div",7),e.YNc(12,Cf,26,29,"ng-container",9),e.ALo(13,"async"),e.qZA()()(),e.TgZ(14,"results-layout",10),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(15,"async"),e.YNc(16,Zf,3,7,"mobile-result",11),e.YNc(17,Qf,14,8,"table",12),e.qZA()}if(2&n){const t=e.oxw();let i,o;e.Q6J("heading",t.i18n.transaction.title.transfersOverview)("mobileHeading",t.i18n.transaction.mobileTitle.transfersOverview)("headingActions",e.lcZ(1,13,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>1),e.xp6(2),e.Q6J("ngIf",null==(null==(i=t.form.value||e.lcZ(7,15,t.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.begin)),e.xp6(2),e.Q6J("ngIf",null==(null==(o=t.form.value||e.lcZ(9,17,t.form.valueChanges))||null==o.preselectedPeriod?null:o.preselectedPeriod.end)),e.xp6(2),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.currencies?null:t.currencies.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(13,19,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(15,21,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}function Nf(n,a){1&n&&e._UZ(0,"spinner",59)}let If=(()=>{class n extends ae.t{constructor(t,i,o){super(t),this.transfersService=i,this.bankingHelper=o,this.filters$=new y.X([])}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}getFormControlNames(){return["preselectedPeriod","periodBegin","periodEnd","groups","currency","channels","fromAccountTypes","toAccountTypes","transferFilters","kinds","chargedBack","minAmount","maxAmount","transactionNumber","user","by","orderBy","brokers","customFields"]}getInitialFormValue(t){const i=super.getInitialFormValue(t);return i.orderBy=i.orderBy||_t.DATE_DESC,i}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.transfersService.getTransferDataForSearch()).subscribe(t=>this.data=t)}prepareForm(t){this.fieldsInSearch=t.customFields.filter(i=>t.fieldsInBasicSearch.includes(i.internalName)),this.fieldsInList=t.customFields.filter(i=>t.fieldsInList.includes(i.internalName)),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields))}onDataInitialized(t){super.onDataInitialized(t),this.currencies=[...new Set((t.accountTypes||[]).map(o=>o.currency))].sort((o,r)=>o.name.localeCompare(r.name)),this.singleCurrency=1===(this.currencies||[]).length?this.currencies[0]:null,this.singleAccount=1===(t.accountTypes||[]).length?t.accountTypes[0]:null;const i=this.currencies.map(o=>o.transactionNumberPattern).filter(o=>o).reduce((o,r)=>o.includes(r)?o:[...o,r],[]);this.hasTransactionNumber=i.length>0,this.transactionNumberPattern=1===i.length?i[0]:null,this.bankingHelper.preProcessPreselectedPeriods(t,this.form),this.addSub(this.form.controls.fromAccountTypes.valueChanges.subscribe(o=>this.updateTransferFilters(o))),this.addSub(this.form.controls.currency.valueChanges.subscribe(o=>this.updateAccountTypes(o))),this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(t.exportFormats,o=>this.transfersService.exportTransfers$Response(Object.assign({format:o.internalName},this.toSearchParams(this.form.value)))).forEach(o=>this.headingActions.push(o))}updateTransferFilters(t){const i=this.form.controls.transferFilters.value;t&&i&&this.form.controls.transferFilters.setValue(i.filter(o=>this.data.transferFilters.find(r=>r.id===o).accountType.id===t))}updateAccountTypes(t){const i=this.form.controls.fromAccountTypes.value,o=this.form.controls.toAccountTypes.value;if(t&&i){const r=this.data.accountTypes.find(l=>l.id===i).currency;this.form.controls.fromAccountTypes.setValue(r&&r.id!==t?null:i)}if(t&&o){const r=this.data.accountTypes.find(l=>l.id===o).currency;this.form.controls.toAccountTypes.setValue(r&&r.id!==t?null:o)}}userSearchFilters(){return{roles:[_e.g.BROKER]}}findCurrency(t){var i;if(this.singleCurrency)return this.singleCurrency;const o=this.form.controls.currency.value;if(o)return this.data.currencies.find(l=>l.id===o);const r=this.form.controls.fromAccountTypes.value;return t&&r?null===(i=this.data.accountTypes.find(l=>l.id===r))||void 0===i?void 0:i.currency:null}transferFilters(){const t=this.form.controls.fromAccountTypes.value,i=this.data.transferFilters||[];if(t)return i.filter(o=>o.accountType.id===t);if(this.findCurrency(!0)){const o=this.accountTypes().map(r=>r.id);return i.filter(r=>o.includes(r.accountType.id))}return i}accountTypes(){const t=this.findCurrency(!1),i=this.data.accountTypes||[];return t?i.filter(o=>!o.currency||o.currency.id===t.id):i}currencyDecimalDigits(){const t=this.findCurrency(!0);return t?t.decimalDigits:2}currencyPrefix(){const t=this.findCurrency(!0);return t?t.prefix:null}currencySuffix(){const t=this.findCurrency(!0);return t?t.suffix:null}toSearchParams(t){const i=t;return i.currencies=t.currency?[t.currency]:[],i.datePeriod=this.bankingHelper.resolveDatePeriod(t),i.amountRange=b.S.rangeFilter(t.minAmount,t.maxAmount),i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i.fields=[],t.chargedBack&&(i.chargedBack="yes"===t.chargedBack),i}doSearch(t){return this.transfersService.searchTransfers$Response(t)}get kindOptions(){return Object.values(af.e).map(i=>({value:i,text:this.apiI18n.transferKind(i)}))}path(t){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(t)]}get toLink(){return t=>this.path(t)}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return this.dataForFrontendHolder.role===_e.g.ADMINISTRATOR?v.v2.ADMIN_TRANSFERS_OVERVIEW:v.v2.BROKER_TRANSFERS_OVERVIEW}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Zt),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-transfers-overview"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"w-100","d-none","d-sm-block"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["formControlName","periodBegin","maxDate","todayEnd","fieldSize","full",1,"",3,"label","minDate"],["formControlName","periodEnd","maxDate","todayEnd","fieldSize","full",3,"label","minDate"],["hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","user",3,"label"],["formControlName","brokers",3,"label","filters","allowContacts"],["formControlName","kinds",3,"emptyLabel","label","fieldOptions"],["formControlName","chargedBack",3,"label","emptyOption"],["value","yes",3,"text"],["value","no",3,"text"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["formControlName","fromAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["formControlName","toAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text"],["formControlName","transferFilters",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["formControlName","transactionNumber",3,"mask","label"],["labelPosition","side",3,"field","formControl"],["forceSign","",3,"date","amount","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"amount"],[3,"click"],[3,"routerLink"],[3,"fields","plainText","fieldName","object"],[1,"p-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,rf,1,0,"ng-container",1),e.qZA(),e.YNc(3,Uf,18,23,"ng-template",null,2,e.W1O),e.YNc(5,Nf,1,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,O.f,s.JJ,s.u,u.sg,J.s,j.Q,be.x,B.U,te.l,F.q,fe.h,Ze.L,s.oH,D.D,R.E,V.t,Y.p,ce.yS,ve.x,ne.O],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();function Jf(n,a){if(1&n&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e._UZ(2,"transfer-details",3),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.transaction.title.detailsTransfer)("mobileHeading",t.i18n.transaction.mobileTitle.detailsTransfer)("headingActions",e.lcZ(1,5,t.headingActions$)),e.xp6(2),e.Q6J("headingActions",e.lcZ(3,7,t.headingActions$))("transfer",t.transfer)}}let zt=(()=>{class n extends nt.k{constructor(t,i,o,r){super(t),this.bankingHelper=i,this.transfersService=o,this.runOperationHelper=r}get transfer(){return this.data}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;this.accountId=t.params.account,this.addSub(this.transfersService.viewTransfer({key:t.params.key}).subscribe(i=>{this.headingActions=this.initActions(i),this.data=i}))}initActions(t){const i=this.exportHelper.headingActions(t.exportFormats,r=>this.transfersService.exportTransfer$Response({format:r.internalName,key:t.id})),o=t.transaction||{};(0,h.cS)(o.authorizations)||i.push(new T.Yu(x.l.CheckCircle,this.i18n.transaction.viewAuthorizations,()=>{this.router.navigate(["/banking","transaction",this.bankingHelper.transactionNumberOrId(o),"authorization-history"])})),t.canChargeback&&i.push(new T.Yu(x.l.ArrowCounterclockwise,this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const r of t.operations||[])i.push(this.runOperationHelper.headingAction(r,t.id));return i}chargebackDeviceConfirmation(){return()=>({type:U.l.CHARGEBACK,transfer:this.transfer.id})}chargeback(){this.confirmation.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transfer.confirmationPasswordInput,callback:t=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transfer.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>{this.notification.snackBar(this.i18n.transaction.chargebackTransferDone),this.reload()}))}})}resolveMenu(t){return this.menu.transferMenu(t,this.accountId)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(N.J),e.Y36(Zt),e.Y36(Ht.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-transfer"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"headingActions","transfer"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Jf,4,9,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[A.w,u.O5,Z.Y,jt],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var ht=m(686);let ge=(()=>{class n extends K.b{constructor(t,i){super(t,i)}getGeneralVouchersDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetGeneralVouchersDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getGeneralVouchersDataForSearch(t,i){return this.getGeneralVouchersDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.SearchVouchersPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("amountRange",t.amountRange,{}),o.query("buyer",t.buyer,{}),o.query("buyerGroups",t.buyerGroups,{}),o.query("creationPeriod",t.creationPeriod,{}),o.query("creationType",t.creationType,{}),o.query("customFields",t.customFields,{}),o.query("email",t.email,{}),o.query("expirationPeriod",t.expirationPeriod,{}),o.query("mobilePhone",t.mobilePhone,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("printed",t.printed,{}),o.query("redeemPeriod",t.redeemPeriod,{}),o.query("redeemer",t.redeemer,{}),o.query("redeemerGroups",t.redeemerGroups,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("token",t.token,{}),o.query("transactionPeriod",t.transactionPeriod,{}),o.query("transactionUser",t.transactionUser,{}),o.query("transactionUserGroups",t.transactionUserGroups,{}),o.query("types",t.types,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchVouchers(t,i){return this.searchVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}exportVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.ExportVouchersPath,"get");return t&&(o.path("format",t.format,{}),o.query("amountRange",t.amountRange,{}),o.query("buyer",t.buyer,{}),o.query("buyerGroups",t.buyerGroups,{}),o.query("creationPeriod",t.creationPeriod,{}),o.query("creationType",t.creationType,{}),o.query("customFields",t.customFields,{}),o.query("email",t.email,{}),o.query("expirationPeriod",t.expirationPeriod,{}),o.query("mobilePhone",t.mobilePhone,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("printed",t.printed,{}),o.query("redeemPeriod",t.redeemPeriod,{}),o.query("redeemer",t.redeemer,{}),o.query("redeemerGroups",t.redeemerGroups,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("token",t.token,{}),o.query("transactionPeriod",t.transactionPeriod,{}),o.query("transactionUser",t.transactionUser,{}),o.query("transactionUserGroups",t.transactionUserGroups,{}),o.query("types",t.types,{}),o.query("markAsPrinted",t.markAsPrinted,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportVouchers(t,i){return this.exportVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherDataForGenerate$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherDataForGeneratePath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("user",t.user,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherDataForGenerate(t,i){return this.getVoucherDataForGenerate$Response(t,i).pipe((0,c.U)(o=>o.body))}generateVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.GenerateVouchersPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}generateVouchers(t,i){return this.generateVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}viewVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.ViewVoucherPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}viewVoucher(t,i){return this.viewVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}searchVoucherTransactions$Response(t,i){const o=new d.c(this.rootUrl,n.SearchVoucherTransactionsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("key",t.key,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchVoucherTransactions(t,i){return this.searchVoucherTransactions$Response(t,i).pipe((0,c.U)(o=>o.body))}exportVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.ExportVoucherPath,"get");return t&&(o.path("key",t.key,{}),o.path("format",t.format,{}),o.query("markAsPrinted",t.markAsPrinted,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportVoucher(t,i){return this.exportVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherQrCode$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherQrCodePath,"get");return t&&(o.path("key",t.key,{}),o.query("size",t.size,{})),this.http.request(o.build({responseType:"blob",accept:"image/png",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherQrCode(t,i){return this.getVoucherQrCode$Response(t,i).pipe((0,c.U)(o=>o.body))}changeVoucherExpirationDate$Response(t,i){const o=new d.c(this.rootUrl,n.ChangeVoucherExpirationDatePath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changeVoucherExpirationDate(t,i){return this.changeVoucherExpirationDate$Response(t,i).pipe((0,c.U)(o=>o.body))}assignVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.AssignVoucherPath,"post");return t&&(o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}assignVoucher(t,i){return this.assignVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}changeVoucherNotificationSettings$Response(t,i){const o=new d.c(this.rootUrl,n.ChangeVoucherNotificationSettingsPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changeVoucherNotificationSettings(t,i){return this.changeVoucherNotificationSettings$Response(t,i).pipe((0,c.U)(o=>o.body))}resendVoucherEmail$Response(t,i){const o=new d.c(this.rootUrl,n.ResendVoucherEmailPath,"post");return t&&o.path("key",t.key,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}resendVoucherEmail(t,i){return this.resendVoucherEmail$Response(t,i).pipe((0,c.U)(o=>o.body))}resendPin$Response(t,i){const o=new d.c(this.rootUrl,n.ResendPinPath,"post");return t&&o.path("key",t.key,{}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}resendPin(t,i){return this.resendPin$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.CancelVoucherPath,"post");return t&&(o.header("confirmationPassword",t.confirmationPassword,{}),o.path("key",t.key,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelVoucher(t,i){return this.cancelVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}unblockVoucherPin$Response(t,i){const o=new d.c(this.rootUrl,n.UnblockVoucherPinPath,"post");return t&&o.path("key",t.key,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}unblockVoucherPin(t,i){return this.unblockVoucherPin$Response(t,i).pipe((0,c.U)(o=>o.body))}changeVoucherPin$Response(t,i){const o=new d.c(this.rootUrl,n.ChangeVoucherPinPath,"post");return t&&(o.path("key",t.key,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changeVoucherPin(t,i){return this.changeVoucherPin$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserVouchersDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetUserVouchersDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("relation",t.relation,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getUserVouchersDataForSearch(t,i){return this.getUserVouchersDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchUserVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.SearchUserVouchersPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("amountRange",t.amountRange,{}),o.query("creationPeriod",t.creationPeriod,{}),o.query("creationType",t.creationType,{}),o.query("expirationPeriod",t.expirationPeriod,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("redeemBy",t.redeemBy,{}),o.query("redeemPeriod",t.redeemPeriod,{}),o.query("relation",t.relation,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("token",t.token,{}),o.query("types",t.types,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchUserVouchers(t,i){return this.searchUserVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}exportUserVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.ExportUserVouchersPath,"get");return t&&(o.path("format",t.format,{}),o.path("user",t.user,{}),o.query("amountRange",t.amountRange,{}),o.query("creationPeriod",t.creationPeriod,{}),o.query("creationType",t.creationType,{}),o.query("expirationPeriod",t.expirationPeriod,{}),o.query("orderBy",t.orderBy,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("redeemBy",t.redeemBy,{}),o.query("redeemPeriod",t.redeemPeriod,{}),o.query("relation",t.relation,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("token",t.token,{}),o.query("types",t.types,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportUserVouchers(t,i){return this.exportUserVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherDataForBuy$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherDataForBuyPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherDataForBuy(t,i){return this.getVoucherDataForBuy$Response(t,i).pipe((0,c.U)(o=>o.body))}previewBuyVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewBuyVouchersPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewBuyVouchers(t,i){return this.previewBuyVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}buyVouchers$Response(t,i){const o=new d.c(this.rootUrl,n.BuyVouchersPath,"post");return t&&(o.path("user",t.user,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}buyVouchers(t,i){return this.buyVouchers$Response(t,i).pipe((0,c.U)(o=>o.body))}buyVouchersWithStatus$Response(t,i){const o=new d.c(this.rootUrl,n.BuyVouchersWithStatusPath,"post");return t&&(o.path("user",t.user,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}buyVouchersWithStatus(t,i){return this.buyVouchersWithStatus$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherDataForSend$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherDataForSendPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherDataForSend(t,i){return this.getVoucherDataForSend$Response(t,i).pipe((0,c.U)(o=>o.body))}previewSendVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewSendVoucherPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewSendVoucher(t,i){return this.previewSendVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}sendVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.SendVoucherPath,"post");return t&&(o.path("user",t.user,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}sendVoucher(t,i){return this.sendVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherInitialDataForRedeem$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherInitialDataForRedeemPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherInitialDataForRedeem(t,i){return this.getVoucherInitialDataForRedeem$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherDataForRedeem$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherDataForRedeemPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.path("token",t.token,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherDataForRedeem(t,i){return this.getVoucherDataForRedeem$Response(t,i).pipe((0,c.U)(o=>o.body))}previewVoucherRedeem$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewVoucherRedeemPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.path("token",t.token,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewVoucherRedeem(t,i){return this.previewVoucherRedeem$Response(t,i).pipe((0,c.U)(o=>o.body))}redeemVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.RedeemVoucherPath,"post");return t&&(o.path("user",t.user,{}),o.path("token",t.token,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}redeemVoucher(t,i){return this.redeemVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherInitialDataForTopUp$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherInitialDataForTopUpPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherInitialDataForTopUp(t,i){return this.getVoucherInitialDataForTopUp$Response(t,i).pipe((0,c.U)(o=>o.body))}getVoucherDataForTopUp$Response(t,i){const o=new d.c(this.rootUrl,n.GetVoucherDataForTopUpPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.path("token",t.token,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getVoucherDataForTopUp(t,i){return this.getVoucherDataForTopUp$Response(t,i).pipe((0,c.U)(o=>o.body))}previewVoucherTopUp$Response(t,i){const o=new d.c(this.rootUrl,n.PreviewVoucherTopUpPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.path("token",t.token,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}previewVoucherTopUp(t,i){return this.previewVoucherTopUp$Response(t,i).pipe((0,c.U)(o=>o.body))}topUpVoucher$Response(t,i){const o=new d.c(this.rootUrl,n.TopUpVoucherPath,"post");return t&&(o.path("user",t.user,{}),o.path("token",t.token,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}topUpVoucher(t,i){return this.topUpVoucher$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserVoucherTransactionsDataForSearch$Response(t,i){const o=new d.c(this.rootUrl,n.GetUserVoucherTransactionsDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}getUserVoucherTransactionsDataForSearch(t,i){return this.getUserVoucherTransactionsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchUserVoucherTransactions$Response(t,i){const o=new d.c(this.rootUrl,n.SearchUserVoucherTransactionsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("amountRange",t.amountRange,{}),o.query("by",t.by,{}),o.query("datePeriod",t.datePeriod,{}),o.query("kind",t.kind,{}),o.query("kinds",t.kinds,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("types",t.types,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}searchUserVoucherTransactions(t,i){return this.searchUserVoucherTransactions$Response(t,i).pipe((0,c.U)(o=>o.body))}viewVoucherTransaction$Response(t,i){const o=new d.c(this.rootUrl,n.ViewVoucherTransactionPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("id",t.id,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}viewVoucherTransaction(t,i){return this.viewVoucherTransaction$Response(t,i).pipe((0,c.U)(o=>o.body))}exportVoucherTransaction$Response(t,i){const o=new d.c(this.rootUrl,n.ExportVoucherTransactionPath,"get");return t&&(o.path("id",t.id,{}),o.path("format",t.format,{})),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,f.h)(r=>r instanceof p.Zn),(0,c.U)(r=>r))}exportVoucherTransaction(t,i){return this.exportVoucherTransaction$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetGeneralVouchersDataForSearchPath="/vouchers/data-for-search",n.SearchVouchersPath="/vouchers",n.ExportVouchersPath="/vouchers/export/{format}",n.GetVoucherDataForGeneratePath="/vouchers/data-for-generate",n.GenerateVouchersPath="/vouchers/generate",n.ViewVoucherPath="/vouchers/{key}",n.SearchVoucherTransactionsPath="/vouchers/{key}/transactions",n.ExportVoucherPath="/vouchers/{key}/export/{format}",n.GetVoucherQrCodePath="/vouchers/{key}/qr-code",n.ChangeVoucherExpirationDatePath="/vouchers/{key}/change-expiration",n.AssignVoucherPath="/vouchers/{key}/assign",n.ChangeVoucherNotificationSettingsPath="/vouchers/{key}/change-notification-settings",n.ResendVoucherEmailPath="/vouchers/{key}/resend-email",n.ResendPinPath="/vouchers/{key}/resend-pin",n.CancelVoucherPath="/vouchers/{key}/cancel",n.UnblockVoucherPinPath="/vouchers/{key}/unblock-pin",n.ChangeVoucherPinPath="/vouchers/{key}/change-pin",n.GetUserVouchersDataForSearchPath="/{user}/vouchers/data-for-search",n.SearchUserVouchersPath="/{user}/vouchers",n.ExportUserVouchersPath="/{user}/vouchers/export/{format}",n.GetVoucherDataForBuyPath="/{user}/vouchers/data-for-buy",n.PreviewBuyVouchersPath="/{user}/vouchers/preview-buy",n.BuyVouchersPath="/{user}/vouchers/buy",n.BuyVouchersWithStatusPath="/{user}/vouchers/buy-with-status",n.GetVoucherDataForSendPath="/{user}/vouchers/data-for-send",n.PreviewSendVoucherPath="/{user}/vouchers/preview-send",n.SendVoucherPath="/{user}/vouchers/send",n.GetVoucherInitialDataForRedeemPath="/{user}/vouchers/data-for-redeem",n.GetVoucherDataForRedeemPath="/{user}/vouchers/{token}/data-for-redeem",n.PreviewVoucherRedeemPath="/{user}/vouchers/{token}/preview-redeem",n.RedeemVoucherPath="/{user}/vouchers/{token}/redeem",n.GetVoucherInitialDataForTopUpPath="/{user}/vouchers/data-for-top-up",n.GetVoucherDataForTopUpPath="/{user}/vouchers/{token}/data-for-top-up",n.PreviewVoucherTopUpPath="/{user}/vouchers/{token}/preview-top-up",n.TopUpVoucherPath="/{user}/vouchers/{token}/top-up",n.GetUserVoucherTransactionsDataForSearchPath="/{user}/voucher-transactions/data-for-search",n.SearchUserVoucherTransactionsPath="/{user}/voucher-transactions",n.ViewVoucherTransactionPath="/voucher-transactions/{id}",n.ExportVoucherTransactionPath="/voucher-transactions/{id}/export/{format}",n.\u0275fac=function(t){return new(t||n)(e.LFG(ee.p),e.LFG(p.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var St=m(6734);function Lf(n,a){if(1&n&&e._UZ(0,"user-info",10),2&n){const t=e.oxw();e.Q6J("user",t.data.user)}}function kf(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.minTimeToRedeem),e.xp6(1),e.hij(" ",t.i18n.voucher.buy.minTimeToRedeemAfterBuy(t.format.formatTimeInterval(t.data.minimumTimeToRedeem))," ")}}function Ff(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.expirationDate)," ")}}function Of(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.redeem.onDays),e.xp6(1),e.hij(" ",t.format.formatWeekDays(t.data.redeemOnWeekDays)||t.i18n.voucher.redeem.onDaysAny," ")}}function Df(n,a){if(1&n&&e._UZ(0,"input-field",11),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.numberOfVouchers)}}function Rf(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e.ALo(1,"async"),e._uU(2),e.ALo(3,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",e.lcZ(1,2,t.countLabel$)),e.xp6(2),e.hij(" ",e.xi3(3,4,t.fixedAmount,t.currency)," ")}}const Vf=function(n,a){return{min:n,max:a}};function Yf(n,a){if(1&n&&(e._UZ(0,"label-value",14),e.ALo(1,"currency"),e.ALo(2,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.amountRange)("value",t.format.formatRange(e.WLB(8,Vf,e.xi3(1,2,t.data.amountRange.min,t.currency),e.xi3(2,5,t.data.amountRange.max,t.currency))))}}function Ef(n,a){if(1&n&&(e._UZ(0,"label-value",14),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.minimumAmount)("value",e.xi3(1,2,t.data.amountRange.min,t.currency))}}function $f(n,a){if(1&n&&(e._UZ(0,"label-value",14),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.maximumAmount)("value",e.xi3(1,2,t.data.amountRange.max,t.currency))}}function Bf(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e.ALo(1,"async"),e._UZ(2,"decimal-field",13),e.qZA(),e.YNc(3,Yf,3,11,"label-value",8),e.YNc(4,Ef,2,5,"label-value",8),e.YNc(5,$f,2,5,"label-value",8)),2&n){const t=e.oxw();e.Q6J("label",e.lcZ(1,7,t.countLabel$)),e.xp6(2),e.Q6J("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),e.xp6(1),e.Q6J("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)&&(null==t.data.amountRange?null:t.data.amountRange.max)),e.xp6(1),e.Q6J("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)&&!(null!=t.data.amountRange&&t.data.amountRange.max)),e.xp6(1),e.Q6J("ngIf",!(null!=t.data.amountRange&&t.data.amountRange.min)&&(null==t.data.amountRange?null:t.data.amountRange.max))}}function Hf(n,a){if(1&n&&(e.TgZ(0,"radio-group-field",15),e._UZ(1,"field-option",16)(2,"field-option",16),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.usage),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.voucher.buy.usageSelf),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.voucher.buy.usageGift)}}function jf(n,a){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.usage)("value",t.i18n.voucher.buy.usageAlwaysSelf)}}function Mf(n,a){if(1&n&&e._UZ(0,"custom-field-input",17),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.paymentCustomValues.get(t.internalName))}}function zf(n,a){if(1&n&&e._UZ(0,"custom-field-input",17),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.voucherCustomValues.get(t.internalName))}}let Gf=(()=>{class n extends q.H{constructor(t,i){super(t),this.authHelper=i,this.countLabel$=new y.X("")}ngOnInit(){super.ngOnInit();const t=this.data.amountRange;(null==t?void 0:t.min)&&(null==t?void 0:t.min)===t.max&&(this.fixedAmount=t.min,this.form.patchValue({amount:this.fixedAmount})),this.addSub(this.form.valueChanges.subscribe(i=>this.updateCountLabel(i))),this.updateCountLabel(this.form.value)}updateCountLabel(t){const i=null==t?void 0:t.count;this.countLabel$.next(i&&1!==i&&"1"!==i?this.i18n.voucher.amountPerVoucher:this.i18n.transaction.amount)}get currency(){return this.data.account.currency}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["buy-vouchers-step-form"]],inputs:{data:"data",form:"form"},features:[e.qOj],decls:18,vars:19,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["regularAmount",""],["asColumn","","formControlName","gift",3,"label",4,"ngIf"],["kind","fieldView",3,"label","value",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["kind","field","required","","fieldSize","medium",3,"label"],["formControlName","amount","required","",3,"prefix","suffix","scale"],["kind","fieldView",3,"label","value"],["asColumn","","formControlName","gift",3,"label"],[3,"value","text"],[3,"field","formControl"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,Lf,1,1,"user-info",1),e.TgZ(2,"label-value",2),e._uU(3),e.qZA(),e.TgZ(4,"label-value",2),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.YNc(7,kf,2,2,"label-value",3),e.YNc(8,Ff,3,4,"label-value",3),e.YNc(9,Of,2,2,"label-value",3),e.YNc(10,Df,1,1,"input-field",4),e.YNc(11,Rf,4,7,"label-value",5),e.YNc(12,Bf,6,9,"ng-template",null,6,e.W1O),e.YNc(14,Hf,3,5,"radio-group-field",7),e.YNc(15,jf,1,2,"label-value",8),e.YNc(16,Mf,1,2,"custom-field-input",9),e.YNc(17,zf,1,2,"custom-field-input",9),e.BQk()),2&t){const o=e.MAs(13);e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.data.user&&!i.authHelper.isSelf(i.data.user)),e.xp6(1),e.Q6J("label",i.i18n.voucher.originAccount),e.xp6(1),e.hij(" ",i.data.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.availableBalance),e.xp6(1),e.hij(" ",e.xi3(6,16,i.data.account.status.availableBalance,i.currency)," "),e.xp6(2),e.Q6J("ngIf",i.data.minimumTimeToRedeem),e.xp6(1),e.Q6J("ngIf",i.data.expirationDate),e.xp6(1),e.Q6J("ngIf",i.data.redeemOnWeekDays),e.xp6(1),e.Q6J("ngIf",null==i.data.type.maxVouchersPerBuy||i.data.type.maxVouchersPerBuy>1),e.xp6(1),e.Q6J("ngIf",i.fixedAmount)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf","choose"===i.data.type.gift),e.xp6(1),e.Q6J("ngIf","never"===i.data.type.gift),e.xp6(1),e.Q6J("ngForOf",i.data.paymentCustomFields),e.xp6(1),e.Q6J("ngForOf",i.data.voucherCustomFields)}},directives:[s.JL,s.sg,u.O5,oe.M,C.t,F.q,s.JJ,s.u,s.Q7,B.U,qe.Y,J.s,u.sg,Se.G,s.oH],pipes:[w.H,E.u,u.Ov],encapsulation:2,changeDetection:0}),n})();var Qt=m(9175);function Wf(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",6),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.preview.user)}}function Xf(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",1),e._uU(2),e.ALo(3,"currency"),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(3,2,t.buyVoucher.amount,t.preview.type.configuration.currency)," ")}}function Kf(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA(),e.TgZ(2,"label-value",1),e._uU(3),e.ALo(4,"currency"),e.qZA(),e.TgZ(5,"label-value",1),e._uU(6),e.ALo(7,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.numberOfVouchers),e.xp6(1),e.hij(" ",t.buyVoucher.count," "),e.xp6(1),e.Q6J("label",t.i18n.voucher.amountPerVoucher),e.xp6(1),e.hij(" ",e.xi3(4,6,t.buyVoucher.amount,t.preview.type.configuration.currency)," "),e.xp6(2),e.Q6J("label",t.i18n.voucher.totalAmount),e.xp6(1),e.hij(" ",e.xi3(7,9,t.preview.totalAmount,t.preview.type.configuration.currency)," ")}}function e_(n,a){if(1&n&&e._UZ(0,"label-value",7),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.usage)("value",t.buyVoucher.gift?t.i18n.voucher.buy.usageGift:t.i18n.voucher.buy.usageSelf)}}function t_(n,a){if(1&n&&e._UZ(0,"label-value",7),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.usage)("value",t.i18n.voucher.buy.usageAlwaysSelf)}}function n_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",8),e.ALo(2,"async"),e._UZ(3,"format-field-value",9),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.fieldHelper.hasValue(t.internalName,i.buyVoucher.paymentCustomValues))("label",t.name)("labelPosition",i.labelOnTop(e.lcZ(2,6,i.layout.ltsm$),t)?"top":"auto"),e.xp6(2),e.Q6J("customValues",i.buyVoucher.paymentCustomValues)("fields",i.paymentCustomFields)("fieldName",t.internalName)}}function i_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",8),e.ALo(2,"async"),e._UZ(3,"format-field-value",9),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.fieldHelper.hasValue(t.internalName,i.buyVoucher.voucherCustomValues))("label",t.name)("labelPosition",i.labelOnTop(e.lcZ(2,6,i.layout.ltsm$),t)?"top":"auto"),e.xp6(2),e.Q6J("customValues",i.buyVoucher.voucherCustomValues)("fields",i.voucherCustomFields)("fieldName",t.internalName)}}function o_(n,a){1&n&&e._UZ(0,"hr")}function a_(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,o_,1,0,"hr",0),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",10),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.form.get("confirmationPassword"))("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}let r_=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.authHelper=i,this.fieldHelper=o,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.buyVoucher=this.preview.buyVoucher,this.createDeviceConfirmation=()=>({type:U.l.BUY_VOUCHERS,amount:this.buyVoucher.amount,voucherType:this.preview.buyVoucher.type,numberOfVouchers:this.buyVoucher.count}),this.preview.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}labelOnTop(t,i){return!!t&&[W.L.RICH_TEXT,W.L.TEXT].includes(i?i.type:null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N),e.Y36(Qt.A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["buy-vouchers-step-confirm"]],inputs:{preview:"preview",paymentCustomFields:"paymentCustomFields",voucherCustomFields:"voucherCustomFields",confirmationPassword:"confirmationPassword"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:11,vars:10,consts:[[4,"ngIf"],[3,"label"],[4,"ngIf","ngIfElse"],["multiple",""],["kind","fieldView",3,"label","value",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user"],["kind","fieldView",3,"label","value"],[3,"hidden","label","labelPosition"],[3,"customValues","fields","fieldName"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"]],template:function(t,i){if(1&t&&(e.YNc(0,Wf,2,1,"ng-container",0),e.TgZ(1,"label-value",1),e._uU(2),e.qZA(),e.YNc(3,Xf,4,5,"ng-container",2),e.YNc(4,Kf,8,12,"ng-template",null,3,e.W1O),e.YNc(6,e_,1,2,"label-value",4),e.YNc(7,t_,1,2,"label-value",4),e.YNc(8,n_,4,8,"ng-container",5),e.YNc(9,i_,4,8,"ng-container",5),e.YNc(10,a_,4,6,"ng-container",0)),2&t){const o=e.MAs(5);e.Q6J("ngIf",i.preview.user&&!i.authHelper.isSelf(i.preview.user)),e.xp6(1),e.Q6J("label",i.i18n.voucher.voucher),e.xp6(1),e.hij(" ",i.preview.type.voucherTitle,"\n"),e.xp6(1),e.Q6J("ngIf",1===i.buyVoucher.count)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf","choose"===i.preview.type.gift),e.xp6(1),e.Q6J("ngIf","never"===i.preview.type.gift),e.xp6(1),e.Q6J("ngForOf",i.paymentCustomFields),e.xp6(1),e.Q6J("ngForOf",i.voucherCustomFields),e.xp6(1),e.Q6J("ngIf",i.preview.confirmationPasswordInput)}},directives:[u.O5,oe.M,C.t,u.sg,ve.x,he.y,z.A,s.JJ,s.oH],pipes:[w.H,u.Ov],encapsulation:2,changeDetection:0}),n})();function s_(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"voucher-type-selection",4),e.NdJ("typeSelected",function(o){return e.CHM(t),e.oxw().toForm(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.data.user)("heading",t.i18n.voucher.title.buy)("mobileHeading",t.i18n.voucher.mobileTitle.buy)("categories",t.data.categories)("types",t.data.types)}}function c_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToSelectType()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.previous)}}function l_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e._UZ(2,"buy-vouchers-step-form",6),e.TgZ(3,"actions",7)(4,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().toConfirm()}),e.ALo(5,"async"),e.qZA(),e.YNc(6,c_,1,1,"action-button",9),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.dataTypeForBuy.type.voucherTitle)("mobileHeading",t.dataTypeForBuy.type.voucherTitle)("mode",e.lcZ(1,8,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.dataTypeForBuy)("form",t.form),e.xp6(2),e.Q6J("disabled",e.lcZ(5,10,t.requesting$))("label",t.i18n.general.next),e.xp6(2),e.Q6J("ngIf",!t.singleType)}}function u_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).buy()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function p_(n,a){1&n&&e._uU(0,"\xa0")}function m_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e.TgZ(2,"buy-vouchers-step-confirm",11),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().buy(o)}),e.qZA(),e.TgZ(3,"actions",7),e.YNc(4,u_,2,4,"action-button",12),e.ALo(5,"async"),e.YNc(6,p_,1,0,"ng-template",null,13,e.W1O),e.TgZ(8,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw().backToForm()}),e.qZA()()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.voucher.title.buyConfirmation)("mobileHeading",i.i18n.voucher.mobileTitle.buyConfirmation)("mode",e.lcZ(1,10,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("preview",i.preview)("paymentCustomFields",i.dataTypeForBuy.paymentCustomFields)("voucherCustomFields",i.dataTypeForBuy.voucherCustomFields)("confirmationPassword",i.confirmationPassword),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,12,i.showSubmit$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.general.previous)}}function d_(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let f_=(()=>{class n extends $.y{constructor(t,i){super(t),this.voucherService=i,this.step$=new y.X(null),this.singleType=!1,this.showSubmit$=new y.X(!0)}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.params;this.user=this.authHelper.isSelf(t.user)?this.ApiHelper.SELF:t.user,this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user}).subscribe(i=>this.data=i))}onDataInitialized(t){const i=t.types||[];1===i.length?(this.singleType=!0,this.toForm(i[0])):this.step="select-type"}get currency(){return this.dataTypeForBuy.account.currency}buy(t){var i;t&&this.confirmationPassword.setValue(t);const o=null===(i=this.preview)||void 0===i?void 0:i.confirmationPasswordInput;this.confirmationPasswordInput&&!(0,h.pt)(this.confirmationPassword)||this.addSub(this.voucherService.buyVouchers({user:this.user,confirmationPassword:o?this.confirmationPassword.value:null,body:this.preview.buyVoucher}).subscribe(_=>{this.router.navigate(1===_.length?["/banking","vouchers","view",_[0]]:["/banking",this.user,"vouchers"]),this.notification.snackBar(this.i18n.voucher.buy.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(t){this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user,type:t.id,fields:["-confirmationPasswordInput"]}).subscribe(i=>{this.dataTypeForBuy=i,this.buildForm(),this.step="form"}))}toConfirm(){if(!(0,h.pt)(this.form))return;const t=this.dataTypeForBuy.type,i=this.form.value;i.type=t.id,this.addSub(this.voucherService.previewBuyVouchers({fields:["confirmationPasswordInput","totalAmount","buyVoucher"],user:this.user,body:i}).subscribe(o=>{o.type=t,o.user=this.data.user;const r=o.confirmationPasswordInput;this.canConfirm=this.authHelper.canConfirm(o.confirmationPasswordInput),this.canConfirm?(r&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(s.kI.required))),this.step="confirm",this.preview=o):this.notification.warning(this.authHelper.getConfirmationMessage(r))}))}get confirmationPasswordInput(){return this.dataTypeForBuy.confirmationPasswordInput}buildForm(){this.form=this.formBuilder.group({count:1,amount:null,gift:!1}),this.form.addControl("paymentCustomValues",this.fieldHelper.customValuesFormGroup(this.dataTypeForBuy.paymentCustomFields)),this.form.addControl("voucherCustomValues",this.fieldHelper.customValuesFormGroup(this.dataTypeForBuy.voucherCustomFields)),this.form.get("count").setValue(1)}resolveMenu(t){return this.menu.userMenu(t.user,this.dataForFrontendHolder.dataForFrontend.voucherBuyingMenu==ht.K.MARKETPLACE?v.v2.SEARCH_MY_VOUCHERS_MARKETPLACE:v.v2.SEARCH_MY_VOUCHERS_BANKING)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["buy-vouchers"]],features:[e.qOj],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","heading","mobileHeading","categories","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"preview","paymentCustomFields","voucherCustomFields","confirmationPassword","showSubmit","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,s_,2,5,"ng-container",1),e.YNc(4,l_,7,12,"page-content",2),e.YNc(5,m_,9,14,"page-content",2),e.YNc(6,d_,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","select-type"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,St.W,Z.Y,Gf,L.h,k.x,u.O5,r_,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var Ie=(()=>{return(n=Ie||(Ie={})).ACTIVATION="activation",n.DYNAMIC="dynamic",n.GENERATION="generation",Ie;var n})(),gt=(()=>{return(n=gt||(gt={})).ACTIVE="active",n.BLOCKED="blocked",n.INACTIVE="inactive",gt;var n})();function __(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.minTimeToRedeem),e.xp6(1),e.hij(" ",t.i18n.voucher.buy.minTimeToRedeemAfterBuy(t.format.formatTimeInterval(t.data.minimumTimeToRedeem))," ")}}function h_(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.expirationDate)," ")}}function g_(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.redeem.onDays),e.xp6(1),e.hij(" ",t.format.formatWeekDays(t.data.redeemOnWeekDays)||t.i18n.voucher.redeem.onDaysAny," ")}}function y_(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.account.availableBalance),e.xp6(1),e.hij(" ",e.xi3(2,2,t.data.account.status.availableBalance,t.currency)," ")}}function x_(n,a){if(1&n&&e._UZ(0,"decimal-field",7),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits)}}function b_(n,a){if(1&n&&e._UZ(0,"user-field",8,9),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.user)("allowContacts",!1)}}function v_(n,a){if(1&n&&e._UZ(0,"custom-field-input",10),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.voucherCustomValues.get(t.internalName))}}let T_=(()=>{class n extends q.H{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.addSub(this.form.get("user").valueChanges.subscribe(()=>this.saveUserData())),this.showAmount=this.data.generationAmount===Ie.GENERATION,this.showUser=this.data.generationStatus!==gt.INACTIVE}saveUserData(){this.userField.user&&this.form.get("userData").setValue(this.userField.user)}get currency(){return this.data.account.currency}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["generate-vouchers-step-form"]],viewQuery:function(t,i){if(1&t&&e.Gf(te.l,5),2&t){let o;e.iGM(o=e.CRH())&&(i.userField=o.first)}},inputs:{data:"data",form:"form"},features:[e.qOj],decls:11,vars:11,consts:[[3,"formGroup"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale",4,"ngIf"],["formControlName","user",3,"label","allowContacts",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["formControlName","user",3,"label","allowContacts"],["user",""],[3,"field","formControl"]],template:function(t,i){1&t&&(e.ynx(0,0),e.TgZ(1,"label-value",1),e._uU(2),e.qZA(),e.YNc(3,__,2,2,"label-value",2),e.YNc(4,h_,3,4,"label-value",2),e.YNc(5,g_,2,2,"label-value",2),e.YNc(6,y_,3,5,"label-value",2),e._UZ(7,"input-field",3),e.YNc(8,x_,1,4,"decimal-field",4),e.YNc(9,b_,2,2,"user-field",5),e.YNc(10,v_,1,2,"custom-field-input",6),e.BQk()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("label",i.i18n.voucher.originAccount),e.xp6(1),e.hij(" ",i.data.account.type.name," "),e.xp6(1),e.Q6J("ngIf",i.data.minimumTimeToRedeem),e.xp6(1),e.Q6J("ngIf",i.data.expirationDate),e.xp6(1),e.Q6J("ngIf",i.data.redeemOnWeekDays),e.xp6(1),e.Q6J("ngIf",i.data.account.status.availableBalance),e.xp6(1),e.Q6J("label",i.i18n.voucher.numberOfVouchers),e.xp6(1),e.Q6J("ngIf",i.showAmount),e.xp6(1),e.Q6J("ngIf",i.showUser),e.xp6(1),e.Q6J("ngForOf",i.data.voucherCustomFields))},directives:[s.JL,s.sg,C.t,u.O5,F.q,s.JJ,s.u,s.Q7,B.U,te.l,u.sg,Se.G,s.oH],pipes:[E.u,w.H],encapsulation:2,changeDetection:0}),n})();function w_(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.amountPerVoucher),e.xp6(1),e.hij(" ",e.xi3(2,2,t.generateVoucher.amount,t.data.account.currency),"\n")}}function C_(n,a){if(1&n&&(e.TgZ(0,"label-value",0),e._UZ(1,"user-link",4),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.user)}}function A_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",5),e.ALo(2,"async"),e._UZ(3,"format-field-value",6),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.fieldHelper.hasValue(t.internalName,i.generateVoucher.voucherCustomValues))("label",t.name)("labelPosition",i.labelOnTop(e.lcZ(2,6,i.layout.ltsm$),t)?"top":"auto"),e.xp6(2),e.Q6J("customValues",i.generateVoucher.voucherCustomValues)("fields",i.data.voucherCustomFields)("fieldName",t.internalName)}}function Z_(n,a){1&n&&e._UZ(0,"hr")}function P_(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,Z_,1,0,"hr",3),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",7),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.form.get("confirmationPassword"))("passwordInput",t.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}let q_=(()=>{class n extends q.H{constructor(t,i){super(t),this.fieldHelper=i,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.showAmount=this.data.generationAmount===Ie.GENERATION,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:U.l.GENERATE_VOUCHERS,amount:this.generateVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.generateVoucher.count}),this.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}labelOnTop(t,i){return!!t&&[W.L.RICH_TEXT,W.L.TEXT].includes(i?i.type:null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Qt.A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["generate-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",generateVoucher:"generateVoucher",data:"data",user:"user"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:8,vars:8,consts:[[3,"label"],[3,"label",4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"user"],[3,"hidden","label","labelPosition"],[3,"customValues","fields","fieldName"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"]],template:function(t,i){1&t&&(e.TgZ(0,"label-value",0),e._uU(1),e.qZA(),e.TgZ(2,"label-value",0),e._uU(3),e.qZA(),e.YNc(4,w_,3,5,"label-value",1),e.YNc(5,C_,2,2,"label-value",1),e.YNc(6,A_,4,8,"ng-container",2),e.YNc(7,P_,4,6,"ng-container",3)),2&t&&(e.Q6J("label",i.i18n.general.type),e.xp6(1),e.hij(" ",i.data.type.voucherTitle,"\n"),e.xp6(1),e.Q6J("label",i.i18n.voucher.numberOfVouchers),e.xp6(1),e.hij(" ",i.generateVoucher.count,"\n"),e.xp6(1),e.Q6J("ngIf",i.showAmount),e.xp6(1),e.Q6J("ngIf",i.user),e.xp6(1),e.Q6J("ngForOf",i.data.voucherCustomFields),e.xp6(1),e.Q6J("ngIf",i.confirmationPasswordInput))},directives:[C.t,u.O5,Q.F,u.sg,ve.x,he.y,z.A,s.JJ,s.oH],pipes:[w.H,u.Ov],encapsulation:2,changeDetection:0}),n})();function S_(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"voucher-type-selection",4),e.NdJ("typeSelected",function(o){return e.CHM(t),e.oxw().toForm(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.voucher.title.generate)("mobileHeading",t.i18n.voucher.mobileTitle.generate)("categories",t.data.categories)("types",t.data.types)}}function Q_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToSelectType()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.previous)}}function U_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e._UZ(2,"generate-vouchers-step-form",6),e.TgZ(3,"actions",7)(4,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().toConfirm()}),e.ALo(5,"async"),e.qZA(),e.YNc(6,Q_,1,1,"action-button",9),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.dataTypeForGenerate.type.voucherTitle)("mobileHeading",t.dataTypeForGenerate.type.voucherTitle)("mode",e.lcZ(1,8,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.dataTypeForGenerate)("form",t.form),e.xp6(2),e.Q6J("disabled",e.lcZ(5,10,t.requesting$))("label",t.i18n.general.next),e.xp6(2),e.Q6J("ngIf",!t.singleType)}}function N_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).generate()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function I_(n,a){1&n&&e._uU(0,"\xa0")}function J_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e.TgZ(2,"generate-vouchers-step-confirm",11),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().generate(o)}),e.qZA(),e.TgZ(3,"actions",7),e.YNc(4,N_,2,4,"action-button",12),e.ALo(5,"async"),e.YNc(6,I_,1,0,"ng-template",null,13,e.W1O),e.TgZ(8,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw().backToForm()}),e.qZA()()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.voucher.title.generateConfirmation)("mobileHeading",i.i18n.voucher.mobileTitle.generateConfirmation)("mode",e.lcZ(1,11,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("generateVoucher",i.form.value)("data",i.dataTypeForGenerate)("user",i.form.get("userData").value)("confirmationPasswordInput",i.dataTypeForGenerate.confirmationPasswordInput)("confirmationPassword",i.confirmationPassword),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,13,i.showSubmit$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.general.previous)}}function L_(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let k_=(()=>{class n extends $.y{constructor(t,i){super(t),this.voucherService=i,this.step$=new y.X(null),this.singleType=!1,this.showSubmit$=new y.X(!0)}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVoucherDataForGenerate().subscribe(t=>this.data=t))}onDataInitialized(t){const i=t.types||[];1===i.length?(this.singleType=!0,this.toForm(i[0])):this.step="select-type"}get currency(){return this.dataTypeForGenerate.account.currency}generate(t){if(t&&this.confirmationPassword.setValue(t),this.confirmationPasswordInput&&!(0,h.pt)(this.confirmationPassword))return;const i=this.form.value;i.type=this.dataTypeForGenerate.type.id,delete i.userData,this.addSub(this.voucherService.generateVouchers({confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:i}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.generate.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(t){this.addSub(this.voucherService.getVoucherDataForGenerate({type:t.id}).subscribe(i=>{this.dataTypeForGenerate=i,this.buildForm(),this.step="form"}))}toConfirm(){if((0,h.pt)(this.form)){if(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),!this.canConfirm)return void this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput));this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(s.kI.required))),this.step="confirm"}}get confirmationPasswordInput(){var t;return null===(t=this.dataTypeForGenerate)||void 0===t?void 0:t.confirmationPasswordInput}buildForm(){this.form=this.formBuilder.group({amount:new s.NI(""),count:new s.NI(""),user:new s.NI(""),userData:new s.NI("")}),this.form.addControl("voucherCustomValues",this.fieldHelper.customValuesFormGroup(this.dataTypeForGenerate.voucherCustomFields));const t=this.form.controls.amount;this.data.generationAmount===Ie.GENERATION?t.setValidators(s.kI.required):t.clearValidators(),this.form.get("count").setValue(1)}resolveMenu(){return v.v2.SEARCH_VOUCHERS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["generate-vouchers"]],features:[e.qOj],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"heading","mobileHeading","categories","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"generateVoucher","data","user","confirmationPasswordInput","confirmationPassword","showSubmit","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,S_,2,4,"ng-container",1),e.YNc(4,U_,7,12,"page-content",2),e.YNc(5,J_,9,15,"page-content",2),e.YNc(6,L_,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","select-type"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,St.W,Z.Y,T_,L.h,k.x,u.O5,q_,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})(),Gt=(()=>{class n extends $.y{constructor(t){super(t),this.step$=new y.X(null),this.token=new s.NI("",s.kI.required),this.mask="",this.dataForTransaction$=new y.X(null),this.preview$=new y.X(null),this.pin=new s.NI("",s.kI.required),this.showSubmit$=new y.X(!0),this.vouchersService=t.get(ge)}get dataForTransaction(){return this.dataForTransaction$.value}get preview(){return this.preview$.value}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit(),this.userId=this.route.snapshot.paramMap.get("user"),this.addSub(this.getInitialData(this.userId).subscribe(t=>{this.data=t,this.mask=this.data.mask?this.data.mask:"",this.self=this.authHelper.isSelf(t.user)})),this.step="token",this.step$.subscribe(()=>setTimeout(()=>this.injector.get(e.sBO).detectChanges()))}toForm(){!(0,h.pt)(this.token)||this.addSub(this.getVoucherTransactionData({user:this.userId,token:this.token.value}).subscribe(t=>{this.dataForTransaction$.next(t),this.form=new s.cw({}),this.setupForm(this.form,t),this.form.addControl("paymentCustomValues",this.fieldHelper.customValuesFormGroup(t.paymentCustomFields)),this.step="form"},()=>this.token.reset()))}backToToken(){this.step="token",this.token.reset(),this.form.reset(),this.dataForTransaction$.next(null),this.preview$.next(null),this.pin.reset()}backToForm(){this.step="form",this.preview$.next(null),this.pin.reset()}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.VOUCHER_TRANSACTIONS)}maybePreview(){var t;if(!(0,h.pt)(this.form))return;const i={user:null===(t=this.dataForTransaction.user)||void 0===t?void 0:t.id,token:this.dataForTransaction.token,body:this.form.value};this.dataForTransaction.shouldPreview?this.addSub(this.previewTransaction(i).subscribe(o=>{this.preview$.next(o),this.step="confirm"})):this.performFromForm()}performFromForm(){const t=this.dataForTransaction;this.validatePerformFromForm(t,this.form)&&this.addSub(this.performTransaction(null,{user:t.user.id,token:t.token,body:this.form.value}).subscribe(o=>{this.router.navigate(["/banking","voucher-transactions","view",o.id],{state:{url:this.router.url}})}))}performFromPreview(){this.validatePerformFromPreview(this.preview)&&this.addSub(this.performTransaction(this.preview,{user:this.preview.user.id,token:this.preview.token}).subscribe(i=>{this.router.navigate(["/banking","voucher-transactions","view",i.id],{state:{url:this.router.url}})}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275dir=e.lG2({type:n,features:[e.qOj]}),n})();var F_=m(1375);const O_=["inputField"];function D_(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",7)(2,"hr"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.data.user)}}function R_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",8,9),e.NdJ("click",function(){return e.CHM(t),e.oxw().showScanQrCode()}),e._UZ(2,"icon",10),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("tooltip",t.i18n.field.user.scanQrCodeTooltip),e.xp6(2),e.Q6J("icon",t.SvgIcon.QrCodeScan)}}let Wt=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.authHelper=i,this.modal=o,this.scan=new e.vpe}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.data.user)}showScanQrCode(){this.modal.show(F_.u,{class:"modal-form"}).content.select.pipe((0,Le.P)()).subscribe(o=>{this.token.setValue(o),this.scan.emit()}),this.modal.onHide.pipe((0,Le.P)()).subscribe(()=>(0,h.T_)(this.inputField,!0))}maybeSubmit(){var t;this.data.mask?(null===(t=this.token.value)||void 0===t?void 0:t.length)===this.data.mask.length&&this.scan.emit():(0,h.cS)(this.token.value)||this.scan.emit()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N),e.Y36(He.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-transaction-step-token"]],viewQuery:function(t,i){if(1&t&&e.Gf(O_,5),2&t){let o;e.iGM(o=e.CRH())&&(i.inputField=o.first)}},inputs:{token:"token",data:"data"},outputs:{scan:"scan"},features:[e.qOj],decls:7,vars:5,consts:[[4,"ngIf"],[1,"d-flex","flex-grow-1"],[1,"flex-grow-1"],["kind","field",3,"label"],["type","text","focused","",3,"mask","formControl","placeholder","keyup.enter"],["inputField",""],["type","button","class","btn btn-icon",3,"tooltip","click",4,"extraCell"],[3,"user"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],[3,"icon"]],template:function(t,i){1&t&&(e.YNc(0,D_,3,1,"ng-container",0),e.TgZ(1,"div",1)(2,"div",2)(3,"label-value",3)(4,"input-field",4,5),e.NdJ("keyup.enter",function(){return i.maybeSubmit()}),e.qZA(),e.YNc(6,R_,3,2,"button",6),e.qZA()()()),2&t&&(e.Q6J("ngIf",!i.self),e.xp6(3),e.Q6J("label",i.i18n.voucher.token),e.xp6(1),e.Q6J("mask",i.data.mask)("formControl",i.token)("placeholder",i.data.mask))},directives:[u.O5,oe.M,C.t,F.q,z.A,fe.h,s.JJ,s.oH,Vt.j,Xe.i9,lt.o],encapsulation:2,changeDetection:0}),n})();var Ut=m(7334),je=(()=>{return(n=je||(je={})).INPUT="input",n.NONE="none",n.SEND="send",je;var n})(),Nt=m(7229),Xt=m(4897);function V_(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",7)(2,"hr"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.data.user)}}const Y_=function(n){return{"flex-grow-1":n}};function E_(n,a){if(1&n&&(e.TgZ(0,"div",8),e._UZ(1,"avatar-lightbox",9),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,Y_,!t.data.type.voucherDescription)),e.xp6(1),e.Q6J("image",t.data.type.image)}}function $_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",10),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij("",t.data.type.voucherDescription," ")}}function B_(n,a){1&n&&e._UZ(0,"hr",11)}function H_(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"label-value",5),e.ALo(2,"currency"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.voucher.redeem.voucherBalance)("value",e.xi3(2,2,t.balance,t.data.type.configuration.currency))}}function j_(n,a){if(1&n&&e._UZ(0,"decimal-field",14),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("label",!i.topUpData&&i.data.type.allowPartialRedeems?i.i18n.voucher.redeem.amountToRedeem:i.i18n.voucher.transaction.amount)("prefix",t.prefix)("suffix",t.suffix)("scale",t.decimalDigits)}}function M_(n,a){if(1&n&&(e._UZ(0,"label-value",5),e.ALo(1,"currency")),2&n){const t=e.oxw().ngIf,i=e.oxw();e.Q6J("label",i.i18n.transaction.amount)("value",e.xi3(1,2,i.data.amount,t))}}function z_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,j_,1,4,"decimal-field",12),e.YNc(2,M_,2,5,"ng-template",null,13,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.amountAsField)("ngIfElse",t)}}function G_(n,a){if(1&n&&e._UZ(0,"label-value",5),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.topUp.sendPinBy)("value",t.sendByOptions[0].text)}}function W_(n,a){if(1&n&&e._UZ(0,"radio-group-field",20),2&n){const t=e.oxw(2);e.Q6J("formControl",t.sendMedium)("label",t.pinIsSent?t.i18n.voucher.topUp.sendPinBy:t.i18n.voucher.topUp.sendNotificationsBy)("fieldOptions",t.sendByOptions)}}function X_(n,a){if(1&n&&e._UZ(0,"input-field",21),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.user.email)}}function K_(n,a){if(1&n&&e._UZ(0,"input-field",22),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.phone.mobile)}}function eh(n,a){if(1&n&&e._UZ(0,"boolean-field",24),2&n){const t=e.oxw(3);e.Q6J("formControl",t.manualPin)("label",t.i18n.voucher.topUp.manualPin)}}function th(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",25),e._UZ(2,"password-input",26),e.qZA(),e.TgZ(3,"label-value",25),e._UZ(4,"password-input",27),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.voucher.topUp.pin),e.xp6(1),e.Q6J("passwordInput",t.topUpData.pinInput),e.xp6(1),e.Q6J("label",t.i18n.voucher.topUp.pinConfirm),e.xp6(1),e.Q6J("passwordInput",t.topUpData.pinInput)}}function nh(n,a){if(1&n&&(e.ynx(0),e.YNc(1,eh,1,2,"boolean-field",23),e.ALo(2,"async"),e.YNc(3,th,5,4,"ng-container",0),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","off"!==(t.sendMedium.value||e.lcZ(2,2,t.sendMedium.valueChanges))),e.xp6(2),e.Q6J("ngIf",t.manualPin.value||e.lcZ(4,4,t.manualPin.valueChanges))}}function ih(n,a){if(1&n&&e._UZ(0,"custom-field-input",28),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("field",t)("formControl",i.form.controls.voucherCustomValues.get(t.internalName))}}function oh(n,a){if(1&n&&(e.ynx(0),e.YNc(1,G_,1,2,"label-value",15),e.YNc(2,W_,1,3,"ng-template",null,16,e.W1O),e.ynx(4,17),e.ALo(5,"async"),e.YNc(6,X_,1,1,"input-field",18),e.YNc(7,K_,1,1,"input-field",19),e.BQk(),e.YNc(8,nh,5,6,"ng-container",0),e.YNc(9,ih,1,2,"custom-field-input",6),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",0===i.sendByOptions.length)("ngIfElse",t),e.xp6(3),e.Q6J("ngSwitch",e.lcZ(5,7,i.sendMedium.valueChanges)||i.sendMedium.value),e.xp6(2),e.Q6J("ngSwitchCase","email"),e.xp6(1),e.Q6J("ngSwitchCase","sms"),e.xp6(1),e.Q6J("ngIf",(null==i.topUpData?null:i.topUpData.pinOnActivation)===i.VoucherPinOnActivationEnum.INPUT),e.xp6(1),e.Q6J("ngForOf",i.resolveCustomFields())}}function ah(n,a){if(1&n&&e._UZ(0,"custom-field-input",28),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.paymentCustomValues.get(t.internalName))}}const rh=function(n){return{"d-flex flex-row-reverse justify-content-between":n}};let Kt=(()=>{class n extends q.H{constructor(t,i){super(t),this.authHelper=i,this.VoucherPinOnActivationEnum=je,this.sendMedium=new s.NI,this.manualPin=new s.NI(!0)}resolveCustomFields(){return this.data.voucherCustomFields||[]}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.data.user),this.data.kind==me.n.TOP_UP&&(this.topUpData=this.data,this.topUpData.isActivation&&(this.sendMedium.setValue(this.pinIsSent?Ut.x.EMAIL:"off"),this.addSub(this.sendMedium.valueChanges.subscribe(t=>{this.manualPin.setValue("off"===t)})),this.sendByOptions=[],this.pinIsSent||this.sendByOptions.push({value:"off",text:this.i18n.voucher.topUp.dontSendNotifications}),this.sendByOptions.push({value:Ut.x.EMAIL,text:this.i18n.general.sendMedium.email}),this.topUpData.phoneConfiguration&&this.sendByOptions.push({value:Ut.x.SMS,text:this.i18n.general.sendMedium.sms}),this.addSub(this.manualPin.valueChanges.subscribe(t=>{t&&this.form.patchValue({pin:"",pinConfirmation:""})}))))}get balance(){return this.data.balance}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-transaction-step-form"]],inputs:{data:"data",form:"form",amountAsField:"amountAsField",pinIsSent:"pinIsSent"},features:[e.qOj],decls:12,vars:16,consts:[[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],["class","mt-3",4,"ngIf"],["kind","fieldView",3,"label","value"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200",3,"image"],[1,"break-nl"],[1,"mt-3"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale",4,"ngIf","ngIfElse"],["plainAmount",""],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf","ngIfElse"],["sendMediumsRadio",""],[3,"ngSwitch"],["formControlName","email","required","",3,"label",4,"ngSwitchCase"],["formControlName","mobilePhone","required","",3,"label",4,"ngSwitchCase"],[3,"formControl","label","fieldOptions"],["formControlName","email","required","",3,"label"],["formControlName","mobilePhone","required","",3,"label"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"],["kind","field","required","","fieldSize","small",3,"label"],["disableAutocomplete","","formControlName","pin","placeholder","",3,"passwordInput"],["disableAutocomplete","","formControlName","pinConfirmation","placeholder","",3,"passwordInput"],[3,"field","formControl"]],template:function(t,i){1&t&&(e.YNc(0,V_,3,1,"ng-container",0),e.TgZ(1,"div",1)(2,"div",2),e.ALo(3,"async"),e.YNc(4,E_,2,4,"div",3),e.YNc(5,$_,3,1,"ng-container",0),e.qZA(),e.YNc(6,B_,1,0,"hr",4),e._UZ(7,"label-value",5),e.YNc(8,H_,3,5,"ng-container",0),e.YNc(9,z_,4,2,"ng-container",0),e.YNc(10,oh,10,9,"ng-container",0),e.YNc(11,ah,1,2,"custom-field-input",6),e.qZA()),2&t&&(e.Q6J("ngIf",!i.self),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngClass",e.VKq(14,rh,e.lcZ(3,12,i.layout.gtsm$)&&i.data.type.image)),e.xp6(2),e.Q6J("ngIf",i.data.type.image),e.xp6(1),e.Q6J("ngIf",i.data.type.voucherDescription),e.xp6(1),e.Q6J("ngIf",i.data.type.image),e.xp6(1),e.Q6J("label",i.i18n.voucher.voucher)("value",i.data.type.voucherTitle),e.xp6(1),e.Q6J("ngIf",i.data.type.allowPartialRedeems&&i.balance),e.xp6(1),e.Q6J("ngIf",i.data.type.configuration.currency),e.xp6(1),e.Q6J("ngIf",null==i.topUpData?null:i.topUpData.isActivation),e.xp6(1),e.Q6J("ngForOf",i.data.paymentCustomFields))},directives:[u.O5,oe.M,s.JL,s.sg,u.mk,Nt.X,C.t,B.U,s.JJ,s.u,z.A,s.Q7,qe.Y,s.oH,u.RF,u.n9,F.q,at.M,Xt.C,u.sg,Se.G],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function sh(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",9)(2,"hr"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.preview.user)}}const ch=function(n){return{"flex-grow-1":n}};function lh(n,a){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"avatar-lightbox",11),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,ch,!t.preview.type.voucherDescription)),e.xp6(1),e.Q6J("image",t.preview.type.image)}}function uh(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",12),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij("",t.preview.type.voucherDescription," ")}}function ph(n,a){if(1&n&&(e._UZ(0,"label-value",7),e.ALo(1,"currency")),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.redeem.voucherBalance)("value",e.xi3(1,2,t.balance,t.currency))}}function mh(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"label-value",7)(2,"label-value",7),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.pinIsSent?t.i18n.voucher.topUp.sendPinBy:t.i18n.voucher.topUp.sendNotificationsBy)("value",t.i18n.general.sendMedium.email),e.xp6(1),e.Q6J("label",t.i18n.user.email)("value",t.topUp.email)}}function dh(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"label-value",7)(2,"label-value",7),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.pinIsSent?t.i18n.voucher.topUp.sendPinBy:t.i18n.voucher.topUp.sendNotificationsBy)("value",t.i18n.general.sendMedium.sms),e.xp6(1),e.Q6J("label",t.i18n.phone.mobile)("value",t.topUpPreview.formattedMobilePhone)}}function fh(n,a){if(1&n&&e._UZ(0,"label-value",7),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.owner)("value",t.topUpPreview.owner.display)}}function _h(n,a){1&n&&e._UZ(0,"custom-field-value",13),2&n&&e.Q6J("fieldValue",a.$implicit)}function hh(n,a){1&n&&e._UZ(0,"custom-field-value",13),2&n&&e.Q6J("fieldValue",a.$implicit)}const gh=function(n){return{"d-flex flex-row-reverse justify-content-between":n}};let en=(()=>{class n extends q.H{constructor(t,i){super(t),this.authHelper=i}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.preview.user),this.currency=this.preview.type.configuration.currency,this.preview.kind===me.n.TOP_UP&&(this.topUpPreview=this.preview,this.topUp=this.transaction)}get balance(){return this.data&&this.data.balance}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-transaction-step-confirm"]],inputs:{preview:"preview",data:"data",transaction:"transaction",pinIsSent:"pinIsSent"},features:[e.qOj],decls:16,vars:21,consts:[[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],[1,"mt-3"],["kind","fieldView",3,"label","value"],[3,"label","value",4,"ngIf"],[3,"label","value"],[3,"fieldValue",4,"ngFor","ngForOf"],[3,"user"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200",3,"image"],[1,"break-nl"],[3,"fieldValue"]],template:function(t,i){1&t&&(e.YNc(0,sh,3,1,"ng-container",0),e.TgZ(1,"div",1)(2,"div",2),e.ALo(3,"async"),e.YNc(4,lh,2,4,"div",3),e.YNc(5,uh,3,1,"ng-container",0),e.qZA(),e._UZ(6,"hr",4)(7,"label-value",5),e.YNc(8,ph,2,5,"label-value",6),e._UZ(9,"label-value",7),e.ALo(10,"currency"),e.YNc(11,mh,3,4,"ng-container",0),e.YNc(12,dh,3,4,"ng-container",0),e.YNc(13,fh,1,2,"label-value",6),e.YNc(14,_h,1,1,"custom-field-value",8),e.YNc(15,hh,1,1,"custom-field-value",8),e.qZA()),2&t&&(e.Q6J("ngIf",!i.self),e.xp6(2),e.Q6J("ngClass",e.VKq(19,gh,e.lcZ(3,14,i.layout.gtsm$)&&i.preview.type.image)),e.xp6(2),e.Q6J("ngIf",i.preview.type.image),e.xp6(1),e.Q6J("ngIf",i.preview.type.voucherDescription),e.xp6(2),e.Q6J("label",i.i18n.voucher.voucher)("value",i.preview.type.voucherTitle),e.xp6(1),e.Q6J("ngIf",i.data&&i.data.type.allowPartialRedeems&&i.balance),e.xp6(1),e.Q6J("label",i.data&&i.data.type.allowPartialRedeems?i.i18n.voucher.redeem.amountToRedeem:i.i18n.voucher.transaction.amount)("value",e.xi3(10,16,i.preview.amount,i.currency)),e.xp6(2),e.Q6J("ngIf",null==i.topUp?null:i.topUp.email),e.xp6(1),e.Q6J("ngIf",null==i.topUp?null:i.topUp.mobilePhone),e.xp6(1),e.Q6J("ngIf",null==i.topUpPreview?null:i.topUpPreview.owner),e.xp6(1),e.Q6J("ngForOf",null==i.topUpPreview?null:i.topUpPreview.voucherCustomValues),e.xp6(1),e.Q6J("ngForOf",i.preview.paymentCustomValues))},directives:[u.O5,oe.M,u.mk,Nt.X,C.t,u.sg,Qe.W],pipes:[u.Ov,w.H],encapsulation:2,changeDetection:0}),n})();function yh(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"voucher-transaction-step-token",5),e.NdJ("scan",function(){return e.CHM(t),e.oxw(2).toForm()}),e.qZA(),e.TgZ(2,"actions")(3,"action-button",6),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).toForm()}),e.ALo(4,"async"),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("data",t.data)("token",t.token),e.xp6(2),e.Q6J("disabled",e.lcZ(4,4,t.requesting$))("label",t.i18n.general.next)}}function xh(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,yh,5,6,"ng-container",4),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.redeem)("mobileHeading",t.i18n.voucher.mobileTitle.redeem)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.data$))("ngIfElse",i)}}function bh(n,a){if(1&n&&(e.TgZ(0,"notification",12),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.voucher.redeem.confirm," ")}}function vh(n,a){1&n&&e._UZ(0,"hr")}function Th(n,a){if(1&n&&(e.ynx(0),e.YNc(1,vh,1,0,"hr",9),e.ALo(2,"async"),e.TgZ(3,"label-value",13),e._UZ(4,"password-input",14),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("label",t.dataForTransaction.pinInput.name),e.xp6(1),e.Q6J("formControl",t.form.get("pin"))("passwordInput",t.dataForTransaction.pinInput)}}function wh(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).resendPin()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.sendPinToClient)}}function Ch(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,bh,2,1,"notification",7),e._UZ(2,"voucher-transaction-step-form",8),e.YNc(3,Th,5,6,"ng-container",9),e.TgZ(4,"actions")(5,"action-button",6),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).maybePreview()}),e.ALo(6,"async"),e.qZA(),e.YNc(7,wh,1,1,"action-button",10),e.TgZ(8,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToToken()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.dataForTransaction.shouldPreview),e.xp6(1),e.Q6J("data",t.dataForTransaction)("form",t.form)("amountAsField",t.dataForTransaction.type.allowPartialRedeems),e.xp6(1),e.Q6J("ngIf",t.dataForTransaction.pinInput),e.xp6(2),e.Q6J("disabled",e.lcZ(6,9,t.requesting$))("label",t.dataForTransaction.shouldPreview?t.i18n.general.next:t.i18n.general.submit),e.xp6(2),e.Q6J("ngIf",t.dataForTransaction.canSendPin&&t.dataForTransaction.pinInput),e.xp6(1),e.Q6J("label",t.i18n.general.previous)}}function Ah(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Ch,9,11,"ng-container",4),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.redeem)("mobileHeading",t.i18n.voucher.mobileTitle.redeem)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.dataForTransaction$))("ngIfElse",i)}}function Zh(n,a){if(1&n&&e._UZ(0,"voucher-transaction-step-confirm",17),2&n){const t=e.oxw(3);e.Q6J("preview",t.preview)("transaction",t.preview.redeem)("data",t.dataForTransaction)}}function Ph(n,a){1&n&&e._UZ(0,"hr")}function qh(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ph,1,0,"hr",9),e.ALo(2,"async"),e.TgZ(3,"label-value",13),e._UZ(4,"password-input",14),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("label",t.preview.pinInput.name),e.xp6(1),e.Q6J("formControl",t.pin)("passwordInput",t.preview.pinInput)}}function Sh(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).resendPin()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.sendPinToClient)}}function Qh(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"notification",15),e._uU(2),e.qZA(),e.YNc(3,Zh,1,3,"voucher-transaction-step-confirm",16),e.ALo(4,"async"),e.YNc(5,qh,5,6,"ng-container",9),e.TgZ(6,"actions")(7,"action-button",6),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).performFromPreview()}),e.ALo(8,"async"),e.qZA(),e.YNc(9,Sh,1,1,"action-button",10),e.TgZ(10,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToForm()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.voucher.redeem.confirm," "),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,7,t.preview$)),e.xp6(2),e.Q6J("ngIf",t.preview.pinInput),e.xp6(2),e.Q6J("disabled",e.lcZ(8,9,t.requesting$))("label",t.i18n.general.submit),e.xp6(2),e.Q6J("ngIf",t.preview.canSendPin&&t.preview.pinInput),e.xp6(1),e.Q6J("label",t.i18n.general.previous)}}function Uh(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Qh,11,11,"ng-container",4),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.redeem)("mobileHeading",t.i18n.voucher.mobileTitle.redeem)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.dataForTransaction$))("ngIfElse",i)}}function Nh(n,a){1&n&&e._UZ(0,"spinner")}let Ih=(()=>{class n extends Gt{constructor(t){super(t),this.pin=new s.NI("",s.kI.required)}getInitialData(t){return this.vouchersService.getVoucherInitialDataForRedeem({user:t})}getVoucherTransactionData(t){return this.vouchersService.getVoucherDataForRedeem(t)}setupForm(t,i){i.type.allowPartialRedeems&&t.addControl("amount",new s.NI(null,s.kI.required)),i.pinInput&&t.addControl("pin",new s.NI(null,s.kI.required))}previewTransaction(t){return this.vouchersService.previewVoucherRedeem(t)}performTransaction(t,i){return t&&(i.body=t.redeem,i.body.pin=this.pin.value),this.vouchersService.redeemVoucher(i)}resendPin(){this.addSub(this.vouchersService.resendPin({key:this.dataForTransaction.token}).subscribe(t=>{this.notification.info(this.i18n.voucher.pinSent((t||[]).join(", ")))}))}validatePerformFromForm(t,i){return!!(0,h.pt)(i)}validatePerformFromPreview(t){return!t.pinInput||!!(0,h.pt)(this.pin)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["redeem-voucher"]],features:[e.qOj],decls:8,vars:9,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["loading",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"data","token","scan"],[3,"disabled","label","action"],["class","mb-3","type","warning",4,"ngIf"],[3,"data","form","amountAsField"],[4,"ngIf"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],["type","warning",1,"mb-3"],["kind","field","required","",3,"label"],["disableAutocomplete","",3,"formControl","passwordInput"],["ngClass","mb-3","type","warning"],[3,"preview","transaction","data",4,"ngIf"],[3,"preview","transaction","data"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,xh,4,9,"page-content",1),e.YNc(4,Ah,4,9,"page-content",1),e.YNc(5,Uh,4,9,"page-content",1),e.qZA(),e.YNc(6,Nh,1,0,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","token"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,Z.Y,u.O5,Wt,L.h,k.x,Ee.c,Kt,C.t,Xt.C,s.JJ,s.oH,u.mk,en,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var Jh=m(441);let tn=(()=>{class n extends ae.t{constructor(t){super(t),this.vouchersService=t.get(ge)}toSearchParams(t){return t}doSearch(t){return this.vouchersService.searchVouchers$Response(t)}get statusOptions(){let t=Object.values(Re.v);return this.useInactiveStatus()||(t=t.filter(i=>i!==Re.v.INACTIVE)),t.map(i=>({value:i,text:this.apiI18n.voucherStatus(i)}))}useInactiveStatus(){return!0}get toLink(){return t=>this.path(t)}path(t){return["/banking/vouchers/view/",t.id]}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275dir=e.lG2({type:n,features:[e.qOj]}),n})();var Lh=m(8680);function kh(n,a){1&n&&e.GkF(0)}function Fh(n,a){1&n&&e._UZ(0,"div",8)}function Oh(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",8)(2,"label-value",15),e._UZ(3,"user-link",16),e.qZA()(),e.YNc(4,Fh,1,0,"div",7),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function Dh(n,a){if(1&n&&e._UZ(0,"field-option",19),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function Rh(n,a){if(1&n&&(e.TgZ(0,"div",8)(1,"multi-selection-field",17),e.YNc(2,Dh,1,4,"field-option",18),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.general.type),e.xp6(1),e.Q6J("ngForOf",t.data.types)}}function Vh(n,a){if(1&n&&(e.TgZ(0,"div",20),e._UZ(1,"radio-group-field",21),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("asColumn",e.lcZ(2,3,t.layout.ltsm$))("label",t.i18n.voucher.creationType.userLabel)("fieldOptions",t.creationTypeOptions)}}function Yh(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",22),e.TgZ(2,"div",8),e._UZ(3,"date-field",23),e.qZA(),e.TgZ(4,"div",8),e._UZ(5,"date-field",24),e.qZA(),e.TgZ(6,"div",8),e._UZ(7,"date-field",25),e.qZA(),e.TgZ(8,"div",8),e._UZ(9,"date-field",26),e.qZA(),e.TgZ(10,"div",8),e._UZ(11,"decimal-field",27),e.qZA(),e.TgZ(12,"div",8),e._UZ(13,"decimal-field",28),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("label",t.i18n.voucher.beginCreationDate),e.xp6(2),e.Q6J("label",t.i18n.voucher.endCreationDate),e.xp6(2),e.Q6J("label",t.i18n.voucher.beginExpirationDate),e.xp6(2),e.Q6J("label",t.i18n.voucher.endExpirationDate),e.xp6(2),e.Q6J("label",t.i18n.ad.minPrice),e.xp6(2),e.Q6J("label",t.i18n.ad.maxPrice)}}function Eh(n,a){if(1&n&&(e.TgZ(0,"mobile-result",29)(1,"div",30),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.creationDate)("amount",t.amount)("amountColor",!1)("avatarImage",t.type.image)("avatarIcon",i.SvgIcon.Ticket)("currency",t.type.configuration.currency),e.xp6(2),e.hij(" ",t.type.voucherTitle," ")}}function $h(n,a){if(1&n&&(e.TgZ(0,"a",37),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Oqu(e.lcZ(2,2,t.expirationDate))}}function Bh(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",35),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(1,"td",32),e._UZ(2,"avatar",36),e.qZA(),e.TgZ(3,"td")(4,"a",37),e._uU(5),e.qZA()(),e.TgZ(6,"td"),e.YNc(7,$h,3,4,"a",38),e.qZA(),e.TgZ(8,"td")(9,"a",37),e._uU(10),e.qZA()(),e.TgZ(11,"td",33)(12,"a",37),e._uU(13),e.ALo(14,"currency"),e.qZA()(),e.TgZ(15,"td",33)(16,"a",37),e._uU(17),e.ALo(18,"currency"),e.qZA()()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("image",t.type.image)("icon",i.SvgIcon.Ticket),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Oqu(t.type.voucherTitle),e.xp6(2),e.Q6J("ngIf",t.status!==i.VoucherStatusEnum.REDEEMED),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Oqu(i.apiI18n.voucherStatus(t.status)),e.xp6(2),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Oqu(e.xi3(14,11,t.amount,t.type.configuration.currency)),e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.Oqu(e.xi3(18,14,t.balance,t.type.configuration.currency))}}function Hh(n,a){if(1&n&&(e.TgZ(0,"table",31)(1,"tbody"),e._UZ(2,"th",32),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th",33),e._uU(10),e.qZA(),e.TgZ(11,"th",33),e._uU(12),e.qZA(),e.YNc(13,Bh,19,17,"tr",34),e.ALo(14,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.voucher.voucher),e.xp6(2),e.Oqu(t.i18n.general.expirationDate),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Oqu(t.i18n.voucher.balance),e.xp6(1),e.Q6J("ngForOf",null==(i=e.lcZ(14,6,t.results$))?null:i.results)}}function jh(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,Oh,5,3,"ng-container",6),e.YNc(5,Rh,3,3,"div",7),e.TgZ(6,"div",8),e._UZ(7,"multi-selection-field",9),e.qZA(),e.TgZ(8,"div",8),e._UZ(9,"input-field",10),e.qZA(),e.YNc(10,Vh,3,5,"div",11),e.YNc(11,Yh,14,6,"ng-container",6),e.ALo(12,"async"),e.qZA()()(),e.TgZ(13,"results-layout",12),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(14,"async"),e.YNc(15,Eh,3,7,"mobile-result",13),e.YNc(16,Hh,15,8,"table",14),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.voucher.title.search)("mobileHeading",t.i18n.voucher.mobileTitle.search)("headingActions",e.lcZ(1,16,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(1),e.Q6J("ngIf",(null==t.data.types?null:t.data.types.length)>0),e.xp6(2),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.general.status)("fieldOptions",t.statusOptions),e.xp6(2),e.Q6J("label",t.i18n.voucher.token)("mask",t.data.mask),e.xp6(1),e.Q6J("ngIf",t.data.canBuy&&t.data.canSend),e.xp6(1),e.Q6J("ngIf",e.lcZ(12,18,t.moreFilters$)),e.xp6(2),e.Q6J("results",e.lcZ(14,20,t.results$))("rendering$",t.rendering$)("toLink",t.toLink)}}let Mh=(()=>{class n extends tn{constructor(t){super(t),this.VoucherStatusEnum=Re.v}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user"),this.addSub(this.vouchersService.getUserVouchersDataForSearch({user:this.param}).subscribe(t=>this.data=t))}prepareForm(t){this.form.patchValue({creationType:"all"})}onDataInitialized(t){var i;super.onDataInitialized(t),this.self=this.authHelper.isSelf(t.user);const o=[this.moreFiltersAction];t.canBuy&&o.push(new T.Yu(x.l.TicketArrowLeft,this.i18n.voucher.buy.buy,()=>this.buy())),t.canSend&&o.push(new T.Yu(x.l.TicketArrowRight,this.i18n.voucher.send.send,()=>this.send())),t.canSendImport&&o.push(new T.Yu(x.l.ArrowUpCircle,this.i18n.voucher.send.sendImport,()=>this.sendImport())),o.push(...this.exportActions(t)),this.headingActions=o,null===(i=this.form.get("creationType"))||void 0===i||i.valueChanges.subscribe(()=>{var r;this.headingActions$.next(this.headingActions.filter(l=>l.id!==Lh.A.EXPORT_ACTION)),(null===(r=this.form.get("creationType"))||void 0===r?void 0:r.value)!==re.t.SENT&&this.headingActions.push(...this.exportActions(t))})}exportActions(t){return this.exportHelper.headingActions(t.exportFormats,i=>this.vouchersService.exportUserVouchers$Response(Object.assign({format:i.internalName},this.toSearchParams(this.form.value))))}toSearchParams(t){const i=super.toSearchParams(t);return i.user=this.param,i.amountRange=b.S.rangeFilter(t.minAmount,t.maxAmount),i.creationPeriod=b.S.dateRangeFilter(t.beginCreationDate,t.endCreationDate),i.expirationPeriod=b.S.dateRangeFilter(t.beginExpirationDate,t.endExpirationDate),"all"===i.creationType&&(i.creationType=null),i.fields=["id","amount","balance","status","creationDate","expirationDate","type.image","type.voucherTitle","type.configuration.currency"],i}doSearch(t){return this.vouchersService.searchUserVouchers$Response(t)}getFormControlNames(){return["types","token","statuses","creationType","minAmount","maxAmount","beginCreationDate","endCreationDate","beginExpirationDate","endExpirationDate"]}buy(){this.router.navigate(["/banking",this.param,"vouchers","buy"])}send(){this.router.navigate(["/banking",this.param,"vouchers","send"])}sendImport(){this.router.navigate(["/imports",this.param,Jh.R.USER_SEND_VOUCHERS,"files"])}get creationTypeOptions(){return["all",re.t.BOUGHT,re.t.SENT].map(i=>({value:i,text:"all"===i?this.i18n.general.all:this.apiI18n.voucherCreationType(i)}))}useInactiveStatus(){return!1}resolveMenu(t){return this.menu.userMenu(t.user,this.dataForFrontendHolder.dataForFrontend.voucherBuyingMenu==ht.K.MARKETPLACE?v.v2.SEARCH_MY_VOUCHERS_MARKETPLACE:v.v2.SEARCH_MY_VOUCHERS_BANKING)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-user-vouchers"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["formControlName","token",3,"label","mask"],["class","col-12",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"date","amount","amountColor","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","types",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"col-12"],["formControlName","creationType",3,"asColumn","label","fieldOptions"],[1,"w-100"],["formControlName","beginCreationDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","endCreationDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginExpirationDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","endExpirationDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","minAmount","fieldSize","full",3,"label"],["formControlName","maxAmount","fieldSize","full",3,"label"],[3,"date","amount","amountColor","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink",4,"ngIf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,kh,1,0,"ng-container",1),e.qZA(),e.YNc(3,jh,17,22,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,C.t,Q.F,be.x,s.JJ,s.u,u.sg,J.s,F.q,fe.h,qe.Y,j.Q,B.U,D.D,R.E,V.t,Y.p,Pe.A,ce.yS],pipes:[u.Ov,Ce.i,w.H],encapsulation:2,changeDetection:0}),n})();function zh(n,a){1&n&&e.GkF(0)}function Gh(n,a){1&n&&e._UZ(0,"div",9)}function Wh(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",9)(2,"label-value",15),e._UZ(3,"user-link",16),e.qZA()(),e.YNc(4,Gh,1,0,"div",7),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function Xh(n,a){if(1&n&&e._UZ(0,"field-option",19),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function Kh(n,a){if(1&n&&(e.TgZ(0,"div",9)(1,"multi-selection-field",17),e.YNc(2,Xh,1,4,"field-option",18),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.type),e.xp6(1),e.Q6J("ngForOf",t.data.types)}}function e1(n,a){if(1&n&&(e.TgZ(0,"div",9),e._UZ(1,"multi-selection-field",20),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.voucher.transaction.kind)("fieldOptions",t.kindsOptions)}}function t1(n,a){if(1&n&&(e.TgZ(0,"mobile-result",21)(1,"div",22),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",t.date)("amount",t.amount)("currency",t.type.configuration.currency)("avatarImage",t.type.image)("avatarIcon",i.SvgIcon.Ticket)("amountColor",!1),e.xp6(2),e.hij(" ",t.type.voucherTitle," ")}}function n1(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.voucher.transaction.kind)}}function i1(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.apiI18n.voucherTransactionKind(t.kind)," ")}}function o1(n,a){if(1&n&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.i18n.voucher.transaction.searchResultChargebackTitle," ")}}function a1(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",27),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(2,"td",24),e._UZ(3,"avatar",28),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"dateTime"),e.qZA(),e.YNc(7,i1,2,1,"td",6),e.TgZ(8,"td"),e.YNc(9,o1,3,1,"ng-container",6),e._uU(10),e.qZA(),e.TgZ(11,"td",25),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",t.type.image)("icon",i.SvgIcon.Ticket),e.xp6(2),e.hij(" ",e.lcZ(6,7,t.date)," "),e.xp6(2),e.Q6J("ngIf",i.data.topUpEnabled),e.xp6(2),e.Q6J("ngIf",!i.data.topUpEnabled&&t.kind===i.VoucherTransactionKind.CHARGEBACK),e.xp6(1),e.hij(" ",t.type.voucherTitle," "),e.xp6(2),e.hij(" ",e.xi3(13,9,i.format.abs(t.amount),t.type.configuration.currency)," ")}}function r1(n,a){if(1&n&&(e.TgZ(0,"table",23)(1,"thead"),e._UZ(2,"th",24),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.YNc(5,n1,2,1,"th",6),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th",25),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,a1,14,12,"ng-container",26),e.ALo(12,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.voucher.transaction.date),e.xp6(1),e.Q6J("ngIf",t.data.topUpEnabled),e.xp6(2),e.Oqu(t.i18n.voucher.voucher),e.xp6(2),e.Oqu(t.i18n.voucher.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(12,5,t.results$))?null:i.results)}}function s1(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5),e.YNc(4,Wh,5,3,"ng-container",6),e.YNc(5,Kh,3,2,"div",7),e.YNc(6,e1,2,3,"div",7),e.TgZ(7,"div",8)(8,"div",9),e._UZ(9,"date-field",10),e.qZA(),e.TgZ(10,"div",9),e._UZ(11,"date-field",11),e.qZA()()()()(),e.TgZ(12,"results-layout",12),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(13,"async"),e.YNc(14,t1,3,7,"mobile-result",13),e.YNc(15,r1,13,7,"table",14),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.resolveVoucherTransactionsTitle())("mobileHeading",t.resolveVoucherTransactionsMobileTitle())("headingActions",e.lcZ(1,12,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(1),e.Q6J("ngIf",(null==t.data.types?null:t.data.types.length)>1),e.xp6(1),e.Q6J("ngIf",t.data.topUpEnabled),e.xp6(3),e.Q6J("label",t.i18n.general.beginDate),e.xp6(2),e.Q6J("label",t.i18n.general.endDate),e.xp6(1),e.Q6J("results",e.lcZ(13,14,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let c1=(()=>{class n extends ae.t{constructor(t,i){super(t),this.vouchersService=i,this.VoucherTransactionKind=me.n}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user"),this.addSub(this.vouchersService.getUserVoucherTransactionsDataForSearch({user:this.param}).subscribe(t=>this.data=t))}getFormControlNames(){return["types","kinds","periodBegin","periodEnd"]}onDataInitialized(t){super.onDataInitialized(t),this.self=this.authHelper.isSelf(t.user);const i=[];t.canRedeem&&i.push(new T.Yu(x.l.TicketArrowDown,this.i18n.voucher.redeem.redeem,()=>this.redeem(),!0)),t.canTopUp&&i.push(new T.Yu(x.l.TicketArrowUp,this.i18n.voucher.topUp.topUp,()=>this.topUp(),!0)),this.headingActions=i}toSearchParams(t){const i=t;return i.user=this.param,(t.periodBegin||t.periodEnd)&&(i.datePeriod=this.ApiHelper.dateRangeFilter(t.periodBegin,t.periodEnd)),i.fields=["id","date","kinds","amount","type.voucherTitle","type.configuration.currency","type.image"],i}doSearch(t){return this.vouchersService.searchUserVoucherTransactions$Response(t)}get kindsOptions(){return[me.n.REDEEM,me.n.TOP_UP,me.n.CHARGEBACK].map(i=>({value:i,text:this.apiI18n.voucherTransactionKind(i)}))}resolveVoucherTransactionsTitle(){return this.data.topUpEnabled?this.i18n.voucher.title.transactions:this.i18n.voucher.title.transactionsRedeems}resolveVoucherTransactionsMobileTitle(){return this.data.topUpEnabled?this.i18n.voucher.mobileTitle.transactions:this.i18n.voucher.mobileTitle.transactionsRedeems}redeem(){this.router.navigate(["/banking",this.param,"vouchers","redeem"])}topUp(){this.router.navigate(["/banking",this.param,"vouchers","top-up"])}get toLink(){return t=>this.path(t)}path(t){return["/banking","voucher-transactions","view",t.id]}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.VOUCHER_TRANSACTIONS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-voucher-transactions"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],[1,"col-12","col-md-6"],["formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency","avatarImage","avatarIcon","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","kinds",3,"emptyLabel","label","fieldOptions"],[3,"date","amount","currency","avatarImage","avatarIcon","amountColor"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,zh,1,0,"ng-container",1),e.qZA(),e.YNc(3,s1,16,16,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,Z.Y,s.JL,s.sg,C.t,Q.F,be.x,s.JJ,s.u,u.sg,J.s,j.Q,D.D,R.E,V.t,Y.p,Pe.A],pipes:[u.Ov,Ce.i,w.H],encapsulation:2,changeDetection:0}),n})();var ye=(()=>{return(n=ye||(ye={})).CREATION_DATE_ASC="creationDateAsc",n.CREATION_DATE_DESC="creationDateDesc",n.EXPIRATION_DATE_ASC="expirationDateAsc",n.EXPIRATION_DATE_DESC="expirationDateDesc",n.REDEEM_DATE_ASC="redeemDateAsc",n.REDEEM_DATE_DESC="redeemDateDesc",ye;var n})();function l1(n,a){if(1&n&&e._UZ(0,"field-option",15),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function u1(n,a){if(1&n&&(e.TgZ(0,"div",4)(1,"multi-selection-field",13),e.YNc(2,l1,1,4,"field-option",14),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("label",t.i18n.general.type),e.xp6(1),e.Q6J("ngForOf",t.data.types)}}function p1(n,a){if(1&n&&e._UZ(0,"field-option",34),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function m1(n,a){if(1&n&&(e.TgZ(0,"div",4)(1,"multi-selection-field",32),e.YNc(2,p1,1,5,"field-option",33),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.voucher.buyerGroups),e.xp6(1),e.Q6J("ngForOf",t.data.userGroups)}}function d1(n,a){if(1&n&&e._UZ(0,"field-option",34),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function f1(n,a){if(1&n&&(e.TgZ(0,"div",4)(1,"multi-selection-field",35),e.YNc(2,d1,1,5,"field-option",33),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.voucher.transaction.userGroups),e.xp6(1),e.Q6J("ngForOf",t.data.userGroups)}}function _1(n,a){if(1&n&&(e.TgZ(0,"div",4),e._UZ(1,"custom-field-filter",36),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("field",t)("formControl",i.form.get("customFields").get(t.internalName))}}function h1(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",16)(2,"div",4),e._UZ(3,"date-field",17),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"date-field",18),e.qZA()(),e.TgZ(6,"div",16)(7,"div",4),e._UZ(8,"date-field",19),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"date-field",20),e.qZA()(),e.TgZ(11,"div",16)(12,"div",4),e._UZ(13,"date-field",21),e.qZA(),e.TgZ(14,"div",4),e._UZ(15,"date-field",22),e.qZA()(),e.TgZ(16,"div",16)(17,"div",4),e._UZ(18,"decimal-field",23,24),e.qZA(),e.TgZ(20,"div",4),e._UZ(21,"decimal-field",25,24),e.qZA()(),e.YNc(23,m1,3,2,"div",3),e.TgZ(24,"div",4)(25,"label-value",26),e._UZ(26,"user-field",27),e.qZA()(),e.YNc(27,f1,3,2,"div",3),e.TgZ(28,"div",4)(29,"label-value",26),e._UZ(30,"user-field",28),e.qZA()(),e.TgZ(31,"div",4),e._UZ(32,"input-field",29),e.qZA(),e.TgZ(33,"div",4),e._UZ(34,"input-field",30),e.qZA(),e.YNc(35,_1,2,2,"div",31),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("label",t.i18n.general.creationDate),e.xp6(2),e.Q6J("label",t.i18n.general.to),e.xp6(3),e.Q6J("label",t.i18n.general.expirationDate),e.xp6(2),e.Q6J("label",t.i18n.general.to),e.xp6(3),e.Q6J("label",t.i18n.voucher.transaction.date),e.xp6(2),e.Q6J("label",t.i18n.general.to),e.xp6(3),e.Q6J("label",t.i18n.transaction.amount)("scale",t.maxScale),e.xp6(3),e.Q6J("label",t.i18n.general.to)("scale",t.maxScale),e.xp6(2),e.Q6J("ngIf",(null==t.data.userGroups?null:t.data.userGroups.length)>1),e.xp6(2),e.Q6J("label",t.i18n.voucher.buy.buyer),e.xp6(1),e.Q6J("autoSearch",!0)("allowContacts",!0)("allowSearch",!0),e.xp6(1),e.Q6J("ngIf",(null==t.data.userGroups?null:t.data.userGroups.length)>1),e.xp6(2),e.Q6J("label",t.i18n.voucher.transaction.user),e.xp6(1),e.Q6J("autoSearch",!0)("allowContacts",!0)("allowSearch",!0),e.xp6(2),e.Q6J("label",t.i18n.user.email),e.xp6(2),e.Q6J("label",t.i18n.phone.mobile),e.xp6(1),e.Q6J("ngForOf",t.customFieldsInSearch)}}function g1(n,a){if(1&n&&e._UZ(0,"field-option",9),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("value",t)("text",i.orderBy(t))}}let y1=(()=>{class n extends q.H{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.mask=this.data.mask?this.data.mask:""}get statusOptions(){return Object.values(Re.v).map(i=>({value:i,text:this.apiI18n.voucherStatus(i)}))}get creationTypeOptions(){return[re.t.GENERATED,re.t.BOUGHT,re.t.SENT].map(i=>({value:i,text:this.apiI18n.voucherCreationType(i)}))}get maxScale(){return this.data.types.map(t=>t.configuration.currency.decimalDigits).reduce((t,i,o,r)=>t>i?t:i)}orderByOptions(){return Object.values(ye)}orderBy(t){switch(t){case ye.CREATION_DATE_ASC:return this.i18n.voucher.sort.creationDateAsc;case ye.CREATION_DATE_DESC:return this.i18n.voucher.sort.creationDateDesc;case ye.EXPIRATION_DATE_ASC:return this.i18n.voucher.sort.expirationDateAsc;case ye.EXPIRATION_DATE_DESC:return this.i18n.voucher.sort.expirationDateDesc;case ye.REDEEM_DATE_ASC:return this.i18n.voucher.sort.redeemDateAsc;case ye.REDEEM_DATE_DESC:return this.i18n.voucher.sort.redeemDateDesc}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-filters"]],inputs:{data:"data",heading:"heading",mobileHeading:"mobileHeading",form:"form",moreFilters:"moreFilters",headingActions:"headingActions",customFieldsInSearch:"customFieldsInSearch"},features:[e.qOj],decls:18,vars:23,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["type","text","formControlName","token",3,"label","mask","placeholder"],["formControlName","creationType",3,"label","fieldOptions","emptyOption"],["formControlName","printed",3,"label","emptyOption"],[3,"value","text"],[4,"ngIf"],["formControlName","orderBy",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"row","no-gutters","col-12"],["formControlName","creationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","creationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","expirationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","expirationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","transactionDateBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","transactionDateEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","amountMin",3,"label","scale"],["amount",""],["formControlName","amountMax",3,"label","scale"],["kind","field",3,"label"],["formControlName","buyer",3,"autoSearch","allowContacts","allowSearch"],["formControlName","transactionUser",3,"autoSearch","allowContacts","allowSearch"],["formControlName","email",3,"label"],["formControlName","mobilePhone",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["hierarchyProperty","groupSet","formControlName","buyerGroups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["hierarchyProperty","groupSet","formControlName","transactionUserGroups",3,"label"],[3,"field","formControl"]],template:function(t,i){1&t&&(e.TgZ(0,"page-content",0)(1,"div",1)(2,"div",2),e.YNc(3,u1,3,2,"div",3),e.TgZ(4,"div",4),e._UZ(5,"multi-selection-field",5),e.qZA(),e.TgZ(6,"div",4),e._UZ(7,"input-field",6),e.qZA(),e.TgZ(8,"div",4),e._UZ(9,"single-selection-field",7),e.qZA(),e.TgZ(10,"div",4)(11,"single-selection-field",8),e._UZ(12,"field-option",9)(13,"field-option",9),e.qZA()(),e.YNc(14,h1,36,23,"ng-container",10),e.TgZ(15,"div",4)(16,"single-selection-field",11),e.YNc(17,g1,1,2,"field-option",12),e.qZA()()()()()),2&t&&(e.Q6J("heading",i.heading)("mobileHeading",i.mobileHeading)("headingActions",i.headingActions),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(2),e.Q6J("ngIf",(null==i.data.types?null:i.data.types.length)>1),e.xp6(2),e.Q6J("label",i.i18n.general.status)("fieldOptions",i.statusOptions)("emptyLabel",i.i18n.general.notApplied),e.xp6(2),e.Q6J("label",i.i18n.voucher.token)("mask",i.mask)("placeholder",i.mask),e.xp6(2),e.Q6J("label",i.i18n.voucher.creationType.label)("fieldOptions",i.creationTypeOptions)("emptyOption",i.i18n.general.all),e.xp6(2),e.Q6J("label",i.i18n.general.printed)("emptyOption",i.i18n.general.all),e.xp6(1),e.Q6J("value","true")("text",i.i18n.general.yes),e.xp6(1),e.Q6J("value","false")("text",i.i18n.general.no),e.xp6(1),e.Q6J("ngIf",i.moreFilters),e.xp6(2),e.Q6J("label",i.i18n.general.orderBy),e.xp6(1),e.Q6J("ngForOf",i.orderByOptions()))},directives:[Z.Y,s.JL,s.sg,u.O5,be.x,s.JJ,s.u,u.sg,J.s,F.q,fe.h,O.f,j.Q,B.U,C.t,te.l,Ze.L,s.oH],encapsulation:2,changeDetection:0}),n})();function x1(n,a){1&n&&e.GkF(0)}function b1(n,a){if(1&n&&(e.TgZ(0,"mobile-result",7)(1,"div",8),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",t.type.image)("avatarIcon",i.SvgIcon.Ticket)("amount",t.amount)("amountColor",!1)("currency",t.type.configuration.currency)("topLeft",i.apiI18n.voucherStatus(t.status)),e.xp6(2),e.hij(" ",t.type.name," ")}}function v1(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.path(r))}),e.TgZ(2,"td",10),e._UZ(3,"avatar",14),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA(),e.TgZ(14,"td",11),e._uU(15),e.ALo(16,"currency"),e.qZA(),e.TgZ(17,"td",11),e._uU(18),e.ALo(19,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",t.type.image)("icon",i.SvgIcon.Ticket),e.xp6(2),e.Oqu(e.lcZ(6,8,t.creationDate)),e.xp6(3),e.Oqu(e.lcZ(9,10,t.expirationDate)),e.xp6(3),e.Oqu(i.apiI18n.voucherStatus(t.status)),e.xp6(2),e.Oqu(t.type.name),e.xp6(2),e.hij(" ",e.xi3(16,12,t.amount,t.type.configuration.currency)," "),e.xp6(3),e.hij(" ",e.xi3(19,15,t.balance,t.type.configuration.currency),"")}}function T1(n,a){if(1&n&&(e.TgZ(0,"table",9)(1,"thead"),e._UZ(2,"th",10),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA(),e.TgZ(11,"th",11),e._uU(12),e.qZA(),e.TgZ(13,"th",11),e._uU(14),e.qZA()(),e.TgZ(15,"tbody"),e.YNc(16,v1,20,18,"ng-container",12),e.ALo(17,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.general.creationDate),e.xp6(2),e.Oqu(t.i18n.general.expirationDate),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.general.type),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Oqu(t.i18n.voucher.balance),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(17,7,t.results$))?null:i.results)}}function w1(n,a){if(1&n){const t=e.EpF();e._UZ(0,"voucher-filters",3),e.ALo(1,"async"),e.ALo(2,"async"),e.TgZ(3,"results-layout",4),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(4,"async"),e.YNc(5,b1,3,7,"mobile-result",5),e.YNc(6,T1,18,9,"table",6),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("data",t.data)("form",t.form)("heading",t.i18n.voucher.title.search)("mobileHeading",t.i18n.voucher.mobileTitle.search)("moreFilters",e.lcZ(1,10,t.moreFilters$))("headingActions",e.lcZ(2,12,t.headingActions$))("customFieldsInSearch",t.customFieldsInSearch),e.xp6(3),e.Q6J("results",e.lcZ(4,14,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}let C1=(()=>{class n extends tn{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.addSub(this.vouchersService.getGeneralVouchersDataForSearch({}).subscribe(t=>this.data=t))}prepareForm(t){this.customFieldsInSearch=[],t.fieldsInBasicSearch.forEach(i=>{var o=t.customFields.find(r=>r.internalName===i);o&&this.customFieldsInSearch.push(o)}),this.form.setControl("customFields",this.fieldHelper.customFieldsForSearchFormGroup(this.customFieldsInSearch,t.query.customFields))}onDataInitialized(t){super.onDataInitialized(t);const i=[this.moreFiltersAction];t.canGenerate&&i.push(new T.Yu(this.SvgIcon.Ticket,this.i18n.voucher.generate.generate,()=>this.generate())),i.push(...this.exportActions(t)),this.headingActions=i}exportActions(t){return this.exportHelper.headingActions(t.exportFormats,i=>this.vouchersService.exportVouchers$Response(Object.assign({format:i.internalName},this.toSearchParams(this.form.value))))}generate(){this.router.navigate(["/banking","vouchers","generate"])}getFormControlNames(){return["types","creationBegin","creationEnd","statuses","token","creationType","printed","customFields","amountMin","amountMax","expirationBegin","expirationEnd","transactionDateBegin","transactionDateEnd","buyer","transactionUser","buyerGroups","transactionUserGroups","email","mobilePhone","orderBy"]}toSearchParams(t){const i=super.toSearchParams(t);return(t.transactionDateBegin||t.transactionDateEnd)&&(i.transactionPeriod=this.ApiHelper.dateRangeFilter(t.redeemBegin,t.redeemEnd)),(t.creationBegin||t.creationEnd)&&(i.creationPeriod=this.ApiHelper.dateRangeFilter(t.creationBegin,t.creationEnd)),(t.expirationBegin||t.expirationEnd)&&(i.expirationPeriod=this.ApiHelper.dateRangeFilter(t.expirationBegin,t.expirationEnd)),(t.amountMin||t.amountMax)&&(i.amountRange=this.ApiHelper.rangeFilter(t.amountMin,t.amountMax)),i.customFields=this.fieldHelper.toCustomValuesFilter(t.customFields),i}resolveMenu(t){return v.v2.SEARCH_VOUCHERS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-vouchers"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"data","form","heading","mobileHeading","moreFilters","headingActions","customFieldsInSearch"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"avatarImage","avatarIcon","amount","amountColor","currency","topLeft",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"avatarImage","avatarIcon","amount","amountColor","currency","topLeft"],[1,"cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,x1,1,0,"ng-container",1),e.qZA(),e.YNc(3,w1,7,16,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[A.w,u.O5,y1,D.D,R.E,V.t,Y.p,u.sg,Pe.A],pipes:[u.Ov,E.u,w.H],encapsulation:2,changeDetection:0}),n})();function A1(n,a){if(1&n&&e._UZ(0,"user-info",9),2&n){const t=e.oxw();e.Q6J("user",t.data.user)}}function Z1(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.buy.minTimeToRedeem),e.xp6(1),e.hij(" ",t.i18n.voucher.buy.minTimeToRedeemAfterBuy(t.format.formatTimeInterval(t.data.minimumTimeToRedeem))," ")}}function P1(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.expirationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.expirationDate)," ")}}function q1(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.redeem.onDays),e.xp6(1),e.hij(" ",t.format.formatWeekDays(t.data.redeemOnWeekDays)||t.i18n.voucher.redeem.onDaysAny," ")}}function S1(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(2,2,t.fixedAmount,t.currency)," ")}}const Q1=function(n,a){return{min:n,max:a}};function U1(n,a){if(1&n&&(e._UZ(0,"label-value",12),e.ALo(1,"currency"),e.ALo(2,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.amountRange)("value",t.format.formatRange(e.WLB(8,Q1,e.xi3(1,2,t.data.amountRange.min,t.currency),e.xi3(2,5,t.data.amountRange.max,t.currency))))}}function N1(n,a){if(1&n&&(e._UZ(0,"label-value",12),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.minimumAmount)("value",e.xi3(1,2,t.data.amountRange.min,t.currency))}}function I1(n,a){if(1&n&&(e._UZ(0,"label-value",12),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.maximumAmount)("value",e.xi3(1,2,t.data.amountRange.max,t.currency))}}function J1(n,a){if(1&n&&(e._UZ(0,"decimal-field",10),e.YNc(1,U1,3,11,"label-value",11),e.YNc(2,N1,2,5,"label-value",11),e.YNc(3,I1,2,5,"label-value",11)),2&n){const t=e.oxw();e.Q6J("label",t.i18n.transaction.amount)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),e.xp6(1),e.Q6J("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)&&(null==t.data.amountRange?null:t.data.amountRange.max)),e.xp6(1),e.Q6J("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)&&!(null!=t.data.amountRange&&t.data.amountRange.max)),e.xp6(1),e.Q6J("ngIf",!(null!=t.data.amountRange&&t.data.amountRange.min)&&(null==t.data.amountRange?null:t.data.amountRange.max))}}function L1(n,a){if(1&n&&e._UZ(0,"custom-field-input",13),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.paymentCustomValues.get(t.internalName))}}function k1(n,a){if(1&n&&e._UZ(0,"custom-field-input",13),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("field",t)("formControl",i.form.controls.voucherCustomValues.get(t.internalName))}}let F1=(()=>{class n extends q.H{constructor(t,i){super(t),this.authHelper=i}ngOnInit(){super.ngOnInit();const t=this.data.amountRange;(null==t?void 0:t.min)&&(null==t?void 0:t.min)===t.max&&(this.fixedAmount=t.min,this.form.patchValue({amount:this.fixedAmount}))}get currency(){return this.data.account.currency}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["send-voucher-step-form"]],inputs:{data:"data",form:"form"},features:[e.qOj],decls:17,vars:18,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","email","required","",3,"label"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["regularAmount",""],["formControlName","message",3,"label"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],["required","","formControlName","amount",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf"],["kind","fieldView",3,"label","value"],[3,"field","formControl"]],template:function(t,i){if(1&t&&(e.ynx(0,0),e.YNc(1,A1,1,1,"user-info",1),e.TgZ(2,"label-value",2),e._uU(3),e.qZA(),e.TgZ(4,"label-value",2),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.YNc(7,Z1,2,2,"label-value",3),e.YNc(8,P1,3,4,"label-value",3),e.YNc(9,q1,2,2,"label-value",3),e._UZ(10,"input-field",4),e.YNc(11,S1,3,5,"label-value",5),e.YNc(12,J1,4,7,"ng-template",null,6,e.W1O),e._UZ(14,"textarea-field",7),e.YNc(15,L1,1,2,"custom-field-input",8),e.YNc(16,k1,1,2,"custom-field-input",8),e.BQk()),2&t){const o=e.MAs(13);e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.data.user&&!i.authHelper.isSelf(i.data.user)),e.xp6(1),e.Q6J("label",i.i18n.voucher.originAccount),e.xp6(1),e.hij(" ",i.data.account.type.name," "),e.xp6(1),e.Q6J("label",i.i18n.account.availableBalance),e.xp6(1),e.hij(" ",e.xi3(6,15,i.data.account.status.availableBalance,i.currency)," "),e.xp6(2),e.Q6J("ngIf",i.data.minimumTimeToRedeem),e.xp6(1),e.Q6J("ngIf",i.data.expirationDate),e.xp6(1),e.Q6J("ngIf",i.data.redeemOnWeekDays),e.xp6(1),e.Q6J("label",i.i18n.user.email),e.xp6(1),e.Q6J("ngIf",i.fixedAmount)("ngIfElse",o),e.xp6(3),e.Q6J("label",i.i18n.voucher.send.message),e.xp6(1),e.Q6J("ngForOf",i.data.paymentCustomFields),e.xp6(1),e.Q6J("ngForOf",i.data.voucherCustomFields)}},directives:[s.JL,s.sg,u.O5,oe.M,C.t,F.q,s.JJ,s.u,s.Q7,B.U,Te.u,u.sg,Se.G,s.oH],pipes:[w.H,E.u],encapsulation:2,changeDetection:0}),n})();function O1(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",5),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.preview.user)}}function D1(n,a){if(1&n&&(e.TgZ(0,"label-value",1),e._UZ(1,"user-link",5),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.owner),e.xp6(1),e.Q6J("user",t.preview.owner)}}function R1(n,a){if(1&n&&(e.TgZ(0,"label-value",6),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.send.message),e.xp6(1),e.Oqu(t.sendVoucher.message)}}function V1(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",7),e.ALo(2,"async"),e._UZ(3,"format-field-value",8),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.fieldHelper.hasValue(t.internalName,i.sendVoucher.paymentCustomValues))("label",t.name)("labelPosition",i.labelOnTop(e.lcZ(2,6,i.layout.ltsm$),t)?"top":"auto"),e.xp6(2),e.Q6J("customValues",i.sendVoucher.paymentCustomValues)("fields",i.paymentCustomFields)("fieldName",t.internalName)}}function Y1(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",7),e.ALo(2,"async"),e._UZ(3,"format-field-value",8),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(1),e.Q6J("hidden",!i.fieldHelper.hasValue(t.internalName,i.sendVoucher.voucherCustomValues))("label",t.name)("labelPosition",i.labelOnTop(e.lcZ(2,6,i.layout.ltsm$),t)?"top":"auto"),e.xp6(2),e.Q6J("customValues",i.sendVoucher.voucherCustomValues)("fields",i.voucherCustomFields)("fieldName",t.internalName)}}function E1(n,a){1&n&&e._UZ(0,"hr")}function $1(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,E1,1,0,"hr",0),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",9),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit.emit(o)})("confirmed",function(o){return e.CHM(t),e.oxw().confirmed.emit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.form.get("confirmationPassword"))("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}let B1=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.authHelper=i,this.fieldHelper=o,this.showSubmit=new e.vpe,this.confirmed=new e.vpe}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.sendVoucher=this.preview.sendVoucher,this.createDeviceConfirmation=()=>({type:U.l.SEND_VOUCHER,amount:this.sendVoucher.amount,voucherType:this.sendVoucher.type,email:this.sendVoucher.email}),this.preview.confirmationPasswordInput||this.addShortcut(Ye.Ce,()=>this.confirmed.emit())}labelOnTop(t,i){return!!t&&[W.L.RICH_TEXT,W.L.TEXT].includes(i?i.type:null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(M.N),e.Y36(Qt.A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["send-voucher-step-confirm"]],inputs:{preview:"preview",paymentCustomFields:"paymentCustomFields",voucherCustomFields:"voucherCustomFields",confirmationPassword:"confirmationPassword"},outputs:{showSubmit:"showSubmit",confirmed:"confirmed"},features:[e.qOj],decls:13,vars:15,consts:[[4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user"],["valueFormat","break",3,"label"],[3,"hidden","label","labelPosition"],[3,"customValues","fields","fieldName"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"]],template:function(t,i){1&t&&(e.YNc(0,O1,2,1,"ng-container",0),e.TgZ(1,"label-value",1),e._uU(2),e.qZA(),e.TgZ(3,"label-value",1),e._uU(4),e.qZA(),e.YNc(5,D1,2,2,"label-value",2),e.TgZ(6,"label-value",1),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.YNc(9,R1,2,2,"label-value",3),e.YNc(10,V1,4,8,"ng-container",4),e.YNc(11,Y1,4,8,"ng-container",4),e.YNc(12,$1,4,6,"ng-container",0)),2&t&&(e.Q6J("ngIf",i.preview.user&&!i.authHelper.isSelf(i.preview.user)),e.xp6(1),e.Q6J("label",i.i18n.voucher.voucher),e.xp6(1),e.hij(" ",i.preview.type.voucherTitle,"\n"),e.xp6(1),e.Q6J("label",i.i18n.user.email),e.xp6(1),e.hij(" ",i.sendVoucher.email,"\n"),e.xp6(1),e.Q6J("ngIf",i.preview.owner),e.xp6(1),e.Q6J("label",i.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(8,12,i.sendVoucher.amount,i.preview.type.configuration.currency),"\n"),e.xp6(2),e.Q6J("ngIf",i.sendVoucher.message),e.xp6(1),e.Q6J("ngForOf",i.paymentCustomFields),e.xp6(1),e.Q6J("ngForOf",i.voucherCustomFields),e.xp6(1),e.Q6J("ngIf",i.preview.confirmationPasswordInput))},directives:[u.O5,oe.M,C.t,Q.F,u.sg,ve.x,he.y,z.A,s.JJ,s.oH],pipes:[w.H,u.Ov],encapsulation:2,changeDetection:0}),n})();function H1(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"voucher-type-selection",4),e.NdJ("typeSelected",function(o){return e.CHM(t),e.oxw().toForm(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("user",t.data.user)("heading",t.i18n.voucher.title.send)("mobileHeading",t.i18n.voucher.mobileTitle.send)("categories",t.data.categories)("types",t.data.types)}}function j1(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToSelectType()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.previous)}}function M1(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e._UZ(2,"send-voucher-step-form",6),e.TgZ(3,"actions",7)(4,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().toConfirm()}),e.ALo(5,"async"),e.qZA(),e.YNc(6,j1,1,1,"action-button",9),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.dataTypeForBuy.type.voucherTitle)("mobileHeading",t.dataTypeForBuy.type.voucherTitle)("mode",e.lcZ(1,8,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("data",t.dataTypeForBuy)("form",t.form),e.xp6(2),e.Q6J("disabled",e.lcZ(5,10,t.requesting$))("label",t.i18n.general.next),e.xp6(2),e.Q6J("ngIf",!t.singleType)}}function z1(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).send()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",!t.canConfirm||e.lcZ(1,2,t.requesting$))("label",t.i18n.general.confirm)}}function G1(n,a){1&n&&e._uU(0,"\xa0")}function W1(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",5),e.ALo(1,"async"),e.TgZ(2,"send-voucher-step-confirm",11),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().send(o)}),e.qZA(),e.TgZ(3,"actions",7),e.YNc(4,z1,2,4,"action-button",12),e.ALo(5,"async"),e.YNc(6,G1,1,0,"ng-template",null,13,e.W1O),e.TgZ(8,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw().backToForm()}),e.qZA()()()}if(2&n){const t=e.MAs(7),i=e.oxw();e.Q6J("heading",i.i18n.voucher.title.sendConfirmation)("mobileHeading",i.i18n.voucher.mobileTitle.sendConfirmation)("mode",e.lcZ(1,10,i.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("preview",i.preview)("paymentCustomFields",i.dataTypeForBuy.paymentCustomFields)("voucherCustomFields",i.dataTypeForBuy.voucherCustomFields)("confirmationPassword",i.confirmationPassword),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,12,i.showSubmit$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.general.previous)}}function X1(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let K1=(()=>{class n extends $.y{constructor(t,i){super(t),this.voucherService=i,this.step$=new y.X(null),this.singleType=!1,this.showSubmit$=new y.X(!0)}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.params;this.user=this.authHelper.isSelf(t.user)?this.ApiHelper.SELF:t.user,this.addSub(this.voucherService.getVoucherDataForSend({user:this.user}).subscribe(i=>this.data=i))}onDataInitialized(t){const i=t.types||[];1===i.length?(this.singleType=!0,this.toForm(i[0])):this.step="select-type"}get currency(){return this.dataTypeForBuy.account.currency}send(t){var i;t&&this.confirmationPassword.setValue(t);const o=null===(i=this.preview)||void 0===i?void 0:i.confirmationPasswordInput;if(o&&!(0,h.pt)(this.confirmationPassword))return;const r=this.preview.sendVoucher;this.addSub(this.voucherService.sendVoucher({user:this.user,confirmationPassword:o?this.confirmationPassword.value:null,body:r}).subscribe(_=>{this.router.navigate(["/banking","vouchers","view",_.vouchers[0]]),this.notification.snackBar(this.i18n.voucher.send.done(r.email))}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(t){this.addSub(this.voucherService.getVoucherDataForSend({user:this.user,type:t.id,fields:["-type"]}).subscribe(i=>{i.type=t,this.dataTypeForBuy=i,this.buildForm(),this.step="form"}))}toConfirm(){if(!(0,h.pt)(this.form))return;const t=this.dataTypeForBuy.type,i=this.form.value;i.type=t.id,this.addSub(this.voucherService.previewSendVoucher({fields:["confirmationPasswordInput","owner","sendVoucher"],user:this.user,body:i}).subscribe(o=>{o.type=t,o.user=this.data.user;const r=o.confirmationPasswordInput;this.canConfirm=this.authHelper.canConfirm(o.confirmationPasswordInput),this.canConfirm?(r&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(s.kI.required))),this.step="confirm",this.preview=o):this.notification.warning(this.authHelper.getConfirmationMessage(r))}))}buildForm(){this.form?this.form.reset():(this.form=this.formBuilder.group({amount:1,email:["",s.kI.compose([s.kI.required,s.kI.email])],message:""}),this.form.addControl("paymentCustomValues",this.fieldHelper.customValuesFormGroup(this.dataTypeForBuy.paymentCustomFields)),this.form.addControl("voucherCustomValues",this.fieldHelper.customValuesFormGroup(this.dataTypeForBuy.voucherCustomFields)))}resolveMenu(t){return this.menu.userMenu(t.user,this.dataForFrontendHolder.dataForFrontend.voucherBuyingMenu==ht.K.MARKETPLACE?v.v2.SEARCH_MY_VOUCHERS_MARKETPLACE:v.v2.SEARCH_MY_VOUCHERS_BANKING)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["send-voucher"]],features:[e.qOj],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","heading","mobileHeading","categories","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"preview","paymentCustomFields","voucherCustomFields","confirmationPassword","showSubmit","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,H1,2,5,"ng-container",1),e.YNc(4,M1,7,12,"page-content",2),e.YNc(5,W1,9,14,"page-content",2),e.YNc(6,X1,2,0,"page-content",3),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","select-type"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,St.W,Z.Y,F1,L.h,k.x,u.O5,B1,u.ED,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();function eg(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"voucher-transaction-step-token",6),e.NdJ("scan",function(){return e.CHM(t),e.oxw(2).toForm()}),e.qZA(),e.TgZ(2,"actions")(3,"action-button",7),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).toForm()}),e.ALo(4,"async"),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("data",t.data)("token",t.token),e.xp6(2),e.Q6J("disabled",e.lcZ(4,4,t.requesting$))("label",t.i18n.general.next)}}function tg(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.YNc(2,eg,5,6,"ng-container",5),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.topUp)("mobileHeading",t.i18n.voucher.mobileTitle.topUp)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.data$))("ngIfElse",i)}}function ng(n,a){if(1&n&&(e.TgZ(0,"notification",13),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.voucher.topUp.confirm," ")}}function ig(n,a){1&n&&e._UZ(0,"hr")}function og(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,ig,1,0,"hr",10),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",14),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw(3).showSubmit$.next(o)})("confirmed",function(o){e.CHM(t);const r=e.oxw(3);return r.confirmationPassword.setValue(o),r.performFromForm()}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.confirmationPassword)("passwordInput",t.dataForTransaction.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}function ag(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",7),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).maybePreview()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.dataForTransaction.shouldPreview?t.i18n.general.next:t.i18n.general.submit)}}function rg(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,ng,2,1,"notification",8),e._UZ(2,"voucher-transaction-step-form",9),e.YNc(3,og,4,6,"ng-container",10),e.TgZ(4,"actions"),e.YNc(5,ag,2,4,"action-button",11),e.ALo(6,"async"),e.TgZ(7,"action-button",12),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToToken()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2),i=e.MAs(9);e.xp6(1),e.Q6J("ngIf",!t.dataForTransaction.shouldPreview),e.xp6(1),e.Q6J("data",t.dataForTransaction)("form",t.form)("amountAsField",t.dataForTransaction.generationAmount!==t.VoucherGenerationAmountEnum.GENERATION)("pinIsSent",t.pinIsSent),e.xp6(1),e.Q6J("ngIf",t.dataForTransaction.confirmationPasswordInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,9,t.showSubmit$))("ngIfElse",i),e.xp6(2),e.Q6J("label",t.i18n.general.previous)}}function sg(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.YNc(2,rg,8,11,"ng-container",5),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.topUp)("mobileHeading",t.i18n.voucher.mobileTitle.topUp)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.dataForTransaction$))("ngIfElse",i)}}function cg(n,a){if(1&n&&e._UZ(0,"voucher-transaction-step-confirm",17),2&n){const t=e.oxw(3);e.Q6J("preview",t.preview)("transaction",t.preview.topUp)("pinIsSent",t.pinIsSent)}}function lg(n,a){1&n&&e._UZ(0,"hr")}function ug(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.YNc(1,lg,1,0,"hr",10),e.ALo(2,"async"),e.TgZ(3,"confirmation-password",14),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw(3).showSubmit$.next(o)})("confirmed",function(o){e.CHM(t);const r=e.oxw(3);return r.confirmationPassword.setValue(o),r.performFromPreview()}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,t.layout.gtxxs$)),e.xp6(2),e.Q6J("formControl",t.confirmationPassword)("passwordInput",t.preview.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}function pg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",7),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).performFromPreview()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.submit)}}function mg(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"notification",15),e._uU(2),e.qZA(),e.YNc(3,cg,1,3,"voucher-transaction-step-confirm",16),e.ALo(4,"async"),e.YNc(5,ug,4,6,"ng-container",10),e.TgZ(6,"actions"),e.YNc(7,pg,2,4,"action-button",11),e.ALo(8,"async"),e.TgZ(9,"action-button",12),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).backToForm()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2),i=e.MAs(9);e.xp6(2),e.hij(" ",t.i18n.voucher.topUp.confirm," "),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,6,t.preview$)),e.xp6(2),e.Q6J("ngIf",t.preview.confirmationPasswordInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,8,t.showSubmit$))("ngIfElse",i),e.xp6(2),e.Q6J("label",t.i18n.general.previous)}}function dg(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.YNc(2,mg,10,10,"ng-container",5),e.ALo(3,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(7);e.Q6J("heading",t.i18n.voucher.title.topUp)("mobileHeading",t.i18n.voucher.mobileTitle.topUp)("mode",e.lcZ(1,5,t.layout.ltsm$)?"fullHeight":"normal"),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,t.dataForTransaction$))("ngIfElse",i)}}function fg(n,a){1&n&&e._UZ(0,"spinner")}function _g(n,a){1&n&&e._UZ(0,"div")}const nn=n=>{const a=n.parent;if(null!=a){const t=a.value;if((0,h.cS)(t.email)&&(0,h.cS)(t.mobilePhone))return s.kI.required(n)}return null};let hg=(()=>{class n extends Gt{constructor(t){super(t),this.VoucherGenerationAmountEnum=Ie,this.confirmationPassword=new s.NI("",s.kI.required),this.showSubmit$=new y.X(!0)}getInitialData(t){return this.vouchersService.getVoucherInitialDataForTopUp({user:t})}getVoucherTransactionData(t){return this.vouchersService.getVoucherDataForTopUp(t)}setupForm(t,i){i.generationAmount!==Ie.GENERATION&&t.addControl("amount",new s.NI(i.amount,s.kI.required)),i.isActivation&&(t.addControl("email",new s.NI(null)),t.addControl("mobilePhone",new s.NI(null)),i.pinOnActivation===je.INPUT&&(t.addControl("pin",new s.NI(null,nn)),t.addControl("pinConfirmation",new s.NI(null,nn)),t.addControl("checkPinConfirmation",new s.NI(!0)))),t.addControl("voucherCustomValues",this.fieldHelper.customValuesFormGroup(i.voucherCustomFields)),this.pinIsSent=i.pinOnActivation===je.SEND}previewTransaction(t){return this.vouchersService.previewVoucherTopUp(t)}performTransaction(t,i){return i.confirmationPassword=this.confirmationPassword.value,t&&(i.body=t.topUp),this.vouchersService.topUpVoucher(i)}validatePerformFromForm(t,i){return!(!(0,h.pt)(i)||t.confirmationPasswordInput&&!(0,h.pt)(this.confirmationPassword))}validatePerformFromPreview(t){return!t.confirmationPasswordInput||!!(0,h.pt)(this.confirmationPassword)}get createDeviceConfirmation(){return()=>{var t,i,o,r,l,_,g,P,S;return{type:U.l.TOP_UP_VOUCHER,voucherType:null!==(o=null===(i=null===(t=this.preview)||void 0===t?void 0:t.type)||void 0===i?void 0:i.id)&&void 0!==o?o:null===(l=null===(r=this.dataForTransaction)||void 0===r?void 0:r.type)||void 0===l?void 0:l.id,amount:null!==(S=null!==(g=null===(_=this.preview)||void 0===_?void 0:_.amount)&&void 0!==g?g:null===(P=this.dataForTransaction)||void 0===P?void 0:P.amount)&&void 0!==S?S:this.form.value.amount}}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["top-up-voucher"]],features:[e.qOj],decls:10,vars:9,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["loading",""],["emptyDiv",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"data","token","scan"],[3,"disabled","label","action"],["class","mb-3","type","warning",4,"ngIf"],[3,"data","form","amountAsField","pinIsSent"],[4,"ngIf"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["outline","",3,"label","action"],["type","warning",1,"mb-3"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"],["ngClass","mb-3","type","warning"],[3,"preview","transaction","pinIsSent",4,"ngIf"],[3,"preview","transaction","pinIsSent"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,tg,4,9,"page-content",1),e.YNc(4,sg,4,9,"page-content",1),e.YNc(5,dg,4,9,"page-content",1),e.qZA(),e.YNc(6,fg,1,0,"ng-template",null,2,e.W1O),e.YNc(8,_g,1,0,"ng-template",null,3,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$))("ngSwitch",e.lcZ(2,7,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","token"),e.xp6(1),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","confirm"))},directives:[A.w,u.RF,u.n9,Z.Y,u.O5,Wt,L.h,k.x,Ee.c,Kt,he.y,z.A,s.JJ,s.oH,u.mk,en,ne.O],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();function gg(n,a){if(1&n&&(e.TgZ(0,"notification",11)(1,"div"),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("icon",t.SvgIcon.Check2),e.xp6(2),e.Oqu(t.resolveLastTransactionNotificationMessage())}}function yg(n,a){if(1&n&&(e.TgZ(0,"label-value",12)(1,"maybe-link",13),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.token),e.xp6(1),e.Q6J("link",t.voucherLink),e.xp6(1),e.Oqu(t.transaction.token)}}function xg(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.transaction.user)("value",null==t.transaction.user?null:t.transaction.user.display)}}function bg(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.by)("value",null==t.transaction.by?null:t.transaction.by.display)}}function vg(n,a){if(1&n&&(e.TgZ(0,"label-value",12)(1,"maybe-link",13),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.transaction.payment),e.xp6(1),e.Q6J("link",t.transaction.payment.id?t.bankingHelper.transactionPath(t.transaction.payment):null),e.xp6(1),e.hij(" ",t.transaction.payment.display," ")}}const on=function(n){return["/banking","voucher-transactions","view",n]};function Tg(n,a){if(1&n&&(e.TgZ(0,"label-value",12)(1,"a",14),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.transaction.chargebackOf),e.xp6(1),e.Q6J("routerLink",e.VKq(3,on,t.transaction.chargebackOf.id)),e.xp6(1),e.hij(" ",t.i18n.voucher.transaction.viewTransaction," ")}}function wg(n,a){if(1&n&&(e.TgZ(0,"label-value",12)(1,"a",14),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.transaction.chargedBackBy),e.xp6(1),e.Q6J("routerLink",e.VKq(3,on,t.transaction.chargedBackBy.id)),e.xp6(1),e.hij(" ",t.i18n.voucher.transaction.viewTransaction," ")}}function Cg(n,a){1&n&&e._UZ(0,"custom-field-value",15),2&n&&e.Q6J("fieldValue",a.$implicit)}function Ag(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"actions",16)(2,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).navigateToPerformNew()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.close)}}function Zg(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,gg,3,2,"notification",4),e.TgZ(3,"div",5),e._UZ(4,"label-value",6),e.YNc(5,yg,3,3,"label-value",7),e._UZ(6,"label-value",6),e.ALo(7,"dateTime"),e.YNc(8,xg,1,2,"label-value",8),e.YNc(9,bg,1,2,"label-value",8),e._UZ(10,"label-value",6),e.ALo(11,"currency"),e.YNc(12,vg,3,3,"label-value",7),e.YNc(13,Tg,3,5,"label-value",7),e.YNc(14,wg,3,5,"label-value",7),e.YNc(15,Cg,1,1,"custom-field-value",9),e.qZA(),e.YNc(16,Ag,3,1,"ng-container",10),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("headingActions",e.lcZ(1,18,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.comesFromANewTransaction()),e.xp6(2),e.Q6J("label",t.i18n.voucher.voucher)("value",t.transaction.type.voucherTitle),e.xp6(1),e.Q6J("ngIf",t.transaction.token),e.xp6(1),e.Q6J("label",t.i18n.voucher.transaction.date)("value",e.lcZ(7,20,t.transaction.date)),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("ngIf",t.transaction.by),e.xp6(1),e.Q6J("label",t.i18n.voucher.transaction.amount)("value",e.xi3(11,22,t.transaction.amount,t.transaction.type.configuration.currency)),e.xp6(2),e.Q6J("ngIf",t.transaction.payment),e.xp6(1),e.Q6J("ngIf",t.transaction.chargebackOf),e.xp6(1),e.Q6J("ngIf",t.transaction.chargedBackBy),e.xp6(1),e.Q6J("ngForOf",t.data.customValues),e.xp6(1),e.Q6J("ngIf",t.comesFromANewTransaction())}}function Pg(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let qg=(()=>{class n extends nt.k{constructor(t,i,o){super(t),this.voucherService=i,this.bankingHelper=o}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.paramMap.get("id");this.addSub(this.voucherService.viewVoucherTransaction({id:t}).subscribe(i=>this.data=i))}onDataInitialized(t){switch(this.self=this.authHelper.isSelfOrOwner(t.user),this.headingActions=this.exportHelper.headingActions(t.exportFormats,i=>this.voucherService.exportVoucherTransaction$Response({format:i.internalName,id:t.id})),t.kind){case me.n.REDEEM:this.title=this.i18n.voucher.title.redeemDetails,this.mobileTitle=this.i18n.voucher.mobileTitle.redeemDetails;break;case me.n.TOP_UP:this.title=this.i18n.voucher.title.topUpDetails,this.mobileTitle=this.i18n.voucher.mobileTitle.topUpDetails;break;case me.n.CHARGEBACK:this.title=this.i18n.voucher.title.chargebackDetails,this.mobileTitle=this.i18n.voucher.mobileTitle.chargebackDetails}}get voucherLink(){return this.transaction.voucherId?["/banking","vouchers","view",this.transaction.voucherId]:null}viewTransaction(t){t.payment&&this.router.navigate(this.bankingHelper.transactionPath(t.payment))}resolveMenu(t){return this.dataForFrontendHolder.auth.role===_e.g.ADMINISTRATOR?v.v2.SEARCH_VOUCHERS:this.menu.userMenu(t.user,v.v2.VOUCHER_TRANSACTIONS)}resolveLastTransactionNotificationMessage(){return this.transaction.kind===me.n.REDEEM?this.i18n.voucher.redeem.done:this.i18n.voucher.topUp.done}comesFromANewTransaction(){return history.state.url}navigateToPerformNew(){this.router.navigateByUrl(history.state.url)}get transaction(){return this.data}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge),e.Y36(N.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-voucher-transaction"]],features:[e.qOj],decls:6,vars:7,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["loading",""],[3,"heading","mobileHeading","headingActions"],["class","mb-3","type","info",3,"icon",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label","value"],[3,"label",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],[4,"ngIf"],["type","info",1,"mb-3",3,"icon"],[3,"label"],[3,"link"],[3,"routerLink"],[3,"fieldValue"],["forceRow",""],[3,"label","action"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Zg,17,25,"page-content",1),e.ALo(3,"async"),e.qZA(),e.YNc(4,Pg,2,0,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(5);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,5,i.data$))("ngIfElse",o)}},directives:[A.w,u.O5,Z.Y,Ee.c,C.t,Pt.O,ce.yS,u.sg,Qe.W,L.h,k.x,ne.O],pipes:[u.Ov,Ce.i,w.H],encapsulation:2,changeDetection:0}),n})();var Sg=m(4414),Ve=(()=>{return(n=Ve||(Ve={})).CANCEL="cancel",n.CHANGE_EXPIRATION="changeExpiration",n.CHANGE_NOTIFICATION_SETTINGS="changeNotificationSettings",n.CHANGE_PIN="changePin",Ve;var n})(),xe=(()=>{return(n=xe||(xe={})).CANCEL_AND_CHARGEBACK="cancelAndChargeback",n.CANCEL_AND_REFUND="cancelAndRefund",n.CANCEL_GENERATED="cancelGenerated",n.CANCEL_PENDING_PACK="cancelPendingPack",n.CANCEL_PENDING_SINGLE="cancelPendingSingle",xe;var n})(),Qg=m(2400),Ug=m(2342);function Ng(n,a){if(1&n&&e._UZ(0,"input-field",9),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.changePin.oldPin)}}function Ig(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"confirmation-password",10),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().submit(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("createDeviceConfirmation",t.createDeviceConfirmation)("passwordInput",t.voucher.confirmationPasswordInput)}}function Jg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().submit()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.submit)}}function Lg(n,a){1&n&&e._UZ(0,"div")}const kg=n=>{const a=n.value;if(n.touched&&null!=a&&""!==a){const t=n.parent;if((null==t.get("newPin")?"":t.get("newPin").value)!==a)return{passwordsMatch:!0}}return null};let Fg=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.modalRef=i,this.vouchersService=o,this.VoucherCreationTypeEnum=re.t,this.done=new e.vpe,this.showSubmit$=new y.X(!0)}ngOnInit(){var t,i,o,r;super.ngOnInit(),this.form=this.formBuilder.group({newPin:[null,[s.kI.required,s.kI.minLength(null!==(i=null===(t=this.voucher.pinInput)||void 0===t?void 0:t.minLength)&&void 0!==i?i:6),s.kI.maxLength(null!==(r=null===(o=this.voucher.pinInput)||void 0===o?void 0:o.maxLength)&&void 0!==r?r:6)]],newPinConfirmation:[null,[s.kI.required,kg]]}),this.voucher.requireOldPinForChange?this.form.addControl("oldPin",new s.NI(null,s.kI.required)):this.voucher.confirmationPasswordInput&&this.form.addControl("confirmationPassword",new s.NI(null,s.kI.required))}submit(t){if(t&&this.form.patchValue({confirmationPassword:t}),!(0,h.pt)(this.form))return;const i=this.form.value,o=Object.assign({},i);delete o.confirmationPassword,this.addSub(this.vouchersService.changeVoucherPin({key:this.voucher.id,confirmationPassword:i.confirmationPassword,body:o}).subscribe(()=>{this.done.emit(),this.modalRef.hide()}))}get createDeviceConfirmation(){return()=>({type:U.l.MANAGE_VOUCHER,voucher:this.voucher.id,voucherAction:Ve.CHANGE_PIN})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(He.UZ),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-change-pin-dialog"]],inputs:{voucher:"voucher"},outputs:{done:"done"},features:[e.qOj],decls:13,vars:12,consts:[[3,"formGroup"],["required","","focused","","formControlName","oldPin","type","password",3,"label",4,"ngIf"],["required","","formControlName","newPin","type","password",3,"focused","label"],["required","","formControlName","newPinConfirmation","type","password",3,"label"],["class","mt-4","formControlName","confirmationPassword",3,"createDeviceConfirmation","passwordInput","showSubmit","confirmed",4,"ngIf"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["outline","",3,"label","action"],["emptyDiv",""],["required","","focused","","formControlName","oldPin","type","password",3,"label"],["formControlName","confirmationPassword",1,"mt-4",3,"createDeviceConfirmation","passwordInput","showSubmit","confirmed"],[3,"disabled","label","action"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.ynx(2,0),e.YNc(3,Ng,1,1,"input-field",1),e._UZ(4,"input-field",2)(5,"input-field",3),e.YNc(6,Ig,1,2,"confirmation-password",4),e.BQk(),e.TgZ(7,"actions",5),e.YNc(8,Jg,2,4,"action-button",6),e.ALo(9,"async"),e.TgZ(10,"action-button",7),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA(),e.YNc(11,Lg,1,0,"ng-template",null,8,e.W1O),e.qZA()),2&t){const o=e.MAs(12);e.xp6(1),e.Oqu(i.i18n.voucher.changePin.title),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.voucher.requireOldPinForChange),e.xp6(1),e.Q6J("focused",!i.voucher.requireOldPinForChange)("label",i.i18n.voucher.changePin.newPin),e.xp6(1),e.Q6J("label",i.i18n.voucher.changePin.pinConfirmation),e.xp6(1),e.Q6J("ngIf",!i.voucher.requireOldPinForChange&&i.voucher.confirmationPasswordInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,10,i.showSubmit$))("ngIfElse",o),e.xp6(2),e.Q6J("label",i.i18n.general.cancel)}},directives:[s.JL,s.sg,u.O5,F.q,s.Q7,z.A,s.JJ,s.u,he.y,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();function Og(n,a){if(1&n&&e._UZ(0,"input-field",9),2&n){const t=e.oxw();e.Q6J("label",t.i18n.voucher.mobilePhone)}}function Dg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"confirmation-password",10),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw().showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw().submit(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("createDeviceConfirmation",t.createDeviceConfirmation)("passwordInput",t.voucher.confirmationPasswordInput)}}function Rg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().submit()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.submit)}}function Vg(n,a){1&n&&e._uU(0,"\xa0")}let Yg=(()=>{class n extends q.H{constructor(t,i,o){super(t),this.modalRef=i,this.vouchersService=o,this.VoucherCreationTypeEnum=re.t,this.done=new e.vpe,this.showSubmit$=new y.X(!0)}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({email:[this.voucher.email,s.kI.email],mobilePhone:this.voucher.mobilePhone,enableNotifications:this.voucher.enableNotifications}),this.voucher.confirmationPasswordInput&&this.form.addControl("confirmationPassword",new s.NI(null,s.kI.required)),this.voucher.creationType===re.t.SENT&&this.form.controls.email.setValidators([s.kI.required,s.kI.email])}submit(t){if(t&&this.form.patchValue({confirmationPassword:t}),!(0,h.pt)(this.form))return;const i=this.form.value,o=Object.assign({},i);delete o.confirmationPassword,this.addSub(this.vouchersService.changeVoucherNotificationSettings({key:this.voucher.id,confirmationPassword:i.confirmationPassword,body:o}).subscribe(()=>{this.done.emit(),this.modalRef.hide()}))}get createDeviceConfirmation(){return()=>({type:U.l.MANAGE_VOUCHER,voucher:this.voucher.id,voucherAction:Ve.CHANGE_NOTIFICATION_SETTINGS})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(He.UZ),e.Y36(ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["voucher-notification-settings-dialog"]],inputs:{voucher:"voucher"},outputs:{done:"done"},features:[e.qOj],decls:13,vars:12,consts:[[3,"formGroup"],["focused","","formControlName","email","type","text",3,"required","label"],["formControlName","mobilePhone","type","tel",3,"label",4,"ngIf"],["formControlName","enableNotifications","switch","",3,"label"],["class","mt-4","formControlName","confirmationPassword",3,"createDeviceConfirmation","passwordInput","showSubmit","confirmed",4,"ngIf"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["blank",""],["outline","",3,"label","action"],["formControlName","mobilePhone","type","tel",3,"label"],["formControlName","confirmationPassword",1,"mt-4",3,"createDeviceConfirmation","passwordInput","showSubmit","confirmed"],[3,"disabled","label","action"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.ynx(2,0),e._UZ(3,"input-field",1),e.YNc(4,Og,1,1,"input-field",2),e._UZ(5,"boolean-field",3),e.YNc(6,Dg,1,2,"confirmation-password",4),e.BQk(),e.TgZ(7,"actions",5),e.YNc(8,Rg,2,4,"action-button",6),e.ALo(9,"async"),e.YNc(10,Vg,1,0,"ng-template",null,7,e.W1O),e.TgZ(12,"action-button",8),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()()),2&t){const o=e.MAs(11);e.xp6(1),e.Oqu(i.i18n.voucher.notificationSettings.title),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("required",i.voucher.creationType===i.VoucherCreationTypeEnum.SENT)("label",i.i18n.voucher.email),e.xp6(1),e.Q6J("ngIf",i.voucher.creationType!=i.VoucherCreationTypeEnum.SENT),e.xp6(1),e.Q6J("label",i.i18n.voucher.enableNotifications),e.xp6(1),e.Q6J("ngIf",i.voucher.confirmationPasswordInput),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,10,i.showSubmit$))("ngIfElse",o),e.xp6(4),e.Q6J("label",i.i18n.general.cancel)}},directives:[s.JL,s.sg,F.q,z.A,s.JJ,s.u,s.Q7,u.O5,at.M,he.y,L.h,k.x],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();var Eg=m(7645),Bg=Math.floor;var Mg=m(4810),zg=m(6569),Gg=m(7266);const Xg=function Wg(n,a,t){return a=(t?(0,Mg.Z)(n,a,t):void 0===a)?1:(0,zg.Z)(a),function Hg(n,a){var t="";if(!n||a<1||a>9007199254740991)return t;do{a%2&&(t+=n),(a=Bg(a/2))&&(n+=n)}while(a);return t}((0,Gg.Z)(n),a)};let Kg=(()=>{class n extends Eg.k{constructor(t){super(t),this.classMaxWidth=!0,this.hidden$=new y.X(!0),this.display$=new y.X("")}ngOnInit(){super.ngOnInit(),this.addSub(this.hidden$.subscribe(()=>this.updateDisplay())),this.updateDisplay()}toggle(){this.hidden$.next(!this.hidden$.value)}updateDisplay(){this.display$.next(this.hidden$.value?Xg("\u2022",(this.text||"123456").length):this.text)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["hidden-text"]],hostVars:2,hostBindings:function(t,i){2&t&&e.ekj("mw-100",i.classMaxWidth)},inputs:{text:"text"},features:[e.qOj],decls:6,vars:6,consts:[[1,"hidden-text-label"],["href","#",1,"plain","hidden-text-icon",3,"click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._uU(1),e.ALo(2,"async"),e.qZA(),e.TgZ(3,"a",1),e.NdJ("click",function(r){return i.toggle(),r.preventDefault()}),e._UZ(4,"icon",2),e.ALo(5,"async"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,2,i.display$)),e.xp6(3),e.Q6J("icon",e.lcZ(5,4,i.hidden$)?i.SvgIcon.Eye:i.SvgIcon.EyeSlash))},directives:[lt.o],pipes:[u.Ov],encapsulation:2,changeDetection:0}),n})();function ey(n,a){if(1&n&&(e.TgZ(0,"div",16),e._UZ(1,"avatar-lightbox",17),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("image",t.data.type.image)}}function ty(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.configuration)("value",t.data.type.configuration.name)}}function ny(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.type)("value",t.data.type.name)}}function iy(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.token)("value",t.data.token)}}function oy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.data.allowPartialRedeems?t.i18n.voucher.redeem.amountAtCreation:t.i18n.transaction.amount)("value",e.xi3(1,2,t.data.amount,t.data.type.configuration.currency))}}function ay(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.balance)("value",e.xi3(1,2,t.data.balance,t.data.type.configuration.currency))}}function ry(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.creationType.label)("value",t.apiI18n.voucherCreationType(t.data.creationType))}}function sy(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.sentToEmail)("value",t.data.email)}}function cy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"dateTime")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.creationDate)("value",e.lcZ(1,2,t.data.creationDate))}}function ly(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.owner),e.xp6(1),e.Q6J("user",t.data.owner)}}function uy(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.data.creationType===t.VoucherCreationTypeEnum.SENT?t.i18n.voucher.send.issuer:t.i18n.voucher.buy.buyer),e.xp6(1),e.Q6J("user",t.data.buyer)}}function py(n,a){if(1&n&&(e.TgZ(0,"label-value",18)(1,"a",20),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.buy.payment),e.xp6(1),e.Q6J("routerLink",t.transactionPath(t.data.buy)),e.xp6(1),e.hij(" ",t.data.buy.display," ")}}function my(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"hidden-text",21),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.pin),e.xp6(1),e.Q6J("text",t.data.pin)}}function dy(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.pinStatusForRedeem.status)("value",t.apiI18n.voucherPinStatusForRedeem(t.data.pinStatusForRedeem))}}function fy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"dateTime")),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.general.expirationDate)("value",e.lcZ(1,2,t.data.expirationDate))}}function _y(n,a){if(1&n&&e._UZ(0,"label-value",22),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.expirationDateComments)("value",t.data.expirationDateComments)}}function hy(n,a){if(1&n&&(e.ynx(0),e.YNc(1,fy,2,4,"label-value",9),e.YNc(2,_y,1,2,"label-value",13),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.data.expirationDate),e.xp6(1),e.Q6J("ngIf",t.data.expirationDateComments)}}function gy(n,a){if(1&n&&e._UZ(0,"label-value",22),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.send.message)("value",t.data.sendMessage)}}function yy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"dateTime")),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.voucher.redeem.date)("value",e.lcZ(1,2,t.date))}}function xy(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.voucher.redeem.redeemer),e.xp6(1),e.Q6J("user",t.user)}}function by(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.voucher.redeem.by),e.xp6(1),e.Q6J("user",t.by)}}function vy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"currency")),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.voucher.redeem.amount)("value",e.xi3(1,2,t.amount,i.data.type.configuration.currency))}}function Ty(n,a){if(1&n&&(e.TgZ(0,"label-value",18)(1,"a",20),e._uU(2),e.qZA()()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.voucher.redeem.payment),e.xp6(1),e.Q6J("routerLink",i.transactionPath(t.payment)),e.xp6(1),e.hij(" ",t.payment.display," ")}}function wy(n,a){if(1&n&&(e.ynx(0),e.YNc(1,yy,2,4,"label-value",9),e.YNc(2,xy,2,2,"label-value",10),e.YNc(3,by,2,2,"label-value",10),e.YNc(4,vy,2,5,"label-value",9),e.YNc(5,Ty,3,3,"label-value",10),e.BQk()),2&n){const t=a.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.date),e.xp6(1),e.Q6J("ngIf",t.user&&!i.authHelper.isSelfOrOwner(t.user)),e.xp6(1),e.Q6J("ngIf",null==t.by?null:t.by.user),e.xp6(1),e.Q6J("ngIf",t.amount!=i.data.amount),e.xp6(1),e.Q6J("ngIf",t.payment)}}function Cy(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"date")),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.redeem.afterDate)("value",e.lcZ(1,2,t.data.redeemAfterDate))}}function Ay(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.redeem.onDays)("value",t.redeemOnDays)}}function Zy(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Cy,2,4,"label-value",9),e.YNc(2,Ay,1,2,"label-value",9),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.data.redeemAfterDateReached),e.xp6(1),e.Q6J("ngIf",t.redeemOnDays)}}function Py(n,a){if(1&n&&(e._UZ(0,"label-value",11),e.ALo(1,"dateTime")),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.refundDate)("value",e.lcZ(1,2,t.data.refundDate))}}function qy(n,a){if(1&n&&(e.TgZ(0,"label-value",18)(1,"a",20),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.refundPayment),e.xp6(1),e.Q6J("routerLink",t.transactionPath(t.data.refund)),e.xp6(1),e.hij(" ",t.data.refund.display," ")}}function Sy(n,a){1&n&&e._UZ(0,"custom-field-value",23),2&n&&e.Q6J("fieldValue",a.$implicit)}function Qy(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.email)("value",t.data.email)}}function Uy(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.mobilePhone)("value",t.data.mobilePhone)}}function Ny(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.voucher.enableNotifications)("value",t.data.enableNotifications)}}function Iy(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Qy,1,2,"label-value",9),e.YNc(2,Uy,1,2,"label-value",9),e.YNc(3,Ny,1,2,"label-value",9),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.data.email),e.xp6(1),e.Q6J("ngIf",t.data.mobilePhone),e.xp6(1),e.Q6J("ngIf",t.data.email||t.data.mobilePhone)}}function Jy(n,a){if(1&n&&(e.ynx(0,24),e._UZ(1,"hr"),e.TgZ(2,"div"),e._uU(3),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.voucher.personal(t.data.buyer.display))}}function Ly(n,a){if(1&n&&(e.ynx(0,24),e.TgZ(1,"h2",25),e._uU(2),e.qZA(),e.TgZ(3,"div",26),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.general.description," "),e.xp6(2),e.Oqu(t.data.description)}}function ky(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"hr",25),e.TgZ(2,"div",27),e._UZ(3,"img",28),e.ALo(4,"trust"),e.qZA(),e.BQk()),2&n){const t=a.ngIf;e.xp6(3),e.Q6J("src",e.xi3(4,1,t,"url"),e.LSH)}}function Fy(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"div",5)(3,"div",6),e.YNc(4,ey,2,1,"div",7),e.TgZ(5,"div",8),e.YNc(6,ty,1,2,"label-value",9),e.YNc(7,ny,1,2,"label-value",9),e.YNc(8,iy,1,2,"label-value",9),e.YNc(9,oy,2,5,"label-value",9),e.YNc(10,ay,2,5,"label-value",9),e.YNc(11,ry,1,2,"label-value",9),e.YNc(12,sy,1,2,"label-value",9),e.YNc(13,cy,2,4,"label-value",9),e.YNc(14,ly,2,2,"label-value",10),e.YNc(15,uy,2,2,"label-value",10),e.YNc(16,py,3,3,"label-value",10),e.YNc(17,my,2,2,"label-value",10),e._UZ(18,"label-value",11),e.YNc(19,dy,1,2,"label-value",9),e.YNc(20,hy,3,2,"ng-container",12),e.YNc(21,gy,1,2,"label-value",13),e.YNc(22,wy,6,5,"ng-container",12),e.YNc(23,Zy,3,2,"ng-container",12),e.YNc(24,Py,2,4,"label-value",9),e.YNc(25,qy,3,3,"label-value",10),e.qZA()(),e.YNc(26,Sy,1,1,"custom-field-value",14),e.YNc(27,Iy,4,3,"ng-container",12),e.YNc(28,Jy,4,1,"ng-container",15),e.YNc(29,Ly,5,2,"ng-container",15),e.YNc(30,ky,5,4,"ng-container",12),e.ALo(31,"async"),e.qZA()()),2&n){const t=e.oxw();e.Q6J("heading",t.data.title)("mobileHeading",t.data.title)("headingActions",e.lcZ(1,30,t.headingActions$)),e.xp6(4),e.Q6J("ngIf",t.data.type.image),e.xp6(2),e.Q6J("ngIf",t.data.showConfiguration),e.xp6(1),e.Q6J("ngIf",t.data.showType),e.xp6(1),e.Q6J("ngIf",t.data.token),e.xp6(1),e.Q6J("ngIf",t.data.amount),e.xp6(1),e.Q6J("ngIf",t.data.balance),e.xp6(1),e.Q6J("ngIf",t.data.creationType),e.xp6(1),e.Q6J("ngIf",t.data.creationType===t.VoucherCreationTypeEnum.SENT),e.xp6(1),e.Q6J("ngIf",t.data.creationDate),e.xp6(1),e.Q6J("ngIf",t.data.owner&&!t.authHelper.isSelf(t.data.owner)),e.xp6(1),e.Q6J("ngIf",t.data.buyer&&!t.authHelper.isSelf(t.data.buyer)),e.xp6(1),e.Q6J("ngIf",t.data.buy),e.xp6(1),e.Q6J("ngIf",t.data.pin),e.xp6(1),e.Q6J("label",t.i18n.general.status)("value",t.apiI18n.voucherStatus(t.data.status)),e.xp6(1),e.Q6J("ngIf",t.data.pinStatusForRedeem!==t.VoucherPinStatusForRedeemEnum.NOT_USED),e.xp6(1),e.Q6J("ngIf",t.data.status!==t.VoucherStatusEnum.REDEEMED),e.xp6(1),e.Q6J("ngIf",t.data.sendMessage),e.xp6(1),e.Q6J("ngIf",t.data.singleRedeem),e.xp6(1),e.Q6J("ngIf",t.data.amount&&t.data.status===t.VoucherStatusEnum.OPEN),e.xp6(1),e.Q6J("ngIf",t.data.refundDate),e.xp6(1),e.Q6J("ngIf",t.data.refund),e.xp6(1),e.Q6J("ngForOf",t.data.customValues),e.xp6(1),e.Q6J("ngIf",t.data.creationType!==t.VoucherCreationTypeEnum.SENT),e.xp6(1),e.Q6J("ngIf",!1===t.data.gift),e.xp6(1),e.Q6J("ngIf",t.data.description),e.xp6(1),e.Q6J("ngIf",e.lcZ(31,32,t.qrCodeUrl$))}}function Oy(n,a){if(1&n&&(e.TgZ(0,"mobile-result",34)(1,"div",35),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",null==t.user?null:t.user.image)("avatarIcon",i.SvgIcon.Person)("date",t.date)("amount",t.amount)("currency",i.data.type.configuration.currency),e.xp6(2),e.hij(" ",null==t.user?null:t.user.display," ")}}function Dy(n,a){1&n&&e._UZ(0,"th",40)}function Ry(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.voucher.transaction.user)}}function Vy(n,a){if(1&n&&(e.TgZ(0,"td",40),e._UZ(1,"avatar",43),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("image",null==t.user?null:t.user.image)("icon",i.SvgIcon.Person)}}function Yy(n,a){if(1&n&&(e.TgZ(0,"td")(1,"a",20),e._uU(2),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("routerLink",i.voucherTransactionPath(t)),e.xp6(1),e.hij(" ",null==t.user?null:t.user.display," ")}}const Ey=function(n,a){return{positive:n,negative:a}};function $y(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",41),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).viewVoucherTransaction(r)}),e.YNc(2,Vy,2,2,"td",37),e.ALo(3,"async"),e.TgZ(4,"td")(5,"a",20),e._uU(6),e.ALo(7,"date"),e.qZA()(),e.YNc(8,Yy,3,2,"td",12),e.ALo(9,"async"),e.TgZ(10,"td",38)(11,"a",42),e._uU(12),e.ALo(13,"currency"),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("ngIf",e.lcZ(3,7,i.showTransactionsUser$)),e.xp6(3),e.Q6J("routerLink",i.voucherTransactionPath(t)),e.xp6(1),e.hij(" ",e.lcZ(7,9,t.date)," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,11,i.showTransactionsUser$)),e.xp6(3),e.Q6J("routerLink",i.voucherTransactionPath(t))("ngClass",e.WLB(17,Ey,i.format.isPositive(t.amount),i.format.isNegative(t.amount))),e.xp6(1),e.hij(" ",e.Dn7(13,13,t.amount,i.data.type.configuration.currency,!0)," ")}}function By(n,a){if(1&n&&(e.TgZ(0,"table",36)(1,"thead"),e.YNc(2,Dy,1,0,"th",37),e.ALo(3,"async"),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.YNc(6,Ry,2,1,"th",12),e.ALo(7,"async"),e.TgZ(8,"th",38),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,$y,14,20,"ng-container",39),e.ALo(12,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(2),e.Q6J("ngIf",e.lcZ(3,5,t.showTransactionsUser$)),e.xp6(3),e.Oqu(t.i18n.voucher.transaction.date),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,7,t.showTransactionsUser$)),e.xp6(3),e.Oqu(t.i18n.voucher.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(12,9,t.transactions$))?null:i.results)}}function Hy(n,a){if(1&n&&(e.TgZ(0,"div",29)(1,"h1",30),e._uU(2),e.qZA(),e.TgZ(3,"results-layout",31),e.ALo(4,"async"),e.YNc(5,Oy,3,6,"mobile-result",32),e.YNc(6,By,13,11,"table",33),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.resolveVoucherTransactionsTitle()),e.xp6(1),e.Q6J("results",e.lcZ(4,3,t.transactions$))("toLink",t.toVoucherTransactionLink)}}function jy(n,a){1&n&&(e.TgZ(0,"page-content"),e._UZ(1,"spinner"),e.qZA())}let My=(()=>{class n extends nt.k{constructor(t,i,o,r){super(t),this.voucherService=i,this.bankingHelper=o,this.modal=r,this.VoucherStatusEnum=Re.v,this.VoucherPinStatusForRedeemEnum=Sg.J,this.VoucherCreationTypeEnum=re.t,this.transactions$=new y.X(null),this.qrCodeUrl$=new y.X(null),this.showTransactionsUser$=new y.X(!1)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.paramMap.get("key");this.addSub(this.voucherService.viewVoucher({key:t}).subscribe(i=>this.data=i)),this.addSub(this.transactions$.subscribe(i=>{var o;this.showTransactionsUser$.next(!!(null===(o=null==i?void 0:i.results)||void 0===o?void 0:o.find(r=>r.user)))}))}onDataInitialized(t){var i;if(t.showQrCode&&this.addSub(this.voucherService.getVoucherQrCode({key:t.id,size:Rt.r.MEDIUM}).subscribe(o=>this.qrCodeUrl$.next(URL.createObjectURL(o)))),this.createCancelDeviceConfirmation=()=>({type:U.l.MANAGE_VOUCHER,voucher:t.id,voucherAction:Ve.CANCEL}),this.createChangeExpirationDeviceConfirmation=()=>({type:U.l.MANAGE_VOUCHER,voucher:t.id,voucherAction:Ve.CHANGE_EXPIRATION}),this.canConfirm=this.authHelper.canConfirm(t.confirmationPasswordInput),t.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("confirmationPassword",s.kI.required)),this.headingActions=this.initActions(t),t.status===Re.v.OPEN){const o=null===(i=t.redeemOnWeekDays)||void 0===i?void 0:i.length;this.redeemOnDays=[0,7].includes(o)?this.i18n.voucher.redeem.onDaysAny:t.redeemOnWeekDays.map(r=>this.format.weekDay(r)).join(", ")}t.hasTransactions&&setTimeout(()=>this.updateTransactions())}updateTransactions(){this.addSub(this.voucherService.searchVoucherTransactions$Response({key:this.data.id}).subscribe(t=>this.transactions$.next(Jt.x.from(t))))}initActions(t){const i=this.exportHelper.headingActions(t.exportFormats,o=>this.voucherService.exportVoucher$Response({format:o.internalName,key:t.id}));return t.cancelAction&&i.push(new T.Yu(x.l.XCircle,t.cancelAction===xe.CANCEL_AND_REFUND?this.i18n.voucher.cancel.cancelAndRefund:t.cancelAction===xe.CANCEL_AND_CHARGEBACK?this.i18n.voucher.cancel.cancelAndChargeback:this.i18n.general.cancel,()=>{this.canConfirm?this.confirmation.confirm({title:this.cancelConfirmationTitle(t.cancelAction),passwordInput:t.confirmationPasswordInput,createDeviceConfirmation:this.createCancelDeviceConfirmation,callback:r=>this.cancel(r.confirmationPassword)}):this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput))})),t.canAssign&&i.push(new T.Yu(x.l.PersonBadge,this.i18n.voucher.assign,()=>{this.confirmation.confirm({title:this.i18n.voucher.assign,customFields:this.assignFields,callback:o=>{this.addSub(this.voucherService.assignVoucher({key:t.id,body:{user:o.customValues.user}}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.assigned),this.reload()}))}})})),t.canChangeExpirationDate&&i.push(new T.Yu(x.l.CalendarEvent,this.i18n.voucher.changeExpirationDate,()=>{this.canConfirm?this.confirmation.confirm({title:this.i18n.voucher.changeExpirationDate,passwordInput:t.confirmationPasswordInput,createDeviceConfirmation:this.createChangeExpirationDeviceConfirmation,customFields:this.changeExpirationFields,callback:o=>{this.addSub(this.voucherService.changeVoucherExpirationDate({key:t.id,confirmationPassword:o.confirmationPassword,body:{comments:o.customValues.comments,newExpirationDate:o.customValues.newExpirationDate}}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.expirationDateChanged),this.reload()}))}}):this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput))})),t.canResendEmail&&i.push(new T.Yu(x.l.At,this.i18n.voucher.resendEmail.label,()=>{this.canConfirm?this.confirmation.confirm({title:this.i18n.voucher.resendEmail.label,message:this.i18n.voucher.resendEmail.confirmation(t.email),callback:()=>{this.addSub(this.voucherService.resendVoucherEmail({key:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.resendEmail.done),this.reload()}))}}):this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput))})),t.canChangeNotificationSettings&&i.push(new T.Yu(x.l.Gear,this.i18n.voucher.notificationSettings.label,()=>{if(!t.requireOldPinForChange&&!this.canConfirm)return void this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput));const r=this.modal.show(Yg,{class:"modal-form",initialState:{voucher:t}}).content;this.addSub(r.done.subscribe(()=>{this.notification.snackBar(this.i18n.voucher.notificationSettings.done),this.reload()}))})),t.canChangePin&&i.push(new T.Yu(x.l.Key,this.i18n.voucher.changePin.label,()=>{if(!t.requireOldPinForChange&&!this.canConfirm)return void this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput));const r=this.modal.show(Fg,{class:"modal-form",initialState:{voucher:t}}).content;this.addSub(r.done.subscribe(()=>{this.notification.snackBar(this.i18n.voucher.changePin.done),this.reload()}))})),t.canUnblockPin&&i.push(new T.Yu(x.l.Unlock,this.i18n.voucher.unblockPin.unblockPin,()=>{this.addSub(this.voucherService.unblockVoucherPin({key:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.unblockPin.done),this.reload()}))})),i}cancel(t){!t&&this.confirmationPassword&&(t=this.confirmationPassword.value),(0,h.pt)(this.confirmationPassword)&&this.addSub(this.voucherService.cancelVoucher({key:this.data.id,confirmationPassword:t}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.cancel.done)}))}cancelConfirmationTitle(t){switch(t){case xe.CANCEL_AND_REFUND:return this.i18n.voucher.cancel.refundConfirmation;case xe.CANCEL_AND_CHARGEBACK:return this.i18n.voucher.cancel.chargebackConfirmation;case xe.CANCEL_PENDING_PACK:return this.i18n.voucher.cancel.packConfirmation;case xe.CANCEL_GENERATED:case xe.CANCEL_PENDING_SINGLE:return this.i18n.voucher.cancel.confirmation}}get changeExpirationFields(){return[{internalName:"newExpirationDate",name:this.i18n.general.newExpirationDate,type:W.L.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:W.L.TEXT}]}get assignFields(){return[{internalName:"user",name:this.i18n.general.user,size:Qg.s.LARGE,type:W.L.LINKED_ENTITY,linkedEntityType:Ug.X.USER,required:!0}]}transactionPath(t){return null===t.authorizationStatus||t.authorizationStatus===Ne.s.AUTHORIZED?["/banking","transfer",this.bankingHelper.transactionNumberOrId(t)]:["/banking","transaction",this.bankingHelper.transactionNumberOrId(t)]}get toVoucherTransactionLink(){return t=>this.voucherTransactionPath(t)}voucherTransactionPath(t){return["/banking","voucher-transactions","view",t.id]}viewVoucherTransaction(t){this.router.navigate(this.voucherTransactionPath(t))}resolveVoucherTransactionsTitle(){return this.data.topUpEnabled?this.i18n.voucher.transactions:this.i18n.voucher.transactionsRedeems}resolveMenu(t){var i,o,r;const l=t.buyer&&this.authHelper.isSelfOrOwner(t.buyer),_=t.owner&&this.authHelper.isSelfOrOwner(t.owner),g=this.dataForFrontendHolder.auth;return l||_?this.dataForFrontendHolder.dataForFrontend.voucherBuyingMenu==ht.K.MARKETPLACE?v.v2.SEARCH_MY_VOUCHERS_MARKETPLACE:v.v2.SEARCH_MY_VOUCHERS_BANKING:(null===(r=null===(o=null===(i=null==g?void 0:g.permissions)||void 0===i?void 0:i.vouchers)||void 0===o?void 0:o.vouchers)||void 0===r?void 0:r.find(P=>{var S,I;return P.configuration.id===(null===(I=null===(S=null==t?void 0:t.type)||void 0===S?void 0:S.configuration)||void 0===I?void 0:I.id)&&P.view}))?v.v2.SEARCH_VOUCHERS:this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(ge),e.Y36(N.J),e.Y36(He.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-voucher"]],features:[e.qOj],decls:7,vars:8,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["class","no-top-margin-page-content",4,"ngIf"],["loading",""],[3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[1,"d-flex","flex-column","flex-sm-row-reverse","justify-content-sm-between"],["class","image d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[3,"label","value",4,"ngIf"],[3,"label",4,"ngIf"],[3,"label","value"],[4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["class","d-flex justify-content-start",4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4"],["size","160","imageSize","200",3,"image"],[3,"label"],[3,"user"],[3,"routerLink"],[3,"text"],["valueFormat","break",3,"label","value"],[3,"fieldValue"],[1,"d-flex","justify-content-start"],[1,"mt-3"],[1,"break-nl"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code",1,"mw-100",3,"src"],[1,"no-top-margin-page-content"],[1,"header-root"],[3,"results","toLink"],[3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],["class","avatar",4,"ngIf"],[1,"amount"],[4,"ngFor","ngForOf"],[1,"avatar"],[3,"click"],[3,"routerLink","ngClass"],[3,"image","icon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Fy,32,34,"page-content",1),e.ALo(3,"async"),e.YNc(4,Hy,7,5,"div",2),e.qZA(),e.YNc(5,jy,2,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(6);e.Q6J("ready",e.lcZ(1,4,i.data$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,6,i.data$))("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",null==i.data?null:i.data.hasTransactions)}},directives:[A.w,u.O5,Z.Y,Nt.X,C.t,Q.F,ce.yS,Kg,u.sg,Qe.W,D.D,R.E,V.t,Y.p,Pe.A,u.mk,ne.O],pipes:[u.Ov,w.H,Ce.i,E.u,Yt.a],encapsulation:2,changeDetection:0}),n})();const Gy=[{path:"",canActivateChild:[m(5747).b],children:[{path:":owner/account/:type",component:li},{path:":owner/accounts-summary",component:bi},{path:":user/account-visibility",component:un},{path:"transfer/:key",component:zt},{path:"transfer/:account/:key",component:zt},{path:"transaction/:key",component:of},{path:"transfers-overview",component:If},{path:"transaction/:key/authorization-history",component:Dp},{path:":from/payment",component:Ct},{path:":from/payment/:to",component:Ct},{path:":from/payment-request",component:Dt},{path:"payment-request/:key/accept",component:fc},{path:":from/payment-request/:to",component:Dt},{path:":owner/payment-requests",component:mt,data:{kind:"payment-request"}},{path:":owner/tickets",component:mt,data:{kind:"ticket"}},{path:"payment-requests",component:tt,data:{kind:"payment-request"}},{path:"tickets",component:tt,data:{kind:"ticket"}},{path:":owner/external-payments",component:mt,data:{kind:"external-payment"}},{path:"external-payments",component:tt,data:{kind:"external-payment"}},{path:":owner/external-payment",component:Qa},{path:"pos",component:Ct},{path:"qr",component:_l},{path:":owner/installments",component:mu},{path:"installments-overview",component:zl},{path:":owner/authorized-payments",component:mt,data:{kind:"authorized"}},{path:"authorized-payments",component:tt,data:{kind:"authorized"}},{path:"pending-my-authorization",component:tt,data:{kind:"myAuth"}},{path:":user/vouchers",component:Mh},{path:":user/vouchers/redeem",component:Ih},{path:":user/vouchers/top-up",component:hg},{path:":user/vouchers/buy",component:f_},{path:":user/vouchers/send",component:K1},{path:"vouchers",component:C1},{path:"vouchers/view/:key",component:My},{path:":user/voucher-transactions",component:c1},{path:"voucher-transactions/view/:id",component:qg},{path:":user/account-balance-limits",component:ho},{path:":user/account-balance-limits/:accountType",component:Fo},{path:":user/account-balance-limits/:accountType/edit",component:uo},{path:"account-balance-limits-overview",component:So},{path:":user/account-payment-limits",component:Fa},{path:":user/account-payment-limits/:accountType",component:or},{path:":user/account-payment-limits/:accountType/edit",component:Na},{path:"account-payment-limits-overview",component:Ga},{path:"user-balances-overview",component:co},{path:"vouchers/generate",component:k_},{path:"edit-recurring-payment/:id",component:Ql}]}];let Wy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[ce.Bz.forChild(Gy)],ce.Bz]}),n})();var Xy=m(4443);let Ky=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Wy,Xy.C]]}),n})()}}]);