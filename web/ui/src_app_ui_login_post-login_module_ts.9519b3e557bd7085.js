"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([["src_app_ui_login_post-login_module_ts"],{871:(L,f,r)=>{r.d(f,{l:()=>p});var p=(()=>{return(s=p||(p={})).ACCEPT_ORDER="acceptOrder",s.APPROVE_TICKET="approveTicket",s.BUY_VOUCHERS="buyVouchers",s.CHANGE_ACCOUNT_LIMITS="changeAccountLimits",s.CHARGEBACK="chargeback",s.CLIENT_ACTION="clientAction",s.EDIT_PROFILE="editProfile",s.GENERATE_PASSWORD="generatePassword",s.GENERATE_VOUCHERS="generateVouchers",s.IMPORT_PAYMENTS="importPayments",s.IMPORT_USER_PAYMENTS="importUserPayments",s.IMPORT_USER_SEND_VOUCHERS="importUserSendVouchers",s.MANAGE_ADDRESS="manageAddress",s.MANAGE_AUTHORIZATION="manageAuthorization",s.MANAGE_CONTACT_INFO="manageContactInfo",s.MANAGE_DEVICE="manageDevice",s.MANAGE_EXTERNAL_PAYMENT="manageExternalPayment",s.MANAGE_FAILED_OCCURRENCE="manageFailedOccurrence",s.MANAGE_INSTALLMENT="manageInstallment",s.MANAGE_PAYMENT_REQUEST="managePaymentRequest",s.MANAGE_PHONE="managePhone",s.MANAGE_RECORD="manageRecord",s.MANAGE_RECURRING_PAYMENT="manageRecurringPayment",s.MANAGE_SCHEDULED_PAYMENT="manageScheduledPayment",s.MANAGE_VOUCHER="manageVoucher",s.PERFORM_EXTERNAL_PAYMENT="performExternalPayment",s.PERFORM_PAYMENT="performPayment",s.PERSONALIZE_NFC="personalizeNfc",s.REMOVE_TOTP_SECRET="removeTotpSecret",s.RUN_OPERATION="runOperation",s.RUN_WIZARD="runWizard",s.SECONDARY_LOGIN="secondaryLogin",s.SEND_VOUCHER="sendVoucher",s.SHOPPING_CART_CHECKOUT="shoppingCartCheckout",s.TOP_UP_VOUCHER="topUpVoucher",p;var s})()},2736:(L,f,r)=>{r.r(f),r.d(f,{PostLoginModule:()=>Qt});var p=r(5300),s=r(5747),i=r(3075),d=r(6163),_=r(2614),h=r(6243),P=r(7224),t=r(6435),H=r(3868),T=r(169),w=r(1963),l=r(9808),x=r(2032),J=r(2525),R=r(4435),C=r(6903),b=r(1556),Z=r(3317);function U(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"page-content",2)(1,"notification",3),t._UZ(2,"div",4),t.ALo(3,"trust"),t.qZA(),t.TgZ(4,"div",5),t._UZ(5,"accept-agreements",6),t.qZA(),t.TgZ(6,"actions")(7,"action-button",7),t.NdJ("action",function(){return t.CHM(e),t.oxw().submit()}),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"action-button",8),t.NdJ("action",function(){return t.CHM(e),t.oxw().cancel()}),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("heading",e.title)("mobileHeading",e.mobileTitle),t.xp6(2),t.Q6J("innerHTML",t.lcZ(3,8,e.message),t.oJD),t.xp6(3),t.Q6J("agreements",e.agreements)("formControl",e.accepted),t.xp6(2),t.Q6J("disabled",t.lcZ(8,10,e.requesting$))("label",e.i18n.general.submit),t.xp6(2),t.Q6J("label",e.i18n.general.cancel)}}let q=(()=>{class n extends _.y{constructor(e,o,c){super(e),this.agreementsService=o,this.loginState=c,this.accepted=new i.NI([])}get agreements(){return this.data}ngOnInit(){super.ngOnInit();const e=this.dataForFrontendHolder.auth||{};e.pendingAgreements?(e.everAcceptedAgreements?(this.title=this.i18n.pendingAgreements.title.previouslyAccepted,this.mobileTitle=this.i18n.pendingAgreements.mobileTitle.previouslyAccepted,this.message=this.i18n.pendingAgreements.messagePreviouslyAccepted):(this.title=this.i18n.pendingAgreements.title.firstTime,this.mobileTitle=this.i18n.pendingAgreements.mobileTitle.firstTime,this.message=this.i18n.pendingAgreements.messageFirstTime),this.addSub(this.agreementsService.listPendingAgreements({fields:["-content"]}).subscribe(o=>{(0,d.cS)(o)?this.router.navigateByUrl(this.loginState.redirectUrl||""):this.data=o}))):this.router.navigateByUrl(this.loginState.redirectUrl||"")}submit(){(0,d.pt)(this.accepted)&&this.addSub(this.agreementsService.acceptPendingAgreement({agreements:this.accepted.value}).subscribe(()=>this.reload()))}reload(){this.dataForFrontendHolder.reload().pipe((0,P.P)()).subscribe(()=>this.router.navigateByUrl(this.loginState.redirectUrl||""))}cancel(){this.login.logout()}resolveMenu(){return h.v2.DASHBOARD}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3),t.Y36(H.T),t.Y36(T.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["accept-pending-agreements"]],features:[t.qOj],decls:3,vars:4,consts:[["size","small","hideMenu","",3,"ready"],["layout","centered",3,"heading","mobileHeading",4,"ngIf"],["layout","centered",3,"heading","mobileHeading"],["type","warning"],[3,"innerHTML"],[1,"mt-3","text-left"],[3,"agreements","formControl"],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,o){1&e&&(t.TgZ(0,"page-layout",0),t.ALo(1,"async"),t.YNc(2,U,10,12,"page-content",1),t.qZA()),2&e&&(t.Q6J("ready",t.lcZ(1,2,o.data$)),t.xp6(2),t.Q6J("ngIf",o.data))},directives:[w.w,l.O5,x.Y,J.c,R.l,i.JJ,i.oH,C.h,b.x],pipes:[l.Ov,Z.a],encapsulation:2,changeDetection:0}),n})();var v=r(8625),u=r(7e3),y=r(591),Y=r(7119),A=r(3728),m=r(8361);function B(n,a){if(1&n&&(t._UZ(0,"div",11),t.ALo(1,"trust")),2&n){const e=t.oxw(3);t.Q6J("innerHTML",t.lcZ(1,1,e.i18n.password.expired.messageGenerated),t.oJD)}}function G(n,a){if(1&n&&(t._UZ(0,"div",11),t.ALo(1,"trust")),2&n){const e=t.oxw(3);t.Q6J("innerHTML",t.lcZ(1,1,e.i18n.password.expired.messageManual),t.oJD)}}function V(n,a){if(1&n&&(t.TgZ(0,"notification",9)(1,"div"),t._uU(2),t.qZA(),t.YNc(3,B,2,3,"div",10),t.YNc(4,G,2,3,"div",10),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(e.i18n.password.expired.preface(e.typeName)),t.xp6(1),t.Q6J("ngIf",e.generated),t.xp6(1),t.Q6J("ngIf",!e.generated)}}const $=function(n,a){return{type:n,value:a}};function D(n,a){if(1&n&&(t.TgZ(0,"notification"),t._UZ(1,"div",11),t.ALo(2,"trust"),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.i18n.password.expired.generatedValue(t.WLB(3,$,e.typeName,e.generatedValue$.value))),t.oJD)}}function z(n,a){if(1&n&&(t.YNc(0,D,3,6,"notification",6),t.ALo(1,"async")),2&n){const e=t.oxw(2);t.Q6J("ngIf",t.lcZ(1,1,e.generatedValue$))}}function j(n,a){if(1&n&&t._UZ(0,"input-field",15),2&n){const e=t.oxw(3);t.Q6J("placeholder",e.i18n.password.oldPassword)}}function X(n,a){if(1&n&&(t.ynx(0),t.YNc(1,j,1,1,"input-field",12),t._UZ(2,"input-field",13)(3,"input-field",14),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.data.requireOldPasswordForChange),t.xp6(1),t.Q6J("focused",!e.data.requireOldPasswordForChange)("placeholder",e.i18n.password.newPassword),t.xp6(1),t.Q6J("placeholder",e.i18n.password.passwordConfirmation)}}function k(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"action-button",16),t.NdJ("action",function(){return t.CHM(e),t.oxw(2).submit()}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",t.lcZ(1,2,e.requesting$))("label",e.i18n.password.expired.generateNew)}}function W(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"action-button",16),t.NdJ("action",function(){return t.CHM(e),t.oxw(2).reload()}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",t.lcZ(1,2,e.requesting$))("label",e.i18n.general.close)}}function K(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"action-button",16),t.NdJ("action",function(){return t.CHM(e),t.oxw(2).submit()}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",t.lcZ(1,2,e.requesting$))("label",e.i18n.general.submit)}}function tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"action-button",17),t.NdJ("action",function(){return t.CHM(e),t.oxw(2).cancel()}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("label",e.i18n.general.cancel)}}function et(n,a){if(1&n&&(t.TgZ(0,"page-content",2),t.ynx(1,3),t.YNc(2,V,5,3,"notification",4),t.ALo(3,"async"),t.YNc(4,z,2,3,"ng-template",null,5,t.W1O),t.YNc(6,X,4,4,"ng-container",6),t.TgZ(7,"actions"),t.YNc(8,k,2,4,"action-button",7),t.ALo(9,"async"),t.YNc(10,W,2,4,"action-button",7),t.ALo(11,"async"),t.YNc(12,K,2,4,"action-button",7),t.YNc(13,tt,1,1,"action-button",8),t.ALo(14,"async"),t.qZA(),t.BQk(),t.qZA()),2&n){const e=t.MAs(5),o=t.oxw();t.Q6J("heading",o.i18n.password.title.changeSelf)("mobileHeading",o.i18n.password.mobileTitle.changeSelf),t.xp6(1),t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("ngIf",null===t.lcZ(3,10,o.generatedValue$))("ngIfElse",e),t.xp6(4),t.Q6J("ngIf",!o.generated),t.xp6(2),t.Q6J("ngIf",o.generated&&null===t.lcZ(9,12,o.generatedValue$)),t.xp6(2),t.Q6J("ngIf",o.generated&&null!==t.lcZ(11,14,o.generatedValue$)),t.xp6(2),t.Q6J("ngIf",!o.generated),t.xp6(1),t.Q6J("ngIf",null===t.lcZ(14,16,o.generatedValue$))}}const nt=n=>{const a=n.value;if(n.touched&&null!=a&&""!==a){const e=n.parent;if((null==e.get("newPassword")?"":e.get("newPassword").value)!==a)return{passwordsMatch:!0}}return null};let ot=(()=>{class n extends _.y{constructor(e,o,c){super(e),this.passwordsService=o,this.loginState=c,this.generated=!1,this.generatedValue$=new y.X(null),this.form=this.formBuilder.group({})}ngOnInit(){super.ngOnInit();const e=this.dataForFrontendHolder.auth||{};e.expiredPassword?(this.typeId=e.passwordType.id,this.addSub(this.passwordsService.getUserPasswordsData({user:u.S.SELF,type:this.typeId,fields:["type.name","type.mode","status","permissions","requireOldPasswordForChange"]}).subscribe(o=>{this.data=o}))):this.router.navigateByUrl(this.loginState.redirectUrl||"")}onDataInitialized(e){this.typeName=e.type.name,this.generated=e.type.mode===v.Y.GENERATED,this.generated||(this.form.setControl("checkConfirmation",this.formBuilder.control(!0)),e.requireOldPasswordForChange&&this.form.setControl("oldPassword",this.formBuilder.control("",i.kI.required)),this.form.setControl("newPassword",this.formBuilder.control("",i.kI.required)),this.form.setControl("newPasswordConfirmation",this.formBuilder.control("",i.kI.compose([i.kI.required,nt]))))}submit(){if(!(0,d.pt)(this.form))return;const e=this.data.type;this.addSub(this.generated?this.passwordsService.generatePassword({type:this.typeId}).subscribe(o=>{this.generatedValue$.next(o)}):this.passwordsService.changePassword({user:u.S.SELF,type:this.typeId,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.i18n.password.expired.changed(e.name)),this.dataForFrontendHolder.reload().pipe((0,P.P)()).subscribe(()=>this.router.navigateByUrl(this.loginState.redirectUrl||""))}))}cancel(){this.login.logout()}resolveMenu(){return h.v2.DASHBOARD}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3),t.Y36(Y.i),t.Y36(T.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["change-expired-password"]],features:[t.qOj],decls:3,vars:4,consts:[["size","small","hideMenu","",3,"ready"],["layout","centered",3,"heading","mobileHeading",4,"ngIf"],["layout","centered",3,"heading","mobileHeading"],[3,"formGroup"],["type","warning",4,"ngIf","ngIfElse"],["generatedValue",""],[4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["outline","",3,"label","action",4,"ngIf"],["type","warning"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],["ngClass","mt-3","labelPosition","above","required","","formControlName","oldPassword","type","password","focused","",3,"placeholder",4,"ngIf"],["labelPosition","above","required","","formControlName","newPassword","type","password",1,"mt-3",3,"focused","placeholder"],["labelPosition","above","required","","formControlName","newPasswordConfirmation","type","password",1,"mt-3",3,"placeholder"],["ngClass","mt-3","labelPosition","above","required","","formControlName","oldPassword","type","password","focused","",3,"placeholder"],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,o){1&e&&(t.TgZ(0,"page-layout",0),t.ALo(1,"async"),t.YNc(2,et,15,18,"page-content",1),t.qZA()),2&e&&(t.Q6J("ready",t.lcZ(1,2,o.data$)),t.xp6(2),t.Q6J("ngIf",o.data))},directives:[w.w,l.O5,x.Y,i.JL,i.sg,J.c,A.q,l.mk,i.Q7,i.JJ,i.u,m.A,C.h,b.x],pipes:[l.Ov,Z.a],encapsulation:2,changeDetection:0}),n})();var I=r(2151),at=r(7334),S=r(3553),Q=r(5962),rt=r(8089),N=r(7947),st=r(5739),it=r(8868),F=r(195),ct=r(4113);function lt(n,a){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(e.name)}}function dt(n,a){if(1&n&&(t.TgZ(0,"radio-group-field",6),t._UZ(1,"field-option",7)(2,"field-option",8),t.qZA()),2&n){const e=t.oxw();t.Q6J("label",e.i18n.password.forgotten.sendMedium),t.xp6(1),t.Q6J("text",e.i18n.general.sendMedium.email),t.xp6(1),t.Q6J("text",e.i18n.general.sendMedium.sms)}}function pt(n,a){if(1&n&&(t.TgZ(0,"label-value",9),t._UZ(1,"captcha",10),t.qZA()),2&n){const e=t.oxw();t.Q6J("label",e.i18n.password.forgotten.captcha),t.xp6(1),t.Q6J("captchaInput",e.data.forgotPasswordCaptchaInput)("form",e.form.get("captcha"))}}let gt=(()=>{class n extends N.H{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.principalTypes=[...this.data.extraForgotPasswordPrincipalTypes||[],...this.data.principalTypes||[]]}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3))},n.\u0275cmp=t.Xpm({type:n,selectors:[["forgot-password-step-request"]],inputs:{data:"data",form:"form"},features:[t.qOj],decls:8,vars:6,consts:[[3,"formGroup"],[1,"mt-0","mt-xs-3","mt-sm-0","mb-4","text-left"],[4,"ngFor","ngForOf"],["formControlName","user","fieldSize","medium","focused","","required","",3,"label"],["formControlName","sendMedium",3,"label",4,"ngIf"],["kind","field",3,"label",4,"ngIf"],["formControlName","sendMedium",3,"label"],["value","email",3,"text"],["value","sms",3,"text"],["kind","field",3,"label"],[3,"captchaInput","form"]],template:function(e,o){1&e&&(t.ynx(0,0),t.TgZ(1,"div",1),t._uU(2),t.TgZ(3,"ul"),t.YNc(4,lt,2,1,"li",2),t.qZA()(),t._UZ(5,"input-field",3),t.YNc(6,dt,3,3,"radio-group-field",4),t.YNc(7,pt,2,3,"label-value",5),t.BQk()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(2),t.hij(" ",o.i18n.password.forgotten.preface," "),t.xp6(2),t.Q6J("ngForOf",o.principalTypes),t.xp6(1),t.Q6J("label",o.i18n.password.forgotten.principal),t.xp6(1),t.Q6J("ngIf",(null==o.data.forgotPasswordMediums?null:o.data.forgotPasswordMediums.length)>1),t.xp6(1),t.Q6J("ngIf",o.data.forgotPasswordCaptchaInput))},directives:[i.JL,i.sg,l.sg,A.q,i.JJ,i.u,m.A,i.Q7,l.O5,st.Y,it.s,F.t,ct.h],encapsulation:2,changeDetection:0}),n})(),ut=(()=>{class n extends N.H{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3))},n.\u0275cmp=t.Xpm({type:n,selectors:[["forgot-password-step-code"]],inputs:{form:"form"},features:[t.qOj],decls:5,vars:5,consts:[[3,"formGroup"],["kind","fieldView",3,"label"],[1,"text-left"],["required","","focused","",3,"label","formControl"]],template:function(e,o){1&e&&(t.ynx(0,0),t.TgZ(1,"label-value",1)(2,"div",2),t._uU(3),t.qZA()(),t._UZ(4,"input-field",3),t.BQk()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("label",o.i18n.password.forgotten.principal),t.xp6(2),t.Oqu(o.form.value.user),t.xp6(1),t.Q6J("label",o.i18n.password.forgotten.code)("formControl",o.form.get("code")))},directives:[i.JL,i.sg,F.t,A.q,i.Q7,m.A,i.JJ,i.oH],encapsulation:2,changeDetection:0}),n})();function mt(n,a){if(1&n&&t._UZ(0,"label-value",1),2&n){const e=a.$implicit;t.Q6J("label",e.type.name)("value",e.value)}}function ft(n,a){if(1&n&&(t.TgZ(0,"div",5),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.data.passwordType.description,"")}}function _t(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"label-value",6)(2,"input-field",7),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("label",e.i18n.securityQuestion.question)("value",e.data.securityQuestion),t.xp6(1),t.Q6J("label",e.i18n.securityQuestion.answer)}}function ht(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"input-field",8)(2,"input-field",9),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("label",e.i18n.password.newPassword)("focused",!e.data.securityQuestion),t.xp6(1),t.Q6J("label",e.i18n.password.passwordConfirmation)}}function wt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"h2"),t._uU(2),t.qZA(),t.YNc(3,ft,2,1,"div",4),t.YNc(4,_t,3,3,"ng-container",3),t.YNc(5,ht,3,3,"ng-container",3),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.i18n.password.forgotten.titleChangePassword),t.xp6(1),t.Q6J("ngIf",e.data.passwordType.description),t.xp6(1),t.Q6J("ngIf",e.data.securityQuestion),t.xp6(1),t.Q6J("ngIf","manual"===e.data.passwordType.mode)}}let xt=(()=>{class n extends N.H{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3))},n.\u0275cmp=t.Xpm({type:n,selectors:[["forgot-password-step-change"]],inputs:{data:"data",form:"form"},features:[t.qOj],decls:4,vars:5,consts:[[3,"formGroup"],[3,"label","value"],[3,"label","value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","mb-2",4,"ngIf"],[1,"mb-2"],["kind","fieldView",3,"label","value"],["formControlName","securityAnswer","focused","","required","",3,"label"],["type","password","formControlName","newPassword","kind","fieldView","required","",3,"label","focused"],["type","password","formControlName","newPasswordConfirmation","required","",3,"label"]],template:function(e,o){1&e&&(t.ynx(0,0),t._UZ(1,"label-value",1),t.YNc(2,mt,1,2,"label-value",2),t.YNc(3,wt,6,4,"ng-container",3),t.BQk()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("label",o.i18n.general.user)("value",o.data.user.display),t.xp6(1),t.Q6J("ngForOf",o.data.principals),t.xp6(1),t.Q6J("ngIf",o.data.securityQuestion||"manual"===o.data.passwordType.mode))},directives:[i.JL,i.sg,F.t,l.sg,l.O5,A.q,i.JJ,i.u,m.A,i.Q7],encapsulation:2,changeDetection:0}),n})();function Ct(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"page-content",3),t.ALo(1,"async"),t._UZ(2,"forgot-password-step-request",4),t.TgZ(3,"actions")(4,"action-button",5),t.NdJ("action",function(){return t.CHM(e),t.oxw().toCode()}),t.qZA(),t.TgZ(5,"action-button",6),t.NdJ("action",function(){return t.CHM(e),t.oxw().cancel()}),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("layout",t.lcZ(1,7,e.layout.ltmd$)?"normal":"centered")("heading",e.i18n.password.title.forgotten)("mobileHeading",e.i18n.password.mobileTitle.forgotten),t.xp6(2),t.Q6J("data",e.data)("form",e.form),t.xp6(2),t.Q6J("label",e.i18n.general.submit),t.xp6(1),t.Q6J("label",e.i18n.general.cancel)}}function bt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"page-content",7),t.ALo(1,"async"),t._UZ(2,"forgot-password-step-code",8),t.TgZ(3,"actions")(4,"action-button",5),t.NdJ("action",function(){return t.CHM(e),t.oxw().toChange()}),t.qZA(),t.TgZ(5,"action-button",6),t.NdJ("action",function(){return t.CHM(e),t.oxw().cancel()}),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("layout",t.lcZ(1,6,e.layout.ltmd$)?"normal":"centered")("heading",e.i18n.password.title.forgotten)("mobileHeading",e.i18n.password.mobileTitle.forgotten),t.xp6(2),t.Q6J("form",e.form),t.xp6(2),t.Q6J("label",e.i18n.general.submit),t.xp6(1),t.Q6J("label",e.i18n.general.cancel)}}function At(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"page-content",7),t.ALo(1,"async"),t._UZ(2,"forgot-password-step-change",4),t.TgZ(3,"actions")(4,"action-button",5),t.NdJ("action",function(){return t.CHM(e),t.oxw().change()}),t.qZA(),t.TgZ(5,"action-button",6),t.NdJ("action",function(){return t.CHM(e),t.oxw().cancel()}),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("layout",t.lcZ(1,7,e.layout.ltmd$)?"normal":"centered")("heading",e.i18n.password.title.forgotten)("mobileHeading",e.i18n.password.mobileTitle.forgotten),t.xp6(2),t.Q6J("data",e.changeData)("form",e.form),t.xp6(2),t.Q6J("label","generated"===e.changeData.passwordType.mode?e.i18n.password.forgotten.generate:e.i18n.general.submit),t.xp6(1),t.Q6J("label",e.i18n.general.cancel)}}let Pt=(()=>{class n extends _.y{constructor(e,o,c){super(e),this.authService=o,this.captchaHelper=c,this.step$=new y.X("request")}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit();const e=this.dataForFrontendHolder.dataForUi||{};null!=(e.auth||{}).user?this.router.navigateByUrl(""):this.data=e.dataForLogin}onDataInitialized(e){this.requestForm=this.formBuilder.group({user:[null,i.kI.required],sendMedium:e.forgotPasswordMediums[0]}),e.forgotPasswordCaptchaInput&&this.requestForm.addControl("captcha",this.captchaHelper.captchaFormGroup(e.forgotPasswordCaptchaInput))}toCode(){if(!(0,d.pt)(this.requestForm))return;const e=this.requestForm.value;e.user=u.S.escapeNumeric(e.user),this.errorHandler.requestWithCustomErrorHandler(()=>this.authService.forgottenPasswordRequest({body:e}).subscribe(o=>{this.sendMedium=o.sendMedium,this.notification.snackBar(this.i18n.password.forgotten.codeSent(o.sentTo.join(", "))),this.codeForm=this.formBuilder.group({user:[this.requestForm.value.user,i.kI.required],code:[null,i.kI.required]}),this.step="code"},o=>{o.status==S.n.NOT_FOUND?this.notification.error(this.i18n.password.forgotten.invalidUser):this.errorHandler.handleHttpError(o)}))}toChange(){if(!(0,d.pt)(this.codeForm))return;const e=this.codeForm.value;e.user=u.S.escapeNumeric(e.user),this.errorHandler.requestWithCustomErrorHandler(o=>{this.authService.getDataForChangeForgottenPassword(e).subscribe(c=>{this.changeData=c,this.changeForm=this.formBuilder.group({user:[this.codeForm.value.user,i.kI.required],code:[this.codeForm.value.code,i.kI.required]}),c.securityQuestion&&this.changeForm.addControl("securityAnswer",this.formBuilder.control(null,i.kI.required)),c.passwordType.mode===v.Y.MANUAL?(this.changeForm.addControl("checkConfirmation",this.formBuilder.control(!0)),this.changeForm.addControl("newPassword",this.formBuilder.control(null,i.kI.required)),this.changeForm.addControl("newPasswordConfirmation",this.formBuilder.control(null,i.kI.required))):this.changeForm.addControl("sendMedium",this.formBuilder.control(this.requestForm.value.sendMedium)),this.step="change"},c=>{if(c.status===S.n.FORBIDDEN){let g=c.error;if("string"==typeof g)try{g=JSON.parse(g)}catch(O){g={}}const M=g.code===I.j.TEMPORARILY_BLOCKED,Et=g.code===I.j.INDEFINITELY_BLOCKED;M||Et?(this.notification.error(this.i18n.password.forgotten.codeBlocked(M?this.i18n.password.status.temporarilyBlocked:this.i18n.password.status.indefinitelyBlocked)),this.cancel()):o(c)}else o(c)})})}change(){if(!(0,d.pt)(this.changeForm))return;const e=this.changeForm.value;e.user=u.S.escapeNumeric(e.user),this.addSub(this.authService.changeForgottenPassword({body:e}).subscribe(()=>{this.notification.info(this.changeData.passwordType.mode===v.Y.GENERATED?this.sendMedium===at.x.SMS?this.i18n.password.forgotten.generatedDoneSms:this.i18n.password.forgotten.generatedDoneEmail:this.i18n.password.forgotten.manualDone),this.cancel()}))}locateControl(e){return(0,d.xB)(this.form,e)}get form(){switch(this.step){case"request":return this.requestForm;case"code":return this.codeForm;case"change":return this.changeForm}}cancel(){this.login.goToLoginPage("")}resolveMenu(){return h.v2.LOGIN}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3),t.Y36(Q.e),t.Y36(rt.D))},n.\u0275cmp=t.Xpm({type:n,selectors:[["forgot-password"]],features:[t.qOj],decls:5,vars:6,consts:[["size","medium","hideMenu","",3,"ngSwitch"],["hideBack","","last","",3,"layout","heading","mobileHeading",4,"ngSwitchCase"],["last","",3,"layout","heading","mobileHeading",4,"ngSwitchCase"],["hideBack","","last","",3,"layout","heading","mobileHeading"],[3,"data","form"],[3,"label","action"],["outline","",3,"label","action"],["last","",3,"layout","heading","mobileHeading"],[3,"form"]],template:function(e,o){1&e&&(t.TgZ(0,"page-layout",0),t.ALo(1,"async"),t.YNc(2,Ct,6,9,"page-content",1),t.YNc(3,bt,6,8,"page-content",2),t.YNc(4,At,6,9,"page-content",2),t.qZA()),2&e&&(t.Q6J("ngSwitch",t.lcZ(1,4,o.step$)),t.xp6(2),t.Q6J("ngSwitchCase","request"),t.xp6(1),t.Q6J("ngSwitchCase","code"),t.xp6(1),t.Q6J("ngSwitchCase","change"))},directives:[w.w,l.RF,l.n9,x.Y,gt,C.h,b.x,ut,xt],pipes:[l.Ov],encapsulation:2,changeDetection:0}),n})();var Tt=r(871),vt=r(244);function yt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"action-button",8),t.NdJ("action",function(){return t.CHM(e),t.oxw(2).submit()}),t.ALo(1,"async"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",!e.canConfirm||t.lcZ(1,2,e.requesting$))("label",e.i18n.general.submit)}}function Nt(n,a){1&n&&t._uU(0,"\xa0")}function Ft(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"page-content",2)(1,"confirmation-password",3),t.NdJ("showSubmit",function(c){return t.CHM(e),t.oxw().showSubmit$.next(c)})("confirmed",function(c){return t.CHM(e),t.oxw().submit(c)}),t.qZA(),t.TgZ(2,"actions",4),t.YNc(3,yt,2,4,"action-button",5),t.ALo(4,"async"),t.YNc(5,Nt,1,0,"ng-template",null,6,t.W1O),t.TgZ(7,"action-button",7),t.NdJ("action",function(){return t.CHM(e),t.oxw().cancel()}),t.qZA()()()}if(2&n){const e=t.MAs(6),o=t.oxw();t.Q6J("heading",o.i18n.login.titleConfirmation)("mobileHeading",o.i18n.login.mobileTitleConfirmation),t.xp6(1),t.Q6J("formControl",o.control)("passwordInput",o.passwordInput)("createDeviceConfirmation",o.createDeviceConfirmation)("alertMessage",o.i18n.login.confirmationText),t.xp6(2),t.Q6J("ngIf",t.lcZ(4,9,o.showSubmit$))("ngIfElse",e),t.xp6(4),t.Q6J("label",o.i18n.general.cancel)}}const Zt=[{path:"",children:[{path:"forgot-password",component:Pt},{path:"login-confirmation",canActivate:[s.b],component:(()=>{class n extends _.y{constructor(e,o,c){super(e),this.authService=o,this.loginState=c,this.control=new i.NI(null,i.kI.required),this.showSubmit$=new y.X(!0)}get passwordInput(){return this.data}ngOnInit(){const e=this.dataForFrontendHolder.auth||{};e.loginConfirmation?(super.ngOnInit(),this.data=e.loginConfirmation,this.createDeviceConfirmation=()=>({type:Tt.l.SECONDARY_LOGIN})):this.router.navigate([""])}onDataInitialized(e){this.canConfirm=this.authHelper.canConfirm(e)}submit(e=null){!e&&!(0,d.pt)(this.control)||this.addSub(this.authService.confirmLogin({body:e||this.control.value}).subscribe(()=>this.reload()))}reload(){this.dataForFrontendHolder.reload().pipe((0,P.P)()).subscribe(()=>this.router.navigateByUrl(this.loginState.redirectUrl||""))}cancel(){this.login.logout()}resolveMenu(){return h.v2.DASHBOARD}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.zs3),t.Y36(Q.e),t.Y36(T.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["login-confirmation"]],features:[t.qOj],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],["layout","centered",3,"heading","mobileHeading",4,"ngIf"],["layout","centered",3,"heading","mobileHeading"],["focused","",3,"formControl","passwordInput","createDeviceConfirmation","alertMessage","showSubmit","confirmed"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["blank",""],["outline","",3,"label","action"],[3,"disabled","label","action"]],template:function(e,o){1&e&&(t.TgZ(0,"page-layout",0),t.ALo(1,"async"),t.YNc(2,Ft,8,11,"page-content",1),t.qZA()),2&e&&(t.Q6J("ready",t.lcZ(1,2,o.data$)),t.xp6(2),t.Q6J("ngIf",o.passwordInput))},directives:[w.w,l.O5,x.Y,vt.y,m.A,i.JJ,i.oH,C.h,b.x],pipes:[l.Ov],encapsulation:2,changeDetection:0}),n})()},{path:"pending-agreements",canActivate:[s.b],component:q},{path:"expired-password",canActivate:[s.b],component:ot}]}];let It=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.Bz.forChild(Zt)],p.Bz]}),n})();var St=r(4443);let Qt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[It,St.C]]}),n})()}}]);