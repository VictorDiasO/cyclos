"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([["src_app_ui_imports_imports_module_ts-src_app_ui_shared_result-type-field_component_ts-src_app-8f3c71"],{871:(Q,Z,a)=>{a.d(Z,{l:()=>u});var u=(()=>{return(l=u||(u={})).ACCEPT_ORDER="acceptOrder",l.APPROVE_TICKET="approveTicket",l.BUY_VOUCHERS="buyVouchers",l.CHANGE_ACCOUNT_LIMITS="changeAccountLimits",l.CHARGEBACK="chargeback",l.CLIENT_ACTION="clientAction",l.EDIT_PROFILE="editProfile",l.GENERATE_PASSWORD="generatePassword",l.GENERATE_VOUCHERS="generateVouchers",l.IMPORT_PAYMENTS="importPayments",l.IMPORT_USER_PAYMENTS="importUserPayments",l.IMPORT_USER_SEND_VOUCHERS="importUserSendVouchers",l.MANAGE_ADDRESS="manageAddress",l.MANAGE_AUTHORIZATION="manageAuthorization",l.MANAGE_CONTACT_INFO="manageContactInfo",l.MANAGE_DEVICE="manageDevice",l.MANAGE_EXTERNAL_PAYMENT="manageExternalPayment",l.MANAGE_FAILED_OCCURRENCE="manageFailedOccurrence",l.MANAGE_INSTALLMENT="manageInstallment",l.MANAGE_PAYMENT_REQUEST="managePaymentRequest",l.MANAGE_PHONE="managePhone",l.MANAGE_RECORD="manageRecord",l.MANAGE_RECURRING_PAYMENT="manageRecurringPayment",l.MANAGE_SCHEDULED_PAYMENT="manageScheduledPayment",l.MANAGE_VOUCHER="manageVoucher",l.PERFORM_EXTERNAL_PAYMENT="performExternalPayment",l.PERFORM_PAYMENT="performPayment",l.PERSONALIZE_NFC="personalizeNfc",l.REMOVE_TOTP_SECRET="removeTotpSecret",l.RUN_OPERATION="runOperation",l.RUN_WIZARD="runWizard",l.SECONDARY_LOGIN="secondaryLogin",l.SEND_VOUCHER="sendVoucher",l.SHOPPING_CART_CHECKOUT="shoppingCartCheckout",l.TOP_UP_VOUCHER="topUpVoucher",u;var l})()},8121:(Q,Z,a)=>{a.r(Z),a.d(Z,{ImportsModule:()=>en});var u=a(5300),l=a(6163),N=a(2614),e=a(6435),f=a(520),E=a(1352),I=a(8637),m=a(2198),d=a(4850),T=a(297);let y=(()=>{class n extends E.b{constructor(t,i){super(t,i)}getGeneralImportedFilesDataForSearch$Response(t,i){const o=new I.c(this.rootUrl,n.GetGeneralImportedFilesDataForSearchPath,"get");return t&&(o.path("context",t.context,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getGeneralImportedFilesDataForSearch(t,i){return this.getGeneralImportedFilesDataForSearch$Response(t,i).pipe((0,d.U)(o=>o.body))}searchGeneralImportedFiles$Response(t,i){const o=new I.c(this.rootUrl,n.SearchGeneralImportedFilesPath,"get");return t&&(o.path("context",t.context,{}),o.query("fields",t.fields,{explode:!1}),o.query("creationPeriod",t.creationPeriod,{}),o.query("kinds",t.kinds,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}searchGeneralImportedFiles(t,i){return this.searchGeneralImportedFiles$Response(t,i).pipe((0,d.U)(o=>o.body))}getUserImportedFilesDataForSearch$Response(t,i){const o=new I.c(this.rootUrl,n.GetUserImportedFilesDataForSearchPath,"get");return t&&(o.path("user",t.user,{}),o.path("context",t.context,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getUserImportedFilesDataForSearch(t,i){return this.getUserImportedFilesDataForSearch$Response(t,i).pipe((0,d.U)(o=>o.body))}searchUserImportedFiles$Response(t,i){const o=new I.c(this.rootUrl,n.SearchUserImportedFilesPath,"get");return t&&(o.path("user",t.user,{}),o.path("context",t.context,{}),o.query("fields",t.fields,{explode:!1}),o.query("creationPeriod",t.creationPeriod,{}),o.query("kinds",t.kinds,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}searchUserImportedFiles(t,i){return this.searchUserImportedFiles$Response(t,i).pipe((0,d.U)(o=>o.body))}getGeneralImportedFileDataForNew$Response(t,i){const o=new I.c(this.rootUrl,n.GetGeneralImportedFileDataForNewPath,"get");return t&&(o.path("kind",t.kind,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getGeneralImportedFileDataForNew(t,i){return this.getGeneralImportedFileDataForNew$Response(t,i).pipe((0,d.U)(o=>o.body))}importGeneralFile$Response(t,i){const o=new I.c(this.rootUrl,n.ImportGeneralFilePath,"post");return t&&(o.path("kind",t.kind,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"multipart/form-data")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}importGeneralFile(t,i){return this.importGeneralFile$Response(t,i).pipe((0,d.U)(o=>o.body))}getUserImportedFileDataForNew$Response(t,i){const o=new I.c(this.rootUrl,n.GetUserImportedFileDataForNewPath,"get");return t&&(o.path("user",t.user,{}),o.path("kind",t.kind,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getUserImportedFileDataForNew(t,i){return this.getUserImportedFileDataForNew$Response(t,i).pipe((0,d.U)(o=>o.body))}importUserFile$Response(t,i){const o=new I.c(this.rootUrl,n.ImportUserFilePath,"post");return t&&(o.path("user",t.user,{}),o.path("kind",t.kind,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"multipart/form-data")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}importUserFile(t,i){return this.importUserFile$Response(t,i).pipe((0,d.U)(o=>o.body))}viewImportedFile$Response(t,i){const o=new I.c(this.rootUrl,n.ViewImportedFilePath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}viewImportedFile(t,i){return this.viewImportedFile$Response(t,i).pipe((0,d.U)(o=>o.body))}updateImportedFile$Response(t,i){const o=new I.c(this.rootUrl,n.UpdateImportedFilePath,"put");return t&&(o.path("id",t.id,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}updateImportedFile(t,i){return this.updateImportedFile$Response(t,i).pipe((0,d.U)(o=>o.body))}deleteImportedFile$Response(t,i){const o=new I.c(this.rootUrl,n.DeleteImportedFilePath,"delete");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}deleteImportedFile(t,i){return this.deleteImportedFile$Response(t,i).pipe((0,d.U)(o=>o.body))}getImportedFileDataForEdit$Response(t,i){const o=new I.c(this.rootUrl,n.GetImportedFileDataForEditPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getImportedFileDataForEdit(t,i){return this.getImportedFileDataForEdit$Response(t,i).pipe((0,d.U)(o=>o.body))}processImportedFile$Response(t,i){const o=new I.c(this.rootUrl,n.ProcessImportedFilePath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}processImportedFile(t,i){return this.processImportedFile$Response(t,i).pipe((0,d.U)(o=>o.body))}abortImportedFile$Response(t,i){const o=new I.c(this.rootUrl,n.AbortImportedFilePath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:"true"===String(s.body)})))}abortImportedFile(t,i){return this.abortImportedFile$Response(t,i).pipe((0,d.U)(o=>o.body))}getImportedLinesDataForSearch$Response(t,i){const o=new I.c(this.rootUrl,n.GetImportedLinesDataForSearchPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getImportedLinesDataForSearch(t,i){return this.getImportedLinesDataForSearch$Response(t,i).pipe((0,d.U)(o=>o.body))}searchImportedLines$Response(t,i){const o=new I.c(this.rootUrl,n.SearchImportedLinesPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1}),o.query("keywords",t.keywords,{}),o.query("lineNumbers",t.lineNumbers,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}searchImportedLines(t,i){return this.searchImportedLines$Response(t,i).pipe((0,d.U)(o=>o.body))}skipImportedLines$Response(t,i){const o=new I.c(this.rootUrl,n.SkipImportedLinesPath,"post");return t&&(o.path("id",t.id,{}),o.query("lines",t.lines,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}skipImportedLines(t,i){return this.skipImportedLines$Response(t,i).pipe((0,d.U)(o=>o.body))}includeImportedLines$Response(t,i){const o=new I.c(this.rootUrl,n.IncludeImportedLinesPath,"post");return t&&(o.path("id",t.id,{}),o.query("lines",t.lines,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}includeImportedLines(t,i){return this.includeImportedLines$Response(t,i).pipe((0,d.U)(o=>o.body))}viewImportedLine$Response(t,i){const o=new I.c(this.rootUrl,n.ViewImportedLinePath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}viewImportedLine(t,i){return this.viewImportedLine$Response(t,i).pipe((0,d.U)(o=>o.body))}updateImportedLine$Response(t,i){const o=new I.c(this.rootUrl,n.UpdateImportedLinePath,"put");return t&&(o.path("id",t.id,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s.clone({body:void 0})))}updateImportedLine(t,i){return this.updateImportedLine$Response(t,i).pipe((0,d.U)(o=>o.body))}getImportedLineDataForEdit$Response(t,i){const o=new I.c(this.rootUrl,n.GetImportedLineDataForEditPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,m.h)(s=>s instanceof f.Zn),(0,d.U)(s=>s))}getImportedLineDataForEdit(t,i){return this.getImportedLineDataForEdit$Response(t,i).pipe((0,d.U)(o=>o.body))}}return n.GetGeneralImportedFilesDataForSearchPath="/imported-files/{context}/data-for-search",n.SearchGeneralImportedFilesPath="/imported-files/{context}",n.GetUserImportedFilesDataForSearchPath="/{user}/imported-files/{context}/data-for-search",n.SearchUserImportedFilesPath="/{user}/imported-files/{context}",n.GetGeneralImportedFileDataForNewPath="/imported-files/{kind}/data-for-new",n.ImportGeneralFilePath="/imported-files/{kind}",n.GetUserImportedFileDataForNewPath="/{user}/imported-files/{kind}/data-for-new",n.ImportUserFilePath="/{user}/imported-files/{kind}",n.ViewImportedFilePath="/imported-file/{id}",n.UpdateImportedFilePath="/imported-file/{id}",n.DeleteImportedFilePath="/imported-file/{id}",n.GetImportedFileDataForEditPath="/imported-file/{id}/data-for-edit",n.ProcessImportedFilePath="/imported-file/{id}/process",n.AbortImportedFilePath="/imported-file/{id}/abort",n.GetImportedLinesDataForSearchPath="/imported-file/{id}/lines/data-for-search",n.SearchImportedLinesPath="/imported-file/{id}/lines",n.SkipImportedLinesPath="/imported-file/{id}/skip",n.IncludeImportedLinesPath="/imported-file/{id}/include",n.ViewImportedLinePath="/imported-line/{id}",n.UpdateImportedLinePath="/imported-line/{id}",n.GetImportedLineDataForEditPath="/imported-line/{id}/data-for-edit",n.\u0275fac=function(t){return new(t||n)(e.LFG(T.p),e.LFG(f.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=a(4410),g=a(1963),b=a(9808),_=a(2032),p=a(3075),c=a(1030),h=a(6903),F=a(1556);function x(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"div",3),e._UZ(3,"textarea-field",4),e.TgZ(4,"actions")(5,"action-button",5),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(6,"async"),e.qZA()()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.edit)("mobileHeading",t.i18n.imports.mobileTitle.edit)("headingActions",e.lcZ(1,7,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.general.description),e.xp6(2),e.Q6J("disabled",e.lcZ(6,9,t.requesting$))("label",t.i18n.general.save)}}let v=(()=>{class n extends N.y{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.importsService.getImportedFileDataForEdit({id:this.id}).subscribe(i=>this.data=i))}onDataInitialized(t){super.onDataInitialized(t),this.form=this.formBuilder.group({description:t.importedFile.description})}save(){if(!(0,l.pt)(this.form))return;const t=Object.assign(Object.assign({},this.data.importedFile),this.form.value);this.addSub(this.importsService.updateImportedFile({id:this.id,body:t}).subscribe(()=>{this.router.navigate(["/imports","files","view",this.id],{replaceUrl:!0})}))}resolveMenu(){return this.importsHelper.resolveMenu(this.data)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-imported-file"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","",3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["formControlName","description",3,"label"],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,x,7,11,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[g.w,b.O5,_.Y,p.JL,p.sg,c.u,p.JJ,p.u,h.h,F.x],pipes:[b.Ov],encapsulation:2,changeDetection:0}),n})();var A=a(195),R=a(3728);function J(n,r){if(1&n&&e._UZ(0,"input-field",8),2&n){const t=e.oxw().$implicit;e.Q6J("formControl",t.control)("label",t.field.name)}}function M(n,r){if(1&n&&e._UZ(0,"textarea-field",8),2&n){const t=e.oxw().$implicit;e.Q6J("formControl",t.control)("label",t.field.name)}}function D(n,r){if(1&n&&(e.ynx(0),e.YNc(1,J,1,2,"input-field",7),e.YNc(2,M,1,2,"textarea-field",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.multiline),e.xp6(1),e.Q6J("ngIf",t.multiline)}}function V(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"div",3)(3,"label-value",4),e._uU(4),e.qZA(),e.YNc(5,D,3,2,"ng-container",5),e.TgZ(6,"actions")(7,"action-button",6),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(8,"async"),e.qZA()()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.lineEdit)("mobileHeading",t.i18n.imports.mobileTitle.lineEdit)("headingActions",e.lcZ(1,9,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.imports.lineNumber),e.xp6(1),e.Oqu(t.data.lineNumber),e.xp6(1),e.Q6J("ngForOf",t.controls),e.xp6(2),e.Q6J("disabled",e.lcZ(8,11,t.requesting$))("label",t.i18n.general.save)}}let $=(()=>{class n extends N.y{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.importsService.getImportedLineDataForEdit({id:this.id}).subscribe(i=>this.data=i))}onDataInitialized(t){super.onDataInitialized(t);const i=t.importedLine.values.map(o=>new p.NI(o));this.form=new p.cw({values:new p.Oe(i)}),this.controls=i.map((o,s)=>{var C;return{field:t.fields[s],control:o,multiline:null===(C=t.importedLine.values[s])||void 0===C?void 0:C.includes("\n")}})}save(){if(!(0,l.pt)(this.form))return;const t=Object.assign(Object.assign({},this.data.importedLine),this.form.value);this.addSub(this.importsService.updateImportedLine({id:this.id,body:t}).subscribe(()=>{this.router.navigate(["/imports","lines","view",this.id],{replaceUrl:!0})}))}resolveMenu(){var t;return this.importsHelper.resolveMenu(null===(t=this.data)||void 0===t?void 0:t.file)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-imported-line"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","",3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["kind","fieldView",3,"label"],[4,"ngFor","ngForOf"],[3,"disabled","label","action"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,V,9,13,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[g.w,b.O5,_.Y,p.JL,p.sg,A.t,b.sg,R.q,p.JJ,p.oH,c.u,h.h,F.x],pipes:[b.Ov],encapsulation:2,changeDetection:0}),n})();var w=a(5825),G=a(871),q=a(7e3),Y=a(591),pe=a(6734),K=a(5350),H=a(9653),ce=a(3450),ue=a(7816),B=a(8868),de=a(1321),me=a(2479),he=a(244),j=a(3317);function _e(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"voucher-type-selection",3),e.NdJ("typeSelected",function(o){return e.CHM(t),e.oxw().onVoucherTypeSelected(o)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.importNewVouchersSend)("mobileHeading",t.i18n.imports.mobileTitle.importNewVouchersSend)("categories",t.data.dataForSend.categories)("types",t.data.dataForSend.types)("user",t.data.user)}}function fe(n,r){if(1&n&&(e.TgZ(0,"alert",16),e._UZ(1,"div",17),e.ALo(2,"trust"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,t.i18n.imports.information.userSendVouchers(t.data.separator)),e.oJD)}}function ge(n,r){if(1&n&&e._UZ(0,"user-info",18),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function be(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit;e.Q6J("value",t.id)("id",t.id)("internalName",t.internalName)("text",t.name)}}function xe(n,r){if(1&n&&(e.TgZ(0,"single-selection-field",19),e.YNc(1,be,1,4,"field-option",20),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.currency),e.xp6(1),e.Q6J("ngForOf",t.data.currencies)}}function Ie(n,r){if(1&n&&e._UZ(0,"boolean-field",22),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.sendNotifications)}}function ve(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit;e.Q6J("value",t.id)("id",t.id)("internalName",t.internalName)("text",t.name)}}function Te(n,r){if(1&n&&(e.TgZ(0,"single-selection-field",23),e.YNc(1,ve,1,4,"field-option",20),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.type),e.xp6(1),e.Q6J("ngForOf",t.data.recordTypes)}}function Fe(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit;e.Q6J("value",t.id)("id",t.id)("internalName",t.internalName)("text",t.name)}}function ye(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"boolean-field",24),e.TgZ(2,"single-selection-field",25),e.YNc(3,Fe,1,4,"field-option",20),e.qZA(),e._UZ(4,"boolean-field",26),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.imports.useGroupFromFile),e.xp6(1),e.Q6J("label",t.form.controls.useGroupFromFile.value?t.i18n.imports.defaultGroup:t.i18n.user.group)("required",!t.form.controls.useGroupFromFile.value),e.xp6(1),e.Q6J("ngForOf",t.data.groups),e.xp6(1),e.Q6J("label",t.i18n.imports.sendActivationEmail)}}function Ae(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit;e.Q6J("value",t.id)("id",t.id)("internalName",t.internalName)("text",t.name)}}function Ce(n,r){if(1&n&&(e.TgZ(0,"single-selection-field",27),e.YNc(1,Ae,1,4,"field-option",20),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.type),e.xp6(1),e.Q6J("ngForOf",t.data.paymentTypes)}}function Se(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"label-value",8),e.ALo(2,"async"),e._UZ(3,"boolean-field",28),e.TgZ(4,"label-value",29),e.ALo(5,"async"),e.ALo(6,"async"),e._UZ(7,"decimal-field",30),e.ALo(8,"async"),e.ALo(9,"async"),e.qZA(),e._UZ(10,"textarea-field",31),e.BQk()),2&n){const t=e.oxw(2);let i,o,s;e.xp6(1),e.Q6J("label",t.i18n.voucher.voucher)("value",null==(i=e.lcZ(2,8,t.voucherType$))?null:i.voucherDescription),e.xp6(2),e.Q6J("label",t.i18n.imports.useAmountFromFile),e.xp6(1),e.Q6J("label",e.lcZ(5,10,t.useAmountFromFile$)?t.i18n.imports.defaultAmount:t.i18n.transaction.amount)("required",!1===e.lcZ(6,12,t.useAmountFromFile$)),e.xp6(3),e.Q6J("prefix",null==(o=e.lcZ(8,14,t.voucherType$))||null==o.configuration||null==o.configuration.currency?null:o.configuration.currency.prefix)("suffix",null==(s=e.lcZ(9,16,t.voucherType$))||null==s.configuration||null==s.configuration.currency?null:s.configuration.currency.suffix),e.xp6(3),e.Q6J("label",t.i18n.voucher.send.message)}}function we(n,r){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"hr"),e.TgZ(2,"confirmation-password",32),e.NdJ("showSubmit",function(o){return e.CHM(t),e.oxw(2).showSubmit$.next(o)})("confirmed",function(o){return e.CHM(t),e.oxw(2).submit(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("formControl",t.confirmationPasswordControl)("passwordInput",t.data.confirmationPasswordInput)("createDeviceConfirmation",t.createDeviceConfirmation)}}function Ze(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"actions")(1,"action-button",33),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).submit()}),e.ALo(2,"async"),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",e.lcZ(2,2,t.requesting$))("label",t.i18n.general.submit)}}function Ue(n,r){if(1&n&&(e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.YNc(2,fe,3,3,"alert",5),e.TgZ(3,"div",6),e.YNc(4,ge,1,1,"user-info",7),e._UZ(5,"label-value",8)(6,"file-field",9)(7,"textarea-field",10),e.YNc(8,xe,2,2,"single-selection-field",11),e.YNc(9,Ie,1,1,"boolean-field",12),e.YNc(10,Te,2,2,"single-selection-field",13),e.YNc(11,ye,5,5,"ng-container",14),e.YNc(12,Ce,2,2,"single-selection-field",15),e.YNc(13,Se,11,18,"ng-container",14),e.YNc(14,we,3,3,"ng-container",14),e.YNc(15,Ze,3,4,"actions",14),e.ALo(16,"async"),e.qZA()()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.importNew)("mobileHeading",t.i18n.imports.mobileTitle.importNew)("headingActions",e.lcZ(1,19,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.USER_SEND_VOUCHERS),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.data.user&&!t.isSelf),e.xp6(1),e.Q6J("label",t.i18n.imports.kind.label)("value",t.importsHelper.kindLabel(t.data.kind)),e.xp6(1),e.Q6J("label",t.i18n.imports.file)("formControl",t.fileControl),e.xp6(1),e.Q6J("label",t.i18n.general.description),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.ADS),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.PAYMENTS),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.RECORDS),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.USERS),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.USER_PAYMENTS),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.ImportedFileKind.USER_SEND_VOUCHERS),e.xp6(1),e.Q6J("ngIf",t.data.confirmationPasswordInput),e.xp6(1),e.Q6J("ngIf",e.lcZ(16,21,t.showSubmit$))}}const Ne=n=>{const r=n.parent;return r&&!r.get("useGroupFromFile").value?p.kI.required(n):null},Ee=n=>{const r=n.parent;return r&&!r.get("useAmountFromFile").value?p.kI.required(n):null};let Re=(()=>{class n extends N.y{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o,this.ImportedFileKind=w._,this.step$=new Y.X(null),this.voucherType$=new Y.X(null),this.useAmountFromFile$=new Y.X(!1),this.showSubmit$=new Y.X(!0)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot,i=t.params.owner;let o;q.S.SYSTEM===i?(this.generalKind=t.params.kind,o=this.importsService.getGeneralImportedFileDataForNew({kind:this.generalKind})):(this.userKind=t.params.kind,this.user=i,o=this.importsService.getUserImportedFileDataForNew({user:this.user,kind:this.userKind})),this.stateManager.cache("data",o).subscribe(s=>this.data=s)}onDataInitialized(t){var i;super.onDataInitialized(t),this.isSelf=this.authHelper.isSelfOrOwner(t.user),this.form=this.formBuilder.group({description:null}),this.fileControl=new p.NI(null,p.kI.required),t.confirmationPasswordInput&&(this.confirmationPasswordControl=new p.NI("",p.kI.required));const o=t.importedFile;switch(t.kind){case w._.ADS:this.form.addControl("currency",new p.NI(o.currency,p.kI.required));break;case w._.PAYMENTS:this.form.addControl("sendNotifications",new p.NI(!!o.sendNotifications));break;case w._.RECORDS:this.form.addControl("recordType",new p.NI(o.recordType,p.kI.required));break;case w._.USERS:this.form.addControl("useGroupFromFile",new p.NI(o.useGroupFromFile)),this.form.addControl("group",new p.NI(o.group,Ne)),this.form.addControl("sendActivationEmail",new p.NI(o.sendActivationEmail));break;case w._.USER_PAYMENTS:this.form.addControl("paymentType",new p.NI(o.paymentType,p.kI.required));break;case w._.USER_SEND_VOUCHERS:this.useAmountFromFile$.next(!!o.useAmountFromFile);const s=new p.NI(this.useAmountFromFile$.value);this.addSub(s.valueChanges.subscribe(C=>this.useAmountFromFile$.next(C))),this.form.addControl("voucherType",new p.NI(o.voucherType,p.kI.required)),this.form.addControl("useAmountFromFile",s),this.form.addControl("amount",new p.NI(o.amount,Ee)),this.form.addControl("sendMessage",new p.NI(o.sendMessage))}if(t.kind===w._.USER_SEND_VOUCHERS){const s=(null===(i=t.dataForSend)||void 0===i?void 0:i.types)||[];1===s.length?this.onVoucherTypeSelected(s[0]):this.step="voucher-type"}this.step||(this.step="form")}get step(){return this.step$.value}set step(t){this.step$.next(t)}get voucherType(){return this.voucherType$.value}set voucherType(t){this.voucherType$.next(t)}submit(t){var i;if(!(0,l.pt)(this.form)||!(0,l.pt)(this.fileControl)||!t&&this.confirmationPasswordControl&&!(0,l.pt)(this.confirmationPasswordControl))return;t||(t=null===(i=this.confirmationPasswordControl)||void 0===i?void 0:i.value);const o=this.fileControl.value,s=this.form.value;let C;C=this.generalKind?this.importsService.importGeneralFile({kind:this.generalKind,confirmationPassword:t,body:{params:s,file:o}}):this.importsService.importUserFile({user:this.user,kind:this.userKind,confirmationPassword:t,body:{params:s,file:o}}),this.addSub(C.subscribe(tn=>this.router.navigate(["/imports","files","view",tn])))}get createDeviceConfirmation(){let t=null,i=null,o=null;switch(this.data.kind){case w._.PAYMENTS:t=G.l.IMPORT_PAYMENTS;break;case w._.USER_PAYMENTS:t=G.l.IMPORT_USER_PAYMENTS,i=this.form.controls.paymentType.value;break;case w._.USER_SEND_VOUCHERS:t=G.l.IMPORT_USER_SEND_VOUCHERS,o=this.form.controls.voucherType.value}return()=>({type:t,paymentType:i,voucherType:o})}onVoucherTypeSelected(t){this.form.patchValue({voucherType:t.id}),this.voucherType=t,this.step="form"}resolveMenu(){return this.importsHelper.resolveMenu(this.data)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["import-file"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","categories","types","user","typeSelected",4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[3,"heading","mobileHeading","categories","types","user","typeSelected"],["last","",3,"heading","mobileHeading","headingActions"],["type","info",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label","value"],["required","",3,"label","formControl"],["formControlName","description",3,"label"],["formControlName","currency","required","",3,"label",4,"ngIf"],["formControlName","sendNotifications",3,"label",4,"ngIf"],["formControlName","recordType","required","",3,"label",4,"ngIf"],[4,"ngIf"],["formControlName","paymentType","required","",3,"label",4,"ngIf"],["type","info"],[3,"innerHTML"],[3,"user"],["formControlName","currency","required","",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","sendNotifications",3,"label"],["formControlName","recordType","required","",3,"label"],["formControlName","useGroupFromFile",3,"label"],["formControlName","group",3,"label","required"],["formControlName","sendActivationEmail",3,"label"],["formControlName","paymentType","required","",3,"label"],["formControlName","useAmountFromFile",3,"label"],["kind","field","fieldSize","medium",3,"label","required"],["formControlName","amount",3,"prefix","suffix"],["formControlName","sendMessage",3,"label"],[3,"formControl","passwordInput","createDeviceConfirmation","showSubmit","confirmed"],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,_e,1,5,"voucher-type-selection",1),e.YNc(4,Ue,17,23,"page-content",2),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","voucher-type"),e.xp6(1),e.Q6J("ngSwitchCase","form"))},directives:[g.w,b.RF,b.n9,pe.W,_.Y,b.O5,K.wx,p.JL,p.sg,H.M,A.t,ce.O,p.Q7,p.JJ,p.oH,c.u,p.u,ue.f,b.sg,B.s,de.M,me.U,he.y,h.h,F.x],pipes:[b.Ov,j.a],encapsulation:2,changeDetection:0}),n})();var U=a(8101),k=(()=>{return(n=k||(k={})).PAYMENTS="payments",n.SYSTEM="system",k;var n})(),z=a(441),O=a(1879),L=a(5466),X=a(2292),Le=a(6243),W=a(5255),Oe=a(8170),ee=a(8687),te=a(1441),ne=a(629),ie=a(1015),Je=a(8397),oe=a(70),se=a(3812),re=a(3030);function Pe(n,r){1&n&&e.GkF(0)}function Qe(n,r){if(1&n&&e._UZ(0,"user-info",19),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function Me(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit,i=e.oxw(3);e.Q6J("value",t)("text",i.importsHelper.kindLabel(t))}}function De(n,r){if(1&n&&(e.TgZ(0,"div",10)(1,"multi-selection-field",20),e.YNc(2,Me,1,2,"field-option",12),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.imports.kind.label)("emptyLabel",t.i18n.general.notApplied),e.xp6(1),e.Q6J("ngForOf",t.data.kinds)}}function Ye(n,r){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=r.$implicit,i=e.oxw(2);e.Q6J("value",t)("text",i.importsHelper.fileStatusLabel(t))}}function $e(n,r){if(1&n&&(e.TgZ(0,"mobile-result",22)(1,"div",23),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("date",t.creationDate),e.xp6(2),e.hij(" ",t.fileName," ")}}function ke(n,r){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.type)}}function Ve(n,r){1&n&&e._UZ(0,"th",28)}function Ge(n,r){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Oqu(i.importsHelper.kindLabel(t.kind))}}function qe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(o){e.CHM(t);const s=e.oxw(2).$implicit;return e.oxw(3).remove(s),o.stopPropagation()}),e._UZ(1,"icon",32),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function He(n,r){if(1&n&&(e.TgZ(0,"td"),e.YNc(1,qe,2,2,"button",30),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.data.manageKinds.includes(t.kind))}}function Be(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",29),e.NdJ("click",function(){const s=e.CHM(t).$implicit,C=e.oxw(3);return C.router.navigate(C.path(s))}),e.TgZ(2,"td"),e._uU(3),e.ALo(4,"date"),e.qZA(),e.YNc(5,Ge,2,1,"th",25),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.YNc(12,He,2,1,"td",25),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,6,t.creationDate)),e.xp6(2),e.Q6J("ngIf",(null==i.data.kinds?null:i.data.kinds.length)>1),e.xp6(2),e.Oqu(t.fileName),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(i.importsHelper.fileStatusLabel(t.status)),e.xp6(1),e.Q6J("ngIf",null==i.data.manageKinds?null:i.data.manageKinds.length)}}function Ke(n,r){if(1&n&&(e.TgZ(0,"table",24)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.YNc(4,ke,2,1,"th",25),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA(),e.YNc(11,Ve,1,0,"th",26),e.qZA(),e.TgZ(12,"tbody"),e.YNc(13,Be,13,8,"ng-container",27),e.ALo(14,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.imports.creationDate),e.xp6(1),e.Q6J("ngIf",(null==t.data.kinds?null:t.data.kinds.length)>1),e.xp6(2),e.Oqu(t.i18n.imports.fileName),e.xp6(2),e.Oqu(t.i18n.general.description),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(1),e.Q6J("ngIf",null==t.data.manageKinds?null:t.data.manageKinds.length),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(14,7,t.results$))?null:i.results)}}function je(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7),e.YNc(5,Qe,1,1,"user-info",8),e.qZA(),e.YNc(6,De,3,3,"div",9),e.TgZ(7,"div",10)(8,"multi-selection-field",11),e.YNc(9,Ye,1,2,"field-option",12),e.qZA()(),e._UZ(10,"div",13),e.TgZ(11,"div",10),e._UZ(12,"date-field",14),e.qZA(),e.TgZ(13,"div",10),e._UZ(14,"date-field",15),e.qZA()()()(),e.TgZ(15,"results-layout",16),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(16,"async"),e.YNc(17,$e,3,2,"mobile-result",17),e.YNc(18,Ke,15,9,"table",18),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("headingActions",e.lcZ(1,14,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("ngIf",t.data.user&&!t.isSelf),e.xp6(1),e.Q6J("ngIf",(null==t.data.kinds?null:t.data.kinds.length)>1),e.xp6(2),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.general.status),e.xp6(1),e.Q6J("ngForOf",t.statuses),e.xp6(3),e.Q6J("label",t.i18n.user.creationBegin),e.xp6(2),e.Q6J("label",t.i18n.user.creationEnd),e.xp6(1),e.Q6J("results",e.lcZ(16,16,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}function ze(n,r){1&n&&e._UZ(0,"spinner",33)}let Xe=(()=>{class n extends X.t{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o,this.statuses=Object.values(U.K)}getFormControlNames(){return["kinds","statuses","beginCreationPeriod","endCreationPeriod"]}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;let i;this.owner=t.params.owner,q.S.SYSTEM===this.owner?(this.systemContext=t.params.context,i=this.importsService.getGeneralImportedFilesDataForSearch({context:this.systemContext})):(this.userContext=t.params.context,this.user=this.owner,i=this.importsService.getUserImportedFilesDataForSearch({user:this.user,context:this.userContext})),this.stateManager.cache("data",i).subscribe(o=>this.data=o)}onDataInitialized(t){switch(super.onDataInitialized(t),this.systemContext||this.userContext){case k.PAYMENTS:this.title=this.i18n.imports.title.payments,this.mobileTitle=this.i18n.imports.mobileTitle.payments;break;case z.R.USER_PAYMENTS:this.title=this.i18n.imports.title.userPayments,this.mobileTitle=this.i18n.imports.mobileTitle.userPayments;break;case z.R.USER_SEND_VOUCHERS:this.title=this.i18n.imports.title.userSendVouchers,this.mobileTitle=this.i18n.imports.mobileTitle.userSendVouchers;break;default:this.title=this.i18n.imports.title.generalSearch,this.mobileTitle=this.i18n.imports.mobileTitle.generalSearch}if(this.isSelf=t.user&&this.authHelper.isSelfOrOwner(t.user),!(0,l.cS)(t.manageKinds)){const i=s=>s?()=>this.router.navigate(["/imports",this.owner,s,"new"]):()=>null,o=new L.Yu(O.l.ArrowUpCircle,this.i18n.imports.importNew,i(1===t.manageKinds.length?t.manageKinds[0]:null),!0);t.manageKinds.length>1&&(o.subActions=t.manageKinds.map(s=>new L.aU(this.importsHelper.kindLabel(s),i(s)))),this.headingActions=[o]}}doSearch(t){return this.systemContext?this.importsService.searchGeneralImportedFiles$Response(Object.assign({context:this.systemContext},t)):this.importsService.searchUserImportedFiles$Response(Object.assign({user:this.user,context:this.userContext},t))}toSearchParams(t){const i=t;return i.creationPeriod=q.S.dateRangeFilter(t.beginCreationPeriod,t.endCreationPeriod),i}resolveMenu(){return Le.v2.PAYMENT_IMPORTS}get toLink(){return t=>this.path(t)}path(t){return["/imports","files","view",t.id]}remove(t){this.confirmation.confirm({message:this.i18n.general.removeConfirm(t.fileName),callback:()=>this.doRemove(t)})}doRemove(t){this.addSub(this.importsService.deleteImportedFile({id:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.update()}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-imported-files"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12"],[3,"user",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","statuses",3,"emptyLabel","label"],[3,"value","text",4,"ngFor","ngForOf"],[1,"w-100"],["formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],[3,"results","toLink","rendering$","update"],[3,"date",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],["formControlName","kinds",3,"label","emptyLabel"],[3,"value","text"],[3,"date"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[4,"ngIf"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"p-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Pe,1,0,"ng-container",1),e.qZA(),e.YNc(3,je,19,18,"ng-template",null,2,e.W1O),e.YNc(5,ze,1,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[g.w,b.O5,_.Y,p.JL,p.sg,H.M,W.x,p.JJ,p.u,b.sg,B.s,Oe.Q,ee.D,te.E,ne.t,ie.p,Je.i9,oe.o,se.O],pipes:[b.Ov,re.u],encapsulation:2,changeDetection:0}),n})();var We=a(3685),et=a(9697);function tt(n,r){1&n&&e.GkF(0)}function nt(n,r){if(1&n&&e._UZ(0,"field-option",18),2&n){const t=r.$implicit,i=e.oxw(2);e.Q6J("value",t)("text",i.importsHelper.lineStatusLabel(t))}}function it(n,r){if(1&n&&(e.TgZ(0,"div",21),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Oqu(o.rowValue(t,i))}}function ot(n,r){if(1&n&&(e.TgZ(0,"mobile-result",19),e.YNc(1,it,2,1,"div",20),e.qZA()),2&n){const t=r.$implicit,i=e.oxw(2);e.Q6J("topLeft",t.lineNumber)("topRight",i.importsHelper.lineStatusLabel(t.status)),e.xp6(1),e.Q6J("ngForOf",i.data.fieldsInList)}}function st(n,r){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t.name)}}function rt(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Oqu(o.rowValue(t,i))}}function lt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(o){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3).showError(s),o.stopPropagation()}),e._UZ(1,"icon",28),e.qZA()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("icon",t.SvgIcon.ExclamationTriangle)}}function at(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(o){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3).navigate(s),o.stopPropagation()}),e._UZ(1,"icon",28),e.qZA()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("icon",t.SvgIcon.Eye)}}function pt(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",25),e.NdJ("click",function(){const s=e.CHM(t).$implicit,C=e.oxw(3);return C.router.navigate(C.path(s))}),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.YNc(6,rt,2,1,"td",23),e.TgZ(7,"td",24),e.YNc(8,lt,2,1,"button",26),e.YNc(9,at,2,1,"button",26),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(t.lineNumber),e.xp6(2),e.Oqu(i.importsHelper.lineStatusLabel(t.status)),e.xp6(1),e.Q6J("ngForOf",i.data.fieldsInList),e.xp6(2),e.Q6J("ngIf",t.errorMessage),e.xp6(1),e.Q6J("ngIf",t.importedEntityId)}}function ct(n,r){if(1&n&&(e.TgZ(0,"table",22)(1,"thead")(2,"th"),e._uU(3,"#"),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.YNc(6,st,2,1,"th",23),e._UZ(7,"th",24),e.qZA(),e.TgZ(8,"tbody"),e.YNc(9,pt,10,5,"ng-container",23),e.ALo(10,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(5),e.Oqu(t.i18n.general.status),e.xp6(1),e.Q6J("ngForOf",t.data.fieldsInList),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(10,3,t.results$))?null:i.results)}}const ut=function(n){return["/imports","files","view",n]};function dt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",4),e.ALo(1,"async"),e.TgZ(2,"div",5)(3,"div",6)(4,"div",7)(5,"label-value",8)(6,"a",9),e._uU(7),e.qZA()()(),e.TgZ(8,"div",10),e._UZ(9,"input-field",11),e.qZA(),e.TgZ(10,"div",10),e._UZ(11,"input-field",12),e.qZA(),e.TgZ(12,"div",10)(13,"multi-selection-field",13),e.YNc(14,nt,1,2,"field-option",14),e.qZA()()()()(),e.TgZ(15,"results-layout",15),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(16,"async"),e.YNc(17,ot,2,3,"mobile-result",16),e.YNc(18,ct,11,5,"table",17),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.lineSearch)("mobileHeading",t.i18n.imports.mobileTitle.lineSearch)("headingActions",e.lcZ(1,15,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.imports.file),e.xp6(1),e.Q6J("routerLink",e.VKq(19,ut,t.id)),e.xp6(1),e.Oqu(t.data.file.fileName),e.xp6(2),e.Q6J("label",t.i18n.general.keywords),e.xp6(2),e.Q6J("label",t.i18n.imports.lineNumber),e.xp6(2),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.general.status),e.xp6(1),e.Q6J("ngForOf",t.statuses),e.xp6(1),e.Q6J("results",e.lcZ(16,17,t.results$))("toLink",t.toLink)("rendering$",t.rendering$)}}function mt(n,r){1&n&&e._UZ(0,"spinner",29)}let ht=(()=>{class n extends X.t{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o,this.statuses=Object.values(We.S)}getFormControlNames(){return["keywords","statuses","lineNumber"]}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.stateManager.cache("data",this.importsService.getImportedLinesDataForSearch({id:this.id})).subscribe(i=>this.data=i)}doSearch(t){return this.importsService.searchImportedLines$Response(Object.assign({id:this.id},t))}toSearchParams(t){const i=t;return i.lineNumbers=t.lineNumber?[t.lineNumber]:null,i}resolveMenu(){var t;return this.importsHelper.resolveMenu(null===(t=this.data)||void 0===t?void 0:t.file)}get toLink(){return t=>this.path(t)}rowValue(t,i){const o=this.data.fieldsInList.indexOf(t);return(i.values||[])[o]}showError(t){(null==t?void 0:t.errorMessage)&&this.notification.error(t.errorMessage)}navigate(t){const i=this.importsHelper.importedRowUrl(this.data.file.kind,t.importedEntityId);i&&this.router.navigateByUrl(i)}path(t){return["/imports","lines","view",t.id]}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-imported-lines"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12"],["labelPosition","side",3,"label"],[3,"routerLink"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["numbersOnly","","labelPosition","side","formControlName","lineNumber",3,"label"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"results","toLink","rendering$","update"],[3,"topLeft","topRight",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"value","text"],[3,"topLeft","topRight"],["class","cell-text",4,"ngFor","ngForOf"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"],["type","button","class","btn btn-icon",3,"click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"click"],[3,"icon"],[1,"p-3"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,tt,1,0,"ng-container",1),e.qZA(),e.YNc(3,dt,19,21,"ng-template",null,2,e.W1O),e.YNc(5,mt,1,0,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[g.w,b.O5,_.Y,p.JL,p.sg,A.t,u.yS,R.q,p.JJ,p.u,et.X,W.x,b.sg,B.s,ee.D,te.E,ne.t,ie.p,oe.o,se.O],pipes:[b.Ov],encapsulation:2,changeDetection:0}),n})();var le=a(7300),_t=a(7107),ft=a(2180);function gt(n,r){if(1&n&&(e.TgZ(0,"alert",11),e._UZ(1,"div",12),e.ALo(2,"trust"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,1,t.i18n.imports.information.ready),e.oJD)}}function bt(n,r){if(1&n&&e._UZ(0,"user-info",13),2&n){const t=e.oxw(2);e.Q6J("user",t.file.user)}}function xt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.kind.label)("value",t.kind)}}const It=function(n){return{width:n}};function vt(n,r){if(1&n&&(e.TgZ(0,"label-value",7)(1,"div",15)(2,"div",16),e._uU(3),e.qZA()()()),2&n){const t=r.ngIf,i=e.oxw(2);e.Q6J("label",i.i18n.general.progress),e.xp6(2),e.Q6J("ngStyle",e.VKq(4,It,t+"%")),e.uIk("aria-valuenow",t),e.xp6(1),e.hij(" ",t,"% ")}}function Tt(n,r){if(1&n&&e._UZ(0,"label-value",17),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.errorMessage)("value",t.file.errorMessage)}}function Ft(n,r){if(1&n&&e._UZ(0,"label-value",17),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.ignoredFields)("value",t.file.ignoredFields.join(", "))}}function yt(n,r){if(1&n&&(e.TgZ(0,"label-value",7),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.by),e.xp6(1),e.Q6J("user",t.file.by)}}function At(n,r){if(1&n&&(e.TgZ(0,"label-value",7),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.processingDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.file.processingDate)," ")}}function Ct(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.archivingDate)("value",t.archiveValue)}}function St(n,r){if(1&n&&e._UZ(0,"label-value",17),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.description)("value",t.file.description)}}function wt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.currency)("value",t.file.currency.name)}}function Zt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.sendNotifications)("value",t.format.formatBoolean(t.file.sendNotifications))}}function Ut(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.type)("value",t.file.recordType.name)}}function Nt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.useGroupFromFile)("value",t.format.formatBoolean(t.file.useGroupFromFile))}}function Et(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.file.useGroupFromFile?t.i18n.imports.defaultGroup:t.i18n.user.group)("value",t.file.group.name)}}function Rt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.sendActivationEmail)("value",t.format.formatBoolean(t.file.sendActivationEmail))}}function Lt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.transaction.type)("value",t.file.paymentType.name)}}function Ot(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.voucher)("value",t.file.voucherType.voucherTitle)}}function Jt(n,r){if(1&n&&e._UZ(0,"label-value",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.imports.useAmountFromFile)("value",t.format.formatBoolean(t.file.useAmountFromFile))}}function Pt(n,r){if(1&n&&(e._UZ(0,"label-value",14),e.ALo(1,"currency")),2&n){const t=e.oxw(2);e.Q6J("label",t.file.useAmountFromFile?t.i18n.imports.defaultAmount:t.i18n.transaction.amount)("value",e.xi3(1,2,t.file.amount,t.file.voucherType.configuration.currency))}}function Qt(n,r){if(1&n&&e._UZ(0,"label-value",17),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.voucher.send.message)("value",t.file.sendMessage)}}function Mt(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2),e.qZA(),e._UZ(3,"label-value",14)(4,"label-value",14)(5,"label-value",14),e.BQk()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.xp6(2),e.hij("",i.i18n.imports.section.validation," "),e.xp6(1),e.Q6J("label",i.i18n.imports.lineStatus.ready)("value",t.linesReady),e.xp6(1),e.Q6J("label",i.i18n.imports.lineStatus.skipped)("value",t.linesSkipped),e.xp6(1),e.Q6J("label",i.i18n.imports.lineStatus.validationError)("value",t.linesValidationError)}}function Dt(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2),e.qZA(),e._UZ(3,"label-value",14)(4,"label-value",14),e.BQk()),2&n){const t=e.oxw().ngIf,i=e.oxw(2);e.xp6(2),e.Oqu(i.i18n.imports.section.import),e.xp6(1),e.Q6J("label",i.i18n.imports.lineStatus.imported)("value",t.linesImported),e.xp6(1),e.Q6J("label",i.i18n.imports.lineStatus.importError)("value",t.linesImportError)}}function Yt(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Mt,6,7,"ng-container",10),e.YNc(2,Dt,5,5,"ng-container",10),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.showValidation),e.xp6(1),e.Q6J("ngIf",t.showImport)}}function $t(n,r){if(1&n&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"div",3),e.YNc(3,gt,3,3,"alert",4),e.YNc(4,bt,1,1,"user-info",5),e.YNc(5,xt,1,2,"label-value",6),e.TgZ(6,"label-value",7),e._uU(7),e.qZA(),e.YNc(8,vt,4,6,"label-value",8),e.ALo(9,"async"),e.YNc(10,Tt,1,2,"label-value",9),e.YNc(11,Ft,1,2,"label-value",9),e.YNc(12,yt,2,2,"label-value",8),e.TgZ(13,"label-value",7),e._uU(14),e.ALo(15,"date"),e.qZA(),e.YNc(16,At,3,4,"label-value",8),e.YNc(17,Ct,1,2,"label-value",6),e.YNc(18,St,1,2,"label-value",9),e.YNc(19,wt,1,2,"label-value",6),e.YNc(20,Zt,1,2,"label-value",6),e.YNc(21,Ut,1,2,"label-value",6),e.YNc(22,Nt,1,2,"label-value",6),e.YNc(23,Et,1,2,"label-value",6),e.YNc(24,Rt,1,2,"label-value",6),e.YNc(25,Lt,1,2,"label-value",6),e.YNc(26,Ot,1,2,"label-value",6),e.YNc(27,Jt,1,2,"label-value",6),e.YNc(28,Pt,2,5,"label-value",6),e.YNc(29,Qt,1,2,"label-value",9),e.YNc(30,Yt,3,2,"ng-container",10),e.ALo(31,"async"),e.qZA()()),2&n){const t=e.oxw();e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("headingActions",e.lcZ(1,29,t.headingActions$)),e.xp6(3),e.Q6J("ngIf",t.file.status===t.ImportedFileStatusEnum.READY),e.xp6(1),e.Q6J("ngIf",t.file.user&&!t.isSelf),e.xp6(1),e.Q6J("ngIf",t.kind),e.xp6(1),e.Q6J("label",t.i18n.general.status),e.xp6(1),e.hij(" ",t.importsHelper.fileStatusLabel(t.file.status)," "),e.xp6(1),e.Q6J("ngIf",t.showProgressBar&&e.lcZ(9,31,t.progressValue$)),e.xp6(2),e.Q6J("ngIf",t.file.errorMessage),e.xp6(1),e.Q6J("ngIf",(null==t.file.ignoredFields?null:t.file.ignoredFields.length)>0),e.xp6(1),e.Q6J("ngIf",t.file.by),e.xp6(1),e.Q6J("label",t.i18n.imports.creationDate),e.xp6(1),e.hij(" ",e.lcZ(15,33,t.file.creationDate)," "),e.xp6(2),e.Q6J("ngIf",t.file.processingDate),e.xp6(1),e.Q6J("ngIf",t.archiveValue),e.xp6(1),e.Q6J("ngIf",t.file.description),e.xp6(1),e.Q6J("ngIf",t.file.currency),e.xp6(1),e.Q6J("ngIf",null!=t.file.sendNotifications),e.xp6(1),e.Q6J("ngIf",t.file.recordType),e.xp6(1),e.Q6J("ngIf",null!=t.file.useGroupFromFile),e.xp6(1),e.Q6J("ngIf",t.file.group),e.xp6(1),e.Q6J("ngIf",null!=t.file.sendActivationEmail),e.xp6(1),e.Q6J("ngIf",t.file.paymentType),e.xp6(1),e.Q6J("ngIf",t.file.voucherType),e.xp6(1),e.Q6J("ngIf",null!=t.file.useAmountFromFile),e.xp6(1),e.Q6J("ngIf",t.file.amount),e.xp6(1),e.Q6J("ngIf",t.file.sendMessage),e.xp6(1),e.Q6J("ngIf",e.lcZ(31,35,t.progress$))}}const kt=[U.K.READING_CSV,U.K.READING_ZIP,U.K.IMPORTING],Vt=[U.K.READY,U.K.READING_CSV],ae=[U.K.IMPORTING,U.K.IMPORTED];let Gt=(()=>{class n extends le.k{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o,this.ImportedFileStatusEnum=U.K,this.progress$=new Y.X(null)}get file(){return this.data}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.importsService.viewImportedFile({id:this.id}).subscribe(t=>this.data=t))}onDataInitialized(t){switch(super.onDataInitialized(t),this.isSelf=t.user&&this.authHelper.isSelfOrOwner(t.user),t.kind){case w._.PAYMENTS:this.title=this.i18n.imports.title.payments,this.mobileTitle=this.i18n.imports.mobileTitle.payments;break;case w._.USER_PAYMENTS:this.title=this.i18n.imports.title.userPayments,this.mobileTitle=this.i18n.imports.mobileTitle.userPayments;break;default:this.title=this.i18n.imports.title.generalDetails,this.mobileTitle=this.i18n.imports.mobileTitle.generalDetails,this.kind=this.importsHelper.kindLabel(t.kind)}if(t.archiveDate)switch(t.status){case U.K.ARCHIVED:this.archiveValue=this.format.formatAsDate(t.archiveDate);break;case U.K.READING_CSV:case U.K.READING_ZIP:break;default:this.archiveValue=this.i18n.imports.archivingDateValue(this.format.formatAsDate(t.archiveDate))}const i=t.progress||{};this.showValidation=Vt.includes(t.status)||ae.includes(t.status)||!!i.linesReady||!!i.linesValidationError||!!i.linesSkipped,this.showImport=ae.includes(t.status)||!!i.linesImported||!!i.linesImportError;const o=[];o.push(new L.Yu(O.l.List,this.i18n.imports.lines,()=>this.searchLines(),!0)),t.canProcess&&o.push(new L.Yu(O.l.CheckCircle,this.i18n.imports.process.label,()=>this.process(),!0)),t.canAbort&&o.push(new L.Yu(O.l.XCircle,this.i18n.imports.abort.label,()=>this.abort())),t.canEdit&&o.push(new L.Yu(O.l.Pencil,this.i18n.general.edit,()=>this.edit())),t.canRemove&&o.push(new L.Yu(O.l.Trash,this.i18n.general.remove,()=>this.remove())),this.headingActions=o,this.showProgressBar=kt.includes(t.status),this.showProgressBar&&(this.progressTimer=setInterval(()=>this.updateProgress(),1e3),this.progressValue$=this.progress$.asObservable().pipe((0,d.U)(s=>Math.round(100*s.progress)))),this.progress$.next(t.progress)}searchLines(){this.router.navigate(["/imports","lines","search",this.id])}process(){var t;this.confirmation.confirm({title:this.i18n.imports.process.label,message:this.i18n.imports.process.confirmation(null===(t=this.file.progress)||void 0===t?void 0:t.linesReady),callback:()=>{this.addSub(this.importsService.processImportedFile({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.imports.process.done),this.reload()}))}})}abort(){this.confirmation.confirm({title:this.i18n.imports.abort.label,message:this.i18n.imports.abort.confirmation,callback:()=>{this.addSub(this.importsService.abortImportedFile({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.imports.abort.done),this.reload()}))}})}edit(){this.router.navigate(["/imports","files","edit",this.id])}remove(){this.confirmation.confirm({message:this.i18n.general.removeConfirm(this.file.fileName),callback:()=>{this.addSub(this.importsService.deleteImportedFile({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.file.fileName)),history.back()}))}})}updateProgress(){this.addSub(this.importsService.viewImportedFile({id:this.id,fields:["status","progress"]}).subscribe(t=>{t.status!==this.file.status?(clearInterval(this.progressTimer),this.reload()):this.progress$.next(t.progress)}))}resolveMenu(){return this.importsHelper.resolveMenu(this.file)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-imported-file"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],["type","info",4,"ngIf"],[3,"user",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],["type","info"],[3,"innerHTML"],[3,"user"],[3,"label","value"],[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",3,"ngStyle"],["valueFormat","break",3,"label","value"],[1,"border-0","mb-2"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,$t,32,37,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[g.w,b.O5,_.Y,K.wx,H.M,A.t,b.PC,_t.F],pipes:[b.Ov,j.a,re.u,ft.H],encapsulation:2,changeDetection:0}),n})();var qt=a(3961);function Ht(n,r){if(1&n&&e._UZ(0,"label-value",9),2&n){const t=r.$implicit,i=e.oxw(2);e.Q6J("label",t.name)("value",i.lineValue(t))}}const Bt=function(n){return["/imports","files","view",n]};function Kt(n,r){if(1&n&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"div",3)(3,"label-value",4)(4,"a",5),e._uU(5),e.qZA()(),e._UZ(6,"label-value",6),e.TgZ(7,"label-value",4)(8,"maybe-link",7),e._uU(9),e.qZA()(),e.YNc(10,Ht,1,2,"label-value",8),e.qZA()()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.imports.title.lineDetails)("mobileHeading",t.i18n.imports.mobileTitle.lineDetails)("headingActions",e.lcZ(1,12,t.headingActions$)),e.xp6(3),e.Q6J("label",t.i18n.imports.file),e.xp6(1),e.Q6J("routerLink",e.VKq(14,Bt,t.line.file.id)),e.xp6(1),e.Oqu(t.line.file.fileName),e.xp6(1),e.Q6J("label",t.i18n.imports.lineNumber)("value",t.line.lineNumber),e.xp6(1),e.Q6J("label",t.i18n.general.status),e.xp6(1),e.Q6J("link",t.importedUrl),e.xp6(1),e.hij(" ",t.importsHelper.lineStatusLabel(t.line.status)," "),e.xp6(1),e.Q6J("ngForOf",t.line.fields)}}let jt=(()=>{class n extends le.k{constructor(t,i,o){super(t),this.importsService=i,this.importsHelper=o}get line(){return this.data}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.importsService.viewImportedLine({id:this.id}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),this.importedUrl=this.importsHelper.importedRowUrl(t.file.kind,t.importedEntityId);const i=[];t.canEdit&&i.push(new L.Yu(O.l.Pencil,this.i18n.general.edit,()=>this.edit(),!0)),t.canInclude&&i.push(new L.Yu(O.l.PlusCircle,this.i18n.imports.include.label,()=>this.include(),!0)),t.canSkip&&i.push(new L.Yu(O.l.DashCircle,this.i18n.imports.skip.label,()=>this.skip(),!0)),this.headingActions=i}lineValue(t){const i=this.line.fields.indexOf(t);return this.line.values[i]}edit(){this.router.navigate(["/imports","lines","edit",this.id])}skip(){this.addSub(this.importsService.skipImportedLines({id:this.line.file.id,lines:[this.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.imports.skip.done),this.reload()}))}include(){this.addSub(this.importsService.includeImportedLines({id:this.line.file.id,lines:[this.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.imports.include.done),this.reload()}))}resolveMenu(){var t;return this.importsHelper.resolveMenu(null===(t=this.line)||void 0===t?void 0:t.file)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(y),e.Y36(S.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-imported-line"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label"],[3,"routerLink"],[3,"label","value"],[3,"link"],["valueFormat","break",3,"label","value",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Kt,11,16,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[g.w,b.O5,_.Y,A.t,u.yS,qt.O,b.sg],pipes:[b.Ov],encapsulation:2,changeDetection:0}),n})();var P=a(5747);const zt=[{path:"",children:[{path:":owner/:context/files",component:Xe,canActivate:[P.b]},{path:":owner/:kind/new",component:Re,canActivate:[P.b]},{path:"files/view/:id",component:Gt,canActivate:[P.b]},{path:"files/edit/:id",component:v,canActivate:[P.b]},{path:"lines/search/:id",component:ht,canActivate:[P.b]},{path:"lines/view/:id",component:jt,canActivate:[P.b]},{path:"lines/edit/:id",component:$,canActivate:[P.b]}]}];let Xt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[u.Bz.forChild(zt)],u.Bz]}),n})();var Wt=a(4443);let en=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Xt,Wt.C]]}),n})()},2292:(Q,Z,a)=>{a.d(Z,{t:()=>b});var u=a(3075),l=(()=>{return(_=l||(l={})).LIST="list",_.LIST_THUMB="list_thumb",_.MAP="map",_.TILED="tiled",l;var _})(),N=a(543),e=a(5466),f=a(7e3),E=a(2614),I=a(6897),m=a(8473),d=a(3531),T=a(591),y=a(13),S=a(1879),g=a(6435);let b=(()=>{class _ extends E.y{constructor(c){super(c),this.ResultType=m.X,this.resultType$=new T.X(null),this.resultTypeControl=new u.NI(null),this.results$=new T.X(null),this.allowedResultTypes$=new T.X([m.X.LIST]),this.rendering$=new T.X(!1),this.moreFilters$=new T.X(!1),this.ignoreNextUpdate=!1,this.nextRequestState=c.get(N.AM);const h={page:0};h.resultType=this.getInitialResultType();for(const F of this.getFormControlNames()||[])h[F]=null;this.form=this.formBuilder.group(h)}getInitialFormValue(c){return c.query||{}}prepareForm(c){}onDataInitialized(c){this.prepareForm(c),this.form.patchValue(this.getInitialFormValue(c)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(h=>{const F=this.previousResultType;this.previousResultType=h,this.resultType$.next(h),this.shouldUpdateOnResultTypeChange(h,F)&&this.update(),(null==F||F!==h)&&(this.rendering=!0,this.stateManager.set("resultType",h),this.onResultTypeChanged(h,F))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe((0,y.b)(f.S.DEBOUNCE_TIME)).subscribe(h=>{this.shouldUpdateOnChange(h)&&this.update(),this.previousValue=h}),!0),this.previousResultType!==m.X.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(c,h){return c!==m.X.CATEGORIES&&([m.X.LIST,m.X.TILES].includes(h)!==[m.X.LIST,m.X.TILES].includes(c)||h===m.X.MAP!=(c===m.X.MAP))}shouldUpdateOnChange(c){return!(0,d.Z)(this.previousValue,c)}get results(){return this.results$.value}set results(c){this.onBeforeRender(c),this.results$.next(c)}onBeforeRender(c){}get rendering(){return this.rendering$.value}set rendering(c){this.rendering$.next(c)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(c){this.allowedResultTypes$.next(c)}get moreFilters(){return this.moreFilters$.value}set moreFilters(c){this.moreFilters$.next(c)}get pageData(){const c=this.form.value;return{page:c.page,pageSize:c.pageSize}}set pageData(c){this.form.patchValue(c)}get resultType(){return this.resultTypeControl.value}set resultType(c){null==c&&(c=this.getInitialResultType()),this.resultTypeControl.setValue(c)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new e.Yu(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}getResultType(c){let h=null;switch(c){case l.LIST:case l.LIST_THUMB:h=m.X.LIST;break;case l.MAP:h=m.X.MAP;break;case l.TILED:h=m.X.TILES}return this.allowedResultTypes.includes(h)||(h=this.allowedResultTypes[0]),h}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return S.l.Funnel}showLessFiltersIcon(){return S.l.Funnel}onResultTypeChanged(c,h){}getInitialResultType(){return m.X.LIST}update(c){if(this.ignoreNextUpdate||this.resultType===m.X.CATEGORIES)return;c&&(this.form.patchValue(c,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const h=this.form.value;h.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(h)).subscribe(F=>{this.resultType===m.X.CATEGORIES&&(this.resultType=this.getDefaultResultType()),this.results=I.x.from(F)}))}resetPage(c=!1){this.form.patchValue({page:0},{emitEvent:c})}getDefaultResultType(){return this.allowedResultTypes.find(c=>c!==m.X.CATEGORIES)}doIgnoringUpdate(c){this.ignoreNextUpdate=!0;try{c()}finally{this.ignoreNextUpdate=!1}}}return _.\u0275fac=function(c){return new(c||_)(g.Y36(g.zs3))},_.\u0275dir=g.lG2({type:_,features:[g.qOj]}),_})()},6168:(Q,Z,a)=>{a.d(Z,{P:()=>c});var u=a(6435),l=a(3075),N=a(2039),e=a(6163),f=a(8473),E=a(2089),I=a(1879),m=a(8664),d=a(8064),T=a(9808),y=a(5896),S=a(8397),g=a(70);const b=function(h){return["focusable",h]};function _(h,F){if(1&h){const x=u.EpF();u.TgZ(0,"label",3,4),u.NdJ("focus",function(){const R=u.CHM(x).$implicit,J=u.MAs(2);return u.oxw(2).onFocus(J,R)})("blur",function(){const R=u.CHM(x).$implicit,J=u.MAs(2);return u.oxw(2).onBlur(J,R)})("click",function(){return u.CHM(x),u.MAs(2).hide()}),u._UZ(3,"icon",5),u.qZA()}if(2&h){const x=F.$implicit,v=u.oxw(2);u.Q6J("ngClass",u.VKq(4,b,"resultType-"+x))("tooltip",v.tooltip(x))("btnRadio",x),u.xp6(3),u.Q6J("icon",v.icon(x))}}function p(h,F){if(1&h&&(u.TgZ(0,"div",1),u.YNc(1,_,4,6,"label",2),u.qZA()),2&h){const x=u.oxw();u.Q6J("formControl",x.formControl),u.xp6(1),u.Q6J("ngForOf",x.allowedResultTypes)}}let c=(()=>{class h extends N.C{constructor(x,v,A,R){super(x,v),this.layout=A,this.maps=R,this.change=new u.vpe,this.blur=new u.vpe,this.resultTypeSubs=new Map}ngOnInit(){super.ngOnInit();const x=this.allowedResultTypes.indexOf(f.X.MAP);!this.maps.enabled&&-1!==x&&this.allowedResultTypes.splice(x,1)}icon(x){switch(x){case f.X.CATEGORIES:return I.l.LayoutThreeColumns;case f.X.TILES:return I.l.Grid;case f.X.LIST:return I.l.GridList;case f.X.MAP:return I.l.GeoAlt}}tooltip(x){switch(x){case f.X.CATEGORIES:return this.i18n.general.categoriesView;case f.X.TILES:return this.i18n.general.tiledView;case f.X.LIST:return this.i18n.general.listView;case f.X.MAP:return this.i18n.general.map}}onFocus(x,v){x.show();const A=this.element,R=A.getElementsByClassName(`resultType-${v}`).item(0);if(document.activeElement!==R)return;const J=this.shortcut.subscribe(E.LU,M=>{let D=this.allowedResultTypes.indexOf(v)+(M.key===E.Xd?-1:1);D=Math.min(Math.max(0,D),this.allowedResultTypes.length-1);const $=A.getElementsByClassName(`resultType-${this.allowedResultTypes[D]}`);$.length>0&&(0,e.T_)($.item(0),!0)});this.resultTypeSubs.set(v,J)}onBlur(x,v){x.hide();const A=this.resultTypeSubs.get(v);A&&(A.unsubscribe(),this.resultTypeSubs.delete(v))}}return h.\u0275fac=function(x){return new(x||h)(u.Y36(u.zs3),u.Y36(l.gN,13),u.Y36(m.Pb),u.Y36(d.Q))},h.\u0275cmp=u.Xpm({type:h,selectors:[["result-type-field"]],inputs:{name:"name",required:"required",placeholder:"placeholder",focused:"focused",privacyControl:"privacyControl",allowedResultTypes:"allowedResultTypes"},outputs:{change:"change",blur:"blur"},features:[u._Bn([{provide:l.JU,useExisting:h,multi:!0}]),u.qOj],decls:1,vars:1,consts:[["class","btn-group","btnRadioGroup","",3,"formControl",4,"ngIf"],["btnRadioGroup","",1,"btn-group",3,"formControl"],["class","btn btn-icon","triggers","","tabindex","0","role","button",3,"ngClass","tooltip","btnRadio","focus","blur","click",4,"ngFor","ngForOf"],["triggers","","tabindex","0","role","button",1,"btn","btn-icon",3,"ngClass","tooltip","btnRadio","focus","blur","click"],["button","","pop","bs-tooltip"],["size","1.2rem",3,"icon"]],template:function(x,v){1&x&&u.YNc(0,p,2,2,"div",0),2&x&&u.Q6J("ngIf",(null==v.allowedResultTypes?null:v.allowedResultTypes.length)>0)},directives:[T.O5,y.pj,l.JJ,l.oH,T.sg,T.mk,S.i9,y.lz,g.o],encapsulation:2,changeDetection:0}),h})()},2939:(Q,Z,a)=>{a.d(Z,{p:()=>I});var u=a(6163),l=a(6435),N=a(867),e=a(9808);const f=[[["","header",""]],"*"],E=["[header]","*"];let I=(()=>{class m{constructor(){this._zoom=!1}get zoom(){return this._zoom}set zoom(T){this._zoom=(0,u.Iw)(T)}}return m.\u0275fac=function(T){return new(T||m)},m.\u0275cmp=l.Xpm({type:m,selectors:[["tiled-result"]],inputs:{image:"image",icon:"icon",zoom:"zoom"},ngContentSelectors:E,decls:5,vars:4,consts:[[1,"card"],["ngClass","card-img-top","size","full","imageSize","200","iconSize","8rem",3,"roundBorders","image","zoom","icon"],[1,"card-body"]],template:function(T,y){1&T&&(l.F$t(f),l.TgZ(0,"div",0),l.Hsn(1),l._UZ(2,"avatar",1),l.TgZ(3,"div",2),l.Hsn(4,1),l.qZA()()),2&T&&(l.xp6(2),l.Q6J("roundBorders",!1)("image",y.image)("zoom",y.zoom)("icon",y.icon))},directives:[N.A,e.mk],encapsulation:2,changeDetection:0}),m})()},9653:(Q,Z,a)=>{a.d(Z,{M:()=>S});var u=a(7947),l=a(6435),N=a(8134),e=a(9808),f=a(195),E=a(7107);function I(g,b){if(1&g&&(l.TgZ(0,"label-value",4),l._UZ(1,"user-link",5),l.qZA()),2&g){const _=l.oxw(2);l.Q6J("label",_.i18n.user.operatorOwner)("kind",_.kind),l.xp6(1),l.Q6J("user",_.user.user)}}function m(g,b){if(1&g&&(l.ynx(0),l.YNc(1,I,2,3,"label-value",3),l.TgZ(2,"label-value",4),l._UZ(3,"user-link",5),l.qZA(),l.BQk()),2&g){const _=l.oxw();l.xp6(1),l.Q6J("ngIf",_.authHelper.isSelf(_.user.user)),l.xp6(1),l.Q6J("label",_.i18n.general.operator)("kind",_.kind),l.xp6(1),l.Q6J("user",_.user)}}function d(g,b){if(1&g&&(l.TgZ(0,"label-value",4),l._UZ(1,"user-link",5),l.qZA()),2&g){const _=l.oxw(2);l.Q6J("label",_.i18n.general.user)("kind",_.kind),l.xp6(1),l.Q6J("user",_.user)}}function T(g,b){if(1&g&&(l.YNc(0,d,2,3,"label-value",6),l.ALo(1,"async")),2&g){const _=l.oxw(),p=l.MAs(4);l.Q6J("ngIf",l.lcZ(1,2,_.layout.gtxs$))("ngIfElse",p)}}function y(g,b){if(1&g&&l._UZ(0,"user-link",7),2&g){const _=l.oxw();l.Q6J("user",_.user)}}let S=(()=>{class g extends u.H{constructor(_,p){super(_),this.authHelper=p,this.kind="view"}get operator(){return!!this.user.user}}return g.\u0275fac=function(_){return new(_||g)(l.Y36(l.zs3),l.Y36(N.N))},g.\u0275cmp=l.Xpm({type:g,selectors:[["user-info"]],inputs:{user:"user",kind:"kind"},features:[l.qOj],decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["regularUser",""],["mobile",""],[3,"label","kind",4,"ngIf"],[3,"label","kind"],[3,"user"],[3,"label","kind",4,"ngIf","ngIfElse"],[1,"my-3",3,"user"]],template:function(_,p){if(1&_&&(l.YNc(0,m,4,4,"ng-container",0),l.YNc(1,T,2,4,"ng-template",null,1,l.W1O),l.YNc(3,y,1,1,"ng-template",null,2,l.W1O)),2&_){const c=l.MAs(2);l.Q6J("ngIf",p.operator)("ngIfElse",c)}},directives:[e.O5,f.t,E.F],pipes:[e.Ov],encapsulation:2,changeDetection:0}),g})()}}]);