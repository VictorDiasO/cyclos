(self.webpackChunkui=self.webpackChunkui||[]).push([["src_app_ui_users_users_module_ts"],{8155:(B,w,s)=>{"use strict";s.r(w),s.d(w,{UsersModule:()=>Ff});var A=s(4443),x=s(5300),g=s(722),l=s(5747),f=s(7e3),y=s(2614),m=s(6163),v=s(6243),S=s(6526),e=s(6435),h=s(520),U=s(1352),b=s(8637),T=s(2198),c=s(4850),G=s(297);let R=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getPrivacySettingsData$Response(t,i){const o=new b.c(this.rootUrl,n.GetPrivacySettingsDataPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPrivacySettingsData(t,i){return this.getPrivacySettingsData$Response(t,i).pipe((0,c.U)(o=>o.body))}savePrivacySettings$Response(t,i){const o=new b.c(this.rootUrl,n.SavePrivacySettingsPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}savePrivacySettings(t,i){return this.savePrivacySettings$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetPrivacySettingsDataPath="/{user}/privacy-settings",n.SavePrivacySettingsPath="/{user}/privacy-settings",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Z=s(1963),E=s(2032),d=s(9808),_=s(3075),H=s(9653),O=s(1321),k=s(6903),N=s(1556);function P(n,a){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t)}}function M(n,a){if(1&n&&e._UZ(0,"user-info",9),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function D(n,a){if(1&n&&e._UZ(0,"boolean-field",11),2&n){const t=a.$implicit;e.Q6J("formControlName",t.id)("label",t.name)("text",t.informationText)}}function J(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,D,1,3,"boolean-field",10),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.privacySettings.controlsSection),e.xp6(1),e.Q6J("ngForOf",t.data.availableControls)}}function L(n,a){if(1&n){const t=e.EpF();e.ynx(0,2),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"ul"),e.YNc(6,P,2,1,"li",3),e.qZA(),e.YNc(7,M,1,1,"user-info",4),e._UZ(8,"boolean-field",5,6),e.YNc(10,J,4,2,"ng-container",7),e.TgZ(11,"actions")(12,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(13,"async"),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(9),i=e.oxw();e.Q6J("formGroup",i.form),e.xp6(2),e.Oqu(i.i18n.privacySettings.information),e.xp6(2),e.Oqu(i.i18n.privacySettings.dataSubjectToControls),e.xp6(2),e.Q6J("ngForOf",i.fields()),e.xp6(1),e.Q6J("ngIf",i.data.user&&!i.authHelper.isSelf(i.data.user)),e.xp6(1),e.Q6J("formControlName","enabled")("label",i.i18n.general.enabled),e.xp6(2),e.Q6J("ngIf",t.value),e.xp6(2),e.Q6J("label",i.i18n.general.save)("disabled",e.lcZ(13,10,i.requesting$))}}let q=(()=>{class n extends y.y{constructor(t,i){super(t),this.privacySettingsService=i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user?this.user:f.S.SELF}).subscribe(t=>this.data=t))}fields(){return this.data.controlledFields.map(t=>this.fieldHelper.fieldDisplay(t,this.data.customFields))}onDataInitialized(t){this.form=this.formBuilder.group({enabled:t.enabled}),t.availableControls.forEach(i=>this.form.addControl(i.id,this.formBuilder.control({value:t.selectedControls.includes(i.id)||i.fieldsAlwaysVisible,disabled:i.fieldsAlwaysVisible})))}save(){if(!(0,m.pt)(this.form))return;const t=(0,S.Z)(this.form.value),i=t.enabled;delete t.enabled;const o={enabled:i,selectedControls:[]};this.data.availableControls.forEach(r=>{t[r.id]&&o.selectedControls.push(r.id)}),this.addSub(this.privacySettingsService.savePrivacySettings({user:this.user?this.user:f.S.SELF,body:o}).subscribe(()=>this.notification.snackBar(this.i18n.privacySettings.saved)))}resolveMenu(){var t;return this.menu.userMenu(null===(t=this.data)||void 0===t?void 0:t.user,v.v2.MY_PROFILE)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-privacy-settings"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"formControlName","label"],["enabled",""],[4,"ngIf"],[3,"label","disabled","action"],[3,"user"],[3,"formControlName","label","text",4,"ngFor","ngForOf"],[3,"formControlName","label","text"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout")(1,"page-content",0),e.ALo(2,"async"),e.YNc(3,L,14,12,"ng-container",1),e.ALo(4,"async"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("heading",i.i18n.privacySettings.title)("mobileHeading",i.i18n.privacySettings.mobileTitle)("headingActions",e.lcZ(2,4,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,6,i.data$)))},directives:[Z.w,E.Y,d.O5,_.JL,_.sg,d.sg,H.M,O.M,_.JJ,_.u,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Y=s(195);function Oe(n,a){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t)}}function _t(n,a){if(1&n&&e._UZ(0,"user-info",5),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function Ke(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"br"),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.informationText," ")}}function gt(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.YNc(2,Ke,3,1,"ng-container",1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("label",t.name),e.xp6(1),e.hij(" ",t.fieldsAlwaysVisible||i.data.selectedControls.includes(t.id)?i.i18n.general.yes:i.i18n.general.no," "),e.xp6(1),e.Q6J("ngIf",t.informationText)}}function Le(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,gt,3,3,"label-value",6),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.privacySettings.controlsSection),e.xp6(1),e.Q6J("ngForOf",t.data.availableControls)}}function Qe(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"ul"),e.YNc(6,Oe,2,1,"li",2),e.qZA(),e.YNc(7,_t,1,1,"user-info",3),e.TgZ(8,"label-value",4),e._uU(9),e.qZA(),e.YNc(10,Le,4,2,"ng-container",1),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.i18n.privacySettings.information),e.xp6(2),e.Oqu(t.i18n.privacySettings.dataSubjectToControls),e.xp6(2),e.Q6J("ngForOf",t.fields()),e.xp6(1),e.Q6J("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),e.xp6(1),e.Q6J("label",t.i18n.general.enabled),e.xp6(1),e.hij(" ",t.data.enabled?t.i18n.general.yes:t.i18n.general.no,""),e.xp6(1),e.Q6J("ngIf",t.data.enabled)}}let We=(()=>{class n extends y.y{constructor(t,i){super(t),this.privacySettingsService=i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user||f.S.SELF}).subscribe(t=>{t.canEdit&&this.router.navigate(["/users",this.user,"privacy-settings","edit"],{replaceUrl:!0}),this.data=t}))}fields(){return this.data.controlledFields.map(t=>this.fieldHelper.fieldDisplay(t,this.data.customFields))}resolveMenu(){var t;return this.menu.userMenu(null===(t=this.data)||void 0===t?void 0:t.user,v.v2.MY_PROFILE)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-privacy-settings"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"label"],[3,"user"],[3,"label",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout")(1,"page-content",0),e.ALo(2,"async"),e.YNc(3,Qe,11,7,"ng-container",1),e.ALo(4,"async"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("heading",i.i18n.privacySettings.title)("mobileHeading",i.i18n.privacySettings.mobileTitle)("headingActions",e.lcZ(2,4,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,6,i.data$)))},directives:[Z.w,E.Y,d.O5,d.sg,H.M,Y.t],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Ye=s(7350),ce=s(7300),Je=s(3868),le=s(6849),X=s(5905),V=s(8687),j=s(1441),K=s(629),te=s(1015),ie=s(8397),ne=s(70),Ce=s(3030),_e=s(2754),bn=s(947);function xn(n,a){1&n&&e.GkF(0)}function vn(n,a){if(1&n&&e._UZ(0,"user-info",8),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function yn(n,a){if(1&n&&(e.TgZ(0,"del"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.agreement.name," ")}}function Tn(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw().$implicit;e.hij(" ",t.agreement.name," ")}}function An(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div")(2,"div",9),e._uU(3),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"div",10),e.YNc(6,yn,2,1,"del",11),e.YNc(7,Tn,1,1,"ng-template",null,12,e.W1O),e.qZA()()()),2&n){const t=a.$implicit,i=e.MAs(8);e.xp6(3),e.hij(" ",e.lcZ(4,3,t.date)," "),e.xp6(3),e.Q6J("ngIf",!t.accepted)("ngIfElse",i)}}function Cn(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.agreements.accepted)}}function wn(n,a){if(1&n&&(e.TgZ(0,"th",18),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.general.remoteAddress,"")}}function En(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"boolean"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t.accepted))}}function Zn(n,a){if(1&n&&(e.TgZ(0,"td",18),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.remoteAddress,"")}}function In(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).showAgreement(o)}),e._UZ(1,"icon",22),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.view),e.xp6(1),e.Q6J("icon",t.SvgIcon.Search)}}const Sn=function(n){return{"cursor-pointer":n}};function Un(n,a){if(1&n&&(e.TgZ(0,"tr",19)(1,"td"),e._uU(2),e.ALo(3,"dateTime"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.YNc(6,En,3,3,"td",14),e.YNc(7,Zn,2,1,"td",15),e.TgZ(8,"td",16),e.YNc(9,In,2,2,"button",20),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.VKq(8,Sn,t.accepted)),e.xp6(2),e.Oqu(e.lcZ(3,6,t.date)),e.xp6(3),e.Oqu(t.agreement.name),e.xp6(1),e.Q6J("ngIf",i.hasAccepted),e.xp6(1),e.Q6J("ngIf",i.hasRemoteAddress),e.xp6(2),e.Q6J("ngIf",t.accepted)}}function Nn(n,a){if(1&n&&(e.TgZ(0,"table",13)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.YNc(6,Cn,2,1,"th",14),e.YNc(7,wn,2,1,"th",15),e._UZ(8,"th",16),e.qZA(),e.TgZ(9,"tbody"),e.YNc(10,Un,10,10,"tr",17),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.agreements.agreement),e.xp6(1),e.Q6J("ngIf",t.hasAccepted),e.xp6(1),e.Q6J("ngIf",t.hasRemoteAddress),e.xp6(3),e.Q6J("ngForOf",t.data.history)}}function kn(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.YNc(1,vn,1,1,"user-info",4),e.qZA(),e.TgZ(2,"results-layout",5),e.YNc(3,An,9,5,"mobile-result",6),e.YNc(4,Nn,11,5,"table",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.agreements.title.history)("mobileHeading",t.i18n.agreements.mobileTitle.history)("mode",t.self?"empty":"normal"),e.xp6(1),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("results",t.data.history)("onClick",t.showAgreement)}}let On=(()=>{class n extends ce.k{constructor(t,i,o,r){super(t),this.agreementsService=i,this.userHelper=o,this.modal=r}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["user","history"]}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user);const i=t.history||[];this.hasAccepted=i.findIndex(o=>!o.accepted)>=0,this.hasRemoteAddress=i.findIndex(o=>o.remoteAddress)>=0}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.AGREEMENTS)}get showAgreement(){return t=>{t.accepted&&this.modal.show(Ye.N,{ignoreBackdropClick:!0,class:"modal-form modal-form-large",initialState:{agreement:t.agreement,version:t.acceptedVersion}})}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Je.T),e.Y36(le.T),e.Y36(X.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-agreements-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","mode"],[3,"user",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"user"],[1,"cell-text","float-left"],[1,"cell-main","float-right"],[4,"ngIf","ngIfElse"],["accepted",""],[1,"table","table-hover"],[4,"ngIf"],["class","align-center",4,"ngIf"],[1,"actions"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"align-center"],[3,"ngClass"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,xn,1,0,"ng-container",1),e.qZA(),e.YNc(3,kn,5,6,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg,d.mk,ie.i9,ne.o],pipes:[d.Ov,Ce.u,_e.i,bn.i],encapsulation:2,changeDetection:0}),n})();var Q=s(5466),F=s(1879),Pn=s(4435),Qn=s(6574);function Jn(n,a){if(1&n&&e._UZ(0,"user-info",10),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function Dn(n,a){if(1&n&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.i18n.agreements.message)}}function Fn(n,a){if(1&n&&e._UZ(0,"accept-agreements",12),2&n){const t=e.oxw(2);e.Q6J("label",1==(null==t.allOptional?null:t.allOptional.length)?t.i18n.agreements.optionalSingular:t.i18n.agreements.optional)("formControl",t.optionalControl)("agreements",t.allOptional)}}function Rn(n,a){1&n&&e.GkF(0)}const Nt=function(n){return{$implicit:n}};function qn(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,Rn,1,0,"ng-container",14),e.qZA()),2&n){const t=e.oxw(3),i=e.MAs(4);e.Q6J("label",1==(null==t.acceptedOptional?null:t.acceptedOptional.length)?t.i18n.agreements.optionalSingular:t.i18n.agreements.optional),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(3,Nt,t.acceptedOptional))}}function Mn(n,a){if(1&n&&e.YNc(0,qn,2,5,"label-value",8),2&n){const t=e.oxw(2);e.Q6J("ngIf",(null==t.acceptedOptional?null:t.acceptedOptional.length)>0)}}function Ln(n,a){1&n&&e.GkF(0)}function Yn(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,Ln,1,0,"ng-container",14),e.qZA()),2&n){const t=e.oxw(2),i=e.MAs(4);e.Q6J("label",1==(null==t.acceptedRequired?null:t.acceptedRequired.length)?t.hasOptional?t.i18n.agreements.requiredSingular:t.i18n.agreements.agreement:t.hasOptional?t.i18n.agreements.required:t.i18n.agreements.agreements),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(3,Nt,t.acceptedRequired))}}function Bn(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"hr"),e._uU(2),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.i18n.agreements.noAccepted," ")}}function Gn(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"actions")(1,"action-button",15),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).save()}),e.ALo(2,"async"),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",e.lcZ(2,2,t.requesting$))("label",t.i18n.general.save)}}function $n(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,Jn,1,1,"user-info",4),e.YNc(3,Dn,2,1,"div",5),e.YNc(4,Fn,1,3,"accept-agreements",6),e.YNc(5,Mn,1,1,"ng-template",null,7,e.W1O),e.YNc(7,Yn,2,5,"label-value",8),e.YNc(8,Bn,3,1,"ng-container",9),e.YNc(9,Gn,3,4,"actions",9),e.qZA()),2&n){const t=e.MAs(6),i=e.oxw();e.Q6J("heading",i.i18n.agreements.title.accepted)("mobileHeading",i.i18n.agreements.mobileTitle.accepted)("headingActions",e.lcZ(1,10,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",!i.self),e.xp6(1),e.Q6J("ngIf",i.self),e.xp6(1),e.Q6J("ngIf",i.optionalControl)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",(null==i.acceptedRequired?null:i.acceptedRequired.length)>0),e.xp6(1),e.Q6J("ngIf",i.noAgreements),e.xp6(1),e.Q6J("ngIf",i.optionalControl)}}const Hn=function(n){return{"mt-2":n}};function Vn(n,a){if(1&n&&(e.TgZ(0,"div",17),e._UZ(1,"agreement-link",18),e.qZA()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(2);e.Q6J("ngClass",e.VKq(3,Hn,!i)),e.xp6(1),e.Q6J("agreement",t)("version",null==o.data.accepted[t.id]?null:o.data.accepted[t.id].acceptedVersion)}}function jn(n,a){1&n&&e.YNc(0,Vn,2,5,"div",16),2&n&&e.Q6J("ngForOf",a.$implicit)}let zn=(()=>{class n extends ce.k{constructor(t,i){super(t),this.agreementsService=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["-history"]}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user);const i=Object.keys(t.accepted||{}),o=(t.agreements||[]).filter(r=>i.includes(r.id));this.allOptional=(t.agreements||[]).filter(r=>!r.required),this.hasOptional=this.allOptional.length>0,this.acceptedOptional=o.filter(r=>!r.required),this.acceptedRequired=o.filter(r=>r.required),t.canEdit?this.hasOptional&&(this.optionalControl=this.formBuilder.control(this.acceptedOptional.map(r=>r.id))):this.noAgreements=0===o.length,this.noAgreements||(this.headingActions=[new Q.Yu(F.l.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"agreements","history"]),!0)])}save(){!(0,m.pt)(this.optionalControl)||this.addSub(this.agreementsService.acceptOptionalAgreements({agreements:this.optionalControl.value}).subscribe(()=>{this.notification.snackBar(this.i18n.agreements.optionalSaved),this.reload()}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.AGREEMENTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Je.T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-user-agreements"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],["agreementLinks",""],[3,"heading","mobileHeading","headingActions"],[3,"user",4,"ngIf"],["class","mb-3",4,"ngIf"],[3,"label","formControl","agreements",4,"ngIf","ngIfElse"],["optionalNotEditable",""],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[1,"mb-3"],[3,"label","formControl","agreements"],[3,"label"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"disabled","label","action"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["ignoreRequired","",3,"agreement","version"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,$n,10,12,"page-content",1),e.qZA(),e.YNc(3,jn,1,1,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,Pn.l,_.JJ,_.oH,Y.t,d.tP,k.h,N.x,d.sg,d.mk,Qn.o],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var xe=s(2292);let Xn=(()=>{class n extends U.b{constructor(t,i){super(t,i)}searchUserAlerts$Response(t,i){const o=new b.c(this.rootUrl,n.SearchUserAlertsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("brokers",t.brokers,{}),o.query("datePeriod",t.datePeriod,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("types",t.types,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchUserAlerts(t,i){return this.searchUserAlerts$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserAlertDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserAlertDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserAlertDataForSearch(t,i){return this.getUserAlertDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.SearchUserAlertsPath="/alerts/user",n.GetUserAlertDataForSearchPath="/alerts/user/data-for-search",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var et=s(8170),ue=s(7816),W=s(8868),ve=s(8747),Ae=s(867);function Kn(n,a){if(1&n&&(e.TgZ(0,"mobile-result",25)(1,"div",26),e._uU(2),e.qZA(),e.TgZ(3,"div",27),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.TgZ(6,"div",28),e._uU(7),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("avatarImage",null==t.user?null:t.user.image)("avatarIcon",i.SvgIcon.Person),e.xp6(1),e.Q6J("tooltip",t.user.display),e.xp6(1),e.hij(" ",t.user.display,""),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.date)," "),e.xp6(3),e.Oqu(t.text)}}const Wn=function(n,a){return{"pb-0":n,"border-0":a}};function ei(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",32),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(2);return p.router.navigate(p.path(r))}),e.TgZ(2,"td",33),e.ALo(3,"async"),e.ALo(4,"async"),e._UZ(5,"avatar",34),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"dateTime"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.Q6J("ngClass",e.WLB(12,Wn,e.lcZ(3,6,i.layout.xxs$),e.lcZ(4,8,i.layout.xxs$))),e.xp6(3),e.Q6J("image",null==t.user?null:t.user.image)("tooltip",null==t.user?null:t.user.display),e.xp6(2),e.Oqu(t.user.display),e.xp6(2),e.Oqu(t.text),e.xp6(2),e.Oqu(e.lcZ(12,10,t.date))}}function ti(n,a){if(1&n&&(e.TgZ(0,"table",29)(1,"thead"),e._UZ(2,"th",30),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,ei,13,15,"ng-container",31),e.ALo(11,"async"),e.qZA()()),2&n){const t=e.oxw();let i;e.xp6(4),e.Oqu(t.i18n.general.user),e.xp6(2),e.Oqu(t.i18n.userAlert.text),e.xp6(2),e.Oqu(t.i18n.general.date),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(11,4,t.results$))?null:i.results)}}let ni=(()=>{class n extends xe.t{constructor(t,i){super(t),this.alertsService=i}ngOnInit(){super.ngOnInit(),this.data={}}getFormControlNames(){return["types","user","beginDate","endDate"]}toSearchParams(t){return{datePeriod:f.S.dateRangeFilter(t.beginDate,t.endDate),page:t.page,pageSize:t.pageSize,types:t.types,user:t.user}}doSearch(t){return this.alertsService.searchUserAlerts$Response(t)}resolveMenu(){return v.v2.USER_ALERTS}path(t){return["/users",t.user.id,"profile"]}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Xn))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-user-alerts"]],features:[e.qOj],decls:30,vars:28,consts:[[3,"ready"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","beginDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","endDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["formControlName","types",3,"label","emptyOption"],["value","custom",3,"text"],["value","givenVeryBadRefs",3,"text"],["value","insufficientBalanceForInitialCredit",3,"text"],["value","maxDeviceActivationAttemptsReached",3,"text"],["value","maxDeviceConfirmationCheckAttemptsReached",3,"text"],["value","maxTokenActivationAttemptsReached",3,"text"],["value","maxUserLocalizationAttemptsReached",3,"text"],["value","maxVoucherRedeemAttemptsReached",3,"text"],["value","moveUserAutomaticallyFailed",3,"text"],["value","passwordDisabledByTries",3,"text"],["value","passwordTemporarilyBlocked",3,"text"],["value","receivedVeryBadRefs",3,"text"],["value","scheduledPaymentFailed",3,"text"],["formControlName","user",3,"label"],["resultType","list",3,"results","rendering$","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"avatarImage","avatarIcon"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1)(3,"div",2)(4,"div",3)(5,"div",4),e._UZ(6,"date-field",5),e.qZA(),e.TgZ(7,"div",4),e._UZ(8,"date-field",6),e.qZA(),e.TgZ(9,"div",4)(10,"single-selection-field",7),e._UZ(11,"field-option",8)(12,"field-option",9)(13,"field-option",10)(14,"field-option",11)(15,"field-option",12)(16,"field-option",13)(17,"field-option",14)(18,"field-option",15)(19,"field-option",16)(20,"field-option",17)(21,"field-option",18)(22,"field-option",19)(23,"field-option",20),e.qZA()(),e.TgZ(24,"div",4),e._UZ(25,"user-field",21),e.qZA()()()(),e.TgZ(26,"results-layout",22),e.NdJ("update",function(r){return i.update(r)}),e.ALo(27,"async"),e.YNc(28,Kn,8,8,"mobile-result",23),e.YNc(29,ti,12,6,"table",24),e.qZA()()),2&t&&(e.Q6J("ready",e.lcZ(1,24,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.userAlert.title)("mobileHeading",i.i18n.userAlert.mobileTitle),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(3),e.Q6J("label",i.i18n.general.beginDate),e.xp6(2),e.Q6J("label",i.i18n.general.endDate),e.xp6(2),e.Q6J("label",i.i18n.userAlert.type.title)("emptyOption",i.i18n.general.notApplied),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.custom),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.givenVeryBadRefs),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.insufficientBalanceForInitialCredit),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.maxDeviceActivationAttemptsReached),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.maxTokenActivationAttemptsReached),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.maxUserLocalizationAttemptsReached),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.maxVoucherRedeemAttemptsReached),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.moveUserAutomaticallyFailed),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.passwordDisabledByTries),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.passwordTemporarilyBlocked),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.receivedVeryBadRefs),e.xp6(1),e.Q6J("text",i.i18n.userAlert.type.receivedVeryBadRefs),e.xp6(2),e.Q6J("label",i.i18n.general.user),e.xp6(1),e.Q6J("results",e.lcZ(27,26,i.results$))("rendering$",i.rendering$))},directives:[Z.w,E.Y,_.JL,_.sg,et.Q,_.JJ,_.u,ue.f,W.s,ve.l,V.D,j.E,K.t,ie.i9,te.p,d.sg,d.mk,Ae.A],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var ee=s(2462);let mt=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserBrokersData$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserBrokersDataPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserBrokersData(t,i){return this.getUserBrokersData$Response(t,i).pipe((0,c.U)(o=>o.body))}getBrokerDataForAdd$Response(t,i){const o=new b.c(this.rootUrl,n.GetBrokerDataForAddPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getBrokerDataForAdd(t,i){return this.getBrokerDataForAdd$Response(t,i).pipe((0,c.U)(o=>o.body))}viewBrokering$Response(t,i){const o=new b.c(this.rootUrl,n.ViewBrokeringPath,"get");return t&&(o.path("user",t.user,{}),o.path("broker",t.broker,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewBrokering(t,i){return this.viewBrokering$Response(t,i).pipe((0,c.U)(o=>o.body))}addBroker$Response(t,i){const o=new b.c(this.rootUrl,n.AddBrokerPath,"post");return t&&(o.path("user",t.user,{}),o.path("broker",t.broker,{}),o.query("main",t.main,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}addBroker(t,i){return this.addBroker$Response(t,i).pipe((0,c.U)(o=>o.body))}removeBroker$Response(t,i){const o=new b.c(this.rootUrl,n.RemoveBrokerPath,"delete");return t&&(o.path("user",t.user,{}),o.path("broker",t.broker,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}removeBroker(t,i){return this.removeBroker$Response(t,i).pipe((0,c.U)(o=>o.body))}setMainBroker$Response(t,i){const o=new b.c(this.rootUrl,n.SetMainBrokerPath,"post");return t&&(o.path("user",t.user,{}),o.path("broker",t.broker,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setMainBroker(t,i){return this.setMainBroker$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserBrokersDataPath="/{user}/brokers",n.GetBrokerDataForAddPath="/{user}/brokers/data-for-add",n.ViewBrokeringPath="/{user}/brokers/{broker}",n.AddBrokerPath="/{user}/brokers/{broker}",n.RemoveBrokerPath="/{user}/brokers/{broker}",n.SetMainBrokerPath="/{user}/brokers/{broker}/set-main",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ii(n,a){if(1&n&&e._UZ(0,"boolean-field",7),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.brokers.mainBroker)}}function oi(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ynx(2,3),e._UZ(3,"user-field",4),e.YNc(4,ii,1,1,"boolean-field",5),e.BQk(),e.TgZ(5,"actions")(6,"action-button",6),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(7,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.brokers.title.new)("mobileHeading",t.i18n.brokers.mobileTitle.new),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("filters",t.userQuery)("allowContacts",!1)("label",t.i18n.brokers.broker),e.xp6(1),e.Q6J("ngIf",t.data.brokers),e.xp6(2),e.Q6J("disabled",e.lcZ(7,9,t.requesting$))("label",t.i18n.general.save)}}let ai=(()=>{class n extends y.y{constructor(t,i){super(t),this.brokeringService=i,this.form=this.formBuilder.group({})}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.brokeringService.getBrokerDataForAdd({user:this.user}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.userQuery={roles:[ee.g.BROKER],usersToExclude:t.brokers.map(i=>i.id),groups:t.brokerGroups.map(i=>i.id)},t.brokers&&this.form.setControl("mainBroker",this.formBuilder.control(!1)),this.form.setControl("broker",this.formBuilder.control(null,_.kI.required))}save(){if(!(0,m.pt)(this.form))return;const t=this.form.value;this.addSub(this.brokeringService.addBroker({broker:t.broker,user:this.user,main:t.mainBroker}).subscribe(()=>{this.notification.snackBar(this.i18n.brokers.brokerAdded),this.breadcrumb.breadcrumb$.value.length>1?this.breadcrumb.back():(this.breadcrumb.pop(),this.router.navigate(["/users",this.user,"brokers"],{replaceUrl:!0}))}))}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(mt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["broker-form"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","broker",3,"filters","allowContacts","label"],["formControlName","mainBroker",3,"label",4,"ngIf"],[3,"disabled","label","action"],["formControlName","mainBroker",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,oi,8,11,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,ve.l,_.JJ,_.u,O.M,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var ri=s(3961);function si(n,a){if(1&n&&e._UZ(0,"user-info",7),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function ci(n,a){if(1&n&&e._UZ(0,"icon",15),2&n){const t=e.oxw(3);e.Q6J("icon",t.SvgIcon.Check2)}}function li(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",16),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).setMain(r),o.stopPropagation(),o.preventDefault()}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(1),e.hij("",t.i18n.brokers.setMain," ")}}function ui(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"button",18),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).remove(r),o.stopPropagation(),o.preventDefault()}),e._UZ(2,"icon",19),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("icon",t.SvgIcon.Trash)}}function pi(n,a){if(1&n&&(e.TgZ(0,"mobile-result",8)(1,"div",9)(2,"div")(3,"div",10),e._uU(4),e.qZA(),e.TgZ(5,"div",11),e.YNc(6,ci,1,1,"icon",12),e.YNc(7,li,2,1,"a",13),e.qZA()(),e.YNc(8,ui,3,1,"div",14),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",null==t.broker?null:t.broker.image)("avatarIcon",i.SvgIcon.Person),e.xp6(4),e.hij(" ",t.broker.display," "),e.xp6(2),e.Q6J("ngIf",t.main),e.xp6(1),e.Q6J("ngIf",i.canSetMain(t)),e.xp6(1),e.Q6J("ngIf",i.canRemove(t))}}function di(n,a){1&n&&e._UZ(0,"th",25)}function _i(n,a){if(1&n&&e._UZ(0,"icon",15),2&n){const t=e.oxw(4);e.Q6J("icon",t.SvgIcon.Check2)}}function gi(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"a",16),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).setMain(r),o.stopPropagation(),o.preventDefault()}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw(4);e.xp6(1),e.hij("",t.i18n.brokers.setMain," ")}}function mi(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",32)(1,"button",33),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).remove(r),o.stopPropagation()}),e._UZ(2,"icon",19),e.qZA()()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}const fi=function(n){return{"cursor-default":n}},hi=function(n,a){return{"pb-0":n,"border-0":a}};function bi(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",26),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.path(r)?p.router.navigate(p.path(r)):null}),e.TgZ(2,"td",27),e.ALo(3,"async"),e.ALo(4,"async"),e._UZ(5,"avatar",28),e.qZA(),e.TgZ(6,"td")(7,"maybe-link",29),e._uU(8),e.qZA()(),e.TgZ(9,"td",30),e.YNc(10,_i,1,1,"icon",12),e.YNc(11,gi,2,1,"a",13),e.qZA(),e.YNc(12,mi,3,2,"td",31),e.qZA(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngClass",e.VKq(13,fi,!i.path(t))),e.xp6(1),e.Q6J("ngClass",e.WLB(15,hi,e.lcZ(3,9,i.layout.xxs$),e.lcZ(4,11,i.layout.xxs$))),e.xp6(3),e.Q6J("image",null==t.broker?null:t.broker.image)("icon",i.SvgIcon.Person),e.xp6(2),e.Q6J("link",i.path(t)),e.xp6(1),e.hij(" ",t.broker.display," "),e.xp6(2),e.Q6J("ngIf",t.main),e.xp6(1),e.Q6J("ngIf",i.canSetMain(t)),e.xp6(1),e.Q6J("ngIf",i.canRemove(t))}}function xi(n,a){if(1&n&&(e.TgZ(0,"table",20)(1,"thead"),e._UZ(2,"th",21),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th",22),e._uU(6),e.qZA(),e.YNc(7,di,1,0,"th",23),e.qZA(),e.TgZ(8,"tbody"),e.YNc(9,bi,13,18,"ng-container",24),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.i18n.general.user),e.xp6(2),e.hij("",t.i18n.brokers.mainBroker," "),e.xp6(1),e.Q6J("ngIf",t.hasActions),e.xp6(2),e.Q6J("ngForOf",t.data.brokers)}}function vi(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,si,1,1,"user-info",3),e.qZA(),e.TgZ(4,"results-layout",4),e.YNc(5,pi,9,6,"mobile-result",5),e.YNc(6,xi,10,4,"table",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.brokers.title.list)("mobileHeading",t.i18n.brokers.mobileTitle.list)("headingActions",e.lcZ(2,7,t.headingActions$))("mode",t.self?"empty":"normal"),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("results",t.data.brokers)("toLink",t.toLink)}}let yi=(()=>{class n extends y.y{constructor(t,i){super(t),this.brokeringService=i,this.hasActions=!1}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param}).subscribe(t=>{this.data=t}))}path(t){if(t.broker.id)return["/users",t.broker.id,"profile"]}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user),this.brokers=t.brokers,this.headingActions=[],t.editable&&this.headingActions.push(new Q.Yu(F.l.PersonPlus,this.i18n.general.addNew,()=>this.router.navigate(["/users",this.param,"brokers","new"]),!0)),t.history&&this.headingActions.push(new Q.Yu(F.l.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"brokers","history"]),!0)),this.hasActions=t.brokers.findIndex(i=>this.canRemove(i))>=0}get toLink(){return t=>this.path(t)}setMain(t){this.addSub(this.brokeringService.setMainBroker({broker:t.broker.id,user:this.param}).subscribe(()=>{this.reload()}))}remove(t){this.confirmation.confirm({message:this.i18n.general.removeConfirm(t.broker.display),callback:()=>this.doRemove(t)})}doRemove(t){this.addSub(this.brokeringService.removeBroker({broker:t.broker.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(t.broker.display)),this.reload()}))}resolveMenu(){return this.menu.searchUsersMenu()}canRemove(t){var i;return(null===(i=this.data)||void 0===i?void 0:i.editable)&&!this.authHelper.isSelfOrOwner(t.broker)&&t.broker.id}canSetMain(t){var i;return(null===(i=this.data)||void 0===i?void 0:i.editable)&&!t.main&&t.broker.id}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(mt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-user-brokers"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","d-inline-block",3,"icon",4,"ngIf"],["class","decorated",3,"click",4,"ngIf"],["class","ml-auto",4,"ngIf"],[1,"d-inline-block",3,"icon"],[1,"decorated",3,"click"],[1,"ml-auto"],["type","button",1,"btn","btn-icon",3,"click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","20%",1,"text-center"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"ngClass","click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"link"],[1,"text-center"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["type","button",1,"btn","btn-icon",3,"tooltip","click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,vi,7,9,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,ne.o,te.p,d.sg,d.mk,Ae.A,ri.O,ie.i9],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var De=(()=>{return(n=De||(De={})).ADD="add",n.REMOVE="remove",n.SET_MAIN="setMain",De;var n})();function Ti(n,a){1&n&&e.GkF(0)}function Ai(n,a){if(1&n&&(e.TgZ(0,"mobile-result",8)(1,"div",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",11),e._uU(7),e.qZA(),e.TgZ(8,"div",11),e._uU(9),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",null==t.broker?null:t.broker.image)("avatarIcon",i.SvgIcon.Person),e.xp6(2),e.hij(" ",t.broker.display," "),e.xp6(2),e.hij(" ",e.lcZ(5,8,t.date)," "),e.xp6(3),e.AsE(" ",i.i18n.general.action,": ",i.showActionLabel(t)," "),e.xp6(2),e.AsE(" ",i.i18n.general.performedBy,": ",t.by?t.by.display:i.i18n.general.administration," ")}}const Ci=function(n,a){return{"pb-0":n,"border-0":a}};function wi(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td",15),e.ALo(2,"async"),e.ALo(3,"async"),e._UZ(4,"avatar",16),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngClass",e.WLB(13,Ci,e.lcZ(2,7,i.layout.xxs$),e.lcZ(3,9,i.layout.xxs$))),e.xp6(3),e.Q6J("image",null==t.broker?null:t.broker.image)("tooltip",null==t.broker?null:t.broker.display),e.xp6(2),e.Oqu(t.broker.display),e.xp6(2),e.Oqu(e.lcZ(9,11,t.date)),e.xp6(3),e.Oqu(i.showActionLabel(t)),e.xp6(2),e.hij(" ",t.by?t.by.display:i.i18n.general.administration," ")}}function Ei(n,a){if(1&n&&(e.TgZ(0,"table",12)(1,"thead"),e._UZ(2,"th",13),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,wi,14,16,"tr",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.i18n.brokers.broker),e.xp6(2),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.action),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function Zi(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e._UZ(1,"user-info",4),e.qZA(),e.TgZ(2,"results-layout",5),e.YNc(3,Ai,10,10,"mobile-result",6),e.YNc(4,Ei,13,5,"table",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.brokers.title.history)("mobileHeading",t.i18n.brokers.mobileTitle.history),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)("onClick",t.onClick)}}let Ii=(()=>{class n extends ce.k{constructor(t,i){super(t),this.brokeringService=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param,fields:["user","history"]}).subscribe(t=>{this.data=t}))}showActionLabel(t){switch(t.action){case De.ADD:return this.i18n.brokers.action.add;case De.REMOVE:return this.i18n.brokers.action.remove;case De.SET_MAIN:return this.i18n.brokers.action.setMain}}get onClick(){return t=>null!=t}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(mt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-broker-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results","onClick"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"avatarImage","avatarIcon"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ti,1,0,"ng-container",1),e.qZA(),e.YNc(3,Zi,5,5,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg,d.mk,Ae.A,ie.i9],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})(),Si=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getSessionDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetSessionDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getSessionDataForSearch(t,i){return this.getSessionDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchSessions$Response(t,i){const o=new b.c(this.rootUrl,n.SearchSessionsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("broker",t.broker,{}),o.query("channels",t.channels,{}),o.query("excludeCurrentSession",t.excludeCurrentSession,{}),o.query("operatorsOf",t.operatorsOf,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("roles",t.roles,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchSessions(t,i){return this.searchSessions$Response(t,i).pipe((0,c.U)(o=>o.body))}loginUser$Response(t,i){const o=new b.c(this.rootUrl,n.LoginUserPath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}loginUser(t,i){return this.loginUser$Response(t,i).pipe((0,c.U)(o=>o.body))}disconnectUserSessions$Response(t,i){const o=new b.c(this.rootUrl,n.DisconnectUserSessionsPath,"delete");return t&&o.path("user",t.user,{}),this.http.request(o.build({responseType:"blob",accept:"plain/text",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}disconnectUserSessions(t,i){return this.disconnectUserSessions$Response(t,i).pipe((0,c.U)(o=>o.body))}disconnectSession$Response(t,i){const o=new b.c(this.rootUrl,n.DisconnectSessionPath,"delete");return t&&o.path("sessionToken",t.sessionToken,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}disconnectSession(t,i){return this.disconnectSession$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetSessionDataForSearchPath="/sessions/data-for-search",n.SearchSessionsPath="/sessions",n.LoginUserPath="/sessions",n.DisconnectUserSessionsPath="/{user}/sessions",n.DisconnectSessionPath="/sessions/{sessionToken}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ie=s(5255);function Ui(n,a){if(1&n&&e._UZ(0,"field-option",13),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("id",t.id)("text",t.name)}}function Ni(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"multi-selection-field",11),e.YNc(2,Ui,1,4,"field-option",12),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.connectedUser.channel),e.xp6(1),e.Q6J("ngForOf",t.data.channels)}}function ki(n,a){if(1&n&&e._UZ(0,"field-option",16),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",t)("text",i.showConnectedLabel(t))}}function Oi(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"multi-selection-field",14),e.YNc(2,ki,1,2,"field-option",15),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.connectedUser.showConnected),e.xp6(1),e.Q6J("ngForOf",t.data.roles)}}function Pi(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).disconnect(r),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",25),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("icon",t.SvgIcon.Logout2)}}function Qi(n,a){if(1&n&&(e.TgZ(0,"mobile-result",17)(1,"div",18)(2,"div")(3,"div",19),e._uU(4),e.qZA(),e.TgZ(5,"div",20),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.TgZ(8,"div",21),e._uU(9),e.qZA()(),e.TgZ(10,"div",22),e.YNc(11,Pi,2,1,"button",23),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",null==t.user?null:t.user.image)("avatarIcon",i.SvgIcon.Person),e.xp6(4),e.hij(" ",t.user.display," "),e.xp6(2),e.hij(" ",e.lcZ(7,6,t.creationDate)," "),e.xp6(3),e.hij(" ",t.channel.name," "),e.xp6(2),e.Q6J("ngIf",i.canDisconnect(t))}}function Ji(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).disconnect(r),o.stopPropagation()}),e._UZ(1,"icon",25),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.connectedUser.disconnect),e.xp6(1),e.Q6J("icon",t.SvgIcon.Logout2)}}const Di=function(n,a){return{"pb-0":n,"border-0":a}};function Fi(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",30),e.ALo(3,"async"),e.ALo(4,"async"),e._UZ(5,"avatar",31),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"dateTime"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td",28),e.YNc(16,Ji,2,2,"button",32),e.qZA()(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("ngClass",e.WLB(14,Di,e.lcZ(3,8,i.layout.xxs$),e.lcZ(4,10,i.layout.xxs$))),e.xp6(3),e.Q6J("image",null==t.user?null:t.user.image)("tooltip",null==t.user?null:t.user.display),e.xp6(2),e.Oqu(t.user.display),e.xp6(2),e.Oqu(t.channel.name),e.xp6(2),e.Oqu(e.lcZ(12,12,t.creationDate)),e.xp6(3),e.Oqu(t.remoteAddress),e.xp6(2),e.Q6J("ngIf",i.canDisconnect(t))}}function Ri(n,a){if(1&n&&(e.TgZ(0,"table",26)(1,"thead"),e._UZ(2,"th",27),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA(),e._UZ(11,"th",28),e.qZA(),e.TgZ(12,"tbody"),e.YNc(13,Fi,17,17,"ng-container",29),e.ALo(14,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.general.user),e.xp6(2),e.Oqu(t.i18n.connectedUser.channel),e.xp6(2),e.Oqu(t.i18n.connectedUser.loggedInAt),e.xp6(2),e.Oqu(t.i18n.connectedUser.ipAddress),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(14,5,t.results$))?null:i.results)}}function qi(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2)(2,"div",3)(3,"div",4),e.YNc(4,Ni,3,2,"div",5),e.YNc(5,Oi,3,2,"div",5),e.TgZ(6,"div",6),e._UZ(7,"user-field",7),e.qZA()()()(),e.TgZ(8,"results-layout",8),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(9,"async"),e.YNc(10,Qi,12,8,"mobile-result",9),e.YNc(11,Ri,15,7,"table",10),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.connectedUser.title)("mobileHeading",t.i18n.connectedUser.mobileTitle),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",(null==t.data.channels?null:t.data.channels.length)>1),e.xp6(1),e.Q6J("ngIf",(null==t.data.roles?null:t.data.roles.length)>1),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("results",e.lcZ(9,9,t.results$))("onClick",t.onClick)("rendering$",t.rendering$)}}let Mi=(()=>{class n extends xe.t{constructor(t,i){super(t),this.sessionsService=i}ngOnInit(){super.ngOnInit(),this.addSub(this.sessionsService.getSessionDataForSearch().subscribe(t=>this.data=t))}toSearchParams(t){return t}disconnect(t){this.addSub(this.sessionsService.disconnectSession({sessionToken:t.sessionToken}).subscribe(()=>{this.notification.snackBar(this.i18n.connectedUser.disconnected(t.user.display)),this.update()}))}canDisconnect(t){return this.login.auth.permissions.sessions.disconnect&&this.login.auth.sessionToken!==t.sessionToken}get onClick(){return t=>null!=t}getFormControlNames(){return["channels","roles","user"]}doSearch(t){return this.sessionsService.searchSessions$Response(t)}showConnectedLabel(t){switch(t){case ee.g.ADMINISTRATOR:return this.i18n.connectedUser.viewConnected.admin;case ee.g.BROKER:return this.i18n.connectedUser.viewConnected.broker;case ee.g.MEMBER:return this.i18n.connectedUser.viewConnected.member;case ee.g.OPERATOR:return this.i18n.connectedUser.viewConnected.operator}}resolveMenu(){return this.dataForFrontendHolder.role===ee.g.BROKER?v.v2.BROKER_CONNECTED_USERS:v.v2.CONNECTED_USERS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Si))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-connected"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","user",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["formControlName","channels",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["formControlName","roles",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],["type","button","class","btn btn-icon",3,"click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,qi,12,11,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Ie.x,_.JJ,_.u,d.sg,W.s,ve.l,V.D,j.E,K.t,ne.o,te.p,d.mk,Ae.A,ie.i9],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var Se=(()=>{return(n=Se||(Se={})).DYNAMIC="dynamic",n.STATIC="static",n.USER="user",Se;var n})(),oe=s(591);let Be=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getDocumentsDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetDocumentsDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getDocumentsDataForSearch(t,i){return this.getDocumentsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchDocuments$Response(t,i){const o=new b.c(this.rootUrl,n.SearchDocumentsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("brokers",t.brokers,{}),o.query("categories",t.categories,{}),o.query("enabled",t.enabled,{}),o.query("groups",t.groups,{}),o.query("keywords",t.keywords,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("range",t.range,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchDocuments(t,i){return this.searchDocuments$Response(t,i).pipe((0,c.U)(o=>o.body))}createSharedDocument$Response(t,i){const o=new b.c(this.rootUrl,n.CreateSharedDocumentPath,"post");return t&&o.body(t.body,"application/json"),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createSharedDocument(t,i){return this.createSharedDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}createSharedDocumentWithUpload$Response(t,i){const o=new b.c(this.rootUrl,n.CreateSharedDocumentWithUploadPath,"post");return t&&o.body(t.body,"multipart/form-data"),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createSharedDocumentWithUpload(t,i){return this.createSharedDocumentWithUpload$Response(t,i).pipe((0,c.U)(o=>o.body))}getSharedDocumentDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetSharedDocumentDataForNewPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getSharedDocumentDataForNew(t,i){return this.getSharedDocumentDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}viewDocument$Response(t,i){const o=new b.c(this.rootUrl,n.ViewDocumentPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewDocument(t,i){return this.viewDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}updateDocument$Response(t,i){const o=new b.c(this.rootUrl,n.UpdateDocumentPath,"put");return t&&(o.path("id",t.id,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updateDocument(t,i){return this.updateDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}deleteDocument$Response(t,i){const o=new b.c(this.rootUrl,n.DeleteDocumentPath,"delete");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}deleteDocument(t,i){return this.deleteDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}updateDocumentWithUpload$Response(t,i){const o=new b.c(this.rootUrl,n.UpdateDocumentWithUploadPath,"post");return t&&(o.path("id",t.id,{}),o.body(t.body,"multipart/form-data")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updateDocumentWithUpload(t,i){return this.updateDocumentWithUpload$Response(t,i).pipe((0,c.U)(o=>o.body))}getDocumentDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetDocumentDataForEditPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getDocumentDataForEdit(t,i){return this.getDocumentDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}downloadDocumentFile$Response(t,i){const o=new b.c(this.rootUrl,n.DownloadDocumentFilePath,"get");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"blob",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}downloadDocumentFile(t,i){return this.downloadDocumentFile$Response(t,i).pipe((0,c.U)(o=>o.body))}uploadDocumentFile$Response(t,i){const o=new b.c(this.rootUrl,n.UploadDocumentFilePath,"post");return t&&(o.path("id",t.id,{}),o.query("name",t.name,{}),o.body(t.body,"multipart/form-data")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}uploadDocumentFile(t,i){return this.uploadDocumentFile$Response(t,i).pipe((0,c.U)(o=>o.body))}getDataForDynamicDocument$Response(t,i){const o=new b.c(this.rootUrl,n.GetDataForDynamicDocumentPath,"get");return t&&(o.path("id",t.id,{}),o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getDataForDynamicDocument(t,i){return this.getDataForDynamicDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}processDynamicDocument$Response(t,i){const o=new b.c(this.rootUrl,n.ProcessDynamicDocumentPath,"post");return t&&(o.path("id",t.id,{}),o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/html",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}processDynamicDocument(t,i){return this.processDynamicDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}listUserDocuments$Response(t,i){const o=new b.c(this.rootUrl,n.ListUserDocumentsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}listUserDocuments(t,i){return this.listUserDocuments$Response(t,i).pipe((0,c.U)(o=>o.body))}createUserDocument$Response(t,i){const o=new b.c(this.rootUrl,n.CreateUserDocumentPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createUserDocument(t,i){return this.createUserDocument$Response(t,i).pipe((0,c.U)(o=>o.body))}createUserDocumentWithUpload$Response(t,i){const o=new b.c(this.rootUrl,n.CreateUserDocumentWithUploadPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"multipart/form-data")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createUserDocumentWithUpload(t,i){return this.createUserDocumentWithUpload$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserDocumentDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserDocumentDataForNewPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserDocumentDataForNew(t,i){return this.getUserDocumentDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetDocumentsDataForSearchPath="/documents/data-for-search",n.SearchDocumentsPath="/documents",n.CreateSharedDocumentPath="/documents",n.CreateSharedDocumentWithUploadPath="/documents/upload",n.GetSharedDocumentDataForNewPath="/documents/data-for-new",n.ViewDocumentPath="/documents/{id}",n.UpdateDocumentPath="/documents/{id}",n.DeleteDocumentPath="/documents/{id}",n.UpdateDocumentWithUploadPath="/documents/{id}/upload",n.GetDocumentDataForEditPath="/documents/{id}/data-for-edit",n.DownloadDocumentFilePath="/documents/{id}/file",n.UploadDocumentFilePath="/documents/{id}/file",n.GetDataForDynamicDocumentPath="/documents/{id}/dynamic/{user}",n.ProcessDynamicDocumentPath="/documents/{id}/dynamic/{user}",n.ListUserDocumentsPath="/{user}/documents",n.CreateUserDocumentPath="/{user}/documents",n.CreateUserDocumentWithUploadPath="/{user}/documents/upload",n.GetUserDocumentDataForNewPath="/{user}/documents/data-for-new",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ae=s(7107),ge=s(3728),Fe=s(1030),Li=s(3450);function Yi(n,a){if(1&n&&(e.TgZ(0,"label-value",18),e._UZ(1,"user-link",19),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user)}}function Bi(n,a){if(1&n&&e._UZ(0,"input-field",20),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.internalName)}}function Gi(n,a){if(1&n&&e._UZ(0,"field-option",23),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("text",t.name)}}function $i(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",21),e.YNc(1,Gi,1,3,"field-option",22),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.category),e.xp6(1),e.Q6J("ngForOf",t.data.categories)}}function Hi(n,a){if(1&n&&e._UZ(0,"boolean-field",24),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.publiclyAccessible)}}function Vi(n,a){if(1&n&&(e.TgZ(0,"label-value",25),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.downloadUrl),e.xp6(1),e.hij(" ",t.downloadUrl," ")}}function ji(n,a){if(1&n&&e._UZ(0,"boolean-field",26),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.userVisible)}}function zi(n,a){if(1&n&&e._UZ(0,"boolean-field",27),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.brokerVisible)}}function Xi(n,a){if(1&n&&e._UZ(0,"boolean-field",28),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.brokerManageable)}}function Ki(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"label-value",29)(1,"div")(2,"span"),e._uU(3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"button",30),e.NdJ("click",function(o){return e.CHM(t),e.oxw(2).download(),o.stopPropagation()}),e._UZ(6,"icon",31),e.qZA()()()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.document),e.xp6(3),e.hij(" ",e.lcZ(4,4,t.fileName$)," "),e.xp6(2),e.Q6J("tooltip",t.i18n.general.download),e.xp6(1),e.Q6J("icon",t.SvgIcon.Download)}}function Wi(n,a){if(1&n&&(e.ynx(0,4),e.YNc(1,Yi,2,2,"label-value",5),e._UZ(2,"input-field",6),e.YNc(3,Bi,1,1,"input-field",7),e._UZ(4,"textarea-field",8),e.YNc(5,$i,2,2,"single-selection-field",9),e._UZ(6,"boolean-field",10),e.YNc(7,Hi,1,1,"boolean-field",11),e.YNc(8,Vi,2,2,"label-value",12),e.ALo(9,"async"),e.YNc(10,ji,1,1,"boolean-field",13),e.YNc(11,zi,1,1,"boolean-field",14),e.YNc(12,Xi,1,1,"boolean-field",15),e.YNc(13,Ki,7,6,"label-value",16),e.ALo(14,"async"),e._UZ(15,"file-field",17),e.ALo(16,"async"),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.general.name),e.xp6(1),e.Q6J("ngIf",t.data.kind!==t.DocumentKind.USER),e.xp6(1),e.Q6J("label",t.i18n.general.description),e.xp6(1),e.Q6J("ngIf",t.data.kind!=t.DocumentKind.USER),e.xp6(1),e.Q6J("label",t.i18n.document.enable),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.DocumentKind.STATIC),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,16,t.downloadUrl$)),e.xp6(2),e.Q6J("ngIf",t.data.kind===t.DocumentKind.USER),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.DocumentKind.USER),e.xp6(1),e.Q6J("ngIf",t.form.controls.brokerVisible.value),e.xp6(1),e.Q6J("ngIf",!t.create&&e.lcZ(14,18,t.fileName$)),e.xp6(2),e.Q6J("required",t.create)("label",t.create||null!==e.lcZ(16,20,t.fileName$)?t.i18n.document.newDocument:t.i18n.document.replaceDocument)("formControl",t.fileControl)}}let kt=(()=>{class n extends y.y{constructor(t,i){super(t),this.documentsService=i,this.DocumentKind=Se,this.fileName$=new oe.X(null),this.downloadUrl$=new oe.X(null)}isOwner(){return this.authHelper.isSelf(this.data.user)}ngOnInit(){super.ngOnInit();const t=this.route.snapshot;this.user=t.params.user,this.id=t.params.id,this.create=null==this.id;const i=this.create?this.documentsService.getUserDocumentDataForNew({user:this.user}):this.documentsService.getDocumentDataForEdit({id:this.id});this.addSub(i.subscribe(o=>this.data=o))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(m.M_))}onDataInitialized(t){var i;super.onDataInitialized(t);const o=t.document,r=t.document;this.create||(this.fileName$.next(null===(i=t.file)||void 0===i?void 0:i.name),this.downloadUrl=this.urlFromTemplate(o.internalName||this.id,t.downloadUrlTemplate)),this.fileControl=this.formBuilder.control(null,this.create?_.kI.required:null),this.form=this.formBuilder.group({name:[o.name,_.kI.required],internalName:o.internalName,description:o.description,category:o.category,enabled:o.enabled,publiclyAccessible:o.publiclyAccessible,userVisible:o.userVisible,brokerVisible:o.brokerVisible,brokerManageable:o.brokerManageable,version:r.version});const p=(C,I)=>{this.downloadUrl=I?this.urlFromTemplate(C||this.id,t.downloadUrlTemplate):null};this.form.controls.internalName.valueChanges.subscribe(C=>p(C,this.form.controls.publiclyAccessible.value)),this.form.controls.publiclyAccessible.valueChanges.subscribe(C=>p(this.form.controls.internalName.value,C))}asEdit(){return this.data}asNew(){return this.data}save(){const t=this.fileControl.value;if(!(0,m.pt)(this.form)||(this.create||t)&&!(0,m.pt)(this.fileControl))return;const i=(0,S.Z)(this.form.value);i.brokerVisible||(i.brokerManageable=!1);const o={next:r=>this.notifySavedAndReload(r||this.id)};this.addSub(this.create?this.documentsService.createUserDocumentWithUpload({user:this.user,body:{document:i,file:t,fileName:t.name}}).subscribe(o):t?this.documentsService.updateDocumentWithUpload({id:this.id,body:{document:i,file:t,fileName:t.name}}).subscribe(o):this.documentsService.updateDocument({id:this.id,body:i}).subscribe(o))}notifySavedAndReload(t){this.notification.snackBar(this.i18n.document.savedSuccessfully),this.router.navigate(["/users","documents","edit",t])}formControl(t){return this.form.get(t)}get downloadUrl(){return this.downloadUrl$.value}set downloadUrl(t){this.downloadUrl$.next(t)}urlFromTemplate(t,i){return(0,m.cS)(i)||(0,m.cS)(t)?null:i.replace("{key}",t)}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-document"]],features:[e.qOj],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],["fieldSize","full","required","","formControlName","name",3,"label"],["fieldSize","full","formControlName","internalName",3,"label",4,"ngIf"],["formControlName","description",3,"label"],["required","","formControlName","category",3,"label",4,"ngIf"],["formControlName","enabled",3,"label"],["formControlName","publiclyAccessible",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["formControlName","userVisible",3,"label",4,"ngIf"],["formControlName","brokerVisible",3,"label",4,"ngIf"],["formControlName","brokerManageable",3,"label",4,"ngIf"],["kind","field",3,"label",4,"ngIf"],[3,"required","label","formControl"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["fieldSize","full","formControlName","internalName",3,"label"],["required","","formControlName","category",3,"label"],[3,"value","internalName","text",4,"ngFor","ngForOf"],[3,"value","internalName","text"],["formControlName","publiclyAccessible",3,"label"],[3,"label"],["formControlName","userVisible",3,"label"],["formControlName","brokerVisible",3,"label"],["formControlName","brokerManageable",3,"label"],["kind","field",3,"label"],["type","button",1,"btn","btn-icon","ml-2",3,"tooltip","click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.YNc(3,Wi,17,22,"ng-container",2),e.TgZ(4,"actions")(5,"action-button",3),e.NdJ("action",function(){return i.save()}),e.ALo(6,"async"),e.qZA()()()()),2&t&&(e.Q6J("ready",e.lcZ(1,6,i.data$)),e.xp6(2),e.Q6J("heading",i.create?i.i18n.document.title.new:i.i18n.document.title.edit)("mobileHeading",i.create?i.i18n.document.mobileTitle.new:i.i18n.document.mobileTitle.edit),e.xp6(1),e.Q6J("ngIf",i.data),e.xp6(2),e.Q6J("disabled",e.lcZ(6,8,i.requesting$))("label",i.i18n.general.save))},directives:[Z.w,E.Y,d.O5,_.JL,_.sg,Y.t,ae.F,ge.q,_.Q7,_.JJ,_.u,Fe.u,ue.f,d.sg,W.s,O.M,ie.i9,ne.o,Li.O,_.oH,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();function eo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).download(r),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",11),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.download),e.xp6(1),e.Q6J("icon",t.SvgIcon.Download)}}function to(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,p=e.oxw(2);return p.router.navigate(p.path(r)),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",11),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.document.process),e.xp6(1),e.Q6J("icon",t.SvgIcon.FileEarmarkText)}}function no(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",6)(2,"div")(3,"label-value",7),e._uU(4),e.qZA(),e.TgZ(5,"label-value",7),e._uU(6),e.qZA()(),e.TgZ(7,"div",8),e.YNc(8,eo,2,2,"button",9),e.YNc(9,to,2,2,"button",9),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.name),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("label",i.i18n.general.description),e.xp6(1),e.hij(" ",t.description," "),e.xp6(2),e.Q6J("ngIf",i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",!i.isStatic(t.kind))}}function io(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).download(r),o.stopPropagation()}),e._UZ(1,"icon",11),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.download),e.xp6(1),e.Q6J("icon",t.SvgIcon.Download)}}function oo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,p=e.oxw(3);return p.router.navigate(p.path(r)),o.stopPropagation()}),e._UZ(1,"icon",11),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.document.process),e.xp6(1),e.Q6J("icon",t.SvgIcon.FileEarmarkText)}}function ao(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",15),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(3);return C.isStatic(p.kind)?C.download(p):C.router.navigate(C.path(p)),o.stopPropagation()}),e.TgZ(1,"td",16),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",17),e.YNc(6,io,2,2,"button",9),e.YNc(7,oo,2,2,"button",9),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",!i.isStatic(t.kind))}}function ro(n,a){if(1&n&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e._UZ(6,"th",13),e.qZA(),e.TgZ(7,"tbody"),e.YNc(8,ao,8,4,"tr",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.name),e.xp6(2),e.Oqu(t.i18n.general.description),e.xp6(3),e.Q6J("ngForOf",t.data)}}function so(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"results-layout",3),e.YNc(4,no,10,6,"mobile-result",4),e.YNc(5,ro,9,3,"table",5),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode","empty")("heading",t.i18n.document.title.list)("mobileHeading",t.i18n.document.mobileTitle.list)("headingActions",e.lcZ(2,5,t.headingActions$)),e.xp6(2),e.Q6J("results",t.data)}}let co=(()=>{class n extends y.y{constructor(t,i){super(t),this.documentsService=i}ngOnInit(){super.ngOnInit(),this.addSub(this.documentsService.listUserDocuments({user:f.S.SELF}).subscribe(t=>this.data=t))}isStatic(t){return t!==Se.DYNAMIC}download(t){t.file?this.addSub(this.documentsService.downloadDocumentFile$Response({id:t.id}).subscribe(m.M_)):this.notification.info(this.i18n.document.errorNoFile)}path(t){return["/users","documents","process-dynamic",t.id]}resolveMenu(){return this.menu.userMenu(null,v.v2.MY_DOCUMENTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-documents"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,so,6,7,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,V.D,j.E,K.t,Y.t,ie.i9,ne.o,te.p,d.sg],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Ot=s(9175),ft=s(1602),tt=s(8361),ht=s(3317);function lo(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"custom-field-input",6),e.BQk()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(2);e.xp6(1),e.Q6J("field",t)("formControl",o.formControl(t.internalName))("focused",i)("labelPosition","auto")}}function uo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.YNc(1,lo,2,4,"ng-container",4),e.TgZ(2,"actions")(3,"action-button",5),e.NdJ("action",function(){return e.CHM(t),e.oxw().process()}),e.ALo(4,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.data.document.name)("mobileHeading",t.data.document.name),e.xp6(1),e.Q6J("ngForOf",t.formFields),e.xp6(2),e.Q6J("disabled",e.lcZ(4,5,t.requesting$))("label",t.i18n.general.submit)}}function po(n,a){if(1&n&&(e.TgZ(0,"page-content",7),e.ALo(1,"async"),e._UZ(2,"div",8),e.ALo(3,"trust"),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.data.document.name)("mobileHeading",t.data.document.name)("headingActions",e.lcZ(1,4,t.headingActions$)),e.xp6(2),e.Q6J("innerHTML",e.lcZ(3,6,t.result),e.oJD)}}let _o=(()=>{class n extends y.y{constructor(t,i,o){super(t),this.fieldsHelper=i,this.documentsService=o,this.step$=new oe.X(null),this.result$=new oe.X(null)}get result(){return this.result$.value}get step(){return this.step$.value}set step(t){this.step$.next(t)}ngOnInit(){super.ngOnInit(),this.documentId=this.route.snapshot.params.id,this.addSub(this.documentsService.getDataForDynamicDocument({id:this.documentId,user:f.S.SELF}).subscribe(i=>{this.data=i}))}onDataInitialized(t){this.formFields=t.formFields||[],this.form=this.fieldsHelper.customValuesFormGroup(this.formFields),this.formFields.length>0?this.step="form":this.process()}process(){!(0,m.pt)(this.form)||this.addSub(this.documentsService.processDynamicDocument({id:this.documentId,user:f.S.SELF,body:{formFields:this.form.value}}).subscribe(t=>{this.result$.next(t);const i=[];i.push(this.exportHelper.printAction()),i[0].maybeRoot=!0,this.headingActions=i,this.step="preview"}))}formControl(t){return this.form.get(t)}resolveMenu(){return this.menu.userMenu(null,v.v2.MY_DOCUMENTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ot.A),e.Y36(Be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["process-dynamic-document"]],features:[e.qOj],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading",4,"ngSwitchCase"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[3,"heading","mobileHeading"],[4,"ngFor","ngForOf"],[3,"disabled","label","action"],[3,"field","formControl","focused","labelPosition"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions"],[3,"innerHTML"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,uo,5,7,"page-content",1),e.YNc(4,po,4,8,"page-content",2),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,4,i.data$))("ngSwitch",e.lcZ(2,6,i.step$)),e.xp6(3),e.Q6J("ngSwitchCase","form"),e.xp6(1),e.Q6J("ngSwitchCase","preview"))},directives:[Z.w,d.RF,d.n9,E.Y,d.sg,ft.G,_.JJ,_.oH,tt.A,k.h,N.x],pipes:[d.Ov,ht.a],encapsulation:2,changeDetection:0}),n})();function go(n,a){1&n&&e._UZ(0,"div",5)}function mo(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",5)(2,"label-value",10),e._UZ(3,"user-link",11),e.qZA()(),e.YNc(4,go,1,0,"div",12),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function fo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).navigateToView(r),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.view),e.xp6(1),e.Q6J("icon",t.SvgIcon.Pencil)}}function ho(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).download(r),o.stopPropagation()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.download),e.xp6(1),e.Q6J("icon",t.SvgIcon.Download)}}function bo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,p=e.oxw(2);return p.router.navigate(p.process(r)),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.document.process),e.xp6(1),e.Q6J("icon",t.SvgIcon.FileEarmarkText)}}function xo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).remove(r),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function vo(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",13)(2,"div")(3,"label-value",14),e._uU(4),e.qZA(),e.TgZ(5,"label-value",14),e._uU(6),e.qZA()(),e.TgZ(7,"div",15),e.YNc(8,fo,2,2,"button",16),e.YNc(9,ho,2,2,"button",17),e.YNc(10,bo,2,2,"button",16),e.YNc(11,xo,2,2,"button",17),e.qZA()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.name),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("label",i.i18n.general.description),e.xp6(1),e.hij(" ",t.description," "),e.xp6(2),e.Q6J("ngIf",i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",!i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",i.isUserKind(t))}}function yo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).download(r),o.stopPropagation()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.download),e.xp6(1),e.Q6J("icon",t.SvgIcon.Download)}}function To(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit,p=e.oxw(3);return p.router.navigate(p.process(r)),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.document.process),e.xp6(1),e.Q6J("icon",t.SvgIcon.FileEarmarkText)}}function Ao(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).remove(r),o.stopPropagation(),o.preventDefault()}),e._UZ(1,"icon",19),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function Co(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",24),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(3);return C.isStatic(p.kind)?C.navigateToView(p):C.router.navigate(C.process(p)),o.stopPropagation(),o.preventDefault()}),e.TgZ(1,"td",25),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",26),e.YNc(6,yo,2,2,"button",16),e.YNc(7,To,2,2,"button",16),e.YNc(8,Ao,2,2,"button",27),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Q6J("ngIf",i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",!i.isStatic(t.kind)),e.xp6(1),e.Q6J("ngIf",i.data.canManageIndividual&&i.isUserKind(t))}}function wo(n,a){if(1&n&&(e.TgZ(0,"table",21)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e._UZ(6,"th",22),e.qZA(),e.TgZ(7,"tbody"),e.YNc(8,Co,9,5,"tr",23),e.ALo(9,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.name),e.xp6(2),e.Oqu(t.i18n.general.description),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(9,3,t.results$))?null:i.results)}}function Eo(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"div",3)(4,"div",4),e.YNc(5,mo,5,3,"ng-container",1),e.TgZ(6,"div",5),e._UZ(7,"input-field",6),e.qZA()()()(),e.TgZ(8,"results-layout",7),e.ALo(9,"async"),e.YNc(10,vo,12,8,"mobile-result",8),e.YNc(11,wo,10,5,"table",9),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.document.title.search)("mobileHeading",t.i18n.document.mobileTitle.search)("headingActions",e.lcZ(2,8,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",!t.authHelper.isSelf(t.data.user)),e.xp6(2),e.Q6J("label",t.i18n.general.keywords),e.xp6(1),e.Q6J("results",e.lcZ(9,10,t.results$))("rendering$",t.rendering$)}}let Zo=(()=>{class n extends xe.t{constructor(t,i){super(t),this.documentsService=i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.documentsService.getDocumentsDataForSearch({user:this.user}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.general.add,()=>this.router.navigate(["/users",this.user,"documents","new"]),!0)]}doSearch(t){return this.documentsService.searchDocuments$Response(t)}remove(t){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove(t)})}doRemove(t){this.addSub(this.documentsService.deleteDocument({id:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.update()}))}toSearchParams(t){return t}getFormControlNames(){return["brokers","categories","enabled","groups","keywords","range","user"]}isStatic(t){return t!==Se.DYNAMIC}download(t){t.file?this.addSub(this.documentsService.downloadDocumentFile$Response({id:t.id}).subscribe(m.M_)):this.notification.info(this.i18n.document.errorNoFile)}process(t){return["/users","documents","process-dynamic",t.id]}view(t){return["/users","documents","view",t.id]}isUserKind(t){return t.kind===Se.USER}navigateToView(t){this.router.navigate(this.view(t))}get toProcessLink(){return t=>this.process(t)}resolveMenu(){return this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-documents"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","keywords","fieldSize","full",3,"label"],["resultType","list",3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button","class","btn btn-icon mt-2",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],["type","button",1,"btn","btn-icon","mt-2",3,"tooltip","click"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"],["type","button","class","btn btn-icon ml-2",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon","ml-2",3,"tooltip","click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Eo,12,12,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,ge.q,_.JJ,_.u,V.D,j.E,K.t,ie.i9,ne.o,te.p,d.sg],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();function Io(n,a){if(1&n&&(e.TgZ(0,"label-value",8),e._UZ(1,"user-link",9),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user)}}function So(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.internalName),e.xp6(1),e.hij(" ",t.data.internalName," ")}}function Uo(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.description),e.xp6(1),e.hij(" ",t.data.description," ")}}function No(n,a){if(1&n&&(e.TgZ(0,"label-value",10),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.category),e.xp6(1),e.hij(" ",t.data.category.name," ")}}function ko(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.publiclyAccessible),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.data.publiclyAccessible)," ")}}function Oo(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.downloadUrl),e.xp6(1),e.hij(" ",t.data.downloadUrl," ")}}function Po(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.userVisible),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.data.userVisible)," ")}}function Qo(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.brokerVisible),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.data.brokerVisible)," ")}}function Jo(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.brokerManageable),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.data.brokerManageable)," ")}}function Do(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.document.document),e.xp6(1),e.hij(" ",t.data.file.name," ")}}function Fo(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Io,2,2,"label-value",4),e.TgZ(2,"label-value",5),e._uU(3),e.qZA(),e.YNc(4,So,2,2,"label-value",6),e.YNc(5,Uo,2,2,"label-value",6),e.YNc(6,No,2,2,"label-value",7),e.TgZ(7,"label-value",5),e._uU(8),e.qZA(),e.YNc(9,ko,2,2,"label-value",6),e.YNc(10,Oo,2,2,"label-value",6),e.YNc(11,Po,2,2,"label-value",6),e.YNc(12,Qo,2,2,"label-value",6),e.YNc(13,Jo,2,2,"label-value",6),e.YNc(14,Do,2,2,"label-value",6),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.general.name),e.xp6(1),e.hij(" ",t.data.name," "),e.xp6(1),e.Q6J("ngIf",!t.empty(t.data.internalName)),e.xp6(1),e.Q6J("ngIf",!t.empty(t.data.description)),e.xp6(1),e.Q6J("ngIf",t.data.category),e.xp6(1),e.Q6J("label",t.i18n.document.enable),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.data.enabled)," "),e.xp6(1),e.Q6J("ngIf",t.data.publiclyAccessible),e.xp6(1),e.Q6J("ngIf",t.data.downloadUrl),e.xp6(1),e.Q6J("ngIf",t.data.userVisible),e.xp6(1),e.Q6J("ngIf",t.data.brokerVisible),e.xp6(1),e.Q6J("ngIf",t.data.brokerVisible),e.xp6(1),e.Q6J("ngIf",t.data.file)}}function Ro(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().download()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.download)}}let qo=(()=>{class n extends y.y{constructor(t,i){super(t),this.documentsService=i,this.empty=m.cS}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.documentsService.viewDocument({id:this.id}).subscribe(t=>this.data=t))}onDataInitialized(t){if(super.onDataInitialized(t),this.dataForFrontendHolder.auth.role!==ee.g.BROKER||t.brokerManageable){const i=[new Q.Yu(F.l.Pencil,this.i18n.general.edit,()=>this.navigateToEdit(),!0)];i.push(new Q.Yu(F.l.Trash,this.i18n.general.remove,()=>this.remove(),!0)),this.headingActions=i}}remove(){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove()})}doRemove(){this.addSub(this.documentsService.deleteDocument({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.router.navigate(["/users",this.data.user.id,"documents","search"])}))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(m.M_))}navigateToEdit(){this.router.navigate(["/users","documents","edit",this.id])}resolveMenu(t){return t.kind===Se.USER&&this.authHelper.isSelf(t.user)?this.menu.userMenu(null,v.v2.MY_DOCUMENTS):this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Be))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-document"]],features:[e.qOj],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["ng","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["ng","",3,"label"],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.ALo(3,"async"),e.YNc(4,Fo,15,14,"ng-container",2),e.TgZ(5,"actions"),e.YNc(6,Ro,2,4,"action-button",3),e.qZA()()()),2&t&&(e.Q6J("ready",e.lcZ(1,6,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.document.title.view)("mobileHeading",i.i18n.document.mobileTitle.view)("headingActions",e.lcZ(3,8,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",i.data),e.xp6(2),e.Q6J("ngIf",i.data.file))},directives:[Z.w,E.Y,d.O5,Y.t,ae.F,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Ue=s(7947);const Mo=["field"],Lo=function(n,a){return{excludeContacts:n,excludedUsers:a}};let Pt=(()=>{class n extends Ue.H{constructor(t,i){super(t),this.modalRef=i,this.allowPrincipal=!1,this.allowSearch=!0,this.hideAfterSubmit=!0,this.done=new e.vpe,this.control=new _.NI(null,_.kI.required)}add(){(0,m.pt)(this.control)&&(this.done.emit(this.field.selection||this.control.value),this.hideAfterSubmit&&this.modalRef.hide())}clear(){this.control.reset(null,{emitEvent:!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.UZ))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pick-user-dialog"]],viewQuery:function(t,i){if(1&t&&e.Gf(Mo,7),2&t){let o;e.iGM(o=e.CRH())&&(i.field=o.first)}},inputs:{title:"title",label:"label",excludeContacts:"excludeContacts",excludedUsers:"excludedUsers",allowPrincipal:"allowPrincipal",allowSearch:"allowSearch",hideAfterSubmit:"hideAfterSubmit"},outputs:{done:"done"},features:[e.qOj],decls:8,vars:15,consts:[["required","","focused","",3,"filters","allowContacts","allowPrincipal","allowSearch","formControl","label"],["field",""],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e._UZ(2,"user-field",0,1),e.TgZ(4,"actions",2)(5,"action-button",3),e.NdJ("action",function(){return i.add()}),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"action-button",4),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()()),2&t&&(e.xp6(1),e.Oqu(i.title),e.xp6(1),e.Q6J("filters",e.WLB(12,Lo,i.excludeContacts,i.excludedUsers))("allowContacts",!1)("allowPrincipal",i.allowPrincipal)("allowSearch",i.allowSearch)("formControl",i.control)("label",i.label),e.xp6(3),e.Q6J("disabled",e.lcZ(6,10,i.requesting$))("label",i.i18n.general.submit),e.xp6(2),e.Q6J("label",i.i18n.general.cancel))},directives:[ve.l,_.Q7,tt.A,_.JJ,_.oH,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})(),Ge=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getPaymentFeedbacksDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetPaymentFeedbacksDataForSearchPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPaymentFeedbacksDataForSearch(t,i){return this.getPaymentFeedbacksDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchPaymentFeedbacks$Response(t,i){const o=new b.c(this.rootUrl,n.SearchPaymentFeedbacksPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("direction",t.direction,{}),o.query("levels",t.levels,{}),o.query("noReplied",t.noReplied,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("period",t.period,{}),o.query("relatedUser",t.relatedUser,{}),o.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchPaymentFeedbacks(t,i){return this.searchPaymentFeedbacks$Response(t,i).pipe((0,c.U)(o=>o.body))}getPaymentFeedbackStatistics$Response(t,i){const o=new b.c(this.rootUrl,n.GetPaymentFeedbackStatisticsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("direction",t.direction,{}),o.query("periods",t.periods,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPaymentFeedbackStatistics(t,i){return this.getPaymentFeedbackStatistics$Response(t,i).pipe((0,c.U)(o=>o.body))}getPaymentFeedbacksDataForGive$Response(t,i){const o=new b.c(this.rootUrl,n.GetPaymentFeedbacksDataForGivePath,"get");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPaymentFeedbacksDataForGive(t,i){return this.getPaymentFeedbacksDataForGive$Response(t,i).pipe((0,c.U)(o=>o.body))}givePaymentFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.GivePaymentFeedbackPath,"post");return t&&(o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}givePaymentFeedback(t,i){return this.givePaymentFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}getPaymentFeedbacksDataForReply$Response(t,i){const o=new b.c(this.rootUrl,n.GetPaymentFeedbacksDataForReplyPath,"get");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPaymentFeedbacksDataForReply(t,i){return this.getPaymentFeedbacksDataForReply$Response(t,i).pipe((0,c.U)(o=>o.body))}replyPaymentFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.ReplyPaymentFeedbackPath,"post");return t&&(o.path("key",t.key,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}replyPaymentFeedback(t,i){return this.replyPaymentFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}searchPaymentAwaitingFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.SearchPaymentAwaitingFeedbackPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("relatedUser",t.relatedUser,{}),o.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchPaymentAwaitingFeedback(t,i){return this.searchPaymentAwaitingFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}listPaymentFeedbackIgnoredUsers$Response(t,i){const o=new b.c(this.rootUrl,n.ListPaymentFeedbackIgnoredUsersPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}listPaymentFeedbackIgnoredUsers(t,i){return this.listPaymentFeedbackIgnoredUsers$Response(t,i).pipe((0,c.U)(o=>o.body))}addPaymentFeedbackIgnoredUser$Response(t,i){const o=new b.c(this.rootUrl,n.AddPaymentFeedbackIgnoredUserPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}addPaymentFeedbackIgnoredUser(t,i){return this.addPaymentFeedbackIgnoredUser$Response(t,i).pipe((0,c.U)(o=>o.body))}removePaymentFeedbackIgnoredUser$Response(t,i){const o=new b.c(this.rootUrl,n.RemovePaymentFeedbackIgnoredUserPath,"delete");return t&&(o.path("user",t.user,{}),o.path("ignored",t.ignored,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}removePaymentFeedbackIgnoredUser(t,i){return this.removePaymentFeedbackIgnoredUser$Response(t,i).pipe((0,c.U)(o=>o.body))}getPaymentFeedbackDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetPaymentFeedbackDataForEditPath,"get");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPaymentFeedbackDataForEdit(t,i){return this.getPaymentFeedbackDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}viewPaymentFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.ViewPaymentFeedbackPath,"get");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewPaymentFeedback(t,i){return this.viewPaymentFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}updatePaymentFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.UpdatePaymentFeedbackPath,"put");return t&&(o.path("key",t.key,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updatePaymentFeedback(t,i){return this.updatePaymentFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}removePaymentFeedback$Response(t,i){const o=new b.c(this.rootUrl,n.RemovePaymentFeedbackPath,"delete");return t&&o.path("key",t.key,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}removePaymentFeedback(t,i){return this.removePaymentFeedback$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetPaymentFeedbacksDataForSearchPath="/{user}/payment-feedbacks/data-for-search",n.SearchPaymentFeedbacksPath="/{user}/payment-feedbacks",n.GetPaymentFeedbackStatisticsPath="/{user}/payment-feedbacks/statistics",n.GetPaymentFeedbacksDataForGivePath="/payment-feedbacks/{key}/data-for-give",n.GivePaymentFeedbackPath="/payment-feedbacks/{key}/give",n.GetPaymentFeedbacksDataForReplyPath="/payment-feedbacks/{key}/data-for-reply",n.ReplyPaymentFeedbackPath="/payment-feedbacks/{key}/reply",n.SearchPaymentAwaitingFeedbackPath="/{user}/payments-awaiting-feedback",n.ListPaymentFeedbackIgnoredUsersPath="/{user}/payment-feedback-ignored-users",n.AddPaymentFeedbackIgnoredUserPath="/{user}/payment-feedback-ignored-users",n.RemovePaymentFeedbackIgnoredUserPath="/{user}/payment-feedback-ignored-users/{ignored}",n.GetPaymentFeedbackDataForEditPath="/payment-feedbacks/{key}/data-for-edit",n.ViewPaymentFeedbackPath="/payment-feedbacks/{key}",n.UpdatePaymentFeedbackPath="/payment-feedbacks/{key}",n.RemovePaymentFeedbackPath="/payment-feedbacks/{key}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Yo(n,a){if(1&n&&(e.TgZ(0,"mobile-result",6)(1,"div",7),e._uU(2),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",t.image)("avatarIcon",i.SvgIcon.Person),e.xp6(2),e.Oqu(t.display)}}function Bo(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr")(2,"td",9),e._UZ(3,"avatar",12),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",10)(7,"button",13),e.NdJ("click",function(o){const p=e.CHM(t).$implicit;return e.oxw(3).remove(p),o.stopPropagation()}),e._UZ(8,"icon",14),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",t.image)("icon",i.SvgIcon.PersonCircle),e.xp6(2),e.hij(" ",t.display," "),e.xp6(2),e.Q6J("tooltip",i.i18n.general.removeTooltip(t.display)),e.xp6(1),e.Q6J("icon",i.SvgIcon.Trash)}}function Go(n,a){if(1&n&&(e.TgZ(0,"table",8)(1,"thead"),e._UZ(2,"th",9),e.TgZ(3,"th"),e._uU(4),e.qZA(),e._UZ(5,"th",10),e.qZA(),e.TgZ(6,"tbody"),e.YNc(7,Bo,9,5,"ng-container",11),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.i18n.feedback.paymentFeedbackDisabledFor),e.xp6(3),e.Q6J("ngForOf",t.data)}}function $o(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"results-layout",3),e.YNc(4,Yo,3,3,"mobile-result",4),e.YNc(5,Go,8,2,"table",5),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.feedback.title.ignoredUsers)("mobileHeading",t.i18n.feedback.mobileTitle.ignoredUsers)("headingActions",e.lcZ(2,4,t.headingActions$)),e.xp6(2),e.Q6J("results",t.data)}}let Ho=(()=>{class n extends y.y{constructor(t,i,o){super(t),this.modal=i,this.feedbackService=o}ngOnInit(){super.ngOnInit(),this.addSub(this.feedbackService.listPaymentFeedbackIgnoredUsers({user:this.ApiHelper.SELF}).subscribe(t=>{this.data=t}))}onDataInitialized(){this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.feedback.addUserToIgnoreList,()=>this.add(),!0)]}remove(t){this.confirmation.confirm({message:this.i18n.general.removeConfirm(t.display),callback:()=>{this.addSub(this.feedbackService.removePaymentFeedbackIgnoredUser({ignored:t.id,user:this.ApiHelper.SELF}).subscribe(()=>{this.notification.snackBar(this.i18n.feedback.removeUser(t.display)),this.reload()}))}})}add(){const i=this.modal.show(Pt,{class:"modal-form",initialState:{excludeContacts:!1,title:this.i18n.feedback.addUserToIgnoreList,label:this.i18n.general.user}}).content;this.addSub(i.done.subscribe(o=>{this.addSub(this.feedbackService.addPaymentFeedbackIgnoredUser({user:this.ApiHelper.SELF,body:o.id}).subscribe(()=>{this.notification.snackBar(this.i18n.feedback.addIgnoredUserDone(o.display)),this.reload()}))}))}resolveMenu(){return v.v2.FEEDBACKS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.tT),e.Y36(Ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-feedback-ignored-users"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","empty",3,"heading","mobileHeading","headingActions"],[3,"results"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover table-no-header cursor-pointer",4,"resultTable"],[3,"avatarImage","avatarIcon"],[1,"cell-main"],[1,"table","table-hover","table-no-header","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"image","icon"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,$o,6,6,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,V.D,j.E,K.t,te.p,d.sg,Ae.A,ie.i9,ne.o],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var we=(()=>{return(n=we||(we={})).GIVEN="given",n.RECEIVED="received",we;var n})(),me=s(7901),Qt=s(6890),nt=s(538),it=s(5739),ot=s(471);function Vo(n,a){1&n&&e._UZ(0,"div",10)}function jo(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",10)(2,"label-value",11),e._UZ(3,"user-link",12),e.qZA()(),e.YNc(4,Vo,1,0,"div",13),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function zo(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",10)(2,"radio-group-field",14),e._UZ(3,"field-option",15)(4,"field-option",15),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.reference.direction.direction),e.xp6(1),e.Q6J("value",t.ReferenceDirectionEnum.GIVEN)("text",t.i18n.reference.direction.given),e.xp6(1),e.Q6J("value",t.ReferenceDirectionEnum.RECEIVED)("text",t.i18n.reference.direction.received)}}function Xo(n,a){1&n&&e.GkF(0)}function Ko(n,a){1&n&&e.GkF(0)}const Jt=function(n,a){return{count:n,total:a}};function Wo(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"rating-stats",23),e.qZA(),e.TgZ(3,"td",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).filter(r.level,!0)}),e.YNc(4,Xo,1,0,"ng-container",24),e.qZA(),e.TgZ(5,"td",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).filter(r.level)}),e.YNc(6,Ko,1,0,"ng-container",24),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3),o=e.MAs(4);e.xp6(2),e.Q6J("level",t.level)("textLeft",t.text),e.xp6(2),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(6,Jt,null==i.allTime?null:i.allTime.counts[t.level],null==i.allTime?null:i.allTime.total)),e.xp6(2),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(9,Jt,null==i.last30Days?null:i.last30Days.counts[t.level],null==i.last30Days?null:i.last30Days.total))}}function ea(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",16)(1,"table",17)(2,"thead")(3,"th",18),e._uU(4),e.qZA(),e.TgZ(5,"th",19),e._uU(6),e.qZA(),e.TgZ(7,"th",19),e._uU(8),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,Wo,7,12,"tr",20),e.TgZ(11,"tr")(12,"td",21),e._uU(13),e.qZA(),e.TgZ(14,"td",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).filter(null,!0)}),e._uU(15),e.qZA(),e.TgZ(16,"td",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).filter()}),e._uU(17),e.qZA()(),e.TgZ(18,"tr")(19,"td",21),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"percent"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"percent"),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.i18n.reference.value),e.xp6(2),e.hij("",t.i18n.reference.allTime," "),e.xp6(2),e.hij("",t.i18n.reference.last30Days," "),e.xp6(2),e.Q6J("ngForOf",t.levels),e.xp6(3),e.Oqu(t.i18n.reference.total),e.xp6(2),e.hij(" ",null==t.allTime?null:t.allTime.total," "),e.xp6(2),e.hij(" ",null==t.last30Days?null:t.last30Days.total,""),e.xp6(3),e.hij(" ",t.i18n.reference.percentagePositive,""),e.xp6(2),e.hij(" ",e.lcZ(23,10,(null==t.allTime?null:t.allTime.totalPositive)/(null==t.allTime?null:t.allTime.total)||0)," "),e.xp6(3),e.hij(" ",e.lcZ(26,12,(null==t.last30Days?null:t.last30Days.totalPositive)/(null==t.last30Days?null:t.last30Days.total)||0)," ")}}function ta(n,a){if(1&n&&(e.TgZ(0,"mobile-result",25)(1,"div",26)(2,"div")(3,"div",27),e._uU(4),e.qZA(),e.TgZ(5,"div",28),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.TgZ(8,"div",29),e._UZ(9,"rating-stats",30),e.qZA()()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",t.relatedUser.image)("avatarIcon",i.SvgIcon.Person),e.xp6(4),e.hij(" ",t.relatedUser.display," "),e.xp6(2),e.hij(" ",e.lcZ(7,5,t.date)," "),e.xp6(3),e.Q6J("level",t.level)}}function na(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).remove(o)}),e._UZ(1,"icon",38),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function ia(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",34),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.router.navigate(p.path(r))}),e.TgZ(2,"td"),e._uU(3),e.ALo(4,"dateTime"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"rating-stats",30),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td",35),e.YNc(12,na,2,2,"button",36),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,5,t.date)),e.xp6(3),e.Oqu(t.relatedUser.display),e.xp6(2),e.Q6J("level",t.level),e.xp6(2),e.hij(" ",t.comments," "),e.xp6(2),e.Q6J("ngIf",i.data.manage)}}function oa(n,a){if(1&n&&(e.TgZ(0,"table",31)(1,"thead")(2,"th",32),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e._UZ(10,"th",33),e.qZA(),e.TgZ(11,"tbody"),e.YNc(12,ia,13,7,"ng-container",20),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.name),e.xp6(2),e.Oqu(t.i18n.reference.level.level),e.xp6(2),e.Oqu(t.i18n.general.description),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(13,5,t.results$))?null:i.results)}}function aa(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",3),e.ALo(2,"async"),e.TgZ(3,"div",4)(4,"div",5),e.YNc(5,jo,5,3,"ng-container",1),e.YNc(6,zo,5,5,"ng-container",1),e.qZA()()(),e.YNc(7,ea,27,14,"page-content",6),e.ALo(8,"async"),e.ALo(9,"async"),e.TgZ(10,"results-layout",7),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(11,"async"),e.YNc(12,ta,10,7,"mobile-result",8),e.YNc(13,oa,14,7,"table",9),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode",t.userFilter||t.directionsFilter?"filters":"emptyFilters")("heading",t.resolveHeading())("mobileHeading",t.resolveHeading(!0))("headingActions",e.lcZ(2,11,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.userFilter),e.xp6(1),e.Q6J("ngIf",t.directionsFilter),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,13,t.layout.gtsm$)&&e.lcZ(9,15,t.stats$)),e.xp6(3),e.Q6J("results",e.lcZ(11,17,t.results$))("rendering$",t.rendering$)("toLink",t.toLink)}}const ra=function(n){return{width:n}};function sa(n,a){if(1&n&&(e.TgZ(0,"div",42),e._uU(1," \xa0"),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngStyle",e.VKq(1,ra,t.count/t.total*190+"px"))}}const ca=function(n){return{"pl-2":n}};function la(n,a){if(1&n&&(e.TgZ(0,"div",39),e.YNc(1,sa,2,3,"div",40),e.TgZ(2,"span",41),e._uU(3),e.qZA()()),2&n){const t=a.count;e.xp6(1),e.Q6J("ngIf",t>0),e.xp6(1),e.Q6J("ngClass",e.VKq(3,ca,t>0)),e.xp6(1),e.Oqu(t)}}let ua=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.referenceHelper=i,this.feedbacksService=o,this.ReferenceDirectionEnum=we,this.stats$=new oe.X(null)}getFormControlNames(){return["direction","levels","period"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.feedbacksService.getPaymentFeedbacksDataForSearch({user:this.param}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),this.isOwner&&this.dataForFrontendHolder.auth.permissions.paymentFeedbacks.give&&(this.headingActions=[new Q.Yu(F.l.Clock,this.i18n.feedback.viewAwaitingFeedback,()=>{this.router.navigate(["/users","feedbacks","search-awaiting"])},!0),new Q.Yu(F.l.Gear,this.i18n.feedback.settings,()=>{this.router.navigate(["/users","feedbacks","settings"])},!0)]),this.levels=[{level:me.U.VERY_GOOD,text:this.i18n.reference.level.veryGood},{level:me.U.GOOD,text:this.i18n.reference.level.good},{level:me.U.NEUTRAL,text:this.i18n.reference.level.neutral},{level:me.U.BAD,text:this.i18n.reference.level.bad},{level:me.U.VERY_BAD,text:this.i18n.reference.level.veryBad}],this.searchStatistics(),this.addSub(this.form.controls.direction.valueChanges.subscribe(()=>this.searchStatistics()))}searchStatistics(){this.addSub(this.feedbacksService.getPaymentFeedbackStatistics({user:this.param,direction:this.form.controls.direction.value}).subscribe(t=>this.stats=t))}toSearchParams(t){return t.user=this.param,t}doSearch(t){return this.feedbacksService.searchPaymentFeedbacks$Response(t)}filter(t,i){this.form.patchValue({levels:t?[t]:null,period:i?null:[this.dataForFrontendHolder.now().clone().subtract(30,"day").startOf("day").format(Qt.m),null]})}get toLink(){return t=>this.path(t)}get stats(){return this.stats$.value}set stats(t){this.stats$.next(t),this.allTime=t.periods.filter(i=>null==i.period)[0],this.last30Days=t.periods.filter(i=>null!=i.period)[0]}remove(t){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.feedbacksService.removePaymentFeedback({key:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}path(t){return["/users","feedbacks","view",t.id]}resolveMenu(t){return this.isOwner?v.v2.FEEDBACKS:this.menu.searchUsersMenu(t.user)}resolveHeading(t=!1){var i,o,r;const p=1===(null===(i=this.data.directions)||void 0===i?void 0:i.length),C=p&&(null===(o=this.data.directions)||void 0===o?void 0:o.includes(we.GIVEN)),I=p&&(null===(r=this.data.directions)||void 0===r?void 0:r.includes(we.RECEIVED));return C?t?this.i18n.feedback.mobileTitle.searchGiven:this.i18n.feedback.title.searchGiven:I?t?this.i18n.feedback.mobileTitle.searchReceived:this.i18n.feedback.title.searchReceived:t?this.i18n.feedback.mobileTitle.search:this.i18n.feedback.title.search}get userFilter(){return this.data.user&&!this.isOwner}get directionsFilter(){var t;return 2===(null===(t=this.data.directions)||void 0===t?void 0:t.length)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(nt.o),e.Y36(Ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-feedbacks"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["columnData",""],[3,"mode","heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["mode","table",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["formControlName","direction",3,"label"],[3,"value","text"],["mode","table"],[1,"table","table-hover","small-height"],["width","40%"],["width","30%"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"],[1,"link","link-undecorated",3,"click"],[1,"w-100","pr-3",3,"level","textLeft"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[3,"level"],[1,"table","table-hover","cursor-pointer"],["width","23%"],[1,"actions"],[3,"click"],[1,"actions","actions-multiple"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"stats"],["class","bar",3,"ngStyle",4,"ngIf"],[1,"count",3,"ngClass"],[1,"bar",3,"ngStyle"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,aa,14,19,"ng-container",1),e.qZA(),e.YNc(3,la,4,5,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,it.Y,_.JJ,_.u,W.s,d.sg,ot.m,d.tP,V.D,j.E,K.t,te.p,ie.i9,ne.o,d.PC,d.mk],pipes:[d.Ov,d.Zx,_e.i],encapsulation:2,changeDetection:0}),n})();var pa=s(9376),bt=s(2180);function da(n,a){if(1&n&&e._UZ(0,"mobile-result",6),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("title",t.relatedUser.display)("avatarImage",t.relatedUser.image)("avatarIcon",i.SvgIcon.Person)("date",t.date)("amount",t.amount)("currency",i.findCurrency(t.currency))}}function _a(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",11),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.router.navigate(p.path(r))}),e.TgZ(2,"td",8),e._UZ(3,"avatar",12),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"dateTime"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"currency"),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("image",null==t.related||null==t.related.user?null:t.related.user.image)("icon",i.SvgIcon.PersonCircle),e.xp6(2),e.Oqu(e.lcZ(6,6,t.date)),e.xp6(3),e.Oqu(null==t.related||null==t.related.user?null:t.related.user.display),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(e.xi3(13,8,t.amount,i.findCurrency(t.currency)))}}function ga(n,a){if(1&n&&(e.TgZ(0,"table",7)(1,"thead"),e._UZ(2,"th",8),e.TgZ(3,"th",9),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA()(),e.TgZ(11,"tbody"),e.YNc(12,_a,14,11,"ng-container",10),e.ALo(13,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.transaction.to),e.xp6(2),e.Oqu(t.i18n.general.description),e.xp6(2),e.Oqu(t.i18n.transaction.amount),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(13,5,t.results$))?null:i.results)}}function ma(n,a){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"results-layout",3),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(4,"async"),e.YNc(5,da,1,6,"mobile-result",4),e.YNc(6,ga,14,7,"table",5),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.feedback.title.searchAwaiting)("mobileHeading",t.i18n.feedback.mobileTitle.searchAwaiting)("headingActions",e.lcZ(2,6,t.headingActions$)),e.xp6(2),e.Q6J("results",e.lcZ(4,8,t.results$))("rendering$",t.rendering$)("toLink",t.toLink)}}let fa=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.feedbacksService=i,this.accountsApi=o}ngOnInit(){super.ngOnInit(),this.addSub(this.accountsApi.listAccountsByOwner({owner:this.ApiHelper.SELF}).subscribe(t=>{this.currencies=[...new Set(t.map(i=>i.currency))],this.data={}}))}getFormControlNames(){return[]}toSearchParams(t){return t.user=this.ApiHelper.SELF,t}get toLink(){return t=>this.path(t)}path(t){return["/users","feedbacks","set",t.id]}findCurrency(t){return this.currencies.find(i=>i.id===t||i.internalName===t)}doSearch(t){return this.feedbacksService.searchPaymentAwaitingFeedback$Response(t)}resolveMenu(){return v.v2.FEEDBACKS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ge),e.Y36(pa.i))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-payment-awaiting-feedback"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"title","avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"title","avatarImage","avatarIcon","date","amount","currency"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","23%"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,ma,7,10,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,V.D,j.E,K.t,te.p,d.sg,Ae.A],pipes:[d.Ov,_e.i,bt.H],encapsulation:2,changeDetection:0}),n})();function ha(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.reference.from),e.xp6(1),e.Q6J("user",t.from)}}function ba(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.reference.to),e.xp6(1),e.Q6J("user",t.to)}}function xa(n,a){if(1&n&&e._UZ(0,"textarea-field",14),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.feedback.reply)}}function va(n,a){if(1&n&&e._UZ(0,"textarea-field",15),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.feedback.administrationComment)}}function ya(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.ynx(3,3),e.YNc(4,ha,2,2,"label-value",4),e.YNc(5,ba,2,2,"label-value",4),e.TgZ(6,"single-selection-field",5),e._UZ(7,"field-option",6)(8,"field-option",6)(9,"field-option",6)(10,"field-option",6)(11,"field-option",6),e.qZA(),e._UZ(12,"textarea-field",7),e.YNc(13,xa,1,1,"textarea-field",8),e.YNc(14,va,1,1,"textarea-field",9),e.BQk(),e.TgZ(15,"actions",10)(16,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(17,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.create?t.i18n.feedback.title.set:t.i18n.feedback.title.edit)("mobileHeading",t.create?t.i18n.reference.mobileTitle.set:t.i18n.reference.title.edit)("headingActions",e.lcZ(2,23,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.from),e.xp6(1),e.Q6J("ngIf",t.to),e.xp6(1),e.Q6J("label",t.i18n.reference.level.level),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.VERY_BAD)("text",t.i18n.reference.level.veryBad),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.BAD)("text",t.i18n.reference.level.bad),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.NEUTRAL)("text",t.i18n.reference.level.neutral),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.GOOD)("text",t.i18n.reference.level.good),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.VERY_GOOD)("text",t.i18n.reference.level.veryGood),e.xp6(1),e.Q6J("formControlName",t.dataForEdit?"giveComments":"comments")("label",t.i18n.general.comments),e.xp6(1),e.Q6J("ngIf",t.dataForEdit),e.xp6(1),e.Q6J("ngIf",t.dataForEdit),e.xp6(2),e.Q6J("disabled",e.lcZ(17,25,t.requesting$))("label",t.i18n.general.submit)}}let Dt=(()=>{class n extends y.y{constructor(t,i){super(t),this.feedbackService=i,this.ReferenceLevelEnum=me.U}ngOnInit(){super.ngOnInit(),this.transactionId=this.route.snapshot.params.transactionId,this.id=this.route.snapshot.params.id,this.id?this.getData():(this.create=!0,this.getDataForGive())}getDataForGive(){this.feedbackService.getPaymentFeedbacksDataForGive({key:this.transactionId?this.transactionId:this.id}).subscribe(t=>{this.dataForGive=t,this.data={}})}getData(){this.feedbackService.viewPaymentFeedback({key:this.id}).subscribe(t=>{this.dataForView=t,this.dataForView.canGive?this.getDataForGive():t.canEdit?this.getDataForEdit():this.data={}})}getDataForEdit(){this.feedbackService.getPaymentFeedbackDataForEdit({key:this.id}).subscribe(t=>{this.dataForEdit=t,this.data={}})}onDataInitialized(){this.form=this.formBuilder.group({level:[this.level,_.kI.required],comments:[this.comments,_.kI.required],giveComments:[this.comments,_.kI.required],replyComments:this.dataForEdit?this.dataForEdit.feedback.replyComments:null,managerComments:this.dataForEdit?this.dataForEdit.feedback.managerComments:null,version:this.dataForEdit?this.dataForEdit.feedback.version:null})}get level(){return this.dataForGive?this.dataForGive.feedback.level:this.dataForEdit?this.dataForEdit.feedback.level:null}get comments(){return this.dataForEdit?this.dataForEdit.feedback.giveComments:this.dataForGive?this.dataForGive.feedback.comments:null}get from(){return this.create&&this.dataForGive.transaction?this.dataForGive.transaction.from.user:this.dataForView.from}get to(){return this.create&&this.dataForGive.transaction?this.dataForGive.transaction.to.user:this.dataForView.to}save(){const t=this.form.value,i=this.dataForGive?this.feedbackService.givePaymentFeedback({body:t,key:this.id?this.id:this.transactionId}):this.feedbackService.updatePaymentFeedback({key:this.id,body:t});this.addSub(i.subscribe(()=>{this.notification.snackBar(this.i18n.feedback.feedbackSet),history.back()}))}resolveMenu(){return this.dataForGive?v.v2.FEEDBACKS:this.menu.userMenu(this.dataForView.from,v.v2.FEEDBACKS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ge))},n.\u0275cmp=e.Xpm({type:n,selectors:[["set-feedback"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","level","required","",3,"label"],[3,"value","text"],["required","",3,"formControlName","label"],["formControlName","replyComments","required","",3,"label",4,"ngIf"],["formControlName","managerComments","required","",3,"label",4,"ngIf"],["forceRow",""],[3,"disabled","label","action"],[3,"label"],[3,"user"],["formControlName","replyComments","required","",3,"label"],["formControlName","managerComments","required","",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,ya,18,27,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,ue.f,_.JJ,_.u,_.Q7,W.s,Fe.u,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var $e=s(7610),Ta=s(2525);const Aa=function(n){return{"mt-4":n}};function Ca(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"notification",7),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(2,Aa,!t.layout.ltmd)),e.xp6(2),e.hij(" ",t.deadline," ")}}function wa(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.general.description),e.xp6(1),e.hij(" ",t.data.transaction.description," ")}}function Ea(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",8),e._uU(2),e.qZA(),e.TgZ(3,"label-value",4),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.TgZ(6,"label-value",4),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"label-value",4),e._UZ(10,"user-link",9),e.qZA(),e.TgZ(11,"label-value",4),e._UZ(12,"user-link",9),e.qZA(),e.YNc(13,wa,2,2,"label-value",10),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij("",t.i18n.transaction.transferkind.payment," "),e.xp6(1),e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,10,t.data.transaction.date)," "),e.xp6(2),e.Q6J("label",t.i18n.transaction.amount),e.xp6(1),e.hij(" ",e.xi3(8,12,t.data.transaction.amount,t.data.transaction.currency)," "),e.xp6(2),e.Q6J("label",t.i18n.transaction.from),e.xp6(1),e.Q6J("user",t.data.from),e.xp6(1),e.Q6J("label",t.i18n.transaction.to),e.xp6(1),e.Q6J("user",t.data.to),e.xp6(1),e.Q6J("ngIf",t.data.transaction.description)}}function Za(n,a){if(1&n&&(e.TgZ(0,"label-value",4),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.replyCommentsDate)," ")}}function Ia(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,Za,3,4,"label-value",10),e.TgZ(4,"label-value",4),e._uU(5),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.feedback.sellerReply),e.xp6(1),e.Q6J("ngIf",t.data.replyCommentsDate),e.xp6(1),e.Q6J("label",t.i18n.feedback.reply),e.xp6(1),e.hij(" ",t.data.replyComments," ")}}function Sa(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"label-value",4),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.TgZ(6,"label-value",4),e._uU(7),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.feedback.administrationComment),e.xp6(1),e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,5,t.data.managerCommentsDate)," "),e.xp6(2),e.Q6J("label",t.i18n.general.comments),e.xp6(1),e.hij(" ",t.data.managerComments," ")}}function Ua(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Ca,3,4,"div",2),e.ALo(2,"async"),e.TgZ(3,"page-content",3),e.ALo(4,"async"),e.YNc(5,Ea,14,15,"ng-container",1),e.TgZ(6,"h2"),e._uU(7),e.qZA(),e.TgZ(8,"label-value",4),e._uU(9),e.ALo(10,"dateTime"),e.qZA(),e.TgZ(11,"label-value",4),e._UZ(12,"rating-stats",5),e.qZA(),e.TgZ(13,"label-value",4),e._uU(14),e.qZA(),e.YNc(15,Ia,6,4,"ng-container",1),e.YNc(16,Sa,8,7,"ng-container",1),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,14,t.deadline$)),e.xp6(2),e.Q6J("heading",t.i18n.feedback.title.view)("mobileHeading",t.i18n.feedback.mobileTitle.view)("headingActions",e.lcZ(4,16,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.data.transaction),e.xp6(2),e.Oqu(t.i18n.feedback.buyerFeedback),e.xp6(1),e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(10,18,t.data.date)," "),e.xp6(2),e.Q6J("label",t.i18n.reference.level.level),e.xp6(1),e.Q6J("level",t.data.level),e.xp6(1),e.Q6J("label",t.i18n.general.comments),e.xp6(1),e.hij(" ",t.data.comments," "),e.xp6(1),e.Q6J("ngIf",t.data.replyComments),e.xp6(1),e.Q6J("ngIf",t.data.managerComments)}}let Na=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.feedbackService=i,this.referenceHelper=o,this.deadline$=new oe.X(null)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.feedbackService.viewPaymentFeedback({key:this.id}).subscribe(t=>this.data=t))}onDataInitialized(t){this.self=this.authHelper.isSelfOrOwner(t.from)||this.authHelper.isSelfOrOwner(t.to);const i=[];(t.canEdit||t.canGive)&&(i.push(new Q.Yu(F.l.Pencil,this.i18n.general.edit,()=>this.router.navigate(["/users","feedbacks","edit",this.id]),!0)),t.canEdit&&i.push(new Q.Yu(F.l.Trash,this.i18n.general.remove,()=>this.confirmation.confirm({message:this.i18n.feedback.removeConfirm,callback:()=>this.doRemove(t.id)}))),t.canGive&&this.addSub(this.feedbackService.getPaymentFeedbacksDataForGive({key:this.id,fields:["deadline"]}).subscribe(o=>{const r=this.format.formatAsDateTime(o.deadline);this.deadline=t.comments?this.i18n.feedback.daysToChangeFeedbackComment(r):this.i18n.feedback.daysToGiveFeedbackComment(r)}))),t.canReply&&(i.push(new Q.Yu(F.l.Reply,this.i18n.feedback.reply,()=>this.reply(t.id))),this.addSub(this.feedbackService.getPaymentFeedbacksDataForReply({key:this.id,fields:["deadline"]}).subscribe(o=>{const r=this.format.formatAsDateTime(o.deadline);this.deadline=r?this.i18n.feedback.daysToReplyFeedbackComment(r):this.i18n.feedback.daysToReplyFeedbackCommentUnlimited}))),this.headingActions=i}reply(t){const i=[];i.push({internalName:"replyComments",name:this.i18n.feedback.reply,type:$e.L.TEXT}),this.confirmation.confirm({title:this.i18n.feedback.sellerReply,labelPosition:"above",customFields:i,callback:o=>{this.addSub(this.feedbackService.replyPaymentFeedback({key:t,body:o.customValues.replyComments}).subscribe(()=>{this.notification.snackBar(this.i18n.feedback.feedbackReplied),this.reload()}))}})}doRemove(t){this.addSub(this.feedbackService.removePaymentFeedback({key:t}).subscribe(()=>{this.notification.snackBar(this.i18n.feedback.removeDone),history.back()}))}get deadline(){return this.deadline$.value}set deadline(t){this.deadline$.next(t)}resolveMenu(){return this.self?v.v2.FEEDBACKS:this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ge),e.Y36(nt.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-feedback"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["class","notifications",3,"ngClass",4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label"],[3,"level"],[1,"notifications",3,"ngClass"],["type","info"],[1,"pt-0","border-0"],[3,"user"],[3,"label",4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ua,17,20,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,d.mk,Ta.c,E.Y,Y.t,ae.F,ot.m],pipes:[d.Ov,_e.i,bt.H],encapsulation:2,changeDetection:0}),n})(),Ft=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getGroupMembershipData$Response(t,i){const o=new b.c(this.rootUrl,n.GetGroupMembershipDataPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getGroupMembershipData(t,i){return this.getGroupMembershipData$Response(t,i).pipe((0,c.U)(o=>o.body))}changeGroupMembership$Response(t,i){const o=new b.c(this.rootUrl,n.ChangeGroupMembershipPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changeGroupMembership(t,i){return this.changeGroupMembership$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetGroupMembershipDataPath="/{user}/group",n.ChangeGroupMembershipPath="/{user}/group",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ka(n,a){1&n&&e.GkF(0)}function Oa(n,a){if(1&n&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.AsE(" ",i.i18n.general.performedBy,": ",t.by.display," ")}}function Pa(n,a){if(1&n&&(e.TgZ(0,"mobile-result",8)(1,"div",9),e._uU(2),e.qZA(),e.YNc(3,Oa,2,2,"div",10),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",null==t.period?null:t.period.date),e.xp6(2),e.AsE(" ",i.i18n.user.group,": ",t.group?t.group.name:i.i18n.user.operatorNoGroup," "),e.xp6(1),e.Q6J("ngIf",t.by)}}function Qa(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,3,null==t.period?null:t.period.begin)),e.xp6(3),e.hij("",t.group?t.group.name:i.i18n.user.operatorNoGroup," "),e.xp6(2),e.Oqu(null==t.by?null:t.by.display)}}function Ja(n,a){if(1&n&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA()(),e.TgZ(8,"tbody"),e.YNc(9,Qa,8,5,"tr",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function Da(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e._UZ(1,"user-info",4),e.qZA(),e.TgZ(2,"results-layout",5),e.YNc(3,Pa,4,4,"mobile-result",6),e.YNc(4,Ja,10,4,"table",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.operator?t.i18n.groupMembership.title.historyOperator:t.i18n.groupMembership.title.historyUser)("mobileHeading",t.operator?t.i18n.groupMembership.mobileTitle.historyOperator:t.i18n.groupMembership.mobileTitle.historyUser),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)}}let Fa=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.groupMembershipService=i,this.userHelper=o}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["user","history"]}).subscribe(t=>{this.data=t}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ft),e.Y36(le.T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-user-group-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,ka,1,0,"ng-container",1),e.qZA(),e.YNc(3,Da,5,4,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})();function Ra(n,a){if(1&n&&e._UZ(0,"field-option",11),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("id",t.id)("internalName",t.internalName)("text",t.name)}}function qa(n,a){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"hr"),e.ynx(2,6),e.TgZ(3,"single-selection-field",7),e.YNc(4,Ra,1,4,"field-option",8),e.qZA(),e._UZ(5,"textarea-field",9),e.BQk(),e.TgZ(6,"actions")(7,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).save()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.groupMembership.new)("required",!t.allowEmptyGroup)("emptyOption",t.allowEmptyGroup?t.i18n.user.operatorNoGroup:null),e.xp6(1),e.Q6J("ngForOf",t.data.possibleNewGroups),e.xp6(1),e.Q6J("label",t.i18n.general.comments),e.xp6(2),e.Q6J("label",t.i18n.general.submit)}}function Ma(n,a){if(1&n&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e._UZ(2,"user-info",3),e.TgZ(3,"label-value",4),e._uU(4),e.qZA(),e.YNc(5,qa,8,7,"ng-container",5),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.operator?t.i18n.groupMembership.title.groupOperator:t.i18n.groupMembership.title.groupUser)("mobileHeading",t.operator?t.i18n.groupMembership.mobileTitle.groupOperator:t.i18n.groupMembership.mobileTitle.groupUser)("headingActions",e.lcZ(1,7,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.groupMembership.current),e.xp6(1),e.hij(" ",t.data.group?t.data.group.name:t.i18n.user.operatorNoGroup," "),e.xp6(1),e.Q6J("ngIf",t.editable)}}let La=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.userHelper=i,this.groupMembershipService=o}get editable(){return!(0,m.cS)(this.data.possibleNewGroups)}get operator(){return this.userHelper.isOperator(this.data.user)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["-history"]}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.allowEmptyGroup=this.userHelper.isOperator(t.user)&&!!t.group,this.form=this.formBuilder.group({group:this.allowEmptyGroup?null:[null,_.kI.required],comment:null}),this.headingActions=[new Q.Yu(F.l.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"group","history"]),!0)]}save(){if(!(0,m.pt)(this.form))return;const t=this.data.possibleNewGroups.find(p=>p.id===this.form.value.group);let o,r;o=this.userHelper.isOperator(this.data.user)?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,r=t?this.i18n.groupMembership.confirm({user:this.data.user.display,group:t?t.name:this.i18n.user.operatorNoGroup}):this.i18n.groupMembership.confirmAliasOperator(this.data.user.display),this.confirmation.confirm({title:o,message:r,callback:()=>this.submit()})}submit(){this.addSub(this.groupMembershipService.changeGroupMembership({user:this.param,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.operator?this.i18n.groupMembership.doneOperator:this.i18n.groupMembership.doneUser),this.reload()}))}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(Ft))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-user-group"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","group",3,"label","required","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","id","internalName","text"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ma,6,9,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,Y.t,_.JL,_.sg,ue.f,_.JJ,_.u,_.Q7,d.sg,W.s,Fe.u,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var He=(()=>{return(n=He||(He={})).DISABLED="disabled",n.LINKED="linked",n.NOT_LINKED="notLinked",He;var n})(),Ya=s(6888);function Ba(n,a){1&n&&e.GkF(0)}function Ga(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",7)(2,"hr"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("user",t.data.user)}}function $a(n,a){1&n&&e._UZ(0,"hr",18)}function Ha(n,a){if(1&n&&e._UZ(0,"avatar",19),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("size",64)("image",t.identityProvider.image)("icon",i.SvgIcon.PersonBadge)}}function Va(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.i18n.identityProvider.connectedOn(e.lcZ(2,1,t.linkDate))," ")}}function ja(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.i18n.identityProvider.disconnected," ")}}function za(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Xa(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.email," ")}}const Ka=function(n){return{"mb-3":n}};function Wa(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",20),e.NdJ("action",function(){return e.CHM(t).$implicit.onClick()}),e.qZA()}if(2&n){const t=a.$implicit;e.Q6J("ngClass",e.VKq(2,Ka,!a.last))("label",t.label)}}const er=function(n){return{"mt-0":n}};function tr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,$a,1,0,"hr",9),e.TgZ(2,"div",10)(3,"div",11),e.YNc(4,Ha,1,3,"avatar",12),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"div",13)(7,"h2",14),e._uU(8),e.qZA(),e.TgZ(9,"div",15),e.YNc(10,Va,3,3,"div",5),e.YNc(11,ja,2,1,"div",5),e.YNc(12,za,2,1,"div",5),e.YNc(13,Xa,2,1,"div",5),e.qZA()(),e.TgZ(14,"div",16),e.YNc(15,Wa,1,4,"action-button",17),e.qZA()(),e.BQk()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!i),e.xp6(3),e.Q6J("ngIf",e.lcZ(5,9,o.layout.gtxxs$)),e.xp6(3),e.Q6J("ngClass",e.VKq(11,er,i)),e.xp6(1),e.hij(" ",t.identityProvider.name,""),e.xp6(2),e.Q6J("ngIf",t.linkDate),e.xp6(1),e.Q6J("ngIf","linked"!==t.status),e.xp6(1),e.Q6J("ngIf",t.name),e.xp6(1),e.Q6J("ngIf",t.email),e.xp6(2),e.Q6J("ngForOf",o.actions(t))}}function nr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,tr,16,13,"ng-container",8),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.data.identityProviders)}}function ir(n,a){if(1&n&&(e.TgZ(0,"page-content",4),e.YNc(1,Ga,3,1,"ng-container",5),e.YNc(2,nr,2,1,"ng-container",6),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(6);e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle),e.xp6(1),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(1),e.Q6J("ngIf",t.data.identityProviders.length>0)("ngIfElse",i)}}function or(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.hij(" ",t.i18n.identityProvider.noResults,"\n")}}let ar=(()=>{class n extends y.y{constructor(t,i){super(t),this.identityProvidersService=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.identityProvidersService.getUserIdentityProvidersListData({user:this.param}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user),this.title=this.self?this.i18n.identityProvider.title.manageSelf:this.i18n.identityProvider.title.manageUser,this.mobileTitle=this.self?this.i18n.identityProvider.mobileTitle.manageSelf:this.i18n.identityProvider.mobileTitle.manageUser}actions(t){const i=[];return t.status!==He.LINKED&&this.data.canLink&&i.push(new Q.aU(this.i18n.identityProvider.action.connect,()=>{this.connect(t)})),t.status===He.LINKED&&this.data.canEdit&&i.push(new Q.aU(this.i18n.identityProvider.action.disconnect,()=>{this.disconnect(t)})),i}connect(t){this.addSub(this.authHelper.identityProviderPopup(t.identityProvider,"link").subscribe(i=>{this.notification.snackBar(this.i18n.identityProvider.action.connectDone({name:i.name,provider:i.identityProvider.name})),this.reload()}))}disconnect(t){this.confirmation.confirm({title:this.i18n.identityProvider.action.disconnect,message:this.i18n.identityProvider.action.disconnectConfirm(t.identityProvider.name),callback:()=>this.doDisconnect(t)})}doDisconnect(t){const i=t.identityProvider;this.addSub(this.identityProvidersService.deleteUserIdentityProvider({user:this.param,identityProvider:i.internalName,disable:!0}).subscribe(()=>{this.notification.info(this.i18n.identityProvider.action.disconnectDone(i.name)),this.reload()}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.IDENTITY_PROVIDERS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Ya.S))},n.\u0275cmp=e.Xpm({type:n,selectors:[["user-identity-providers"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["noResults",""],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"user"],[4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-xs-3","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px",3,"size","image","icon",4,"ngIf"],[1,"col-8","col-xs-9","col-md-7"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px",1,"ml-2","mr-5","management",3,"size","image","icon"],[1,"d-block","ml-auto",3,"ngClass","label","action"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ba,1,0,"ng-container",1),e.qZA(),e.YNc(3,ir,3,5,"ng-template",null,2,e.W1O),e.YNc(5,or,1,1,"ng-template",null,3,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,d.sg,Ae.A,d.mk,N.x],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var fe=s(8543),xt=s(1584),Rt=s(6099),qt=s(723),Mt=s(567),rr=s(5420),sr=s(3594),Lt=s(3455);const cr=["userField"];function lr(n,a){1&n&&e.GkF(0)}function ur(n,a){if(1&n&&(e.TgZ(0,"label-value",2),e.YNc(1,lr,1,0,"ng-container",3),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(2);e.Q6J("formField",t.self)("informationText",t.informationText),e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function pr(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"chip",11),e.NdJ("close",function(){const r=e.CHM(t).$implicit;return e.oxw(3).remove(r)}),e._uU(1),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("image",t.image)("icon",i.SvgIcon.Person),e.xp6(1),e.hij(" ",t.display," ")}}function dr(n,a){if(1&n&&(e.TgZ(0,"div",9),e.YNc(1,pr,2,3,"chip",10),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.users)}}function _r(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"user-field",5,6),e.NdJ("selected",function(o){return e.CHM(t),e.oxw().add(o)}),e.qZA()(),e.YNc(3,dr,2,1,"div",7),e._UZ(4,"field-errors",8)}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formControl",t.userFieldControl)("allowSearch",t.allowSearch)("allowContacts",t.allowContacts)("allowPrincipal",t.allowPrincipal)("principalTypes",t.principalTypes),e.xp6(2),e.Q6J("ngIf",t.users.length>0),e.xp6(1),e.Q6J("control",t.formControl)}}let Yt=(()=>{class n extends qt.T{constructor(t,i,o){super(t,i),this.userCache=o,this.users$=new oe.X([]),this.allowPrincipal=!1,this.allowSearch=!0,this.allowContacts=!0,this.userFieldControl=new _.NI(null)}get users(){return this.users$.value}set users(t){this.users$.next(t)}ngOnInit(){super.ngOnInit(),this.userCache.register(this.preselectedUsers),this.preselectedUsers&&(this.users=[...this.preselectedUsers])}onDisabledChange(t){super.onDisabledChange(t)}add(t){!t||(this.users.find(i=>i.id===t.id)||(this.users=[...this.users,t],this.updateValue()),this.userFieldControl.setValue(null),setTimeout(()=>{this.userField.select(null,null,{emitEvent:!1})},1))}remove(t){t&&this.users.find(i=>i.id===t.id)&&(this.users=this.users.filter(i=>i.id!==t.id),this.updateValue())}preprocessValue(t){return(0,Mt.D)((t||[]).map(i=>this.userCache.get(i))).pipe((0,c.U)(i=>i.map(o=>this.toValue(o))))}toValue(t){return`id:${t.id}`}getFocusableControl(){throw this.userField}getDisabledValue(){return(this.users||[]).map(t=>t.display).join(", ")}updateValue(){this.value=this.users.map(t=>this.toValue(t))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(_.gN,13),e.Y36(rr.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["multiple-users-field"]],viewQuery:function(t,i){if(1&t&&e.Gf(cr,5),2&t){let o;e.iGM(o=e.CRH())&&(i.userField=o.first)}},inputs:{preselectedUsers:"preselectedUsers",allowPrincipal:"allowPrincipal",principalTypes:"principalTypes",allowSearch:"allowSearch",allowContacts:"allowContacts"},features:[e._Bn([{provide:_.JU,useExisting:n,multi:!0}]),e.qOj],decls:3,vars:2,consts:[[3,"formField","informationText",4,"ngIf","ngIfElse"],["widget",""],[3,"formField","informationText"],[4,"ngTemplateOutlet"],[1,"d-flex","mw-100","w-100"],[3,"formControl","allowSearch","allowContacts","allowPrincipal","principalTypes","selected"],["userField",""],["class","d-flex mw-100 w-100 flex-wrap",4,"ngIf"],[3,"control"],[1,"d-flex","mw-100","w-100","flex-wrap"],["class","mt-2 mr-2",3,"image","icon","close",4,"ngFor","ngForOf"],[1,"mt-2","mr-2",3,"image","icon","close"]],template:function(t,i){if(1&t&&(e.YNc(0,ur,2,3,"label-value",0),e.YNc(1,_r,5,7,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",i.label)("ngIfElse",o)}},directives:[d.O5,Y.t,d.tP,ve.l,_.JJ,_.oH,d.sg,sr.Y,Lt.e],encapsulation:2,changeDetection:0}),n})();var gr=s(6974);function mr(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"user-link",13),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.message.sendTo),e.xp6(1),e.Q6J("user",t.toUser)}}function fr(n,a){if(1&n&&e._UZ(0,"field-option",16),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",t)("text",i.messageHelper.resolveDestination(t))}}function hr(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",14),e.YNc(1,fr,1,2,"field-option",15),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.message.sendTo),e.xp6(1),e.Q6J("ngForOf",t.destinations)}}function br(n,a){if(1&n&&e._UZ(0,"user-field",18),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.messageDestination.user)}}function xr(n,a){if(1&n&&e._UZ(0,"multiple-users-field",18),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.toUsers)}}function vr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,br,1,1,"user-field",17),e.YNc(2,xr,1,1,"multiple-users-field",17),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",1===t.maxRecipients),e.xp6(1),e.Q6J("ngIf",0===t.maxRecipients||t.maxRecipients>1)}}function yr(n,a){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function Tr(n,a){if(1&n&&(e.TgZ(0,"multi-selection-field",19),e.YNc(1,yr,1,5,"field-option",20),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.message.toGroups),e.xp6(1),e.Q6J("ngForOf",t.groups)}}function Ar(n,a){if(1&n&&e._UZ(0,"field-option",24),2&n){const t=a.$implicit;e.Q6J("value",t.id)("internalName",t.internalName)("text",t.name)}}function Cr(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",22),e.YNc(1,Ar,1,3,"field-option",23),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.category),e.xp6(1),e.Q6J("ngForOf",t.categories)}}function wr(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,mr,2,2,"label-value",3),e.ynx(4,4),e.YNc(5,hr,2,2,"single-selection-field",5),e.YNc(6,vr,3,2,"ng-container",1),e.ALo(7,"async"),e.YNc(8,Tr,2,3,"multi-selection-field",6),e.ALo(9,"async"),e.YNc(10,Cr,2,2,"single-selection-field",7),e.ALo(11,"async"),e._UZ(12,"input-field",8)(13,"html-field",9),e.BQk(),e.TgZ(14,"actions",10)(15,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().send()}),e.ALo(16,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.resolveTitle())("mobileHeading",t.resolveMobileTitle())("headingActions",e.lcZ(2,12,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.toUser),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.destinations.length>1&&null==t.toUser),e.xp6(1),e.Q6J("ngIf",1===t.destinations.length&&t.destinations[0]===t.MessageDestinationEnum.USER&&null==t.toUser||e.lcZ(7,14,t.form.controls.destination.valueChanges)===t.MessageDestinationEnum.USER),e.xp6(2),e.Q6J("ngIf",t.groups.length>0&&(1===t.destinations.length&&t.destinations[0]===t.MessageDestinationEnum.GROUP||e.lcZ(9,16,t.form.controls.destination.valueChanges)===t.MessageDestinationEnum.GROUP)),e.xp6(2),e.Q6J("ngIf",t.categories.length>0&&!t.reply&&(t.dataForFrontendHolder.role===t.RoleEnum.ADMINISTRATOR||1===t.destinations.length&&t.destinations[0]===t.MessageDestinationEnum.SYSTEM||e.lcZ(11,18,t.form.controls.destination.valueChanges)===t.MessageDestinationEnum.SYSTEM)),e.xp6(2),e.Q6J("label",t.i18n.message.subject),e.xp6(3),e.Q6J("disabled",e.lcZ(16,20,t.requesting$))("label",t.i18n.message.send)}}let Bt=(()=>{class n extends y.y{constructor(t,i,o){super(t),this.messagesService=i,this.messageHelper=o,this.MessageDestinationEnum=fe.C,this.RoleEnum=ee.g}ngOnInit(){super.ngOnInit(),this.reply=this.route.snapshot.params.id,this.to=this.route.snapshot.queryParams.to;const t=this.reply?this.messagesService.getMessageDataForReply({id:this.reply}):this.messagesService.getMessageDataForSend({user:this.to});this.addSub(t.subscribe(i=>this.data=i))}onDataInitialized(t){var i,o;const r=t||{},p=t||{};let C=null;(0,m.cS)(null===(i=r.repliedMessage)||void 0===i?void 0:i.body)||(C="<br><br><br>"+this.i18n.message.replyBody({date:this.format.formatAsDateTime(r.repliedMessage.date),user:r.repliedMessage.from.display})+'</p><div style="border-left:1px solid silver;margin-left: 5px;padding-left:5px;">'+r.repliedMessage.body+"</div>");const I=p.destinations||[];this.form=this.formBuilder.group({destination:1===I.length?I[0]:null,toUsers:p.toUser?[p.toUser.id]:null,toGroups:null,category:null,subject:null===(o=r.reply)||void 0===o?void 0:o.subject,body:C})}send(){if((0,m.pt)(this.form))if((0,m.cS)(this.reply))this.addSub(this.messagesService.sendMessage({body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.i18n.message.messageSent),history.back()}));else{const t=(0,S.Z)(this.data).reply;t.subject=this.form.controls.subject.value,t.body=this.form.controls.body.value,this.addSub(this.messagesService.replyMessage({id:this.reply,body:t}).subscribe(i=>{this.notification.snackBar(this.i18n.message.messageSent),this.router.navigate(["/users","messages","view",i],{replaceUrl:!0})}))}}resolveTitle(){return this.reply?this.i18n.message.title.reply:this.i18n.message.title.newMessage}resolveMobileTitle(){return this.reply?this.i18n.message.mobileTitle.reply:this.i18n.message.mobileTitle.newMessage}get toUser(){return this.data.toUser}get destinations(){return this.data.destinations||[]}get maxRecipients(){return this.data.maxRecipients}get groups(){return this.data.groups||[]}get categories(){return this.data.categories||[]}resolveMenu(){return this.dataForFrontendHolder.role===ee.g.ADMINISTRATOR?v.v2.SYSTEM_MESSAGES:v.v2.MESSAGES}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(xt.K),e.Y36(Rt.L))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-message"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],["class","mb-1",3,"label",4,"ngIf"],[3,"formGroup"],["formControlName","destination","required","",3,"label",4,"ngIf"],["formControlName","toGroups","required","",3,"emptyLabel","label",4,"ngIf"],["formControlName","category","required","",3,"label",4,"ngIf"],["formControlName","subject","required","",3,"label"],["formControlName","body","required","",1,"mt-2"],["forceRow",""],[3,"disabled","label","action"],[1,"mb-1",3,"label"],[3,"user"],["formControlName","destination","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","toUsers","required","",3,"label",4,"ngIf"],["formControlName","toUsers","required","",3,"label"],["formControlName","toGroups","required","",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","category","required","",3,"label"],[3,"value","internalName","text",4,"ngFor","ngForOf"],[3,"value","internalName","text"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,wr,17,22,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,Y.t,ae.F,_.JL,_.sg,ue.f,_.JJ,_.u,_.Q7,d.sg,W.s,ve.l,Yt,Ie.x,ge.q,gr.N,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var he=(()=>{return(n=he||(he={})).INBOX="inbox",n.SENT="sent",n.TRASH="trash",he;var n})(),Ve=(()=>{return(n=Ve||(Ve={})).INCOMING="incoming",n.OUTGOING="outgoing",Ve;var n})(),Re=s(7224),Er=s(1307);function Zr(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("id",t.id)("value",t.id)("text",t.name)}}function Ir(n,a){if(1&n&&(e.TgZ(0,"div",9)(1,"single-selection-field",15),e.YNc(2,Zr,1,3,"field-option",16),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.category)("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("ngForOf",t.data.visibleCategories)}}function Sr(n,a){if(1&n&&e._UZ(0,"field-option",7),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",t)("text",i.messageHelper.resolveDestination(t))}}function Ur(n,a){if(1&n&&(e.TgZ(0,"div",9)(1,"label-value",18)(2,"single-selection-field",19),e.YNc(3,Sr,1,2,"field-option",20),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.resolveProfileTitle()),e.xp6(1),e.Q6J("emptyOption",t.i18n.general.all),e.xp6(1),e.Q6J("ngForOf",t.destinations)}}function Nr(n,a){if(1&n&&(e.TgZ(0,"mobile-result",21)(1,"div",22),e._uU(2),e.qZA(),e.TgZ(3,"div",23),e._uU(4),e.ALo(5,"dateTime"),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",i.resolveProfile(t).image),e.xp6(1),e.Q6J("tooltip",t.subject),e.xp6(1),e.Oqu(t.subject),e.xp6(2),e.hij(" ",e.lcZ(5,4,t.date)," ")}}const kr=function(n,a){return{"pb-0":n,"border-0":a}};function Or(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"td",32),e.ALo(2,"async"),e.ALo(3,"async"),e._UZ(4,"avatar",33),e.qZA(),e.TgZ(5,"td")(6,"span",34),e._uU(7),e.qZA()(),e.BQk()),2&n){const t=a.ngIf,i=e.oxw(4);e.xp6(1),e.Q6J("ngClass",e.WLB(9,kr,e.lcZ(2,5,i.layout.xxs$),e.lcZ(3,7,i.layout.xxs$))),e.xp6(3),e.Q6J("image",t.image)("tooltip",t.display)("icon",t.icon),e.xp6(3),e.Oqu(t.display)}}const Pr=function(n){return{"font-weight-bold":n}};function Qr(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",29),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).rowClick(r)}),e.YNc(2,Or,8,12,"ng-container",1),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.TgZ(8,"td",27)(9,"button",30),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(3);return C.remove(C.form.controls.messageBox.value!==C.MessageBoxEnum.TRASH,p),o.stopPropagation()}),e._UZ(10,"icon",31),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngClass",e.VKq(8,Pr,!t.read)),e.xp6(1),e.Q6J("ngIf",i.resolveProfile(t)),e.xp6(2),e.Oqu(t.subject),e.xp6(2),e.Oqu(e.lcZ(7,6,t.date)),e.xp6(3),e.Q6J("tooltip",i.form.controls.messageBox.value===i.MessageBoxEnum.TRASH?i.i18n.message.actions.remove:i.i18n.message.actions.moveToTrash),e.xp6(1),e.Q6J("icon",i.SvgIcon.Trash)}}function Jr(n,a){if(1&n&&(e.TgZ(0,"table",24)(1,"thead"),e._UZ(2,"th",25),e.TgZ(3,"th",26),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e._UZ(9,"th",27),e.qZA(),e.TgZ(10,"tbody"),e.YNc(11,Qr,11,10,"ng-container",28),e.ALo(12,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(4),e.hij(" ",t.resolveProfileTitle()," "),e.xp6(2),e.Oqu(t.i18n.message.subject),e.xp6(2),e.Oqu(t.i18n.general.date),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(12,4,t.results$))?null:i.results)}}const vt=function(){return[]};function Dr(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"radio-group-field",6),e._UZ(7,"field-option",7)(8,"field-option",7)(9,"field-option",7),e.qZA()(),e.YNc(10,Ir,3,3,"div",8),e.YNc(11,Ur,4,3,"div",8),e.ALo(12,"async"),e.TgZ(13,"div",9),e._UZ(14,"input-field",10),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"user-field",11),e.qZA()()()(),e.TgZ(17,"results-layout",12),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(18,"async"),e.YNc(19,Nr,6,6,"mobile-result",13),e.YNc(20,Jr,13,6,"table",14),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.message.title.search)("mobileHeading",t.i18n.message.mobileTitle.search)("headingActions",e.lcZ(2,18,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.message.messageBox.messageBox),e.xp6(1),e.Q6J("value",t.MessageBoxEnum.INBOX)("text",t.i18n.message.messageBox.inbox),e.xp6(1),e.Q6J("value",t.MessageBoxEnum.SENT)("text",t.i18n.message.messageBox.sent),e.xp6(1),e.Q6J("value",t.MessageBoxEnum.TRASH)("text",t.i18n.message.messageBox.trash),e.xp6(1),e.Q6J("ngIf",(t.data.visibleCategories||e.DdM(24,vt)).length>0),e.xp6(1),e.Q6J("ngIf",t.dataForFrontendHolder.role!==t.RoleEnum.ADMINISTRATOR&&((t.data.destinations||e.DdM(25,vt)).length>0||e.lcZ(12,20,t.form.controls.messageBox.valueChanges)&&(t.data.destinations||e.DdM(26,vt)).length>0)),e.xp6(3),e.Q6J("label",t.i18n.general.keywords),e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("results",e.lcZ(18,22,t.results$))("onClick",t.onClick)("rendering$",t.rendering$)}}let Fr=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.messagesService=i,this.messageHelper=o,this.MessageBoxEnum=he,this.RoleEnum=ee.g}ngOnInit(){super.ngOnInit(),this.addSub(this.messagesService.getMessageDataForSearch().subscribe(i=>this.data=i)),this.addSub(this.messagesService.updateLastViewDateForMessages().pipe((0,Re.P)()).subscribe(()=>{const i=this.messageHelper.messageStatus$,o=Object.assign({},i.value);o.lastViewDate=this.dataForFrontendHolder.now().toISOString(),o.newMessages=0,i.next(o),this.addSub(this.messageHelper.messageStatus$.pipe((0,Er.T)(1)).subscribe(()=>this.update()))}));const t=this.canSend?new Q.Yu(this.SvgIcon.Envelope,this.i18n.message.actions.newMessage,()=>this.router.navigate(["/users","messages","send"]),!0):null;t&&(this.headingActions=[t]),this.addSub(this.results$.subscribe(i=>{const o=(i?i.results:null)||[],r=o.filter(C=>!C.read),p=()=>{const C=[];r.length>0&&C.push(new Q.Yu(F.l.Check2All,this.i18n.notification.actions.markAllRead,()=>this.markAllRead())),o.length>0&&C.push(new Q.Yu(F.l.Trash,this.form.controls.messageBox.value===he.TRASH?this.i18n.notification.actions.removeAll:this.i18n.message.actions.moveAllToTrash,()=>this.removeAll())),t&&C.push(t),this.headingActions=C};p(),this.addSub(this.layout.breakpointChanges$.subscribe(p))}))}rowClick(t){this.router.navigate(["/users","messages","view",t.id])}get canSend(){var t,i;const o=null===(i=null===(t=this.dataForFrontendHolder.auth)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.messages,r=o.my||{},p=o.system||{};return r.sendToUser||r.sendToSystem||r.sendToBrokered||p.sendToGroups||p.sendToUser}markAllRead(){this.addSub(this.messagesService.markMessagesAsRead({ids:this.ids}).subscribe(()=>this.update()))}removeAll(){this.confirmation.confirm({message:this.i18n.general.removeAllItemsConfirm,callback:()=>{if(this.form.controls.messageBox.value===he.TRASH){const t=[];for(const i of this.ids)t.push(this.messagesService.deleteMessage({id:i}));this.addSub((0,Mt.D)(t).pipe((0,Re.P)()).subscribe(()=>this.update()))}else this.addSub(this.messagesService.moveMessagesToTrash({ids:this.ids}).subscribe(()=>this.update()))}})}get ids(){return this.results&&this.results.results?this.results.results.map(t=>t.id):[]}getFormControlNames(){return["messageBox","destination","category","keywords","user"]}toSearchParams(t){return t}doSearch(t){return this.messagesService.searchMessages$Response(t)}get onClick(){return t=>this.rowClick(t)}resolveMenu(){return this.dataForFrontendHolder.role===ee.g.ADMINISTRATOR?v.v2.SYSTEM_MESSAGES:v.v2.MESSAGES}resolveProfileTitle(){switch(this.form.controls.messageBox.value){case he.INBOX:return this.i18n.message.from;case he.SENT:return this.i18n.message.sentTo;case he.TRASH:return this.i18n.message.fromSentTo}}resolveProfile(t){const i={icon:F.l.Person,display:null,image:null},o=()=>{null==t.fromOwner?i.display=this.dataForFrontendHolder.dataForUi.applicationUsername:(i.display=t.fromOwner.display,i.image=t.fromOwner.image)},r=()=>{t.destination===fe.C.BROKERED?i.display=this.i18n.message.sendToBrokered:t.destination===fe.C.SYSTEM?i.display=this.dataForFrontendHolder.dataForUi.applicationUsername:(t.toUsers||[]).length>0?t.toUsers.length>1?(i.display=t.toUsers.map(p=>p.display).join(", "),i.icon=F.l.People):(i.display=t.toUsers[0].display,i.image=t.toUsers[0].image):(t.toGroups||[]).length>0&&(i.display=t.toGroups.length>1?t.toGroups.map(p=>p.name).join(", "):t.toGroups[0].name,i.icon=F.l.People)};switch(this.form.controls.messageBox.value){case he.INBOX:o();break;case he.SENT:r();break;case he.TRASH:t.kind===Ve.INCOMING?o():r()}return i}get destinations(){let t=[fe.C.USER,fe.C.GROUP,fe.C.BROKERED,fe.C.SYSTEM];return this.dataForFrontendHolder.role===ee.g.BROKER?(t=t.filter(i=>i!==fe.C.GROUP),this.form.controls.messageBox.value===he.INBOX&&(t=t.filter(i=>i!==fe.C.BROKERED))):t=t.filter(this.dataForFrontendHolder.role===ee.g.MEMBER?i=>i!==fe.C.GROUP&&i!==fe.C.BROKERED:i=>i!==fe.C.BROKERED),t}remove(t,i){t?this.addSub(this.messagesService.moveMessagesToTrash({ids:[i.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.message.moveToTrashDone),this.update()})):this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.addSub(this.messagesService.deleteMessage({id:i.id}).subscribe(()=>{this.notification.snackBar(this.i18n.message.removeDone),this.update()}))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(xt.K),e.Y36(Rt.L))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-messages"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12"],["formControlName","messageBox","fieldSize","full",3,"label"],[3,"value","text"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["formControlName","keywords",3,"label"],["formControlName","user",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],["avatarIcon","bell",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["formControlName","category",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"label"],["formControlName","destination",3,"emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],["avatarIcon","bell",3,"avatarImage"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%",1,"max-width:","15rem"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"avatar",3,"ngClass"],[3,"image","tooltip","icon"],[1,"ellipsis","d-inline-block",2,"max-width","15rem"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Dr,21,27,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,it.Y,_.JJ,_.u,W.s,ue.f,d.sg,Y.t,ge.q,ve.l,V.D,j.E,K.t,ie.i9,te.p,d.mk,Ae.A,ne.o],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var at=(()=>{return(n=at||(at={})).SYSTEM="system",n.USER="user",at;var n})(),Rr=s(1076);function qr(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.category)("value",t.data.category.name)}}const Mr=function(n){return{"mb-2":n}};function Lr(n,a){if(1&n&&e._UZ(0,"user-link",9),2&n){const t=a.$implicit;e.Q6J("ngClass",e.VKq(2,Mr,!a.last))("user",t)}}function Yr(n,a){if(1&n&&(e.TgZ(0,"label-value",3),e.YNc(1,Lr,1,4,"user-link",8),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.sentTo),e.xp6(1),e.Q6J("ngForOf",t.data.toUsers)}}function Br(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.sentTo)("value",t.i18n.message.sendToBrokered)}}function Gr(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.sentTo)("value",t.groups.join(", "))}}function $r(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.sentTo)("value",t.dataForFrontendHolder.dataForUi.applicationUsername)}}function Hr(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.sentBy)("value",t.data.sentBy.display)}}function Vr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Yr,2,2,"label-value",7),e.YNc(2,Br,1,2,"label-value",4),e.YNc(3,Gr,1,2,"label-value",4),e.YNc(4,$r,1,2,"label-value",4),e.YNc(5,Hr,1,2,"label-value",4),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.data.destination===t.MessageDestinationEnum.USER),e.xp6(1),e.Q6J("ngIf",t.data.destination===t.MessageDestinationEnum.BROKERED),e.xp6(1),e.Q6J("ngIf",t.data.destination===t.MessageDestinationEnum.GROUP),e.xp6(1),e.Q6J("ngIf",t.data.destination===t.MessageDestinationEnum.SYSTEM),e.xp6(1),e.Q6J("ngIf",t.dataForFrontendHolder.role===t.RoleEnum.ADMINISTRATOR)}}function jr(n,a){if(1&n&&e._UZ(0,"label-value",6),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.from)("value",t.dataForFrontendHolder.dataForUi.applicationUsername)}}function zr(n,a){if(1&n&&(e.TgZ(0,"label-value",3),e._UZ(1,"user-link",10),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.message.from),e.xp6(1),e.Q6J("user",t.data.fromOwner)}}function Xr(n,a){if(1&n&&(e.ynx(0),e.YNc(1,jr,1,2,"label-value",4),e.YNc(2,zr,2,2,"label-value",7),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.data.fromOwnerKind===t.MessageOwnerEnum.SYSTEM),e.xp6(1),e.Q6J("ngIf",t.data.fromOwnerKind===t.MessageOwnerEnum.USER)}}function Kr(n,a){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.subject)}}function Wr(n,a){if(1&n&&(e.TgZ(0,"thead"),e._UZ(1,"th",13),e.TgZ(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(3),e.Oqu(t.i18n.message.subject),e.xp6(2),e.Oqu(t.i18n.general.date)}}const es=function(n,a){return{"cursor-pointer":n,"font-weight-bold":a}};function ts(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",14),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.path(r)?p.router.navigate(p.path(r)):null}),e.TgZ(1,"td"),e._UZ(2,"icon",15),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"dateTime"),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("ngClass",e.WLB(6,es,i.path(t),i.isCurrent(t))),e.xp6(2),e.Q6J("icon",t.kind===i.MessageKind.INCOMING?i.SvgIcon.ArrowLeft:i.SvgIcon.ArrowRight),e.xp6(2),e.hij(" ",t.subject," "),e.xp6(2),e.hij(" ",e.lcZ(7,4,t.date)," ")}}function ns(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"hr"),e.TgZ(2,"h3"),e._uU(3),e.qZA(),e.TgZ(4,"table",11),e.YNc(5,Wr,6,2,"thead",1),e.ALo(6,"async"),e.TgZ(7,"tbody"),e.YNc(8,ts,8,9,"tr",12),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.message.replies),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,3,t.layout.gtxs$)),e.xp6(3),e.Q6J("ngForOf",t.data.replies)}}const is=function(){return[]};function os(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"label-value",3),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.YNc(6,qr,1,2,"label-value",4),e.YNc(7,Vr,6,5,"ng-container",1),e.YNc(8,Xr,3,2,"ng-container",1),e._UZ(9,"hr"),e.YNc(10,Kr,2,1,"h3",1),e._UZ(11,"rich-text-container",5),e.YNc(12,ns,9,5,"ng-container",1),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.message.title.details)("mobileHeading",t.i18n.message.mobileTitle.details)("headingActions",e.lcZ(2,11,t.headingActions$)),e.xp6(2),e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,13,t.data.date)," "),e.xp6(2),e.Q6J("ngIf",t.data.category),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.MessageKind.OUTGOING),e.xp6(1),e.Q6J("ngIf",t.data.kind===t.MessageKind.INCOMING),e.xp6(2),e.Q6J("ngIf",t.data.subject),e.xp6(1),e.Q6J("value",t.data.body),e.xp6(1),e.Q6J("ngIf",(t.data.replies||e.DdM(15,is)).length>1)}}let as=(()=>{class n extends ce.k{constructor(t,i){super(t),this.messagesService=i,this.RoleEnum=ee.g,this.MessageKind=Ve,this.MessageDestinationEnum=fe.C,this.MessageOwnerEnum=at}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.messagesService.viewMessage({id:this.id}).subscribe(t=>{this.data=t}))}onDataInitialized(t){t.replies&&t.replies.splice(t.replyPosition,0,t);const i=[];t.canReply&&i.push(new Q.Yu(F.l.Pencil,this.i18n.message.actions.reply,()=>this.router.navigate(["/users","messages","reply",this.id]))),t.canMarkUnread&&i.push(new Q.Yu(F.l.EnvelopeOpen,this.i18n.message.actions.markAsUnread,()=>this.markAsUnread())),t.canMoveToTrash&&i.push(new Q.Yu(F.l.Trash,this.i18n.message.actions.moveToTrash,()=>this.moveToTrash())),t.canRemove&&i.push(new Q.Yu(F.l.Trash,this.i18n.message.actions.remove,()=>this.remove())),t.canRestore&&i.push(new Q.Yu(F.l.ArrowCounterclockwise,this.i18n.message.actions.restore,()=>this.restore())),this.headingActions=i}path(t){return this.isCurrent(t)?null:["/users","messages","view",t.id]}remove(){this.data.removedAt?this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.addSub(this.messagesService.deleteMessage({id:this.data.id}).subscribe(()=>{this.notification.snackBar(this.i18n.message.removeDone),history.back()}))}):this.addSub(this.messagesService.moveMessagesToTrash({ids:[this.data.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.message.moveToTrashDone),this.reload()}))}restore(){this.addSub(this.messagesService.restoreMessagesFromTrash({ids:[this.data.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.message.messageRestored),this.reload()}))}moveToTrash(){this.addSub(this.messagesService.moveMessagesToTrash({ids:[this.data.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.message.moveToTrashDone),this.reload()}))}markAsUnread(){this.addSub(this.messagesService.markMessagesAsUnread({ids:[this.data.id]}).subscribe(()=>{this.notification.snackBar(this.i18n.message.markAsUnreadDone),history.back()}))}resolveMenu(){return this.dataForFrontendHolder.role===ee.g.ADMINISTRATOR?v.v2.SYSTEM_MESSAGES:v.v2.MESSAGES}get groups(){return(this.data.toGroups||[]).map(t=>t.name)}isCurrent(t){return null!=t.replyPosition}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(xt.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-message"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label"],[3,"label","value",4,"ngIf"],["autoHeight","",3,"value"],[3,"label","value"],[3,"label",4,"ngIf"],[3,"ngClass","user",4,"ngFor","ngForOf"],[3,"ngClass","user"],[3,"user"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"avatar"],[3,"ngClass","click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,os,13,16,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,Y.t,d.sg,ae.F,d.mk,Rr.J,ne.o],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var u=s(7220),pe=(()=>{return(n=pe||(pe={})).ACCOUNT_BALANCE_FIXED="accountBalanceFixed",n.ACCOUNT_FEE_CHARGED_NO_FAILURES="accountFeeChargedNoFailures",n.ACCOUNT_FEE_CHARGED_WITH_FAILURES="accountFeeChargedWithFailures",n.APPLICATION_RESTARTED="applicationRestarted",n.CUSTOM="custom",n.CUSTOM_TRANSLATIONS_INVALIDATED="customTranslationsInvalidated",n.EMAIL_SENDING_FAILED="emailSendingFailed",n.INCONSISTENT_BALANCE_BELOW_LIMIT="inconsistentBalanceBelowLimit",n.INCONSISTENT_DB_SCHEMA="inconsistentDbSchema",n.MAX_BLOCKED_USERS_REACHED="maxBlockedUsersReached",n.MAX_GLOBAL_SMS_REACHED="maxGlobalSmsReached",n.MAX_INCORRECT_LOGIN_ATTEMPTS="maxIncorrectLoginAttempts",n.SMS_SENDING_FAILED="smsSendingFailed",pe;var n})(),re=(()=>{return(n=re||(re={})).CUSTOM="custom",n.GIVEN_VERY_BAD_REFS="givenVeryBadRefs",n.INCONSISTENT_BALANCE_BELOW_LIMIT="inconsistentBalanceBelowLimit",n.INSUFFICIENT_BALANCE_FOR_INITIAL_CREDIT="insufficientBalanceForInitialCredit",n.MAX_DEVICE_ACTIVATION_ATTEMPTS_REACHED="maxDeviceActivationAttemptsReached",n.MAX_DEVICE_CONFIRMATION_CHECK_ATTEMPTS_REACHED="maxDeviceConfirmationCheckAttemptsReached",n.MAX_TOKEN_ACTIVATION_ATTEMPTS_REACHED="maxTokenActivationAttemptsReached",n.MAX_TOTP_ATTEMPTS_REACHED="maxTotpAttemptsReached",n.MAX_USER_LOCALIZATION_ATTEMPTS_REACHED="maxUserLocalizationAttemptsReached",n.MAX_VOUCHER_REDEEM_ATTEMPTS_REACHED="maxVoucherRedeemAttemptsReached",n.MOVE_USER_AUTOMATICALLY_FAILED="moveUserAutomaticallyFailed",n.PASSWORD_DISABLED_BY_TRIES="passwordDisabledByTries",n.PASSWORD_TEMPORARILY_BLOCKED="passwordTemporarilyBlocked",n.RECEIVED_VERY_BAD_REFS="receivedVeryBadRefs",n.SCHEDULED_PAYMENT_FAILED="scheduledPaymentFailed",re;var n})();let rs=(()=>{class n extends U.b{constructor(t,i){super(t,i)}viewNotificationSettings$Response(t,i){const o=new b.c(this.rootUrl,n.ViewNotificationSettingsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewNotificationSettings(t,i){return this.viewNotificationSettings$Response(t,i).pipe((0,c.U)(o=>o.body))}saveNotificationSettings$Response(t,i){const o=new b.c(this.rootUrl,n.SaveNotificationSettingsPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}saveNotificationSettings(t,i){return this.saveNotificationSettings$Response(t,i).pipe((0,c.U)(o=>o.body))}getNotificationSettingsDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetNotificationSettingsDataForEditPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getNotificationSettingsDataForEdit(t,i){return this.getNotificationSettingsDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}getDataForEmailUnsubscribe$Response(t,i){const o=new b.c(this.rootUrl,n.GetDataForEmailUnsubscribePath,"get");return t&&(o.path("key",t.key,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getDataForEmailUnsubscribe(t,i){return this.getDataForEmailUnsubscribe$Response(t,i).pipe((0,c.U)(o=>o.body))}emailUnsubscribe$Response(t,i){const o=new b.c(this.rootUrl,n.EmailUnsubscribePath,"post");return t&&o.path("key",t.key,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}emailUnsubscribe(t,i){return this.emailUnsubscribe$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.ViewNotificationSettingsPath="/{user}/notification-settings",n.SaveNotificationSettingsPath="/{user}/notification-settings",n.GetNotificationSettingsDataForEditPath="/{user}/notification-settings/data-for-edit",n.GetDataForEmailUnsubscribePath="/email-unsubscribe/{key}",n.EmailUnsubscribePath="/email-unsubscribe/{key}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ss=s(2039),cs=s(8664);const ls=["button"],us=["ttip"];let ps=(()=>{class n extends ss.C{constructor(t,i,o){super(t,i),this.layout=o,this.icon$=new oe.X(null)}toggle(){this.state=!this.state,this.setValue(this.state),this.ttip.hide()}onValueInitialized(t){this.state=t,this.iconComponent.icon=this.icon}onDisabledChange(t){this.layout.xxs?this.button.nativeElement.style.display=t?"none":"":this.button.nativeElement.style.visibility=t?"hidden":""}get icon(){return this.state?this.onIcon:this.offIcon}get tooltip(){return this.iconTooltip?this.iconTooltip+": "+(this.state?this.i18n.general.enabled:this.i18n.general.disabled).toLowerCase():null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(_.gN,13),e.Y36(cs.Pb))},n.\u0275cmp=e.Xpm({type:n,selectors:[["button-toggle"]],viewQuery:function(t,i){if(1&t&&(e.Gf(ls,7),e.Gf(ne.o,7),e.Gf(us,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.button=o.first),e.iGM(o=e.CRH())&&(i.iconComponent=o.first),e.iGM(o=e.CRH())&&(i.ttip=o.first)}},inputs:{onIcon:"onIcon",offIcon:"offIcon",iconTooltip:"iconTooltip",readOnly:"readOnly"},features:[e._Bn([{provide:_.JU,useExisting:n,multi:!0}]),e.qOj],decls:4,vars:3,consts:[["type","button",1,"btn","btn-icon",3,"tooltip","disabled","click"],["button","","ttip","bs-tooltip"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"button",0,1),e.NdJ("click",function(){return i.toggle()}),e._UZ(3,"icon",2),e.qZA()),2&t&&(e.Q6J("tooltip",i.tooltip)("disabled",i.readOnly),e.xp6(3),e.Q6J("icon",i.icon))},directives:[ie.i9,ne.o],encapsulation:2,changeDetection:0}),n})();function ds(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",8),e._UZ(1,"field-option",9)(2,"field-option",9),e.qZA()),2&n){const t=e.oxw();e.Q6J("emptyOption",!1)("disabled",t.disabled),e.xp6(1),e.Q6J("value",!0)("text",t.i18n.general.enabled),e.xp6(1),e.Q6J("value",!1)("text",t.i18n.general.disabled)}}function _s(n,a){if(1&n&&e._UZ(0,"multi-selection-field",10),2&n){const t=e.oxw();e.Q6J("formControl",t.multiSelectionControl)("fieldOptions",t.options)("disabled",t.disabled)}}function gs(n,a){1&n&&e._UZ(0,"div",11)}function ms(n,a){if(1&n&&e._UZ(0,"button-toggle",12),2&n){const t=e.oxw();e.Q6J("onIcon",t.SvgIcon.Bell)("offIcon",t.SvgIcon.BellSlash)("iconTooltip",t.i18n.notificationSettings.internalNotification)("readOnly",t.disabled)}}function fs(n,a){if(1&n&&e._UZ(0,"button-toggle",13),2&n){const t=e.oxw();e.Q6J("onIcon",t.SvgIcon.Envelope)("offIcon",t.SvgIcon.EnvelopeSlash)("iconTooltip",t.i18n.general.sendMedium.email)("readOnly",t.disabled)}}function hs(n,a){if(1&n&&e._UZ(0,"button-toggle",14),2&n){const t=e.oxw();e.Q6J("onIcon",t.SvgIcon.ChatLeftText)("offIcon",t.SvgIcon.ChatLeftTextSlash)("iconTooltip",t.i18n.general.sendMedium.sms)("readOnly",t.disabled)}}function bs(n,a){if(1&n&&e._UZ(0,"button-toggle",15),2&n){const t=e.oxw();e.Q6J("onIcon",t.SvgIcon.Phone)("offIcon",t.SvgIcon.PhoneSlash)("iconTooltip",t.i18n.general.sendMedium.app)("readOnly",t.disabled)}}let xs=(()=>{class n extends Ue.H{constructor(t){super(t)}ngOnInit(){this.adminType&&this.multiSelectionControl&&this.addSub(this.multiSelectionControl.valueChanges.subscribe(t=>{this.form.controls.internal.setValue(t.length>0)}))}get adminType(){switch(this.setting.type){case u.E.AD_PENDING_BY_ADMIN_AUTHORIZATION:case u.E.APPLICATION_ERROR:case u.E.EXTERNAL_USER_PAYMENT_EXPIRED:case u.E.EXTERNAL_USER_PAYMENT_PERFORMED_FAILED:case u.E.GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case u.E.GENERATED_VOUCHERS_EXPIRED:case u.E.NETWORK_CREATED:case u.E.PAYMENT_AWAITING_ADMIN_AUTHORIZATION:case u.E.PAYMENT_PERFORMED:case u.E.SYSTEM_ALERT:case u.E.USER_ALERT:case u.E.USER_IMPORT:case u.E.USER_REGISTRATION:case u.E.VOUCHER_BUYING_ABOUT_TO_EXPIRE:return!0}return!1}get buttonCount(){let t=0;return this.adminType||t++,null!=this.setting.email&&t++,null!=this.setting.sms&&t++,null!=this.setting.app&&t++,t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["notification-type-setting"]],inputs:{label:"label",setting:"setting",options:"options",form:"form",multiSelectionControl:"multiSelectionControl",disabled:"disabled"},features:[e.qOj],decls:8,vars:9,consts:[[1,"d-flex","flex-wrap","flex-xs-nowrap",3,"ngClass","formGroup"],["class","flex-grow-1","formControlName","internal",3,"emptyOption","disabled",4,"ngIf"],["class","flex-grow-1",3,"formControl","fieldOptions","disabled",4,"ngIf"],["class","d-xs-none",4,"ngIf"],["formControlName","internal",3,"onIcon","offIcon","iconTooltip","readOnly",4,"ngIf"],["formControlName","email",3,"onIcon","offIcon","iconTooltip","readOnly",4,"ngIf"],["formControlName","sms",3,"onIcon","offIcon","iconTooltip","readOnly",4,"ngIf"],["formControlName","app",3,"onIcon","offIcon","iconTooltip","readOnly",4,"ngIf"],["formControlName","internal",1,"flex-grow-1",3,"emptyOption","disabled"],[3,"value","text"],[1,"flex-grow-1",3,"formControl","fieldOptions","disabled"],[1,"d-xs-none"],["formControlName","internal",3,"onIcon","offIcon","iconTooltip","readOnly"],["formControlName","email",3,"onIcon","offIcon","iconTooltip","readOnly"],["formControlName","sms",3,"onIcon","offIcon","iconTooltip","readOnly"],["formControlName","app",3,"onIcon","offIcon","iconTooltip","readOnly"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ds,3,6,"single-selection-field",1),e.YNc(2,_s,1,3,"multi-selection-field",2),e.YNc(3,gs,1,0,"div",3),e.YNc(4,ms,1,4,"button-toggle",4),e.YNc(5,fs,1,4,"button-toggle",5),e.YNc(6,hs,1,4,"button-toggle",6),e.YNc(7,bs,1,4,"button-toggle",7),e.qZA()),2&t&&(e.Q6J("ngClass","has-buttons-"+i.buttonCount)("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.adminType&&!i.options),e.xp6(1),e.Q6J("ngIf",i.adminType&&i.options),e.xp6(1),e.Q6J("ngIf",i.adminType),e.xp6(1),e.Q6J("ngIf",!i.adminType),e.xp6(1),e.Q6J("ngIf",null!=i.setting.email),e.xp6(1),e.Q6J("ngIf",null!=i.setting.sms),e.xp6(1),e.Q6J("ngIf",null!=i.setting.app))},directives:[d.mk,_.JL,_.sg,d.O5,ue.f,_.JJ,_.u,W.s,Ie.x,_.oH,ps],encapsulation:2,changeDetection:0}),n})();var Gt=s(2479);function vs(n,a){if(1&n&&(e.TgZ(0,"label-value",9),e._UZ(1,"boolean-field",10),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("forId","forwardMessages")("label",t.i18n.notificationSettings.forwardMessages),e.xp6(1),e.Q6J("disabled",!t.data.canEdit)("id","forwardMessages")}}function ys(n,a){if(1&n&&(e.TgZ(0,"label-value",9),e._UZ(1,"boolean-field",11),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("forId","emailMailings")("label",t.i18n.notificationSettings.emailMailings),e.xp6(1),e.Q6J("disabled",!t.data.canEdit)("id","emailMailings")}}function Ts(n,a){if(1&n&&(e.TgZ(0,"label-value",9),e._UZ(1,"boolean-field",12),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("forId","smsMailings")("label",t.i18n.notificationSettings.smsMailings),e.xp6(1),e.Q6J("disabled",!t.data.canEdit)("id","smsMailings")}}function As(n,a){if(1&n&&(e.TgZ(0,"label-value",9),e._UZ(1,"boolean-field",13),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("forId","appMailings")("label",t.i18n.notificationSettings.appMailings),e.xp6(1),e.Q6J("disabled",!t.data.canEdit)("id","appMailings")}}const $t=function(n){return{"border-top-0":n}};function Cs(n,a){if(1&n&&(e.TgZ(0,"h2",17),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("ngClass",e.VKq(2,$t,!t.data.forwardMessagesAllowed)),e.xp6(1),e.hij(" ",t.i18n.notificationSettings.payments,"")}}function ws(n,a){if(1&n&&(e.TgZ(0,"h3",18),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Es(n,a){1&n&&e.GkF(0)}const Zs=function(n){return{$implicit:n}};function Is(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Cs,2,4,"h2",14),e.ynx(2,4),e.YNc(3,ws,2,1,"h3",15),e.YNc(4,Es,1,0,"ng-container",16),e.BQk()()),2&n){const t=a.ngIf,i=e.oxw(),o=i.first,r=i.$implicit,p=e.oxw(2),C=e.MAs(4);e.xp6(1),e.Q6J("ngIf",o),e.xp6(1),e.Q6J("formGroup",t),e.xp6(1),e.Q6J("ngIf",!p.singleAccount),e.xp6(1),e.Q6J("ngTemplateOutlet",C)("ngTemplateOutletContext",e.VKq(5,Zs,r))}}function Ss(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Is,5,7,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.form.get("userAccounts").get(t.id))}}function Us(n,a){if(1&n&&e._UZ(0,"field-option",21),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("id",t.id)("internalName",t.internalName)("text",t.name)}}function Ns(n,a){if(1&n&&(e.TgZ(0,"multi-selection-field",19),e.YNc(1,Us,1,4,"field-option",20),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.notificationSettings.forwardMessages),e.xp6(1),e.Q6J("ngForOf",t.data.messageCategories)}}const ks=function(n){return{"section-title-action":n}},Os=function(n,a){return{"mr-3":n,"mb-2":a}};function Ps(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",17),e.ALo(1,"async"),e.TgZ(2,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(2).enableNotifications(o,!0)}),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"action-button",26),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(2).enableNotifications(o,!1)}),e.qZA()()}if(2&n){const t=e.oxw(4);e.Q6J("ngClass",e.VKq(10,ks,e.lcZ(1,4,t.layout.gtsm$))),e.xp6(2),e.Q6J("ngClass",e.WLB(12,Os,!e.lcZ(3,6,t.layout.ltxs$),e.lcZ(4,8,t.layout.ltxs$)))("label",t.i18n.notificationSettings.enableAll),e.xp6(3),e.Q6J("label",t.i18n.notificationSettings.disableAll)}}function Qs(n,a){if(1&n&&(e.TgZ(0,"h2",23)(1,"div",24),e._uU(2),e.qZA(),e.YNc(3,Ps,6,15,"div",14),e.qZA()),2&n){const t=e.oxw(),i=t.first,o=t.$implicit,r=e.oxw(2);e.Q6J("ngClass",e.VKq(3,$t,i&&0===r.data.userAccounts.length&&0===r.data.messageCategories.length&&!r.data.forwardMessagesAllowed)),e.xp6(2),e.hij(" ",o," "),e.xp6(1),e.Q6J("ngIf",!r.adminSettings&&r.notificationSections.get(o).length>3&&r.data.canEdit)}}function Js(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"label-value",27),e._UZ(2,"notification-type-setting",28),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("label",i.resolveNotificationLabel(t)),e.xp6(1),e.Q6J("setting",t)("options",i.typeFieldOptionsMap.get(t.type))("form",i.resolveControl(t.type))("multiSelectionControl",i.typeControlsMap.get(t.type))("disabled",!i.data.canEdit)}}function Ds(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Qs,4,5,"h2",22),e.YNc(2,Js,3,6,"ng-container",6),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",""!==t),e.xp6(1),e.Q6J("ngForOf",i.notificationSections.get(t))}}const Fs=function(n,a){return{count:n,total:a}};function Rs(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.general.sendMedium.sms),e.xp6(2),e.Oqu(t.i18n.notificationSettings.smsCount(e.WLB(2,Fs,t.data.smsCountThisMonth,t.data.maxSmsPerMonth)))}}function qs(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",29),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).save()}),e.ALo(1,"async"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.save)}}function Ms(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",3),e.ynx(2,4),e.YNc(3,vs,2,4,"label-value",5),e.YNc(4,ys,2,4,"label-value",5),e.YNc(5,Ts,2,4,"label-value",5),e.YNc(6,As,2,4,"label-value",5),e.YNc(7,Ss,2,1,"ng-container",6),e.YNc(8,Ns,2,2,"multi-selection-field",7),e.YNc(9,Ds,3,2,"ng-container",6),e.YNc(10,Rs,5,5,"ng-container",1),e.BQk(),e.TgZ(11,"actions"),e.YNc(12,qs,2,4,"action-button",8),e.qZA()(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.notificationSettings.title)("mobileHeading",t.i18n.notificationSettings.mobileTitle),e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.data.forwardMessagesAllowed),e.xp6(1),e.Q6J("ngIf",t.data.emailMailingsAllowed),e.xp6(1),e.Q6J("ngIf",t.data.smsMailingsAllowed),e.xp6(1),e.Q6J("ngIf",t.data.appMailingsAllowed),e.xp6(1),e.Q6J("ngForOf",t.data.userAccounts),e.xp6(1),e.Q6J("ngIf",t.data.messageCategories.length>0),e.xp6(1),e.Q6J("ngForOf",t.notificationSections.keys()),e.xp6(1),e.Q6J("ngIf",t.data.smsAllowed),e.xp6(2),e.Q6J("ngIf",t.data.canEdit)}}function Ls(n,a){if(1&n&&(e.ynx(0,4),e._UZ(1,"decimal-field",30)(2,"decimal-field",31),e.BQk()),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("formGroup",i.form.get("userAccounts").get(t.id).get("paymentAmount")),e.xp6(1),e.Q6J("label",i.i18n.notificationSettings.paymentNotificationsAbove)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("disabled",!i.data.canEdit)("emptyLabel",i.i18n.general.notSet),e.xp6(1),e.Q6J("label",i.i18n.notificationSettings.paymentNotificationsBelow)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("disabled",!i.data.canEdit)("emptyLabel",i.i18n.general.notSet)}}let Ys=(()=>{class n extends y.y{constructor(t,i){super(t),this.notificationSettingsService=i,this.notificationSections=new Map,this.typeControlsMap=new Map,this.typeFieldOptionsMap=new Map}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.notificationSettingsService.getNotificationSettingsDataForEdit({user:this.user}).subscribe(t=>this.data=t))}onDataInitialized(t){if(this.adminSettings=t.role===ee.g.ADMINISTRATOR,this.form=this.formBuilder.group({version:t.settings.version}),t.smsAllowed||(t.settings.notifications=t.settings.notifications.filter(r=>r.type!==u.E.SMS_PERFORMED_PAYMENT&&r.type!==u.E.MAX_SMS_PER_MONTH_REACHED)),this.adminSettings){if(!this.hasSettings(t))return void this.notification.info(this.i18n.notificationSettings.notAvailableSettings);this.notificationSections.set("",t.settings.notifications),this.form.addControl("forwardMessageCategories",this.formBuilder.control(t.settings.forwardMessageCategories))}t.forwardMessagesAllowed&&this.form.setControl("forwardMessages",this.formBuilder.control(t.settings.forwardMessages)),t.emailMailingsAllowed&&this.form.setControl("emailMailings",this.formBuilder.control(t.settings.emailMailings)),t.appMailingsAllowed&&this.form.setControl("appMailings",this.formBuilder.control(t.settings.appMailings)),t.smsMailingsAllowed&&this.form.setControl("smsMailings",this.formBuilder.control(t.settings.smsMailings));const i=[],o=this.formBuilder.array([]);for(const r of t.settings.notifications){const p=this.formBuilder.group({internal:r.internal,type:r.type,email:void 0===r.email?null:r.email,sms:void 0===r.sms?null:r.sms,app:void 0===r.app?null:r.app});if(this.addSub(p.controls.internal.valueChanges.subscribe(()=>{this.updateControls(p)})),this.updateControls(p),o.push(p),i.push(r.type),!this.adminSettings){const C=this.resolveSection(r.type),I=this.notificationSections.get(C);I?I.push(r):this.notificationSections.set(C,[r])}}if(i.length>0)for(const r of i){let p,C,I;[p,C,I]=this.resolveOptions(r,t);const $=this.formBuilder.control(C);this.typeControlsMap.set(r,$),this.form.setControl(I,$),this.typeFieldOptionsMap.set(r,p)}if(this.form.setControl("notifications",o),!(0,m.cS)(t.userAccounts)){this.singleAccount=1===t.userAccounts.length;const r=this.formBuilder.group({});for(const p of t.userAccounts){const I=(t.settings.userAccounts[this.ApiHelper.internalNameOrId(p)]||{}).paymentAmount||{};r.setControl(p.id,this.formBuilder.group({paymentAmount:this.formBuilder.group({min:I.min,max:I.max})}))}this.form.setControl("userAccounts",r)}}updateControls(t){var i,o,r,p,C,I;t.controls.internal.value?(null===(i=t.controls.email)||void 0===i||i.enable(),null===(o=t.controls.sms)||void 0===o||o.enable(),null===(r=t.controls.app)||void 0===r||r.enable()):(null===(p=t.controls.email)||void 0===p||p.disable(),null===(C=t.controls.sms)||void 0===C||C.disable(),null===(I=t.controls.app)||void 0===I||I.disable())}save(){const i=this.notificationSettingsService.saveNotificationSettings({user:this.user,body:this.form.value});this.addSub(i.subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.notificationSettings.saved)}))}hasSettings(t){return!((0,m.cS)(t.settings.notifications)||this.adminSettings&&(0,m.cS)(t.messageCategories))}resolveSection(t){switch(t){case u.E.ALL_NON_SMS_PERFORMED_PAYMENTS:case u.E.AUTHORIZED_PAYMENT_CANCELED:case u.E.AUTHORIZED_PAYMENT_DENIED:case u.E.AUTHORIZED_PAYMENT_EXPIRED:case u.E.AUTHORIZED_PAYMENT_SUCCEEDED:case u.E.VOUCHER_ABOUT_TO_EXPIRE:case u.E.VOUCHER_EXPIRATION_DATE_CHANGED:case u.E.VOUCHER_EXPIRED:case u.E.VOUCHER_PIN_BLOCKED:case u.E.VOUCHER_TOP_UP:case u.E.VOUCHER_REDEEM:case u.E.VOUCHER_ASSIGNED:case u.E.EXTERNAL_PAYMENT_EXPIRED:case u.E.EXTERNAL_PAYMENT_PERFORMED_FAILED:case u.E.EXTERNAL_PAYMENT_RECEIVED_FAILED:case u.E.INCOMING_RECURRING_PAYMENT_CANCELED:case u.E.INCOMING_RECURRING_PAYMENT_FAILED:case u.E.INCOMING_RECURRING_PAYMENT_RECEIVED:case u.E.INCOMING_SCHEDULED_PAYMENT_CANCELED:case u.E.INCOMING_SCHEDULED_PAYMENT_FAILED:case u.E.INCOMING_SCHEDULED_PAYMENT_RECEIVED:case u.E.LIMIT_CHANGE:case u.E.OPERATOR_AUTHORIZED_PAYMENT_APPROVED_STILL_PENDING:case u.E.OPERATOR_AUTHORIZED_PAYMENT_CANCELED:case u.E.OPERATOR_AUTHORIZED_PAYMENT_DENIED:case u.E.OPERATOR_AUTHORIZED_PAYMENT_EXPIRED:case u.E.OPERATOR_AUTHORIZED_PAYMENT_SUCCEEDED:case u.E.OPERATOR_PAYMENT_AWAITING_AUTHORIZATION:case u.E.PAYMENT_AWAITING_AUTHORIZATION:case u.E.PAYMENT_PERFORMED_CHARGED_BACK:case u.E.PAYMENT_RECEIVED_CHARGED_BACK:case u.E.PAYMENT_RECEIVED:case u.E.PAYMENT_REQUEST_CANCELED:case u.E.PAYMENT_REQUEST_DENIED:case u.E.PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:case u.E.PAYMENT_REQUEST_EXPIRED:case u.E.PAYMENT_REQUEST_PROCESSED:case u.E.PAYMENT_REQUEST_RECEIVED:case u.E.RECURRING_PAYMENT_FAILED:case u.E.RECURRING_PAYMENT_OCCURRENCE_PROCESSED:case u.E.SCHEDULED_PAYMENT_FAILED:case u.E.SCHEDULED_PAYMENT_INSTALLMENT_PROCESSED:case u.E.SCHEDULED_PAYMENT_REQUEST_FAILED:case u.E.SENT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:case u.E.SMS_PERFORMED_PAYMENT:case u.E.TICKET_WEBHOOK_FAILED:return this.i18n.notificationSettings.accounts;case u.E.AD_INTEREST_NOTIFICATION:case u.E.AD_QUESTION_ANSWERED:case u.E.ORDER_CANCELED_BUYER:case u.E.ORDER_PAYMENT_CANCELED_BUYER:case u.E.ORDER_PAYMENT_DENIED_BUYER:case u.E.ORDER_PAYMENT_EXPIRED_BUYER:case u.E.ORDER_PENDING_BUYER:case u.E.ORDER_PENDING_AUTHORIZATION_BUYER:case u.E.ORDER_PENDING_DELIVERY_DATA_BUYER:case u.E.ORDER_REALIZED_SELLER:case u.E.ORDER_REJECTED_BY_SELLER:case u.E.SALE_PENDING_BUYER:case u.E.SALE_REJECTED_SELLER:return this.i18n.notificationSettings.marketplaceAsBuyer;case u.E.BROKER_ASSIGNED:case u.E.BROKER_UNASSIGNED:case u.E.MAX_SMS_PER_MONTH_REACHED:case u.E.NEW_TOKEN:case u.E.NEW_TOKEN_PENDING_ACTIVATION:case u.E.PASSWORD_STATUS_CHANGED:case u.E.TOKEN_STATUS_CHANGED:case u.E.USER_STATUS_CHANGED:return this.i18n.notificationSettings.personal;case u.E.FEEDBACK_CHANGED:case u.E.FEEDBACK_CREATED:case u.E.FEEDBACK_EXPIRATION_REMINDER:case u.E.FEEDBACK_OPTIONAL:case u.E.FEEDBACK_REPLY_CREATED:case u.E.FEEDBACK_REQUIRED:case u.E.REFERENCE_CHANGED:case u.E.REFERENCE_CREATED:return this.i18n.notificationSettings.feedbackAndReferences;case u.E.AD_AUTHORIZED:case u.E.AD_EXPIRED:case u.E.LOW_STOCK_QUANTITY:case u.E.ARTICLE_OUT_OF_STOCK:case u.E.AD_QUESTION_CREATED:case u.E.AD_REJECTED:case u.E.ORDER_CANCELED_SELLER:case u.E.ORDER_CREATED:case u.E.ORDER_PAYMENT_CANCELED_SELLER:case u.E.ORDER_PAYMENT_DENIED_SELLER:case u.E.ORDER_PAYMENT_EXPIRED_SELLER:case u.E.ORDER_PENDING_AUTHORIZATION_SELLER:case u.E.ORDER_PENDING_DELIVERY_DATA_SELLER:case u.E.ORDER_REALIZED_BUYER:case u.E.ORDER_REJECTED_BY_BUYER:case u.E.SALE_REALIZED_BUYER:return this.i18n.notificationSettings.marketplaceAsSeller;case u.E.AD_PENDING_AUTHORIZATION:case u.E.MEMBER_ASSIGNED:case u.E.MEMBER_UNASSIGNED:return this.i18n.notificationSettings.brokering;case u.E.AD_PENDING_BY_ADMIN_AUTHORIZATION:case u.E.APPLICATION_ERROR:case u.E.EXTERNAL_USER_PAYMENT_EXPIRED:case u.E.EXTERNAL_USER_PAYMENT_PERFORMED_FAILED:case u.E.GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case u.E.GENERATED_VOUCHERS_EXPIRED:case u.E.NETWORK_CREATED:case u.E.PAYMENT_AWAITING_ADMIN_AUTHORIZATION:case u.E.PAYMENT_PERFORMED:case u.E.SYSTEM_ALERT:case u.E.USER_ALERT:case u.E.USER_IMPORT:case u.E.USER_REGISTRATION:case u.E.VOUCHER_BUYING_ABOUT_TO_EXPIRE:return""}return""}resolveMenu(){return this.adminSettings||this.user===this.ApiHelper.SELF?v.v2.NOTIFICATIONS:this.menu.searchUsersMenu()}resolveControl(t){const i=this.form.controls.notifications.controls;for(const o of i){const r=o;if(r.controls.type.value===t)return r}return null}enableNotifications(t,i){for(const o of this.notificationSections.get(t))this.resolveControl(o.type).controls.internal.setValue(i)}resolveNotificationLabel(t){switch(t.type){case u.E.AD_PENDING_BY_ADMIN_AUTHORIZATION:return this.i18n.notification.admin.adPendingAuthorization;case u.E.APPLICATION_ERROR:return this.i18n.notification.admin.applicationErrors;case u.E.EXTERNAL_USER_PAYMENT_EXPIRED:return this.i18n.notification.admin.externalPaymentExpired;case u.E.EXTERNAL_USER_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.admin.externalPaymentPerformedFailed;case u.E.GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.generatedVouchersAboutToExpire;case u.E.GENERATED_VOUCHERS_EXPIRED:return this.i18n.notification.admin.generatedVouchersExpired;case u.E.NETWORK_CREATED:return this.i18n.notification.admin.networkCreated;case u.E.PAYMENT_AWAITING_ADMIN_AUTHORIZATION:return this.i18n.notification.admin.paymentAwaitingAuthorization;case u.E.PAYMENT_PERFORMED:return this.i18n.notification.admin.paymentPerformed;case u.E.SYSTEM_ALERT:return this.i18n.notification.admin.systemAlert;case u.E.USER_ALERT:return this.i18n.notification.admin.userAlert;case u.E.USER_IMPORT:return"";case u.E.USER_REGISTRATION:return this.i18n.notification.admin.userRegistration;case u.E.VOUCHER_BUYING_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.voucherBuyingAboutToExpire;case u.E.ALL_NON_SMS_PERFORMED_PAYMENTS:return this.i18n.notification.user.account.allNonSmsPerformedPayments;case u.E.AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.authorizedPaymentCanceled;case u.E.AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.authorizedPaymentDenied;case u.E.AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.authorizedPaymentExpired;case u.E.AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.authorizedPaymentSucceeded;case u.E.VOUCHER_ABOUT_TO_EXPIRE:return this.i18n.notification.user.account.voucherAboutToExpire;case u.E.VOUCHER_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.voucherExpirationDateChanged;case u.E.VOUCHER_EXPIRED:return this.i18n.notification.user.account.voucherExpired;case u.E.VOUCHER_PIN_BLOCKED:return this.i18n.notification.user.account.voucherPinBlocked;case u.E.VOUCHER_TOP_UP:return this.i18n.notification.user.account.voucherTopUp;case u.E.VOUCHER_REDEEM:return this.i18n.notification.user.account.voucherRedeem;case u.E.EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.user.account.externalPaymentExpired;case u.E.EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.user.account.externalPaymentPerformedFailed;case u.E.EXTERNAL_PAYMENT_RECEIVED_FAILED:return this.i18n.notification.user.account.externalPaymentReceivedFailed;case u.E.INCOMING_RECURRING_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingRecurringPaymentCanceled;case u.E.INCOMING_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingRecurringPaymentFailed;case u.E.INCOMING_RECURRING_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingRecurringPaymentReceived;case u.E.INCOMING_SCHEDULED_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingScheduledPaymentCanceled;case u.E.INCOMING_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingScheduledPaymentFailed;case u.E.INCOMING_SCHEDULED_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingScheduledPaymentReceived;case u.E.LIMIT_CHANGE:return this.i18n.notification.user.account.limitChange;case u.E.OPERATOR_AUTHORIZED_PAYMENT_APPROVED_STILL_PENDING:return this.i18n.notification.user.account.operator.authorizedPaymentApprovedStillPending;case u.E.OPERATOR_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.operator.authorizedPaymentCanceled;case u.E.OPERATOR_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.operator.authorizedPaymentDenied;case u.E.OPERATOR_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.operator.authorizedPaymentExpired;case u.E.OPERATOR_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.operator.authorizedPaymentSucceeded;case u.E.OPERATOR_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.operator.paymentAwaitingAuthorization;case u.E.PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.paymentAwaitingAuthorization;case u.E.PAYMENT_PERFORMED_CHARGED_BACK:return this.i18n.notification.user.account.paymentPerformedChargedBack;case u.E.PAYMENT_RECEIVED_CHARGED_BACK:return this.i18n.notification.user.account.paymentReceivedChargedBack;case u.E.PAYMENT_RECEIVED:return this.i18n.notification.user.account.paymentReceived;case u.E.PAYMENT_REQUEST_CANCELED:return this.i18n.notification.user.account.paymentRequestCanceled;case u.E.PAYMENT_REQUEST_DENIED:return this.i18n.notification.user.account.paymentRequestDenied;case u.E.PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.paymentRequestExpirationDateChanged;case u.E.PAYMENT_REQUEST_EXPIRED:return this.i18n.notification.user.account.paymentRequestExpired;case u.E.PAYMENT_REQUEST_PROCESSED:return this.i18n.notification.user.account.paymentRequestProcessed;case u.E.PAYMENT_REQUEST_RECEIVED:return this.i18n.notification.user.account.paymentRequestReceived;case u.E.RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.recurringPaymentFailed;case u.E.RECURRING_PAYMENT_OCCURRENCE_PROCESSED:return this.i18n.notification.user.account.recurringPaymentOcurrenceProcessed;case u.E.SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.scheduledPaymentFailed;case u.E.SCHEDULED_PAYMENT_INSTALLMENT_PROCESSED:return this.i18n.notification.user.account.scheduledPaymentInstallmentProcessed;case u.E.SCHEDULED_PAYMENT_REQUEST_FAILED:return this.i18n.notification.user.account.scheduledPaymentRequestFailed;case u.E.SENT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.sentPaymentRequestExpirationDateChanged;case u.E.SMS_PERFORMED_PAYMENT:return this.i18n.notification.user.account.smsPerformedPayment;case u.E.TICKET_WEBHOOK_FAILED:return this.i18n.notification.user.account.ticketWebhookFailed;case u.E.AD_PENDING_AUTHORIZATION:return this.i18n.notification.user.brokering.adPendingAuthorization;case u.E.MEMBER_ASSIGNED:return this.i18n.notification.user.brokering.memberAssigned;case u.E.MEMBER_UNASSIGNED:return this.i18n.notification.user.brokering.memberUnassigned;case u.E.AD_INTEREST_NOTIFICATION:return this.i18n.notification.user.buyer.adInterestNotification;case u.E.AD_QUESTION_ANSWERED:return this.i18n.notification.user.buyer.adQuestionAnswered;case u.E.ORDER_CANCELED_BUYER:return this.i18n.notification.user.buyer.orderCanceled;case u.E.ORDER_PAYMENT_CANCELED_BUYER:return this.i18n.notification.user.buyer.orderPaymentCanceled;case u.E.ORDER_PAYMENT_DENIED_BUYER:return this.i18n.notification.user.buyer.orderPaymentDenied;case u.E.ORDER_PAYMENT_EXPIRED_BUYER:return this.i18n.notification.user.buyer.orderPaymentExpired;case u.E.ORDER_PENDING_BUYER:return this.i18n.notification.user.buyer.orderPending;case u.E.ORDER_PENDING_AUTHORIZATION_BUYER:return this.i18n.notification.user.buyer.orderPendingAuthorization;case u.E.ORDER_PENDING_DELIVERY_DATA_BUYER:return this.i18n.notification.user.buyer.orderPendingDeliveryData;case u.E.ORDER_REALIZED_SELLER:return this.i18n.notification.user.buyer.orderProcessedBySeller;case u.E.ORDER_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.orderRejectedBySeller;case u.E.SALE_PENDING_BUYER:return this.i18n.notification.user.buyer.buyerSalePending;case u.E.SALE_REJECTED_SELLER:return this.i18n.notification.user.buyer.buyerSaleRejectedBySeller;case u.E.FEEDBACK_CHANGED:return this.i18n.notification.user.feedback.changed;case u.E.FEEDBACK_CREATED:return this.i18n.notification.user.feedback.created;case u.E.FEEDBACK_EXPIRATION_REMINDER:return this.i18n.notification.user.feedback.expirationReminder;case u.E.FEEDBACK_OPTIONAL:return this.i18n.notification.user.feedback.optional;case u.E.FEEDBACK_REPLY_CREATED:return this.i18n.notification.user.feedback.replyCreated;case u.E.FEEDBACK_REQUIRED:return this.i18n.notification.user.feedback.required;case u.E.BROKER_ASSIGNED:return this.i18n.notification.user.personal.brokerAssigned;case u.E.BROKER_UNASSIGNED:return this.i18n.notification.user.personal.brokerUnassigned;case u.E.MAX_SMS_PER_MONTH_REACHED:return this.i18n.notification.user.personal.maxSmsPerMonthReached;case u.E.NEW_TOKEN:return this.i18n.notification.user.personal.newToken;case u.E.NEW_TOKEN_PENDING_ACTIVATION:return this.i18n.notification.user.personal.newTokenPendingActivation;case u.E.PASSWORD_STATUS_CHANGED:return this.i18n.notification.user.personal.passwordStatusChanged;case u.E.TOKEN_STATUS_CHANGED:return this.i18n.notification.user.personal.tokenStatusChanged;case u.E.USER_STATUS_CHANGED:return this.i18n.notification.user.personal.userStatusChanged;case u.E.REFERENCE_CHANGED:return this.i18n.notification.user.reference.changed;case u.E.REFERENCE_CREATED:return this.i18n.notification.user.reference.created;case u.E.AD_AUTHORIZED:return this.i18n.notification.user.seller.adAuthorized;case u.E.AD_EXPIRED:return this.i18n.notification.user.seller.adExpired;case u.E.LOW_STOCK_QUANTITY:return this.i18n.notification.user.seller.adLowStock;case u.E.ARTICLE_OUT_OF_STOCK:return this.i18n.notification.user.seller.adOutOfStock;case u.E.AD_QUESTION_CREATED:return this.i18n.notification.user.seller.adQuestionCreated;case u.E.AD_REJECTED:return this.i18n.notification.user.seller.adRejected;case u.E.ORDER_CANCELED_SELLER:return this.i18n.notification.user.seller.orderCanceled;case u.E.ORDER_CREATED:return this.i18n.notification.user.seller.orderCreated;case u.E.ORDER_PAYMENT_CANCELED_SELLER:return this.i18n.notification.user.seller.orderPaymentCanceled;case u.E.ORDER_PAYMENT_DENIED_SELLER:return this.i18n.notification.user.seller.orderPaymentDenied;case u.E.ORDER_PAYMENT_EXPIRED_SELLER:return this.i18n.notification.user.seller.orderPaymentExpired;case u.E.ORDER_PENDING_AUTHORIZATION_SELLER:return this.i18n.notification.user.seller.orderPendingAuthorization;case u.E.ORDER_PENDING_DELIVERY_DATA_SELLER:return this.i18n.notification.user.seller.orderPendingDeliveryData;case u.E.ORDER_REALIZED_BUYER:return this.i18n.notification.user.seller.orderProcessedByBuyer;case u.E.ORDER_REJECTED_BY_BUYER:return this.i18n.notification.user.seller.orderRejectedByBuyer;case u.E.SALE_REALIZED_BUYER:return this.i18n.notification.user.seller.saleProcessedByBuyer}return""}resolveOptions(t,i){let o,r,p,C,I;switch(t){case u.E.EXTERNAL_USER_PAYMENT_EXPIRED:o=i.externalPayments,r=i.settings.externalPaymentsExpired,C="externalPaymentsExpired";break;case u.E.EXTERNAL_USER_PAYMENT_PERFORMED_FAILED:o=i.externalPayments,r=i.settings.externalPaymentsFailed,C="externalPaymentsFailed";break;case u.E.GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case u.E.GENERATED_VOUCHERS_EXPIRED:o=i.voucherConfigurations,r=i.settings.voucherConfigurations,C="voucherConfigurations";break;case u.E.VOUCHER_BUYING_ABOUT_TO_EXPIRE:o=i.voucherConfigurations,r=i.settings.voucherConfigurationsBuying,C="voucherConfigurationsBuying";break;case u.E.PAYMENT_AWAITING_ADMIN_AUTHORIZATION:o=i.authorizablePayments,r=i.settings.authorizablePayments,C="authorizablePayments";break;case u.E.PAYMENT_PERFORMED:o=i.payments,r=i.settings.payments,C="payments";break;case u.E.USER_REGISTRATION:o=i.userGroups,r=i.settings.userGroups,C="userGroups";break;case u.E.SYSTEM_ALERT:p=Object.values(pe),r=i.settings.systemAlerts,C="systemAlert";break;case u.E.USER_ALERT:p=Object.values(re),r=i.settings.userAlerts,C="userAlert"}return o?I=o.map($=>({id:$.id,internalName:$.internalName,value:this.ApiHelper.internalNameOrId($),text:$.name})):p&&(I=p.map($=>({value:$,text:this.resolveAlertLabel($)}))),[I,r,C]}resolveAlertLabel(t){switch(t){case pe.ACCOUNT_BALANCE_FIXED:return this.i18n.systemAlert.type.accountBalanceFixed;case pe.ACCOUNT_FEE_CHARGED_NO_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedNoFailures;case pe.ACCOUNT_FEE_CHARGED_WITH_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedWithFailures;case pe.APPLICATION_RESTARTED:return this.i18n.systemAlert.type.applicationRestarted;case pe.CUSTOM:return this.i18n.systemAlert.type.custom;case pe.CUSTOM_TRANSLATIONS_INVALIDATED:return this.i18n.systemAlert.type.customTranslationsInvalidated;case pe.EMAIL_SENDING_FAILED:return this.i18n.systemAlert.type.emailSendingFailed;case pe.INCONSISTENT_DB_SCHEMA:return this.i18n.systemAlert.type.inconsistentDbSchema;case pe.MAX_BLOCKED_USERS_REACHED:return this.i18n.systemAlert.type.maxBlockedUsersReached;case pe.MAX_GLOBAL_SMS_REACHED:return this.i18n.systemAlert.type.maxGlobalSmsReached;case pe.MAX_INCORRECT_LOGIN_ATTEMPTS:return this.i18n.systemAlert.type.maxIncorrectLoginAttempts;case pe.SMS_SENDING_FAILED:return this.i18n.systemAlert.type.smsSendingFailed;case re.CUSTOM:return this.i18n.userAlert.type.custom;case re.GIVEN_VERY_BAD_REFS:return this.i18n.userAlert.type.givenVeryBadRefs;case re.INCONSISTENT_BALANCE_BELOW_LIMIT:return this.i18n.userAlert.type.inconsistentBalanceBelowLimit;case re.INSUFFICIENT_BALANCE_FOR_INITIAL_CREDIT:return this.i18n.userAlert.type.insufficientBalanceForInitialCredit;case re.MAX_DEVICE_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceActivationAttemptsReached;case re.MAX_DEVICE_CONFIRMATION_CHECK_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached;case re.MAX_TOKEN_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxTokenActivationAttemptsReached;case re.MAX_USER_LOCALIZATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxUserLocalizationAttemptsReached;case re.MAX_VOUCHER_REDEEM_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxVoucherRedeemAttemptsReached;case re.MOVE_USER_AUTOMATICALLY_FAILED:return this.i18n.userAlert.type.moveUserAutomaticallyFailed;case re.PASSWORD_DISABLED_BY_TRIES:return this.i18n.userAlert.type.passwordDisabledByTries;case re.PASSWORD_TEMPORARILY_BLOCKED:return this.i18n.userAlert.type.passwordTemporarilyBlocked;case re.RECEIVED_VERY_BAD_REFS:return this.i18n.userAlert.type.receivedVeryBadRefs;case re.SCHEDULED_PAYMENT_FAILED:case re.SCHEDULED_PAYMENT_FAILED:return this.i18n.userAlert.type.scheduledPaymentFailed}return""}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rs))},n.\u0275cmp=e.Xpm({type:n,selectors:[["notification-settings-form"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],[3,"heading","mobileHeading"],[3,"formGroup"],["kind","view",3,"forId","label",4,"ngIf"],[4,"ngFor","ngForOf"],["formControlName","forwardMessageCategories",3,"label",4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["kind","view",3,"forId","label"],["formControlName","forwardMessages","switch","",3,"disabled","id"],["formControlName","emailMailings","switch","",3,"disabled","id"],["formControlName","smsMailings","switch","",3,"disabled","id"],["formControlName","appMailings","switch","",3,"disabled","id"],[3,"ngClass",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[1,"mt-3","mb-0"],["formControlName","forwardMessageCategories",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["class","d-flex flex-column flex-xs-row justify-content-between",3,"ngClass",4,"ngIf"],[1,"d-flex","flex-column","flex-xs-row","justify-content-between",3,"ngClass"],[1,"mb-2","mb-xs-0"],["outline","",3,"ngClass","label","action"],["outline","",3,"label","action"],["kind","field",3,"label"],[3,"setting","options","form","multiSelectionControl","disabled"],[3,"disabled","label","action"],["formControlName","min",3,"label","scale","prefix","suffix","disabled","emptyLabel"],["formControlName","max",3,"label","scale","prefix","suffix","disabled","emptyLabel"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ms,13,12,"ng-container",1),e.qZA(),e.YNc(3,Ls,3,13,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,O.M,_.JJ,_.u,d.sg,d.mk,d.tP,Ie.x,W.s,N.x,xs,k.h,Gt.U],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})(),yt=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserOperatorGroupsListData$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserOperatorGroupsListDataPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserOperatorGroupsListData(t,i){return this.getUserOperatorGroupsListData$Response(t,i).pipe((0,c.U)(o=>o.body))}listOperatorGroupsByUser$Response(t,i){const o=new b.c(this.rootUrl,n.ListOperatorGroupsByUserPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}listOperatorGroupsByUser(t,i){return this.listOperatorGroupsByUser$Response(t,i).pipe((0,c.U)(o=>o.body))}createOperatorGroup$Response(t,i){const o=new b.c(this.rootUrl,n.CreateOperatorGroupPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createOperatorGroup(t,i){return this.createOperatorGroup$Response(t,i).pipe((0,c.U)(o=>o.body))}getOperatorGroupDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetOperatorGroupDataForNewPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getOperatorGroupDataForNew(t,i){return this.getOperatorGroupDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}getOperatorGroupDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetOperatorGroupDataForEditPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getOperatorGroupDataForEdit(t,i){return this.getOperatorGroupDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}viewOperatorGroup$Response(t,i){const o=new b.c(this.rootUrl,n.ViewOperatorGroupPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewOperatorGroup(t,i){return this.viewOperatorGroup$Response(t,i).pipe((0,c.U)(o=>o.body))}updateOperatorGroup$Response(t,i){const o=new b.c(this.rootUrl,n.UpdateOperatorGroupPath,"put");return t&&(o.path("id",t.id,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updateOperatorGroup(t,i){return this.updateOperatorGroup$Response(t,i).pipe((0,c.U)(o=>o.body))}deleteOperatorGroup$Response(t,i){const o=new b.c(this.rootUrl,n.DeleteOperatorGroupPath,"delete");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}deleteOperatorGroup(t,i){return this.deleteOperatorGroup$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserOperatorGroupsListDataPath="/{user}/operator-groups/list-data",n.ListOperatorGroupsByUserPath="/{user}/operator-groups",n.CreateOperatorGroupPath="/{user}/operator-groups",n.GetOperatorGroupDataForNewPath="/{user}/operator-groups/data-for-new",n.GetOperatorGroupDataForEditPath="/operator-groups/{id}/data-for-edit",n.ViewOperatorGroupPath="/operator-groups/{id}",n.UpdateOperatorGroupPath="/operator-groups/{id}",n.DeleteOperatorGroupPath="/operator-groups/{id}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Bs(n,a){if(1&n&&e._UZ(0,"user-info",7),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function Gs(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",8),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.name)}}function $s(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",11),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.router.navigate(p.path(r))}),e.TgZ(2,"td")(3,"a",12),e._uU(4),e.qZA()(),e.TgZ(5,"td",13)(6,"button",14),e.NdJ("click",function(o){const p=e.CHM(t).$implicit;return e.oxw(3).remove(p),o.stopPropagation()}),e._UZ(7,"icon",15),e.qZA()()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Q6J("routerLink",i.path(t)),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("tooltip",i.i18n.general.removeTooltip(t.name)),e.xp6(1),e.Q6J("icon",i.SvgIcon.Trash)}}function Hs(n,a){if(1&n&&(e.TgZ(0,"table",9)(1,"tbody"),e.YNc(2,$s,8,4,"ng-container",10),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.data.operatorGroups)}}function Vs(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,Bs,1,1,"user-info",3),e.qZA(),e.TgZ(4,"results-layout",4),e.YNc(5,Gs,3,1,"mobile-result",5),e.YNc(6,Hs,3,1,"table",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode",t.self?"empty":"normal")("heading",t.i18n.operatorGroup.title.list)("mobileHeading",t.i18n.operatorGroup.mobileTitle.list)("headingActions",e.lcZ(2,7,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("results",t.data.operatorGroups)("toLink",t.toLink)}}let Ht=(()=>{class n extends y.y{constructor(t,i){super(t),this.operatorGroupsService=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorGroupsService.getUserOperatorGroupsListData({user:this.param}).subscribe(t=>{this.data=t}))}onDataInitialized(t){this.groups=t.operatorGroups,t.canCreate&&(this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.general.addNew,()=>{this.router.navigate(["/users",this.param,"operator-groups","new"])},!0)])}path(t){return["/users","operator-groups",t.id]}get toLink(){return t=>this.path(t)}remove(t){this.confirmation.confirm({message:this.i18n.general.removeConfirm(t.name),callback:()=>this.doRemove(t)})}doRemove(t){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(t.name)),this.reload()}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.OPERATOR_GROUPS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(yt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-operator-groups"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover table-no-header cursor-pointer",4,"resultTable"],[3,"user"],[1,"cell-main"],[1,"table","table-hover","table-no-header","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"actions"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Vs,7,9,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg,x.yS,ie.i9,ne.o],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Ne=s(588),js=s(9238);function zs(n,a){if(1&n&&(e.TgZ(0,"label-value",20),e._UZ(1,"user-link",21),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user)}}function Xs(n,a){if(1&n&&e._UZ(0,"boolean-field",22),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.notifications)}}function Ks(n,a){if(1&n&&e._UZ(0,"boolean-field",23),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.viewAdvertisements)}}function Ws(n,a){if(1&n&&e._UZ(0,"boolean-field",24),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.manageAdvertisements)}}function ec(n,a){if(1&n&&e._UZ(0,"boolean-field",25),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.messages)}}function tc(n,a){if(1&n&&e._UZ(0,"field-option",31),2&n){const t=e.oxw(3);e.Q6J("text",t.i18n.operatorGroup.tokens.enable)}}function nc(n,a){if(1&n&&e._UZ(0,"field-option",32),2&n){const t=e.oxw(3);e.Q6J("text",t.i18n.operatorGroup.tokens.block)}}function ic(n,a){if(1&n&&e._UZ(0,"field-option",33),2&n){const t=e.oxw(3);e.Q6J("text",t.i18n.operatorGroup.tokens.unblock)}}function oc(n,a){if(1&n&&e._UZ(0,"field-option",34),2&n){const t=e.oxw(3);e.Q6J("text",t.i18n.operatorGroup.tokens.cancel)}}function ac(n,a){if(1&n&&(e.TgZ(0,"checkbox-group-field",26),e.YNc(1,tc,1,1,"field-option",27),e.YNc(2,nc,1,1,"field-option",28),e.YNc(3,ic,1,1,"field-option",29),e.YNc(4,oc,1,1,"field-option",30),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.tokens.label)("formControl",t.tokenPermissions),e.xp6(1),e.Q6J("ngIf",t.data.canEnableToken),e.xp6(1),e.Q6J("ngIf",t.data.canBlockToken),e.xp6(1),e.Q6J("ngIf",t.data.canUnblockToken),e.xp6(1),e.Q6J("ngIf",t.data.canCancelToken)}}function rc(n,a){if(1&n&&e._UZ(0,"field-option",37),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("id",t.id)("internalName",t.internalName)("text",t.name)}}function sc(n,a){if(1&n&&(e.TgZ(0,"multi-selection-field",35),e.YNc(1,rc,1,4,"field-option",36),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.records),e.xp6(1),e.Q6J("ngForOf",t.data.recordTypes)}}function cc(n,a){if(1&n&&e._UZ(0,"field-option",37),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("id",t.id)("internalName",t.internalName)("text",t.name)}}function lc(n,a){if(1&n&&(e.TgZ(0,"multi-selection-field",38),e.YNc(1,cc,1,4,"field-option",36),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.runOperations),e.xp6(1),e.Q6J("ngForOf",t.data.operations)}}function uc(n,a){if(1&n&&e._UZ(0,"boolean-field",39),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.brokering)}}function pc(n,a){1&n&&e.GkF(0)}function dc(n,a){if(1&n&&(e.ynx(0),e.YNc(1,pc,1,0,"ng-container",41),e.BQk()),2&n){e.oxw(3);const t=e.MAs(6);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function _c(n,a){if(1&n&&(e.TgZ(0,"h3",9),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function gc(n,a){1&n&&e.GkF(0)}const mc=function(n){return{$implicit:n}};function fc(n,a){if(1&n&&(e.ynx(0),e.YNc(1,gc,1,0,"ng-container",44),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.oxw(3);const i=e.MAs(4);e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.VKq(2,mc,t))}}function hc(n,a){if(1&n&&(e.ynx(0)(1,5),e.YNc(2,_c,2,1,"h3",42),e._UZ(3,"single-selection-field",43),e.YNc(4,fc,2,4,"ng-container",1),e.BQk()()),2&n){const t=a.ngIf,i=e.oxw(4);e.xp6(1),e.Q6J("formGroup",t),e.xp6(1),e.Q6J("ngIf",!i.singleAccount),e.xp6(1),e.Q6J("label",i.i18n.operatorGroup.accountAccess)("fieldOptions",i.accountAccessOptions),e.xp6(1),e.Q6J("ngIf","none"!==t.value.access)}}function bc(n,a){if(1&n&&(e.ynx(0),e.YNc(1,hc,5,5,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.form.get("accounts").get(t.id))}}function xc(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",9),e._uU(2),e.ALo(3,"async"),e.qZA(),e.YNc(4,dc,2,1,"ng-container",1),e.YNc(5,bc,2,1,"ng-container",40),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,3,t.layout.ltsm$)?t.i18n.operatorGroup.mobileTitle.accountAccess:t.i18n.operatorGroup.title.accountAccess," "),e.xp6(2),e.Q6J("ngIf",!t.singleAccount),e.xp6(1),e.Q6J("ngForOf",t.data.accountTypes)}}function vc(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",4),e.ALo(2,"async"),e.ynx(3,5),e.YNc(4,zs,2,2,"label-value",6),e._UZ(5,"input-field",7)(6,"textarea-field",8),e.TgZ(7,"h2",9),e._uU(8),e.ALo(9,"async"),e.qZA(),e._UZ(10,"boolean-field",10),e.YNc(11,Xs,1,1,"boolean-field",11),e.YNc(12,Ks,1,1,"boolean-field",12),e.YNc(13,Ws,1,1,"boolean-field",13),e.YNc(14,ec,1,1,"boolean-field",14),e.YNc(15,ac,5,6,"checkbox-group-field",15),e.YNc(16,sc,2,2,"multi-selection-field",16),e.YNc(17,lc,2,2,"multi-selection-field",17),e.YNc(18,uc,1,1,"boolean-field",18),e.YNc(19,xc,6,5,"ng-container",1),e.BQk(),e.TgZ(20,"actions")(21,"action-button",19),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(22,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.create?t.i18n.operatorGroup.title.new:t.i18n.operatorGroup.title.edit)("mobileHeading",t.create?t.i18n.operatorGroup.mobileTitle.new:t.i18n.operatorGroup.mobileTitle.edit)("headingActions",e.lcZ(2,20,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("label",t.i18n.general.name),e.xp6(1),e.Q6J("label",t.i18n.general.description),e.xp6(2),e.hij("",e.lcZ(9,22,t.layout.ltsm$)?t.i18n.operatorGroup.mobileTitle.general:t.i18n.operatorGroup.title.general," "),e.xp6(2),e.Q6J("label",t.i18n.operatorGroup.editOwnProfile),e.xp6(1),e.Q6J("ngIf",t.data.canHaveNotifications),e.xp6(1),e.Q6J("ngIf",t.data.canViewAdvertisements),e.xp6(1),e.Q6J("ngIf",t.data.canManageAdvertisements),e.xp6(1),e.Q6J("ngIf",t.data.canHaveMessages),e.xp6(1),e.Q6J("ngIf",t.hasTokenPermissions()),e.xp6(1),e.Q6J("ngIf",(null==t.data.recordTypes?null:t.data.recordTypes.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.data.operations?null:t.data.operations.length)>0),e.xp6(1),e.Q6J("ngIf",t.data.broker),e.xp6(1),e.Q6J("ngIf",(null==t.data.accountTypes?null:t.data.accountTypes.length)>0),e.xp6(2),e.Q6J("disabled",e.lcZ(22,24,t.requesting$))("label",t.i18n.general.save)}}function yc(n,a){if(1&n&&(e.ynx(0,5),e._UZ(1,"decimal-field",47)(2,"decimal-field",48),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("formGroup",i.form.get("accounts").get(t.id).get("notificationAmount")),e.xp6(1),e.Q6J("label",i.i18n.operatorGroup.paymentNotificationsAbove)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix),e.xp6(1),e.Q6J("label",i.i18n.operatorGroup.paymentNotificationsBelow)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix)}}function Tc(n,a){1&n&&e.GkF(0)}function Ac(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Tc,1,0,"ng-container",41),e.BQk()),2&n){e.oxw(2);const t=e.MAs(6);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function Cc(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"hr",53),e.TgZ(2,"h4",54),e._uU(3),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.name)}}function wc(n,a){if(1&n&&e._UZ(0,"boolean-field",55),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.operatorGroup.performPaymentsRequiresAuthorization)}}function Ec(n,a){if(1&n&&e._UZ(0,"decimal-field",56),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.operatorGroup.performPaymentsMaxAmountPerDay)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix)}}function Zc(n,a){if(1&n&&(e.ynx(0,5),e.YNc(1,Cc,4,1,"ng-container",1),e._UZ(2,"boolean-field",49),e.YNc(3,wc,1,1,"boolean-field",50),e.YNc(4,Ec,1,4,"decimal-field",51),e._UZ(5,"boolean-field",52),e.BQk()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw();let r;e.Q6J("formGroup",o.form.get("payments").get(t.id)),e.xp6(1),e.Q6J("ngIf",(null==(r=o.paymentTypes(i))?null:r.length)>1),e.xp6(1),e.Q6J("label",o.i18n.operatorGroup.performPayments),e.xp6(1),e.Q6J("ngIf",o.form.get("payments").get(t.id).get("perform").value),e.xp6(1),e.Q6J("ngIf",o.form.get("payments").get(t.id).get("perform").value),e.xp6(1),e.Q6J("label",o.i18n.operatorGroup.authorizePayments)}}function Ic(n,a){if(1&n&&(e.YNc(0,yc,3,9,"ng-container",45),e.YNc(1,Ac,2,1,"ng-container",1),e.YNc(2,Zc,6,6,"ng-container",46)),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("ngIf",i.form.get("notifications").value),e.xp6(1),e.Q6J("ngIf",i.singleAccount),e.xp6(1),e.Q6J("ngForOf",i.paymentTypes(t))}}function Sc(n,a){if(1&n&&e._UZ(0,"boolean-field",62),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.chargebackPayments)}}function Uc(n,a){if(1&n&&e._UZ(0,"boolean-field",63),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.receivePayments)}}function Nc(n,a){if(1&n&&e._UZ(0,"boolean-field",64),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.requestPayments)}}function kc(n,a){if(1&n&&e._UZ(0,"boolean-field",65),2&n){const t=e.oxw(2);e.Q6J("label",t.resolveVoucherTransactionsLabel())}}function Oc(n,a){if(1&n&&(e.ynx(0,5),e.YNc(1,Sc,1,1,"boolean-field",57),e.YNc(2,Uc,1,1,"boolean-field",58),e.YNc(3,Nc,1,1,"boolean-field",59),e.YNc(4,kc,1,1,"boolean-field",60),e._UZ(5,"multiple-users-field",61),e.BQk()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",t.data.canChargebackPayments),e.xp6(1),e.Q6J("ngIf",t.data.canReceivePayments),e.xp6(1),e.Q6J("ngIf",t.data.canRequestPayments),e.xp6(1),e.Q6J("ngIf",t.data.canPerformVoucherTransactions),e.xp6(1),e.Q6J("label",t.i18n.operatorGroup.restrictPaymentsToUsers)("preselectedUsers",t.restrictPaymentsToUsers)}}let Vt=(()=>{class n extends y.y{constructor(t,i,o){super(t),this.userHelper=i,this.operatorGroupsService=o}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null!=this.user;const t=this.create?this.operatorGroupsService.getOperatorGroupDataForNew({user:this.user}):this.operatorGroupsService.getOperatorGroupDataForEdit({id:this.id});this.addSub(t.subscribe(o=>{this.data=o})),this.accountAccessOptions=[Ne.B.NONE,Ne.B.OWN,Ne.B.INCOMING,Ne.B.OUTGOING,Ne.B.FULL].map(o=>({value:o,text:this.userHelper.operatorGroupAccountAccess(o)}))}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user);const i=t.operatorGroup;if(this.form=this.formBuilder.group({name:[i.name,_.kI.required],description:i.description}),!(0,m.cS)(t.accountTypes)){this.singleAccount=1===t.accountTypes.length;const r=this.formBuilder.group({});for(const p of t.accountTypes){const C=i.accounts[p.id]||i.accounts[p.internalName]||{},I=C.notificationAmount||{};r.setControl(p.id,this.formBuilder.group({access:[C.access||Ne.B.NONE,_.kI.required],notificationAmount:this.formBuilder.group({min:I.min,max:I.max})}))}this.form.setControl("accounts",r)}if(!(0,m.cS)(t.paymentTypes)){const r=this.formBuilder.group({});for(const p of t.paymentTypes){const C=i.payments[p.id]||i.payments[p.internalName]||{};r.setControl(p.id,this.formBuilder.group({perform:C.perform,maxAmountPerDay:C.perform?C.maxAmountPerDay:null,requiresAuthorization:C.perform&&C.requiresAuthorization,authorize:C.authorize}))}this.form.setControl("payments",r)}this.form.addControl("editOwnProfile",new _.NI(i.editOwnProfile)),this.form.addControl("restrictPaymentsToUsers",new _.NI(i.restrictPaymentsToUsers)),t.canHaveNotifications&&this.form.addControl("notifications",new _.NI(i.notifications)),t.canChargebackPayments&&this.form.addControl("chargebackPayments",new _.NI(i.chargebackPayments)),t.canReceivePayments&&this.form.addControl("receivePayments",new _.NI(i.receivePayments)),t.canRequestPayments&&this.form.addControl("requestPayments",new _.NI(i.requestPayments)),t.canViewAdvertisements&&this.form.addControl("viewAdvertisements",new _.NI(i.viewAdvertisements)),t.canManageAdvertisements&&this.form.addControl("manageAdvertisements",new _.NI(i.manageAdvertisements)),t.canHaveMessages&&this.form.addControl("messages",new _.NI(i.messages));let o=[];i.enableToken&&o.push("enable"),i.blockToken&&o.push("block"),i.unblockToken&&o.push("unblock"),i.cancelToken&&o.push("cancel"),this.tokenPermissions=new _.NI(o),t.canPerformVoucherTransactions&&this.form.addControl("voucherTransactions",new _.NI(i.voucherTransactions)),t.broker&&this.form.addControl("brokering",new _.NI(i.brokering)),(0,m.cS)(t.operations)||this.form.addControl("operations",new _.NI(i.operations)),(0,m.cS)(t.recordTypes)||this.form.addControl("records",new _.NI(i.records)),i.version&&this.form.addControl("version",new _.NI(i.version))}paymentTypes(t){return this.paymentTypesFromId(t.id)}paymentTypesFromId(t){return(this.data.paymentTypes||[]).filter(i=>i.from.id===t)}save(){if(!(0,m.pt)(this.form))return;const t=this.form.value;Object.keys(t.accounts).filter(r=>t.accounts[r].access===Ne.B.NONE).forEach(r=>this.paymentTypesFromId(r).forEach(p=>delete t.payments[p.id]));const i=this.tokenPermissions.value;t.enableToken=i.includes("enable"),t.blockToken=i.includes("block"),t.unblockToken=i.includes("unblock"),t.cancelToken=i.includes("cancel");const o=this.create?this.operatorGroupsService.createOperatorGroup({user:this.user,body:t}):this.operatorGroupsService.updateOperatorGroup({id:this.id,body:t});this.addSub(o.subscribe(r=>{this.notification.snackBar(this.create?this.i18n.operatorGroup.created:this.i18n.operatorGroup.saved),this.router.navigate(["/users","operator-groups",r||this.id])}))}get restrictPaymentsToUsers(){return this.data.restrictPaymentsToUsers}resolveVoucherTransactionsLabel(){return this.data.topUpEnabled?this.i18n.operatorGroup.voucherTransactions:this.i18n.operatorGroup.voucherTransactionsRedeems}hasTokenPermissions(){return this.data.canEnableToken||this.data.canBlockToken||this.data.canUnblockToken||this.data.canCancelToken}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.OPERATOR_GROUPS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(yt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["operator-group-form"]],features:[e.qOj],decls:7,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],["generalAccounts",""],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["mode","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","description",3,"label"],[1,"mt-3","mb-0"],["formControlName","editOwnProfile",3,"label"],["formControlName","notifications",3,"label",4,"ngIf"],["formControlName","viewAdvertisements",3,"label",4,"ngIf"],["formControlName","manageAdvertisements",3,"label",4,"ngIf"],["formControlName","messages",3,"label",4,"ngIf"],["horizontal","","masterValue","enable",3,"label","formControl",4,"ngIf"],["formControlName","records",3,"label",4,"ngIf"],["formControlName","operations",3,"label",4,"ngIf"],["formControlName","brokering",3,"label",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],["mode","fieldView",3,"label"],[3,"user"],["formControlName","notifications",3,"label"],["formControlName","viewAdvertisements",3,"label"],["formControlName","manageAdvertisements",3,"label"],["formControlName","messages",3,"label"],["horizontal","","masterValue","enable",3,"label","formControl"],["value","enable",3,"text",4,"ngIf"],["value","block",3,"text",4,"ngIf"],["value","unblock",3,"text",4,"ngIf"],["value","cancel",3,"text",4,"ngIf"],["value","enable",3,"text"],["value","block",3,"text"],["value","unblock",3,"text"],["value","cancel",3,"text"],["formControlName","records",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","operations",3,"label"],["formControlName","brokering",3,"label"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],["class","mt-3 mb-0",4,"ngIf"],["formControlName","access","required","",3,"label","fieldOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"formGroup",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],["formControlName","min",3,"label","scale","prefix","suffix"],["formControlName","max",3,"label","scale","prefix","suffix"],["formControlName","perform",3,"label"],["formControlName","requiresAuthorization",3,"label",4,"ngIf"],["formControlName","maxAmountPerDay",3,"label","scale","prefix","suffix",4,"ngIf"],["formControlName","authorize",3,"label"],[1,"inner-separator"],[1,"mt-3","mb-2"],["formControlName","requiresAuthorization",3,"label"],["formControlName","maxAmountPerDay",3,"label","scale","prefix","suffix"],["formControlName","chargebackPayments",3,"label",4,"ngIf"],["formControlName","receivePayments",3,"label",4,"ngIf"],["formControlName","requestPayments",3,"label",4,"ngIf"],["formControlName","voucherTransactions",3,"label",4,"ngIf"],["formControlName","restrictPaymentsToUsers",3,"label","preselectedUsers"],["formControlName","chargebackPayments",3,"label"],["formControlName","receivePayments",3,"label"],["formControlName","requestPayments",3,"label"],["formControlName","voucherTransactions",3,"label"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,vc,23,26,"ng-container",1),e.qZA(),e.YNc(3,Ic,3,3,"ng-template",null,2,e.W1O),e.YNc(5,Oc,6,7,"ng-template",null,3,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,ge.q,_.JJ,_.u,_.Q7,Fe.u,O.M,js.S,_.oH,W.s,Ie.x,d.sg,d.tP,ue.f,k.h,N.x,Gt.U,Yt],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();function Pc(n,a){if(1&n&&(e.TgZ(0,"label-value",9),e._UZ(1,"user-link",10),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.group.user)}}function Qc(n,a){if(1&n&&e._UZ(0,"label-value",11),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.description)("value",t.group.description)}}function Jc(n,a){if(1&n&&(e.TgZ(0,"h2",12),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("",e.lcZ(2,1,t.layout.ltsm$)?t.i18n.operatorGroup.mobileTitle.general:t.i18n.operatorGroup.title.general," ")}}function Dc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.editOwnProfile)("value",t.i18n.general.yes)}}function Fc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.notifications)("value",t.i18n.general.yes)}}function Rc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.viewAdvertisements)("value",t.i18n.general.yes)}}function qc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.manageAdvertisements)("value",t.i18n.general.yes)}}function Mc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.messages)("value",t.i18n.general.yes)}}function Lc(n,a){1&n&&(e.ynx(0),e._uU(1,", "),e.BQk())}function Yc(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,Lc,2,0,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.hij(" ",t,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Bc(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,Yc,3,2,"ng-container",14),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.tokens.label),e.xp6(1),e.Q6J("ngForOf",t.getTokenPermissions())}}function Gc(n,a){1&n&&(e.ynx(0),e._uU(1,", "),e.BQk())}function $c(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,Gc,2,0,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",!i)}}function Hc(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,$c,3,2,"ng-container",14),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.records),e.xp6(1),e.Q6J("ngForOf",t.group.records)}}function Vc(n,a){1&n&&(e.ynx(0),e._uU(1,", "),e.BQk())}function jc(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,Vc,2,0,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",!i)}}function zc(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,jc,3,2,"ng-container",14),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.runOperations),e.xp6(1),e.Q6J("ngForOf",t.group.operations)}}function Xc(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.operatorGroup.brokering)("value",t.i18n.general.yes)}}function Kc(n,a){if(1&n&&(e.TgZ(0,"h3",12),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.accountType.name," ")}}function Wc(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(6);e.xp6(1),e.Oqu(t.i18n.operatorGroup.performPaymentsRequiresAuthorizationView)}}function el(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"currency"),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(5);e.xp6(1),e.Oqu(i.i18n.operatorGroup.performPaymentsMaxAmountPerDayView(e.xi3(2,1,t.maxAmountPerDay,t.paymentType.currency)))}}function tl(n,a){1&n&&e._UZ(0,"br")}function nl(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,Wc,2,1,"ng-container",1),e.YNc(3,el,3,4,"ng-container",1),e.YNc(4,tl,1,0,"br",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.hij(" ",t.paymentType.name,""),e.xp6(1),e.Q6J("ngIf",t.requiresAuthorization),e.xp6(1),e.Q6J("ngIf",t.maxAmountPerDay),e.xp6(1),e.Q6J("ngIf",!i)}}function il(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,nl,5,4,"ng-container",14),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.operatorGroup.performPayments),e.xp6(1),e.Q6J("ngForOf",i.paymentsByAccount[t.accountType.id])}}function ol(n,a){1&n&&(e.ynx(0),e._uU(1,", "),e.BQk())}function al(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,ol,2,0,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function rl(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,al,3,2,"ng-container",14),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.operatorGroup.authorizePayments),e.xp6(1),e.Q6J("ngForOf",i.authorizeByAccount[t.accountType.id])}}const sl=function(n,a){return{min:n,max:a}};function cl(n,a){if(1&n&&(e._UZ(0,"label-value",4),e.ALo(1,"currency"),e.ALo(2,"currency")),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.operatorGroup.paymentNotifications)("value",i.format.formatRange(e.WLB(8,sl,e.xi3(1,2,t.notificationAmount.min,t.accountType.currency),e.xi3(2,5,t.notificationAmount.max,t.accountType.currency))))}}function ll(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Kc,2,1,"h3",6),e._UZ(2,"label-value",4),e.YNc(3,il,2,2,"label-value",8),e.YNc(4,rl,2,2,"label-value",8),e.YNc(5,cl,3,11,"label-value",7),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!i.singleAccount),e.xp6(1),e.Q6J("label",i.i18n.operatorGroup.accountAccess)("value",i.userHelper.operatorGroupAccountAccess(t.access)),e.xp6(1),e.Q6J("ngIf",(null==i.paymentsByAccount[t.accountType.id]?null:i.paymentsByAccount[t.accountType.id].length)>0),e.xp6(1),e.Q6J("ngIf",(null==i.authorizeByAccount[t.accountType.id]?null:i.authorizeByAccount[t.accountType.id].length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.notificationAmount?null:t.notificationAmount.min)||(null==t.notificationAmount?null:t.notificationAmount.max))}}function ul(n,a){if(1&n&&(e.TgZ(0,"h3",12),e._uU(1),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.lcZ(2,1,t.layout.ltsm$)?t.i18n.operatorGroup.mobileTitle.generalAccount:t.i18n.operatorGroup.title.generalAccount," ")}}function pl(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.operatorGroup.chargebackPayments)("value",t.i18n.general.yes)}}function dl(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.operatorGroup.receivePayments)("value",t.i18n.general.yes)}}function _l(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.operatorGroup.requestPayments)("value",t.i18n.general.yes)}}function gl(n,a){if(1&n&&e._UZ(0,"label-value",4),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.operatorGroup.voucherTransactions)("value",t.i18n.general.yes)}}function ml(n,a){1&n&&(e.ynx(0),e._uU(1,", "),e.BQk())}function fl(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.YNc(2,ml,2,0,"ng-container",1),e.BQk()),2&n){const t=a.$implicit,i=a.last;e.xp6(1),e.hij(" ",t.display,""),e.xp6(1),e.Q6J("ngIf",!i)}}function hl(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e.YNc(1,fl,3,2,"ng-container",14),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.operatorGroup.restrictPaymentsToUsers),e.xp6(1),e.Q6J("ngForOf",t.group.restrictPaymentsToUsers)}}function bl(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ul,3,3,"h3",6),e.YNc(2,pl,1,2,"label-value",7),e.YNc(3,dl,1,2,"label-value",7),e.YNc(4,_l,1,2,"label-value",7),e.YNc(5,gl,1,2,"label-value",7),e.YNc(6,hl,2,2,"label-value",8),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!t.singleAccount),e.xp6(1),e.Q6J("ngIf",t.group.chargebackPayments),e.xp6(1),e.Q6J("ngIf",t.group.receivePayments),e.xp6(1),e.Q6J("ngIf",t.group.requestPayments),e.xp6(1),e.Q6J("ngIf",t.group.voucherTransactions),e.xp6(1),e.Q6J("ngIf",(null==t.group.restrictPaymentsToUsers?null:t.group.restrictPaymentsToUsers.length)>0)}}function xl(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",12),e._uU(2),e.ALo(3,"async"),e.qZA(),e.YNc(4,ll,6,6,"ng-container",14),e.YNc(5,bl,7,6,"ng-container",1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,3,t.layout.ltsm$)?t.i18n.operatorGroup.mobileTitle.accountAccess:t.i18n.operatorGroup.title.accountAccess," "),e.xp6(2),e.Q6J("ngForOf",t.visibleAccounts),e.xp6(1),e.Q6J("ngIf",t.hasGeneralAccountOperations())}}function vl(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,Pc,2,2,"label-value",3),e._UZ(4,"label-value",4),e.YNc(5,Qc,1,2,"label-value",5),e.YNc(6,Jc,3,3,"h2",6),e.YNc(7,Dc,1,2,"label-value",7),e.YNc(8,Fc,1,2,"label-value",7),e.YNc(9,Rc,1,2,"label-value",7),e.YNc(10,qc,1,2,"label-value",7),e.YNc(11,Mc,1,2,"label-value",7),e.YNc(12,Bc,2,2,"label-value",8),e.YNc(13,Hc,2,2,"label-value",8),e.YNc(14,zc,2,2,"label-value",8),e.YNc(15,Xc,1,2,"label-value",7),e.YNc(16,xl,6,5,"ng-container",1),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.operatorGroup.title.view)("mobileHeading",t.i18n.operatorGroup.mobileTitle.view)("headingActions",e.lcZ(2,18,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("label",t.i18n.general.name)("value",t.group.name),e.xp6(1),e.Q6J("ngIf",t.group.description),e.xp6(1),e.Q6J("ngIf",t.group.editOwnProfile||t.group.notifications||t.group.viewAdvertisements||t.group.manageAdvertisements||t.group.messages||t.group.brokering||(null==t.group.records?null:t.group.records.length)>0||(null==t.group.operations?null:t.group.operations.length)>0),e.xp6(1),e.Q6J("ngIf",t.group.editOwnProfile),e.xp6(1),e.Q6J("ngIf",t.group.notifications),e.xp6(1),e.Q6J("ngIf",t.group.viewAdvertisements),e.xp6(1),e.Q6J("ngIf",t.group.manageAdvertisements),e.xp6(1),e.Q6J("ngIf",t.group.messages),e.xp6(1),e.Q6J("ngIf",t.hasTokenPermissions()),e.xp6(1),e.Q6J("ngIf",(null==t.group.records?null:t.group.records.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.group.operations?null:t.group.operations.length)>0),e.xp6(1),e.Q6J("ngIf",t.group.brokering),e.xp6(1),e.Q6J("ngIf",(null==t.visibleAccounts?null:t.visibleAccounts.length)>0)}}let yl=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.userHelper=i,this.operatorGroupsService=o}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.operatorGroupsService.viewOperatorGroup({id:this.id}).subscribe(t=>{this.data=t}))}get group(){return this.data}onDataInitialized(t){this.self=this.authHelper.isSelf(t.user);const i=t.accounts||[];this.visibleAccounts=i.filter(r=>r.access!==Ne.B.NONE),this.singleAccount=1===i.length,this.paymentsByAccount={},this.authorizeByAccount={};const o=t.payments||[];for(const r of this.visibleAccounts)this.paymentsByAccount[r.accountType.id]=o.filter(p=>p.perform&&p.paymentType.from.id===r.accountType.id),this.authorizeByAccount[r.accountType.id]=o.filter(p=>p.authorize&&p.paymentType.from.id===r.accountType.id).map(p=>p.paymentType);if(t.canEdit){const r=[new Q.Yu(F.l.Pencil,this.i18n.general.edit,()=>{this.router.navigateByUrl(this.router.url+"/edit")},!0)];this.layout.ltsm&&r.push(new Q.Yu(F.l.Trash,this.i18n.general.remove,()=>this.remove())),this.headingActions=r}}hasGeneralAccountOperations(){var t;return(null===(t=this.group.restrictPaymentsToUsers)||void 0===t?void 0:t.length)>0||this.group.chargebackPayments||this.group.receivePayments||this.group.requestPayments}hasTokenPermissions(){return this.group.enableToken||this.group.blockToken||this.group.unblockToken||this.group.cancelToken}getTokenPermissions(){let t=[];return this.group.enableToken&&t.push(this.i18n.operatorGroup.tokens.enable),this.group.blockToken&&t.push(this.i18n.operatorGroup.tokens.block),this.group.unblockToken&&t.push(this.i18n.operatorGroup.tokens.unblock),this.group.cancelToken&&t.push(this.i18n.operatorGroup.tokens.cancel),t}remove(){this.confirmation.confirm({message:this.i18n.general.removeConfirm(this.group.name),callback:()=>this.doRemove()})}doRemove(){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.group.name)),this.router.navigate(["/users",this.authHelper.orSelf(this.group.user),"operator-groups"])}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.OPERATOR_GROUPS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(yt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-operator-group"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],["valueFormat","break",3,"label","value",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],["valueFormat","break",3,"label","value"],[1,"mt-3","mb-0"],[3,"label"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,vl,17,20,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,Y.t,ae.F,d.sg],pipes:[d.Ov,bt.H],encapsulation:2,changeDetection:0}),n})();var Tt=s(9946);let rt=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserOperatorsDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserOperatorsDataForSearchPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserOperatorsDataForSearch(t,i){return this.getUserOperatorsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchUserOperators$Response(t,i){const o=new b.c(this.rootUrl,n.SearchUserOperatorsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("creationPeriod",t.creationPeriod,{}),o.query("ignoreProfileFieldsInList",t.ignoreProfileFieldsInList,{}),o.query("keywords",t.keywords,{}),o.query("operatorGroups",t.operatorGroups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchUserOperators(t,i){return this.searchUserOperators$Response(t,i).pipe((0,c.U)(o=>o.body))}registerOperator$Response(t,i){const o=new b.c(this.rootUrl,n.RegisterOperatorPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}registerOperator(t,i){return this.registerOperator$Response(t,i).pipe((0,c.U)(o=>o.body))}getGeneralOperatorsDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetGeneralOperatorsDataForSearchPath,"get");return t&&o.query("fields",t.fields,{explode:!1}),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getGeneralOperatorsDataForSearch(t,i){return this.getGeneralOperatorsDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchGeneralOperators$Response(t,i){const o=new b.c(this.rootUrl,n.SearchGeneralOperatorsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("userGroups",t.userGroups,{}),o.query("broker",t.broker,{}),o.query("creationPeriod",t.creationPeriod,{}),o.query("statuses",t.statuses,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchGeneralOperators(t,i){return this.searchGeneralOperators$Response(t,i).pipe((0,c.U)(o=>o.body))}getOperatorDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetOperatorDataForNewPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("group",t.group,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getOperatorDataForNew(t,i){return this.getOperatorDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserOperatorsDataForSearchPath="/{user}/operators/data-for-search",n.SearchUserOperatorsPath="/{user}/operators",n.RegisterOperatorPath="/{user}/operators",n.GetGeneralOperatorsDataForSearchPath="/operators/data-for-search",n.SearchGeneralOperatorsPath="/operators",n.GetOperatorDataForNewPath="/{user}/operators/data-for-new",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Tl(n,a){if(1&n&&(e.TgZ(0,"label-value",15),e._UZ(1,"user-link",16),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.operatorOwner),e.xp6(1),e.Q6J("user",t.data.user)}}function Al(n,a){if(1&n&&e._UZ(0,"field-option",19),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("id",t.id)("internalName",t.internalName)("text",t.name)}}function Cl(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",17),e.YNc(1,Al,1,4,"field-option",18),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.group)("emptyOption",t.i18n.user.operatorNoGroup),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function wl(n,a){if(1&n&&e._UZ(0,"input-field",20),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.name)}}function El(n,a){if(1&n&&e._UZ(0,"input-field",21),2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.username)}}function Zl(n,a){if(1&n&&e._UZ(0,"input-field",24),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.user.email)("required",t.data.emailRequired)}}function Il(n,a){if(1&n&&e._UZ(0,"boolean-field",25),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.user.registration.skipActivationEmail)}}function Sl(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Zl,1,2,"input-field",22),e.YNc(2,Il,1,1,"boolean-field",23),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.canEdit("email")),e.xp6(1),e.Q6J("ngIf",t.data.allowSetSendActivationEmail)}}function Ul(n,a){if(1&n&&e._UZ(0,"custom-field-input",28),2&n){const t=e.oxw().$implicit;e.Q6J("field",t)("formControlName",t.internalName)}}function Nl(n,a){if(1&n&&(e.ynx(0,26),e.YNc(1,Ul,1,2,"custom-field-input",27),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("formGroup",i.form.get("customValues")),e.xp6(1),e.Q6J("ngIf",i.canEdit(t))}}function kl(n,a){if(1&n&&(e.ynx(0,26),e._UZ(1,"input-field",29),e.BQk()),2&n){const t=e.oxw(3);e.Q6J("formGroup",t.mobileForm),e.xp6(1),e.Q6J("label",t.i18n.phone.mobile)("required","required"===t.mobileAvailability)("placeholder",t.data.phoneConfiguration.mobileExample)}}function Ol(n,a){if(1&n&&e._UZ(0,"input-field",31),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.extension)}}function Pl(n,a){if(1&n&&(e.ynx(0,26),e._UZ(1,"input-field",29),e.YNc(2,Ol,1,1,"input-field",30),e.BQk()),2&n){const t=e.oxw(3);e.Q6J("formGroup",t.landLineForm),e.xp6(1),e.Q6J("label",t.i18n.phone.landLine)("required","required"===t.data.phoneConfiguration.landLineAvailability)("placeholder",t.data.phoneConfiguration.landLineExample),e.xp6(1),e.Q6J("ngIf",t.data.phoneConfiguration.extensionEnabled)}}function Ql(n,a){if(1&n&&(e.TgZ(0,"div",34),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.description)}}function Jl(n,a){if(1&n&&e._UZ(0,"boolean-field",35),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.user.registration.passwordAssign)}}function Dl(n,a){if(1&n&&e._UZ(0,"boolean-field",39),2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.registration.passwordForceChange)}}function Fl(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"input-field",36)(2,"input-field",37),e.YNc(3,Dl,1,1,"boolean-field",38),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("label",t.name),e.xp6(1),e.Q6J("label",i.i18n.user.passwordConfirmation(t.name)),e.xp6(1),e.Q6J("ngIf",t.canForceChange)}}function Rl(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.ynx(3,26),e.YNc(4,Ql,2,1,"div",32),e.YNc(5,Jl,1,1,"boolean-field",33),e.YNc(6,Fl,4,3,"ng-container",10),e.BQk()()),2&n){const t=a.$implicit,i=a.index,o=e.oxw(3);e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("formGroup",o.passwordForms[i]),e.xp6(1),e.Q6J("ngIf",t.description),e.xp6(1),e.Q6J("ngIf",o.login.user),e.xp6(1),e.Q6J("ngIf",o.passwordForms[i].get("defined").value)}}function ql(n,a){if(1&n){const t=e.EpF();e.ynx(0,5),e.YNc(1,Tl,2,2,"label-value",6),e.YNc(2,Cl,2,3,"single-selection-field",7),e.YNc(3,wl,1,1,"input-field",8),e.YNc(4,El,1,1,"input-field",9),e.YNc(5,Sl,3,2,"ng-container",10),e.YNc(6,Nl,2,2,"ng-container",11),e.YNc(7,kl,2,4,"ng-container",12),e.YNc(8,Pl,3,5,"ng-container",12),e.YNc(9,Rl,7,5,"ng-container",13),e.TgZ(10,"actions")(11,"action-button",14),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).register()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("ngIf",t.data.groups.length>0),e.xp6(1),e.Q6J("ngIf",t.canEdit("name")),e.xp6(1),e.Q6J("ngIf",t.canEdit("username")),e.xp6(1),e.Q6J("ngIf",t.canEdit("email")),e.xp6(1),e.Q6J("ngForOf",t.data.customFields),e.xp6(1),e.Q6J("ngIf","disabled"!==t.mobileAvailability),e.xp6(1),e.Q6J("ngIf","disabled"!==t.landLineAvailability),e.xp6(1),e.Q6J("ngForOf",t.data.passwordTypes),e.xp6(2),e.Q6J("label",t.i18n.general.submit)}}function Ml(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.YNc(1,ql,12,11,"ng-container",4),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(4);e.Q6J("heading",t.i18n.user.title.operatorRegistration)("mobileHeading",t.i18n.user.mobileTitle.operatorRegistration),e.xp6(1),e.Q6J("ngIf",null==e.lcZ(2,4,t.result$))("ngIfElse",i)}}function Ll(n,a){if(1&n){const t=e.EpF();e._UZ(0,"p",40),e.ALo(1,"trust"),e.TgZ(2,"actions",41)(3,"action-button",14),e.NdJ("action",function(){return e.CHM(t),e.oxw().reload()}),e.qZA(),e.TgZ(4,"action-button",14),e.NdJ("action",function(){return e.CHM(t),e.oxw().viewProfile()}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("innerHTML",e.lcZ(1,3,t.doneMessageHtml),e.oJD),e.xp6(3),e.Q6J("label",t.i18n.user.operatorRegistrationAddAnother),e.xp6(1),e.Q6J("label",t.i18n.user.registration.viewProfile)}}let Yl=(()=>{class n extends y.y{constructor(t,i,o){super(t),this.userHelper=i,this.operatorsService=o,this.result$=new oe.X(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.user),this.addSub(this.operatorsService.getOperatorDataForNew({user:this.user}).subscribe(t=>this.data=t))}onDataInitialized(t){this.form=this.formBuilder.group({group:null}),[this.mobileForm,this.landLineForm]=this.userHelper.setupRegistrationForm(this.form,t,!1),this.passwordForms=this.userHelper.passwordRegistrationForms(t),this.editableFields=this.userHelper.fieldNamesByAction(t,"edit")}canEdit(t){return this.editableFields.has(this.fieldHelper.fieldName(t))}get mobileAvailability(){return this.data.phoneConfiguration.mobileAvailability}get landLineAvailability(){return this.data.phoneConfiguration.landLineAvailability}register(){var t,i;const o=(0,m.lz)(this.form);if(this.mobileForm&&o.setControl("mobilePhones",new _.Oe([this.mobileForm])),this.landLineForm&&o.setControl("landLinePhones",new _.Oe([this.landLineForm])),o.setControl("passwords",new _.Oe(this.passwordForms)),!(0,m.pt)(o))return;const r=o.value;r.mobilePhones=null===(t=r.mobilePhones)||void 0===t?void 0:t.filter(p=>!(0,m.cS)(p.number)),r.landLinePhones=null===(i=r.landLinePhones)||void 0===i?void 0:i.filter(p=>!(0,m.cS)(p.number)),this.addSub(this.operatorsService.registerOperator({user:this.user,body:r}).subscribe(p=>this.result$.next(p)))}get doneMessageHtml(){const t=this.result$.value;if(!t)return null;const i=t.user.display;switch(t.status){case Tt.s.ACTIVE:return this.i18n.user.operatorRegistrationActive(i);case Tt.s.INACTIVE:return this.i18n.user.operatorRegistrationInactive(i);case Tt.s.EMAIL_VALIDATION:return this.i18n.user.operatorRegistrationPending(i)}}viewProfile(){const t=this.result$.value;t&&this.router.navigate(["/users",t.user.id,"profile"])}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.MY_OPERATORS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["operator-registration"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading",4,"ngIf"],["done",""],["last","",3,"heading","mobileHeading"],["autocomplete","off",3,"formGroup",4,"ngIf","ngIfElse"],["autocomplete","off",3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","group",3,"label","emptyOption",4,"ngIf"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label","action"],[3,"label"],[3,"user"],["formControlName","group",3,"label","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["formControlName","email",3,"label","required",4,"ngIf"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["formControlName","email",3,"label","required"],["formControlName","skipActivationEmail",3,"label"],[3,"formGroup"],[3,"field","formControlName",4,"ngIf"],[3,"field","formControlName"],["formControlName","number",3,"label","required","placeholder"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],[3,"innerHTML"],["forceRow",""]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ml,3,6,"page-content",1),e.YNc(3,Ll,5,5,"ng-template",null,2,e.W1O),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,ue.f,_.JJ,_.u,d.sg,W.s,ge.q,_.Q7,O.M,ft.G,k.h,N.x],pipes:[d.Ov,ht.a],encapsulation:2,changeDetection:0}),n})();var jt=s(8134),zt=s(1873),Bl=s(5599),Gl=s(2939),$l=s(9244),Hl=s(6333);const Vl=function(n,a){return{"cell-main":n,"cell-text":a}};function jl(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",8),e._UZ(2,"format-field-value",9),e.qZA(),e.BQk()),2&n){const t=a.$implicit,i=a.first,o=e.oxw().$implicit,r=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(6,Vl,i,!i)),e.xp6(1),e.Q6J("fields",r.data.customFields)("plainText",!0)("fieldName",t)("object",r.user(o))("customValues",r.customValues(o))}}function zl(n,a){if(1&n&&(e.TgZ(0,"div",10),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.hij(" ",i.operatorGroup(t)," ")}}function Xl(n,a){if(1&n&&(e.TgZ(0,"mobile-result",5),e.YNc(1,jl,3,9,"ng-container",6),e.YNc(2,zl,2,1,"div",7),e.qZA()),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("avatarImage",i.canViewImages?i.user(t).image:null)("avatarIcon","operator"===i.resultKind?null:i.SvgIcon.Person),e.xp6(1),e.Q6J("ngForOf",i.fieldsWithValue(t)),e.xp6(1),e.Q6J("ngIf","operator"===i.resultKind)}}function Kl(n,a){1&n&&e._UZ(0,"th",16)}function Wl(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(1),e.Oqu(i.fieldName(t))}}function eu(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.i18n.user.group)}}function tu(n,a){1&n&&e._UZ(0,"th",17)}function nu(n,a){if(1&n&&(e.TgZ(0,"td",16),e._UZ(1,"avatar",19),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("image",i.user(t).image)}}function iu(n,a){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",9),e.qZA()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("fields",o.data.customFields)("plainText",!0)("fieldName",t)("object",o.user(i))("customValues",o.customValues(i))}}function ou(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Oqu(i.operatorGroup(t))}}function au(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",17)(1,"button",20),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(2).removeAction(r),o.stopPropagation(),o.preventDefault()}),e._UZ(2,"icon",21),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("tooltip",t.i18n.user.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function ru(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",18),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(2);return p.canViewProfile?p.router.navigate(p.path(r)):null}),e.YNc(1,nu,2,1,"td",12),e.YNc(2,iu,2,5,"td",6),e.YNc(3,ou,2,1,"td",13),e.YNc(4,au,3,2,"td",14),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.canViewImages&&"operator"!==t.resultKind),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(1),e.Q6J("ngIf","operator"===t.resultKind),e.xp6(1),e.Q6J("ngIf",t.removeAction)}}const su=function(n){return{"cursor-pointer":n}};function cu(n,a){if(1&n&&(e.TgZ(0,"table",11)(1,"thead"),e.YNc(2,Kl,1,0,"th",12),e.YNc(3,Wl,2,1,"th",6),e.YNc(4,eu,2,1,"th",13),e.YNc(5,tu,1,0,"th",14),e.qZA(),e.TgZ(6,"tbody"),e.YNc(7,ru,5,4,"tr",15),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,su,t.canViewProfile)),e.xp6(2),e.Q6J("ngIf",t.canViewImages&&"operator"!==t.resultKind),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(1),e.Q6J("ngIf","operator"===t.resultKind),e.xp6(1),e.Q6J("ngIf",t.removeAction),e.xp6(2),e.Q6J("ngForOf",null==t.results?null:t.results.results)}}function lu(n,a){if(1&n&&(e.TgZ(0,"div",8),e._UZ(1,"format-field-value",25),e.qZA()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(2).$implicit,r=e.oxw();e.Q6J("ngClass",i?"card-title":"card-text"),e.xp6(1),e.Q6J("fields",r.data.customFields)("fieldName",t)("object",r.user(o))("customValues",r.customValues(o))}}function uu(n,a){1&n&&(e.TgZ(0,"div",26),e._uU(1,"\xa0 "),e.qZA())}function pu(n,a){if(1&n&&(e.ynx(0),e.YNc(1,lu,2,5,"div",23),e.YNc(2,uu,2,0,"div",24),e.BQk()),2&n){const t=a.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngForOf",i.blankSpaces(t))}}function du(n,a){if(1&n&&(e.TgZ(0,"tiled-result",22),e.YNc(1,pu,3,2,"ng-container",13),e.qZA()),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("image",i.user(t).image)("icon",i.SvgIcon.PersonCircle),e.xp6(1),e.Q6J("ngIf",i.fieldsWithValue(t))}}const _u=function(n,a){return{"font-weight-bold":n,"mb-2":a}};function gu(n,a){if(1&n&&(e.TgZ(0,"div",8),e._UZ(1,"format-field-value",9),e.qZA()),2&n){const t=a.$implicit,i=a.first,o=a.last,r=e.oxw().$implicit,p=e.oxw();e.Q6J("ngClass",e.WLB(6,_u,i,o)),e.xp6(1),e.Q6J("fields",p.data.customFields)("plainText",!0)("fieldName",t)("object",p.user(r))("customValues",p.customValues(r))}}function mu(n,a){if(1&n&&(e.TgZ(0,"map-result",27),e.YNc(1,gu,2,9,"div",23),e.qZA()),2&n){const t=a.$implicit,i=a.address,o=e.oxw();e.Q6J("image",o.user(t).image)("address",i),e.xp6(1),e.Q6J("ngForOf",o.fieldsWithValue(t))}}let At=(()=>{class n extends Ue.H{constructor(t,i,o){super(t),this.authHelper=i,this.fieldHelper=o,this.clazz="flex-grow-1 d-flex",this.resultKind="user",this.update=new e.vpe}set data(t){this._data=t;const i=(t||{}).fieldsInList||[];this.fieldsInList=i.slice(0,Math.min(i.length,7)),this.fieldsInTile=i.slice(0,Math.min(i.length,2)),this.showTableHeader=this.fieldsInList.length>1}get data(){return this._data}ngOnInit(){super.ngOnInit(),this.canViewProfile=!0===(((this.dataForFrontendHolder.auth||{}).permissions||{}).users||{}).viewProfile||"operator"===this.resultKind}user(t){return"contact"===this.resultKind?t.contact:t}operatorGroup(t){if("operator"===this.resultKind){const i=t.group;return i?i.name:this.i18n.user.operatorNoGroup}return null}displayFunction(){return t=>{const i=this.user(t);if(i.display)return i.display;const o=i,r=this.fieldsInList[0];return o.hasOwnProperty(r)?o[r]:(o.customValues||{})[r]}}customValues(t){return null==t?null:t.customValues}address(t){return"contact"===this.resultKind?null:t.address}fieldName(t){return"operator"===this.resultKind&&"display"===t?this.i18n.general.operator:this.fieldHelper.fieldDisplay(t,this.data.customFields)}path(t){const i=this.user(t);return this.authHelper.isSelf(i)?["/users",this.ApiHelper.SELF,"profile"]:"operator"===this.resultKind?["/users","operators",i.id]:this.canViewProfile?"contact"===this.resultKind?["/users","contacts",i.id]:["/users",i.id,"profile"]:null}get toLink(){return t=>this.path(t)}get canViewImages(){return null!=this.data&&this.data.canViewImages}fieldsWithValue(t){const i=this.user(t),o=this.customValues(t),r=Object.assign(Object.assign({},i),o);return(this.fieldsInTile||[]).filter(C=>this.fieldHelper.hasValue(C,r))}blankSpaces(t){const i=(this.fieldsInList||[]).length-(t||[]).length,o=[];for(let r=0;r<i;r++)o.push("");return o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(jt.N),e.Y36(Ot.A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["users-results"]],hostVars:2,hostBindings:function(t,i){2&t&&e.Tol(i.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",referencePoint:"referencePoint",data:"data",results:"results",resultKind:"resultKind",removeAction:"removeAction"},outputs:{update:"update"},features:[e.qOj],decls:5,vars:7,consts:[[3,"results","rendering$","resultType","toAddress","referencePoint","toMarkerTitle","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",3,"ngClass",4,"resultTable"],["zoom","",3,"image","icon",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[3,"avatarImage","avatarIcon"],[4,"ngFor","ngForOf"],["class","cell-text",4,"ngIf"],[3,"ngClass"],[3,"fields","plainText","fieldName","object","customValues"],[1,"cell-text"],[1,"table","table-hover",3,"ngClass"],["class","avatar",4,"ngIf"],[4,"ngIf"],["class","actions",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"avatar"],[1,"actions"],[3,"click"],[3,"image"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],["zoom","",3,"image","icon"],[3,"ngClass",4,"ngFor","ngForOf"],["class","card-text",4,"ngFor","ngForOf"],["plainText","",1,"d-block","text-truncate",3,"fields","fieldName","object","customValues"],[1,"card-text"],[3,"image","address"]],template:function(t,i){1&t&&(e.TgZ(0,"results-layout",0),e.NdJ("update",function(r){return i.update.emit(r)}),e.YNc(1,Xl,3,4,"mobile-result",1),e.YNc(2,cu,8,8,"table",2),e.YNc(3,du,2,3,"tiled-result",3),e.YNc(4,mu,2,3,"map-result",4),e.qZA()),2&t&&e.Q6J("results",i.results)("rendering$",i.rendering$)("resultType",i.resultType)("toAddress",i.address)("referencePoint",i.referencePoint)("toMarkerTitle",i.displayFunction())("toLink",i.canViewProfile?i.toLink:null)},directives:[V.D,j.E,K.t,d.sg,d.mk,zt.x,d.O5,te.p,Ae.A,ie.i9,ne.o,Bl.r,Gl.p,$l.d,Hl.$],encapsulation:2,changeDetection:0}),n})();function bu(n,a){1&n&&e.GkF(0)}function xu(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"label-value",11),e._UZ(2,"user-link",12),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user)}}function vu(n,a){if(1&n&&e._UZ(0,"field-option",15),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function yu(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"multi-selection-field",13),e.YNc(2,vu,1,4,"field-option",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function Tu(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",6),e._UZ(2,"multi-selection-field",16),e.qZA(),e.TgZ(3,"div",6),e._UZ(4,"date-field",17),e.qZA(),e.TgZ(5,"div",6),e._UZ(6,"date-field",18),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions),e.xp6(2),e.Q6J("label",t.i18n.user.creationBegin),e.xp6(2),e.Q6J("label",t.i18n.user.creationEnd)}}function Au(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6),e._UZ(5,"input-field",7),e.qZA(),e.YNc(6,xu,3,2,"div",8),e.YNc(7,yu,3,2,"div",8),e.YNc(8,Tu,7,4,"ng-container",9),e.ALo(9,"async"),e.qZA()()(),e.TgZ(10,"users-results",10),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(11,"async"),e.ALo(12,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.self?t.i18n.user.title.myOperators:t.i18n.user.title.userOperators)("mobileHeading",t.self?t.i18n.user.mobileTitle.myOperators:t.i18n.user.mobileTitle.userOperators)("headingActions",e.lcZ(1,12,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.general.keywords),e.xp6(1),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,14,t.layout.gtxxs$)),e.xp6(2),e.Q6J("results",e.lcZ(11,16,t.results$))("rendering$",t.rendering$)("data",e.lcZ(12,18,t.data$))("resultKind","operator")}}let Xt=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.operatorsService=i,this.userHelper=o}getFormControlNames(){return["keywords","operatorGroups","statuses","creationBegin","creationEnd"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||f.S.SELF,this.self=this.authHelper.isSelf(this.param),this.statusOptions=this.userHelper.statusOptions(),this.addSub(this.operatorsService.getUserOperatorsDataForSearch({user:this.param}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),(0,m.cS)(t.fieldsInList)&&(t.fieldsInList=["display"]),!this.self&&t.canCreateNew&&(this.headingActions=[new Q.Yu(F.l.PersonPlus,this.i18n.general.addNew,()=>this.router.navigate(["/users",this.param,"operators","registration"]),!0)])}toSearchParams(t){const i=t;return i.user=this.param,i.creationPeriod=f.S.rangeFilter(t.creationBegin,t.creationEnd),delete t.customValues,i}doSearch(t){return this.operatorsService.searchUserOperators$Response(t)}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.MY_OPERATORS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(rt),e.Y36(le.T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-user-operators"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","keywords",3,"label"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","rendering$","data","resultKind","update"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","operatorGroups",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["formControlName","statuses",3,"label","fieldOptions"],["formControlName","creationBegin","fieldSize","full",3,"label"],["formControlName","creationEnd","fieldSize","full",3,"label"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,bu,1,0,"ng-container",1),e.qZA(),e.YNc(3,Au,13,20,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,ge.q,_.JJ,_.u,Y.t,ae.F,Ie.x,d.sg,W.s,et.Q,At],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var je=s(9843),se=s(7334),ke=s(4746),Ct=s(871),wt=s(7119),Cu=s(9048);function wu(n,a){if(1&n&&(e.TgZ(0,"div",10),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.type.description)}}function Eu(n,a){if(1&n&&e._UZ(0,"input-field",11),2&n){const t=e.oxw();e.Q6J("label",t.i18n.password.oldPassword)}}function Zu(n,a){if(1&n&&(e.TgZ(0,"label-value",12),e._UZ(1,"password-hints",13),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("passwordType",t.type)("control",t.form.controls.newPassword)}}function Iu(n,a){if(1&n&&e._UZ(0,"password-hints",14),2&n){const t=e.oxw();e.Q6J("passwordType",t.type)("control",t.form.controls.newPassword)}}const Su=n=>{const a=n.value;if(n.touched&&null!=a&&""!==a){const t=n.parent;if((null==t.get("newPassword")?"":t.get("newPassword").value)!==a)return{passwordsMatch:!0}}return null};let Uu=(()=>{class n extends Ue.H{constructor(t,i,o,r){super(t),this.modalRef=i,this.passwordsService=o,this.authHelper=r,this.done=new e.vpe}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.user),this.form=this.formBuilder.group({newPassword:[null,_.kI.required],newPasswordConfirmation:[null,_.kI.compose([_.kI.required,Su])]}),this.requireOld&&this.form.setControl("oldPassword",this.formBuilder.control(null,_.kI.required))}submit(){if(!(0,m.pt)(this.form))return;const t=this.form.value;t.checkConfirmation=!0,this.addSub(this.passwordsService.changePassword({user:this.param,type:this.type.id,body:t}).subscribe(()=>{this.done.emit(),this.modalRef.hide()}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.UZ),e.Y36(wt.i),e.Y36(jt.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["change-password-dialog"]],inputs:{param:"param",user:"user",type:"type",requireOld:"requireOld"},outputs:{done:"done"},features:[e.qOj],decls:15,vars:17,consts:[["class","mb-3",4,"ngIf"],[3,"formGroup"],["required","","focused","","formControlName","oldPassword","type","password",3,"label",4,"ngIf"],["required","","formControlName","newPassword","type","password",3,"label"],["label"," ",4,"ngIf"],["ngClass","mb-3",3,"passwordType","control",4,"ngIf"],["required","","formControlName","newPasswordConfirmation","type","password",3,"label"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"],[1,"mb-3"],["required","","focused","","formControlName","oldPassword","type","password",3,"label"],["label"," "],[3,"passwordType","control"],["ngClass","mb-3",3,"passwordType","control"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.YNc(2,wu,2,1,"div",0),e.ynx(3,1),e.YNc(4,Eu,1,1,"input-field",2),e._UZ(5,"input-field",3),e.YNc(6,Zu,2,2,"label-value",4),e.ALo(7,"async"),e.YNc(8,Iu,1,2,"password-hints",5),e.ALo(9,"async"),e._UZ(10,"input-field",6),e.BQk(),e.TgZ(11,"actions",7)(12,"action-button",8),e.NdJ("action",function(){return i.submit()}),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"action-button",9),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()()),2&t&&(e.xp6(1),e.hij(" ",i.self?i.i18n.password.title.changeSelf:i.i18n.password.title.changeUser,"\n"),e.xp6(1),e.Q6J("ngIf",i.type.description),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.requireOld),e.xp6(1),e.Q6J("label",i.i18n.password.newPassword),e.xp6(1),e.Q6J("ngIf",e.lcZ(7,11,i.layout.gtxs$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,13,i.layout.ltsm$)),e.xp6(2),e.Q6J("label",i.i18n.password.passwordConfirmation),e.xp6(2),e.Q6J("disabled",e.lcZ(13,15,i.requesting$))("label",i.i18n.general.submit),e.xp6(2),e.Q6J("label",i.i18n.general.cancel))},directives:[d.O5,_.JL,_.sg,ge.q,_.Q7,tt.A,_.JJ,_.u,Y.t,Cu.w,d.mk,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})(),Kt=(()=>{class n extends U.b{constructor(t,i){super(t,i)}viewUserTotpSecret$Response(t,i){const o=new b.c(this.rootUrl,n.ViewUserTotpSecretPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewUserTotpSecret(t,i){return this.viewUserTotpSecret$Response(t,i).pipe((0,c.U)(o=>o.body))}deleteUserTotpSecret$Response(t,i){const o=new b.c(this.rootUrl,n.DeleteUserTotpSecretPath,"delete");return t&&(o.path("user",t.user,{}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}deleteUserTotpSecret(t,i){return this.deleteUserTotpSecret$Response(t,i).pipe((0,c.U)(o=>o.body))}sendTotpSecretActivationCode$Response(t,i){const o=new b.c(this.rootUrl,n.SendTotpSecretActivationCodePath,"post");return t&&(o.query("fields",t.fields,{explode:!1}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}sendTotpSecretActivationCode(t,i){return this.sendTotpSecretActivationCode$Response(t,i).pipe((0,c.U)(o=>o.body))}verifyTotpSecretActivationCode$Response(t,i){const o=new b.c(this.rootUrl,n.VerifyTotpSecretActivationCodePath,"post");return t&&o.body(t.body,"text/plain"),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}verifyTotpSecretActivationCode(t,i){return this.verifyTotpSecretActivationCode$Response(t,i).pipe((0,c.U)(o=>o.body))}activateTotpSecret$Response(t,i){const o=new b.c(this.rootUrl,n.ActivateTotpSecretPath,"post");return t&&o.body(t.body,"text/plain"),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}activateTotpSecret(t,i){return this.activateTotpSecret$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.ViewUserTotpSecretPath="/{user}/totp-secret",n.DeleteUserTotpSecretPath="/{user}/totp-secret",n.SendTotpSecretActivationCodePath="/totp-secret/send-activaction-code",n.VerifyTotpSecretActivationCodePath="/totp-secret/verify-activation-code",n.ActivateTotpSecretPath="/totp-secret/activate",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Nu=s(543),ku=s(169),Ou=s(5350),st=(()=>{return(n=st||(st={})).ACTIVE="active",n.NEVER_CREATED="neverCreated",n.PENDING="pending",st;var n})(),Pu=s(3259),Qu=s(5744);const Ju=["radio"];function Du(n,a){1&n&&e.GkF(0)}function Fu(n,a){if(1&n&&(e.TgZ(0,"label-value",3),e.YNc(1,Du,1,0,"ng-container",4),e.qZA()),2&n){const t=e.oxw(),i=e.MAs(2);e.Q6J("formField",t.self)("informationText",t.informationText),e.xp6(1),e.Q6J("ngTemplateOutlet",i)}}function Ru(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.i18n.password.otp.noMediums," ")}}function qu(n,a){if(1&n&&e.YNc(0,Ru,2,1,"div",5),2&n){const t=e.oxw(),i=e.MAs(4);e.Q6J("ngIf",0===(null==t.fieldOptions?null:t.fieldOptions.length))("ngIfElse",i)}}function Mu(n,a){if(1&n&&e._UZ(0,"radio-group-field",6,7)(2,"field-errors",8),2&n){const t=e.oxw();e.Q6J("formControl",t.radioControl)("fieldOptions",t.fieldOptions),e.xp6(2),e.Q6J("control",t.formControl)}}let Lu=(()=>{class n extends qt.T{constructor(t,i){super(t,i),this.radioControl=new _.NI}ngOnInit(){var t,i,o,r;if(!this.data)throw new Error("Missing data");if(super.ngOnInit(),this.fieldOptions=[],null===(t=this.data.mediums)||void 0===t?void 0:t.includes(se.x.EMAIL)){const p=this.toStringValue({medium:se.x.EMAIL});r=p,this.fieldOptions.push({value:p,text:this.i18n.password.otp.sendToEmail(this.data.email)})}(null===(i=this.data.mediums)||void 0===i?void 0:i.includes(se.x.SMS))&&(null===(o=this.data.phones)||void 0===o||o.forEach(p=>{const C=this.toStringValue({medium:se.x.SMS,mobilePhone:p.id});r=r||C,this.fieldOptions.push({value:C,text:this.i18n.password.otp.sendToPhone(p.number)})})),this.addSub(this.radioControl.valueChanges.subscribe(p=>{this.formControl.setValue(this.fromStringValue(p))})),this.radioControl.setValue(r)}toStringValue(t){if(null==t?void 0:t.medium){if(t.medium===se.x.EMAIL)return se.x.EMAIL;if(t.medium===se.x.SMS&&t.mobilePhone)return`${se.x.SMS}#${t.mobilePhone}`}return null}fromStringValue(t){if(!(0,m.cS)(t)){const i=t.split("#");return{medium:i[0],mobilePhone:i[1]}}}getFocusableControl(){return this.radio}getDisabledValue(){var t,i,o;switch(null===(t=this.value)||void 0===t?void 0:t.medium){case se.x.EMAIL:return this.data.email;case se.x.SMS:return null===(o=null===(i=this.data.phones)||void 0===i?void 0:i.find(r=>r.id===this.value.mobilePhone))||void 0===o?void 0:o.number}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(_.gN,13))},n.\u0275cmp=e.Xpm({type:n,selectors:[["send-otp-field"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ju,5),2&t){let o;e.iGM(o=e.CRH())&&(i.radio=o.first)}},inputs:{data:"data"},features:[e._Bn([{provide:_.JU,useExisting:n,multi:!0}]),e.qOj],decls:5,vars:2,consts:[[3,"formField","informationText",4,"ngIf","ngIfElse"],["widget",""],["radioTpl",""],[3,"formField","informationText"],[4,"ngTemplateOutlet"],[4,"ngIf","ngIfElse"],["asColumn","",3,"formControl","fieldOptions"],["radio",""],[3,"control"]],template:function(t,i){if(1&t&&(e.YNc(0,Fu,2,3,"label-value",0),e.YNc(1,qu,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Mu,3,3,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",i.label)("ngIfElse",o)}},directives:[d.O5,Y.t,d.tP,it.Y,_.JJ,_.oH,Lt.e],encapsulation:2,changeDetection:0}),n})();var Yu=s(9697);const Bu=["qrCodeCanvas"];function Gu(n,a){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.i18n.password.totp.active(e.lcZ(2,1,t.data.activationDate)),"\n")}}function $u(n,a){if(1&n&&e._UZ(0,"send-otp-field",9),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.password.otp.sendMedium)("formControl",t.sendOtpControl)("data",t.data.sendVerificationCodeData)}}function Hu(n,a){if(1&n&&e._UZ(0,"input-field",10),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.password.otp.verificationCode)("formControl",t.otpControl)}}function Vu(n,a){if(1&n&&(e.ynx(0),e.YNc(1,$u,1,3,"send-otp-field",7),e.ALo(2,"async"),e.YNc(3,Hu,1,2,"input-field",8),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",null==e.lcZ(2,2,t.otpResult$)),e.xp6(2),e.Q6J("ngIf",null!=e.lcZ(4,4,t.otpResult$))}}function ju(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"div",5),e.ALo(2,"async"),e.TgZ(3,"div",6),e.YNc(4,Vu,5,6,"ng-container",0),e.ALo(5,"async"),e.qZA(),e.BQk()),2&n){const t=e.oxw(2),i=e.MAs(4);e.xp6(1),e.Q6J("innerHTML",e.lcZ(2,3,t.layout.ltmd$)?t.i18n.password.totp.neverCreatedMessageMobile:t.i18n.password.totp.neverCreatedMessage,e.oJD),e.xp6(3),e.Q6J("ngIf",null==e.lcZ(5,5,t.secretUrl$))("ngIfElse",i)}}function zu(n,a){if(1&n&&e.YNc(0,ju,6,7,"ng-container",0),2&n){const t=e.oxw(),i=e.MAs(6);e.Q6J("ngIf",t.data.canActivate)("ngIfElse",i)}}function Xu(n,a){1&n&&(e.TgZ(0,"div",13),e._UZ(1,"canvas",null,14),e.qZA())}function Ku(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",15),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).openAuthenticatorLink()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.password.totp.openApp)}}function Wu(n,a){if(1&n&&(e.YNc(0,Xu,3,0,"div",11),e.ALo(1,"async"),e.YNc(2,Ku,1,1,"ng-template",null,12,e.W1O),e._UZ(4,"input-field",10)),2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("ngIf",e.lcZ(1,4,i.layout.gtsm$))("ngIfElse",t),e.xp6(4),e.Q6J("label",i.i18n.password.totp.firstTotp)("formControl",i.totpControl)}}function ep(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw();e.hij(" ",t.i18n.password.totp.neverCreatedManagers,"\n")}}function tp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(4).sendVerificationCode()}),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.password.otp.send)}}function np(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(4).verifyCode()}),e.qZA(),e.TgZ(2,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(4).cancelCode()}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.submit),e.xp6(1),e.Q6J("label",t.i18n.general.cancel)}}function ip(n,a){if(1&n&&(e.ynx(0),e.YNc(1,tp,1,1,"action-button",16),e.ALo(2,"async"),e.YNc(3,np,3,2,"ng-container",4),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",null==e.lcZ(2,2,t.otpResult$)),e.xp6(2),e.Q6J("ngIf",null!=e.lcZ(4,4,t.otpResult$))}}function op(n,a){if(1&n&&(e.ynx(0),e.YNc(1,ip,5,6,"ng-container",4),e.ALo(2,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==e.lcZ(2,1,t.secretUrl$))}}function ap(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).activate()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.submit)}}function rp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",17),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).remove()}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.password.totp.remove)}}function sp(n,a){if(1&n&&(e.TgZ(0,"actions"),e.YNc(1,op,3,3,"ng-container",4),e.YNc(2,ap,1,1,"action-button",16),e.ALo(3,"async"),e.YNc(4,rp,1,1,"action-button",16),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.data.canActivate),e.xp6(1),e.Q6J("ngIf",e.lcZ(3,3,t.secretUrl$)),e.xp6(2),e.Q6J("ngIf",t.data.canRemove)}}let cp=(()=>{class n extends Ue.H{constructor(t,i,o){super(t),this.confirmation=i,this.totpService=o,this.TotpStatusEnum=st,this.sendOtpControl=new _.NI,this.otpResult$=new oe.X(null),this.otpControl=new _.NI,this.secretUrl$=new oe.X(null),this.totpControl=new _.NI,this.totpModified=new e.vpe}ngOnInit(){super.ngOnInit(),this.createDeviceConfirmation=this.createDeviceConfirmation=()=>({type:Ct.l.REMOVE_TOTP_SECRET}),this.data.secretUrl&&this.initializeQrCode(this.data.secretUrl)}remove(){this.confirmation.confirm({message:this.i18n.password.totp.removeConfirmation,passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:this.createDeviceConfirmation,callback:t=>{var i;return this.addSub(this.totpService.deleteUserTotpSecret({user:null===(i=this.data.user)||void 0===i?void 0:i.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>{this.notification.snackBar(this.i18n.password.totp.removeDone),this.totpModified.emit()}))}})}sendVerificationCode(){const t=this.sendOtpControl.value;(null==t?void 0:t.medium)&&this.addSub(this.totpService.sendTotpSecretActivationCode({body:t}).subscribe(i=>{this.otpResult$.next(i),this.notification.snackBar(i.sendMedium===se.x.SMS?this.i18n.password.otp.sentToPhone(i.sentTo):this.i18n.password.otp.sentToEmail(i.sentTo))}))}cancelCode(){this.otpResult$.next(null)}verifyCode(){const t=this.otpControl.value;(null==t?void 0:t.length)&&this.addSub(this.totpService.verifyTotpSecretActivationCode({body:t}).subscribe(i=>{this.initializeQrCode(i),this.notification.snackBar(this.i18n.password.totp.scanQr)}))}initializeQrCode(t){this.secretUrl$.next(t),setTimeout(()=>{var i;(null===(i=this.qrCodeCanvas)||void 0===i?void 0:i.nativeElement)&&Pu.toCanvas(this.qrCodeCanvas.nativeElement,t,{errorCorrectionLevel:"Q"})})}activate(){const t=this.totpControl.value;(null==t?void 0:t.length)&&this.addSub(this.totpService.activateTotpSecret({body:t}).subscribe(()=>{this.notification.snackBar(this.i18n.password.totp.activated),this.totpModified.emit(null)}))}openAuthenticatorLink(){const t=this.secretUrl$.value;t&&window.location.assign(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Qu.Y),e.Y36(Kt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["manage-totp-secret"]],viewQuery:function(t,i){if(1&t&&e.Gf(Bu,5),2&t){let o;e.iGM(o=e.CRH())&&(i.qrCodeCanvas=o.first)}},inputs:{data:"data"},outputs:{totpModified:"totpModified"},features:[e.qOj],decls:8,vars:3,consts:[[4,"ngIf","ngIfElse"],["notActive",""],["totpTpl",""],["cannotActivate",""],[4,"ngIf"],[1,"text-left",3,"innerHTML"],[1,"mt-3"],[3,"label","formControl","data",4,"ngIf"],["numbersOnly","",3,"label","formControl",4,"ngIf"],[3,"label","formControl","data"],["numbersOnly","",3,"label","formControl"],["class","clientSideQrCodeContainer mb-3",4,"ngIf","ngIfElse"],["launchAuthenticator",""],[1,"clientSideQrCodeContainer","mb-3"],["qrCodeCanvas",""],[1,"w-100","mb-3",3,"label","action"],[3,"label","action",4,"ngIf"],[3,"label","action"]],template:function(t,i){if(1&t&&(e.YNc(0,Gu,3,3,"ng-container",0),e.YNc(1,zu,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Wu,5,6,"ng-template",null,2,e.W1O),e.YNc(5,ep,1,1,"ng-template",null,3,e.W1O),e.YNc(7,sp,5,5,"actions",4)),2&t){const o=e.MAs(2);e.Q6J("ngIf",i.data.status===i.TotpStatusEnum.ACTIVE)("ngIfElse",o),e.xp6(7),e.Q6J("ngIf",i.data.canActivate||i.data.canRemove)}},directives:[d.O5,Lu,_.JJ,_.oH,ge.q,Yu.X,N.x,k.h],pipes:[Ce.u,d.Ov],encapsulation:2,changeDetection:0}),n})();function lp(n,a){1&n&&e.GkF(0)}function up(n,a){if(1&n&&(e.TgZ(0,"alert",7),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.loginConfirmationMessage)}}function pp(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",11)(2,"hr"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("user",t.data.user)}}function dp(n,a){1&n&&e._UZ(0,"hr",21)}function _p(n,a){if(1&n&&e._UZ(0,"avatar",22),2&n){const t=e.oxw(4);e.Q6J("size",64)("icon",t.SvgIcon.Key)}}const Et=function(n){return{"mt-0":n}};function gp(n,a){if(1&n&&(e.TgZ(0,"h2",23),e._uU(1),e.qZA()),2&n){const t=e.oxw(),o=t.$implicit;e.Q6J("ngClass",e.VKq(2,Et,t.first)),e.xp6(1),e.hij(" ",o.type.name,"")}}function mp(n,a){if(1&n&&(e.TgZ(0,"div",24),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.hij(" ",i.i18n.password.statusSince(e.lcZ(2,1,t.date))," ")}}const fp=function(n){return{"mb-3":n}};function hp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){return e.CHM(t).$implicit.onClick()}),e.qZA()}if(2&n){const t=a.$implicit;e.Q6J("ngClass",e.VKq(2,fp,!a.last))("label",t.label)}}function bp(n,a){if(1&n&&(e.ynx(0),e.YNc(1,dp,1,0,"hr",12),e.TgZ(2,"div",13)(3,"div",14),e.YNc(4,_p,1,2,"avatar",15),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"div",16),e.YNc(7,gp,2,4,"h2",17),e.TgZ(8,"div"),e._uU(9),e.qZA(),e.YNc(10,mp,3,3,"div",18),e.qZA(),e.TgZ(11,"div",19),e.YNc(12,hp,1,4,"action-button",20),e.qZA()(),e.BQk()),2&n){const t=a.$implicit,i=a.first,o=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!i),e.xp6(3),e.Q6J("ngIf",e.lcZ(5,6,o.layout.gtxxs$)),e.xp6(3),e.Q6J("ngIf",o.multiple),e.xp6(2),e.Oqu(o.status(t)),e.xp6(1),e.Q6J("ngIf",t.date),e.xp6(2),e.Q6J("ngForOf",o.actions(t))}}function xp(n,a){if(1&n&&(e.TgZ(0,"page-content",8),e.ALo(1,"async"),e.YNc(2,pp,3,1,"ng-container",9),e.YNc(3,bp,13,8,"ng-container",10),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("heading",t.title)("mobileHeading",t.mobileTitle)("last",!(null!=t.data&&t.data.totpSecret||null!=t.data&&t.data.dataForSetSecurityAnswer))("layout",t.loginConfirmation?"centered":"normal")("headingActions",e.lcZ(1,8,t.headingActions$))("ngClass",e.VKq(10,Et,t.loginConfirmation)),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.self),e.xp6(1),e.Q6J("ngForOf",t.data.passwords)}}function vp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",26)(1,"manage-totp-secret",27),e.NdJ("totpModified",function(){return e.CHM(t),e.oxw(2).reload()}),e.qZA()()}if(2&n){const t=e.oxw(2);e.Q6J("heading",t.i18n.password.title.totp)("mobileHeading",t.i18n.password.mobileTitle.totp)("layout",t.loginConfirmation?"centered":"normal")("ngClass",e.VKq(5,Et,t.loginConfirmation&&!t.showPasswords)),e.xp6(1),e.Q6J("data",t.data.totpSecret)}}function yp(n,a){if(1&n&&e._UZ(0,"field-option",35),2&n){const t=a.$implicit;e.Q6J("value",t.internalName)("text",t.name)}}function Tp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",28)(1,"alert",29),e._uU(2),e.qZA(),e.ynx(3,30),e.TgZ(4,"single-selection-field",31),e.YNc(5,yp,1,2,"field-option",32),e.qZA(),e._UZ(6,"input-field",33),e.BQk(),e.TgZ(7,"actions")(8,"action-button",34),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).setSecurityAnswer()}),e.qZA()()()}if(2&n){const t=e.oxw(2);e.Q6J("heading",t.i18n.password.title.securityAnswer)("mobileHeading",t.i18n.password.mobileTitle.securityAnswer),e.xp6(2),e.Oqu(t.i18n.securityQuestion.message),e.xp6(1),e.Q6J("formGroup",t.securityAnswer),e.xp6(1),e.Q6J("label",t.i18n.securityQuestion.question),e.xp6(1),e.Q6J("ngForOf",t.data.dataForSetSecurityAnswer.securityQuestions),e.xp6(1),e.Q6J("label",t.i18n.securityQuestion.answer),e.xp6(2),e.Q6J("label",t.i18n.general.save)}}function Ap(n,a){if(1&n&&(e.YNc(0,up,2,1,"alert",3),e.YNc(1,xp,4,12,"page-content",4),e.YNc(2,vp,2,7,"page-content",5),e.YNc(3,Tp,9,8,"page-content",6)),2&n){const t=e.oxw();e.Q6J("ngIf",t.loginConfirmationMessage),e.xp6(1),e.Q6J("ngIf",t.showPasswords),e.xp6(1),e.Q6J("ngIf",null==t.data?null:t.data.totpSecret),e.xp6(1),e.Q6J("ngIf",null==t.data?null:t.data.dataForSetSecurityAnswer)}}let Cp=(()=>{class n extends y.y{constructor(t,i,o,r,p,C){super(t),this.modal=i,this.passwordsService=o,this.totpService=r,this.nextRequestState=p,this.loginState=C,this.showPasswords=!0}ngOnInit(){var t,i;super.ngOnInit(),this.param=this.route.snapshot.params.user,this.self=this.authHelper.isSelf(this.param);const o=this.dataForFrontendHolder.auth;this.self&&!(null===(i=null===(t=o.permissions)||void 0===t?void 0:t.passwords)||void 0===i?void 0:i.manage)&&o.totpEnabled?(this.showPasswords=!1,this.addSub(this.totpService.viewUserTotpSecret({user:this.param}).subscribe(r=>{this.data={user:r.user,passwords:[],totpSecret:r}}))):this.addSub(this.passwordsService.getUserPasswordsListData({user:this.param}).subscribe(r=>{this.data=r}))}onDataInitialized(t){var i,o;if(this.loginConfirmation=null===(i=this.dataForFrontendHolder.auth)||void 0===i?void 0:i.loginConfirmation,this.loginConfirmation){const r=this.loginConfirmation.passwordType,p=(this.loginConfirmation.allowedCredentials||[]).filter(C=>[je.w.PASSWORD,je.w.TOTP].includes(C));if(t.passwords=t.passwords.filter(C=>r&&C.type.id===r.id),this.showPasswords=t.passwords.length>0,p.includes(je.w.TOTP)||(t.totpSecret=null),1===p.length)switch(p[0]){case je.w.PASSWORD:this.loginConfirmationMessage=this.i18n.login.error.confirmation.notActive.password(null===(o=this.loginConfirmation.passwordType)||void 0===o?void 0:o.name);break;case je.w.TOTP:this.loginConfirmationMessage=this.i18n.login.error.confirmation.notActive.totp}else if(p.length>1){const C=p.map(I=>this.authHelper.credentialTypeLabel(this.loginConfirmation,I));this.loginConfirmationMessage=this.i18n.login.error.confirmation.notActive.multiple(C.join(", "))}}this.multiple=t.passwords.length>1,this.self?(this.title=this.multiple?this.i18n.password.title.manageMultipleSelf:this.i18n.password.title.manageSingleSelf,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleSelf:this.i18n.password.mobileTitle.manageSingleSelf):(this.title=this.multiple?this.i18n.password.title.manageMultipleUser:this.i18n.password.title.manageSingleUser,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleUser:this.i18n.password.mobileTitle.manageSingleUser),t.dataForSetSecurityAnswer&&(this.securityAnswer=this.formBuilder.group({securityQuestion:[null,_.kI.required],securityAnswer:[null,_.kI.required]})),this.headingActions=[],t.passwords.find(r=>{var p;return(null===(p=r.history)||void 0===p?void 0:p.length)>0})&&this.headingActions.push(new Q.Yu(this.SvgIcon.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"passwords","history"]),!0)),t.totpSecret&&(t.totpSecret.user=t.user)}actions(t){const i=[],o=t.permissions||{};return o.change&&i.push(new Q.aU(this.i18n.password.action.change,()=>{this.change(t)})),o.changeGenerated&&i.push(new Q.aU(this.i18n.password.action.change,()=>{this.changeGenerated(t)})),o.allowGeneration&&i.push(new Q.aU(this.i18n.password.action.allowGeneration,()=>{this.allowGeneration(t)})),o.resetAndSend&&(this.data.sendMediums.includes(se.x.EMAIL)&&i.push(new Q.aU(this.i18n.password.action.resetAndSendEmail,()=>{this.resetAndSend(t,se.x.EMAIL)})),this.data.sendMediums.includes(se.x.SMS)&&i.push(new Q.aU(this.i18n.password.action.resetAndSendSms,()=>{this.resetAndSend(t,se.x.SMS)}))),o.resetGenerated&&i.push(new Q.aU(this.i18n.password.action.resetGenerated,()=>{this.resetGenerated(t)})),o.unblock&&i.push(new Q.aU(this.i18n.password.action.unblock,()=>{this.unblock(t)})),o.generate&&i.push(new Q.aU(this.i18n.password.action.activate,()=>{this.generate(t)})),o.enable&&i.push(new Q.aU(this.i18n.password.action.enable,()=>{this.enable(t)})),o.disable&&i.push(new Q.aU(this.i18n.password.action.disable,()=>{this.disable(t)})),i}setSecurityAnswer(){!(0,m.pt)(this.securityAnswer)||this.addSub(this.passwordsService.setSecurityAnswer({body:this.securityAnswer.value}).subscribe(()=>{this.notification.snackBar(this.i18n.securityQuestion.set),this.reload()}))}status(t){switch(t.status){case ke.M.ACTIVE:return this.i18n.password.status.active;case ke.M.DISABLED:return this.i18n.password.status.disabled;case ke.M.EXPIRED:return this.i18n.password.status.expired;case ke.M.INDEFINITELY_BLOCKED:return this.i18n.password.status.indefinitelyBlocked;case ke.M.NEVER_CREATED:return this.i18n.password.status.neverCreated;case ke.M.PENDING:return this.i18n.password.status.pending;case ke.M.RESET:return this.i18n.password.status.reset;case ke.M.TEMPORARILY_BLOCKED:return this.i18n.password.status.temporarilyBlocked}}change(t){const o=this.modal.show(Uu,{class:"modal-form",initialState:{param:this.param,type:t.type,user:this.data.user,requireOld:t.requireOldPasswordForChange}}).content;this.addSub(o.done.subscribe(()=>{this.notification.snackBar(this.i18n.password.action.changeDone(t.type.name)),this.reload()}))}generate(t){this.confirmation.confirm({title:this.i18n.password.action.activate,message:this.i18n.password.action.activateConfirm(t.type.name),callback:()=>this.doGenerate(t)})}doGenerate(t){this.addSub(this.passwordsService.generatePassword({type:t.type.id}).subscribe(i=>{this.nextRequestState.leaveNotification=!0,this.notification.info(this.i18n.password.action.changeGeneratedDone({type:t.type.name,value:i})),this.reload()}))}createDeviceConfirmation(t){return()=>({type:Ct.l.GENERATE_PASSWORD,passwordType:t.type.id})}changeGenerated(t){this.confirmation.confirm({title:this.i18n.password.action.change,message:this.i18n.password.action.changeGeneratedConfirm(t.type.name),createDeviceConfirmation:this.createDeviceConfirmation(t),passwordInput:this.data.confirmationPasswordInput,callback:i=>this.doChangeGenerated(t,i.confirmationPassword)})}doChangeGenerated(t,i){this.addSub(this.passwordsService.changeGenerated({type:t.type.id,confirmationPassword:i}).subscribe(o=>{this.nextRequestState.leaveNotification=!0,this.notification.info(this.i18n.password.action.changeGeneratedDone({type:t.type.name,value:o})),this.reload()}))}allowGeneration(t){this.confirmation.confirm({title:this.i18n.password.action.allowGeneration,message:this.i18n.password.action.allowGenerationConfirm(t.type.name),callback:()=>this.doAllowGeneration(t)})}doAllowGeneration(t){this.addSub(this.passwordsService.allowGeneration({type:t.type.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.allowGenerationDone(t.type.name)),this.reload()}))}resetGenerated(t){this.confirmation.confirm({title:this.i18n.password.action.resetGenerated,message:this.i18n.password.action.resetGeneratedConfirm(t.type.name),callback:()=>this.doResetGenerated(t)})}doResetGenerated(t){this.addSub(this.passwordsService.resetGeneratedPassword({type:t.type.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.resetGeneratedDone(t.type.name)),this.reload()}))}resetAndSend(t,i){let o,r;switch(i){case se.x.EMAIL:o=this.i18n.password.action.resetAndSendEmail,r=this.i18n.password.action.resetAndSendEmailConfirm(t.type.name);break;case se.x.SMS:o=this.i18n.password.action.resetAndSendSms,r=this.i18n.password.action.resetAndSendSmsConfirm(t.type.name)}this.confirmation.confirm({title:o,message:r,callback:()=>this.doResetAndSend(t,i)})}doResetAndSend(t,i){this.addSub(this.passwordsService.resetAndSendPassword({type:t.type.id,sendMediums:[i],user:this.param}).subscribe(()=>{switch(i){case se.x.EMAIL:this.notification.snackBar(this.i18n.password.action.resetAndSendEmailDone(t.type.name));break;case se.x.SMS:this.notification.snackBar(this.i18n.password.action.resetAndSendSmsDone(t.type.name))}this.reload()}))}unblock(t){this.confirmation.confirm({title:this.i18n.password.action.unblock,message:this.i18n.password.action.unblockConfirm(t.type.name),callback:()=>this.doUnblock(t)})}doUnblock(t){this.addSub(this.passwordsService.unblockPassword({user:this.param,type:t.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.unblockDone(t.type.name)),this.reload()}))}enable(t){this.confirmation.confirm({title:this.i18n.password.action.enable,message:this.i18n.password.action.enableConfirm(t.type.name),callback:()=>this.doEnable(t)})}doEnable(t){this.addSub(this.passwordsService.enablePassword({user:this.param,type:t.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.enableDone(t.type.name)),this.reload()}))}disable(t){this.confirmation.confirm({title:this.i18n.password.action.disable,message:this.i18n.password.action.disableConfirm(t.type.name),callback:()=>this.doDisable(t)})}doDisable(t){this.addSub(this.passwordsService.disablePassword({user:this.param,type:t.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.disableDone(t.type.name)),this.reload()}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.PASSWORDS)}reload(){this.loginConfirmation?this.dataForFrontendHolder.reload().pipe((0,Re.P)()).subscribe(()=>this.router.navigateByUrl(this.loginState.redirectUrl||"")):super.reload()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.tT),e.Y36(wt.i),e.Y36(Kt),e.Y36(Nu.AM),e.Y36(ku.z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["manage-passwords"]],features:[e.qOj],decls:5,vars:6,consts:[[3,"ready","size"],[4,"ngIf","ngIfThen"],["content",""],["class","mt-3","type","warning",4,"ngIf"],[3,"heading","mobileHeading","last","layout","headingActions","ngClass",4,"ngIf"],["hideBack","","last","!(data?.dataForSetSecurityAnswer)",3,"heading","mobileHeading","layout","ngClass",4,"ngIf"],["hideBack","","last","",3,"heading","mobileHeading",4,"ngIf"],["type","warning",1,"mt-3"],[3,"heading","mobileHeading","last","layout","headingActions","ngClass"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px",3,"size","icon",4,"ngIf"],[1,"col-8","col-md-7"],["class","border-0 mb-3",3,"ngClass",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px",1,"ml-2","mr-5","management",3,"size","icon"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"d-block","ml-auto",3,"ngClass","label","action"],["hideBack","","last","!(data?.dataForSetSecurityAnswer)",3,"heading","mobileHeading","layout","ngClass"],[3,"data","totpModified"],["hideBack","","last","",3,"heading","mobileHeading"],["type","info"],[3,"formGroup"],["formControlName","securityQuestion","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,lp,1,0,"ng-container",1),e.qZA(),e.YNc(3,Ap,4,4,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,4,i.data$))("size",i.loginConfirmation?"medium":"full"),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,Ou.wx,E.Y,d.mk,H.M,d.sg,Ae.A,N.x,cp,_.JL,_.sg,ue.f,_.JJ,_.u,_.Q7,W.s,ge.q,k.h],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var ye=(()=>{return(n=ye||(ye={})).ACTIVATE="activate",n.ALLOW_ACTIVATION="allow_activation",n.CHANGE="change",n.DISABLE="disable",n.ENABLE="enable",n.RESET="reset",n.RESET_AND_SEND="resetAndSend",n.UNBLOCK="unblock",ye;var n})();function wp(n,a){1&n&&e.GkF(0)}function Ep(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",8),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"div",9),e._uU(7),e.qZA(),e.TgZ(8,"div",9),e._uU(9),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,7,t.log.date)," "),e.xp6(3),e.AsE(" ",i.i18n.general.performedBy,": ",t.log.by?t.log.by.display:i.i18n.general.administration," "),e.xp6(2),e.AsE(" ",i.i18n.general.type,": ",t.type.name," "),e.xp6(2),e.AsE(" ",i.i18n.general.action,": ",i.showActionLabel(t)," ")}}function Zp(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,4,t.log.date)),e.xp6(3),e.hij(" ",t.log.by?t.log.by.display:i.i18n.general.administration," "),e.xp6(2),e.Oqu(t.type.name),e.xp6(2),e.Oqu(i.showActionLabel(t))}}function Ip(n,a){if(1&n&&(e.TgZ(0,"table",10)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,Zp,10,6,"tr",11),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Oqu(t.i18n.general.type),e.xp6(2),e.Oqu(t.i18n.general.action),e.xp6(2),e.Q6J("ngForOf",t.logs)}}function Sp(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e._UZ(1,"user-info",4),e.qZA(),e.TgZ(2,"results-layout",5),e.YNc(3,Ep,10,9,"mobile-result",6),e.YNc(4,Ip,12,5,"table",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.password.title.history)("mobileHeading",t.i18n.password.mobileTitle.history),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.logs)("onClick",t.onClick)}}class Up{constructor(a,t){this.type=a,this.log=t}}let Np=(()=>{class n extends ce.k{constructor(t,i){super(t),this.passwordsService=i,this.logs=[]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.passwordsService.getUserPasswordsListData({user:this.param,fields:["user","passwords"]}).subscribe(t=>{this.data=t}))}onDataInitialized(t){var i;null===(i=t.passwords)||void 0===i||i.forEach(o=>{var r;return null===(r=o.history)||void 0===r?void 0:r.forEach(p=>this.logs.push(new Up(o.type,p)))})}showActionLabel(t){switch(t.log.action){case ye.ACTIVATE:return this.i18n.password.action.activate;case ye.ALLOW_ACTIVATION:return this.i18n.password.action.allowGeneration;case ye.CHANGE:return this.i18n.password.action.change;case ye.DISABLE:return this.i18n.password.action.disable;case ye.ENABLE:return this.i18n.password.action.enable;case ye.RESET:return this.i18n.password.action.resetGenerated;case ye.RESET_AND_SEND:return this.i18n.password.action.resetAndSend;case ye.UNBLOCK:return this.i18n.password.action.unblock}}get onClick(){return t=>null!=t}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(wt.i))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-passwords-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,wp,1,0,"ng-container",1),e.qZA(),e.YNc(3,Sp,5,5,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})();var qe=(()=>{return(n=qe||(qe={})).ADMINISTRATOR="administrator",n.BROKER="broker",n.MEMBER="member",qe;var n})(),kp=s(4685);let Wt=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserProductsData$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserProductsDataPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserProductsData(t,i){return this.getUserProductsData$Response(t,i).pipe((0,c.U)(o=>o.body))}assignIndividualProduct$Response(t,i){const o=new b.c(this.rootUrl,n.AssignIndividualProductPath,"post");return t&&(o.path("user",t.user,{}),o.path("product",t.product,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}assignIndividualProduct(t,i){return this.assignIndividualProduct$Response(t,i).pipe((0,c.U)(o=>o.body))}unassignIndividualProduct$Response(t,i){const o=new b.c(this.rootUrl,n.UnassignIndividualProductPath,"delete");return t&&(o.path("user",t.user,{}),o.path("product",t.product,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}unassignIndividualProduct(t,i){return this.unassignIndividualProduct$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserProductsDataPath="/{user}/products",n.AssignIndividualProductPath="/{user}/products/{product}",n.UnassignIndividualProductPath="/{user}/products/{product}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Op(n,a){1&n&&e.GkF(0)}function Pp(n,a){1&n&&e.GkF(0)}function Qp(n,a){1&n&&e.GkF(0)}const Jp=function(n,a){return{$implicit:n,title:a}},en=function(n,a){return{$implicit:n,title:a,readOnly:!0}};function Dp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",3),e.ALo(2,"async"),e._UZ(3,"user-info",4),e.YNc(4,Op,1,0,"ng-container",5),e.YNc(5,Pp,1,0,"ng-container",5),e.YNc(6,Qp,1,0,"ng-container",5),e.qZA(),e.BQk()),2&n){const t=e.oxw(),i=e.MAs(4);e.xp6(1),e.Q6J("heading",t.i18n.product.title.list)("mobileHeading",t.i18n.product.mobileTitle.list)("headingActions",e.lcZ(2,10,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.WLB(12,Jp,t.data.userProducts,t.i18n.product.assigned.individual)),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.WLB(15,en,t.data.groupProducts,t.i18n.product.assigned.group)),e.xp6(1),e.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",e.WLB(18,en,t.data.groupSetProducts,t.i18n.product.assigned.groupSet))}}function Fp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"button",14),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(4).remove(r),o.stopPropagation(),o.preventDefault()}),e._UZ(2,"icon",15),e.qZA()()}if(2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function Rp(n,a){if(1&n&&(e.TgZ(0,"div",10)(1,"div",11),e._uU(2),e.qZA(),e.YNc(3,Fp,3,2,"div",12),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(3).readOnly,o=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",!i&&o.canRemove(t))}}function qp(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Rp,4,2,"div",9),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function Mp(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(o){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(4).remove(r),o.stopPropagation()}),e._UZ(1,"icon",15),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}const ct=function(n){return{"no-border":n}};function Lp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",21),e._uU(3),e.qZA(),e.TgZ(4,"td",21),e._uU(5),e.qZA(),e.TgZ(6,"td",21),e._uU(7),e.qZA(),e.TgZ(8,"td",22),e.YNc(9,Mp,2,2,"button",23),e.qZA()(),e.BQk()),2&n){const t=a.$implicit,i=a.last,o=e.oxw(3).readOnly,r=e.oxw();e.xp6(2),e.Q6J("ngClass",e.VKq(8,ct,i)),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngClass",e.VKq(10,ct,i)),e.xp6(1),e.hij(" ",r.resolveKindLabel(t.kind)," "),e.xp6(1),e.Q6J("ngClass",e.VKq(12,ct,i)),e.xp6(1),e.hij(" ",null==t.userAccount?null:t.userAccount.name," "),e.xp6(1),e.Q6J("ngClass",e.VKq(14,ct,i)),e.xp6(1),e.Q6J("ngIf",!o&&r.canRemove(t))}}function Yp(n,a){if(1&n&&(e.TgZ(0,"table",16)(1,"thead")(2,"th",17),e._uU(3),e.qZA(),e.TgZ(4,"th",18),e._uU(5),e.qZA(),e.TgZ(6,"th",18),e._uU(7),e.qZA(),e._UZ(8,"th",19),e.qZA(),e.TgZ(9,"tbody"),e.YNc(10,Lp,10,16,"ng-container",20),e.qZA()()),2&n){const t=e.oxw(2).$implicit,i=e.oxw();e.xp6(3),e.Oqu(i.i18n.general.name),e.xp6(2),e.Oqu(i.i18n.general.type),e.xp6(2),e.hij("",i.i18n.product.userAccount," "),e.xp6(3),e.Q6J("ngForOf",t)}}function Bp(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",6),e._uU(2),e.qZA(),e.YNc(3,qp,2,1,"ng-container",7),e.ALo(4,"async"),e.YNc(5,Yp,11,4,"ng-template",null,8,e.W1O),e.BQk()),2&n){const t=e.MAs(6),i=e.oxw().title,o=e.oxw();e.xp6(2),e.Oqu(i),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,3,o.layout.ltsm$))("ngIfElse",t)}}function Gp(n,a){if(1&n&&e.YNc(0,Bp,7,5,"ng-container",1),2&n){const t=a.$implicit,i=e.oxw();e.Q6J("ngIf",!i.empty(t))}}let $p=(()=>{class n extends y.y{constructor(t,i){super(t),this.productAssignmentService=i,this.empty=m.cS}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentService.getUserProductsData({user:this.user}).subscribe(t=>this.data=t))}onDataInitialized(t){const i=[];t.assignable&&i.push(new Q.Yu(F.l.PlusCircle,this.i18n.product.assignIndividualProduct,()=>this.assign())),t.history&&i.push(new Q.Yu(F.l.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.user,"product-assignment","history"]))),this.headingActions=i}resolveKindLabel(t){switch(t){case qe.ADMINISTRATOR:return this.i18n.product.kind.administrator;case qe.BROKER:return this.i18n.product.kind.broker;case qe.MEMBER:return this.i18n.product.kind.member}}resolveMenu(){return this.menu.searchUsersMenu()}assign(){this.confirmation.confirm({title:this.i18n.product.assignIndividualProduct,labelPosition:"above",customFields:[{internalName:"products",name:this.i18n.product.product,type:$e.L.SINGLE_SELECTION,control:kp.z.SINGLE_SELECTION,hasValuesList:!0,defaultValue:this.data.assignable[0].id,possibleValues:this.data.assignable.map(t=>({id:t.id,value:t.name})),required:!0}],callback:t=>{this.addSub(this.productAssignmentService.assignIndividualProduct({product:t.customValues.products,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.product.productAssigned),this.reload()}))}})}canRemove(t){return this.data.unassignable.find(i=>t.id===i||t.internalName===i)}remove(t){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.productAssignmentService.unassignIndividualProduct({product:t.id,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Wt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-product-assignment"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["products",""],[3,"heading","mobileHeading","headingActions"],[3,"user"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-3","mb-2"],[4,"ngIf","ngIfElse"],["largeTable",""],["class","d-flex mb-2",4,"ngFor","ngForOf"],[1,"d-flex","mb-2"],[1,"cell-main"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","small-height","mb-0"],["width","40%",1,"no-border"],["width","25%",1,"no-border"],["width","10%",1,"no-border"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"actions",3,"ngClass"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Dp,7,21,"ng-container",1),e.qZA(),e.YNc(3,Gp,1,1,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,d.tP,d.sg,ie.i9,ne.o,d.mk],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var lt=(()=>{return(n=lt||(lt={})).ASSIGN="assign",n.UNASSIGN="unassign",lt;var n})();function Hp(n,a){1&n&&e.GkF(0)}function Vp(n,a){if(1&n&&(e.TgZ(0,"mobile-result")(1,"div",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.TgZ(6,"div",11),e._uU(7),e.qZA(),e.TgZ(8,"div",11),e._uU(9),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.hij(" ",t.product.name," "),e.xp6(2),e.hij(" ",e.lcZ(5,6,t.date)," "),e.xp6(3),e.AsE(" ",i.i18n.product.action," ",t.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),e.xp6(2),e.AsE(" ",i.i18n.general.performedBy," ",t.by.display," ")}}function jp(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"dateTime"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,4,t.date)),e.xp6(3),e.Oqu(t.product.name),e.xp6(2),e.hij(" ",t.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),e.xp6(2),e.Oqu(t.by.display)}}function zp(n,a){if(1&n&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,jp,10,6,"tr",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.product.product),e.xp6(2),e.Oqu(t.i18n.product.action),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function Xp(n,a){if(1&n&&(e.TgZ(0,"page-content",3)(1,"label-value",4),e._UZ(2,"user-link",5),e.qZA()(),e.TgZ(3,"results-layout",6),e.YNc(4,Vp,10,8,"mobile-result",7),e.YNc(5,zp,12,5,"table",8),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.i18n.product.title.history)("mobileHeading",t.i18n.product.mobileTitle.history),e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)("onClick",t.onClick)}}let Kp=(()=>{class n extends ce.k{constructor(t,i){super(t),this.productAssignmentSerivce=i,this.ProductAssignmentActionEnum=lt}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentSerivce.getUserProductsData({user:this.user,fields:["user","history"]}).subscribe(t=>this.data=t))}get onClick(){return t=>null!=t}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(Wt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-product-assignment-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"label"],[3,"user"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Hp,1,0,"ng-container",1),e.qZA(),e.YNc(3,Xp,6,6,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,Y.t,ae.F,V.D,j.E,K.t,te.p,d.sg],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var ut=s(3126),Ee=s(288),Wp=s(744),ze=(()=>{return(n=ze||(ze={})).CODE_NOT_SENT="codeNotSent",n.EXPIRED="expired",n.FAILED="failed",n.MAX_ATTEMPTS_REACHED="maxAttemptsReached",n.SUCCESS="success",ze;var n})();let tn=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserPhonesListData$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserPhonesListDataPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserPhonesListData(t,i){return this.getUserPhonesListData$Response(t,i).pipe((0,c.U)(o=>o.body))}listPhonesByUser$Response(t,i){const o=new b.c(this.rootUrl,n.ListPhonesByUserPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}listPhonesByUser(t,i){return this.listPhonesByUser$Response(t,i).pipe((0,c.U)(o=>o.body))}createPhone$Response(t,i){const o=new b.c(this.rootUrl,n.CreatePhonePath,"post");return t&&(o.path("user",t.user,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createPhone(t,i){return this.createPhone$Response(t,i).pipe((0,c.U)(o=>o.body))}getPhoneDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetPhoneDataForNewPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("user",t.user,{}),o.query("type",t.type,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPhoneDataForNew(t,i){return this.getPhoneDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}getPhoneDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetPhoneDataForEditPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("idOrNumber",t.idOrNumber,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPhoneDataForEdit(t,i){return this.getPhoneDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}viewPhone$Response(t,i){const o=new b.c(this.rootUrl,n.ViewPhonePath,"get");return t&&(o.path("idOrNumber",t.idOrNumber,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewPhone(t,i){return this.viewPhone$Response(t,i).pipe((0,c.U)(o=>o.body))}updatePhone$Response(t,i){const o=new b.c(this.rootUrl,n.UpdatePhonePath,"put");return t&&(o.path("idOrNumber",t.idOrNumber,{}),o.header("confirmationPassword",t.confirmationPassword,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updatePhone(t,i){return this.updatePhone$Response(t,i).pipe((0,c.U)(o=>o.body))}deletePhone$Response(t,i){const o=new b.c(this.rootUrl,n.DeletePhonePath,"delete");return t&&(o.path("idOrNumber",t.idOrNumber,{}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}deletePhone(t,i){return this.deletePhone$Response(t,i).pipe((0,c.U)(o=>o.body))}getPasswordInputForRemovePhone$Response(t,i){const o=new b.c(this.rootUrl,n.GetPasswordInputForRemovePhonePath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("idOrNumber",t.idOrNumber,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPasswordInputForRemovePhone(t,i){return this.getPasswordInputForRemovePhone$Response(t,i).pipe((0,c.U)(o=>o.body))}sendPhoneVerificationCode$Response(t,i){const o=new b.c(this.rootUrl,n.SendPhoneVerificationCodePath,"post");return t&&o.path("idOrNumber",t.idOrNumber,{}),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}sendPhoneVerificationCode(t,i){return this.sendPhoneVerificationCode$Response(t,i).pipe((0,c.U)(o=>o.body))}verifyPhone$Response(t,i){const o=new b.c(this.rootUrl,n.VerifyPhonePath,"post");return t&&(o.path("idOrNumber",t.idOrNumber,{}),o.query("code",t.code,{})),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}verifyPhone(t,i){return this.verifyPhone$Response(t,i).pipe((0,c.U)(o=>o.body))}enablePhoneForSms$Response(t,i){const o=new b.c(this.rootUrl,n.EnablePhoneForSmsPath,"post");return t&&o.path("idOrNumber",t.idOrNumber,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}enablePhoneForSms(t,i){return this.enablePhoneForSms$Response(t,i).pipe((0,c.U)(o=>o.body))}disablePhoneForSms$Response(t,i){const o=new b.c(this.rootUrl,n.DisablePhoneForSmsPath,"post");return t&&(o.path("idOrNumber",t.idOrNumber,{}),o.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}disablePhoneForSms(t,i){return this.disablePhoneForSms$Response(t,i).pipe((0,c.U)(o=>o.body))}getPasswordInputForDisablePhoneForSms$Response(t,i){const o=new b.c(this.rootUrl,n.GetPasswordInputForDisablePhoneForSmsPath,"get");return t&&(o.query("fields",t.fields,{explode:!1}),o.path("idOrNumber",t.idOrNumber,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getPasswordInputForDisablePhoneForSms(t,i){return this.getPasswordInputForDisablePhoneForSms$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserPhonesListDataPath="/{user}/phones/list-data",n.ListPhonesByUserPath="/{user}/phones",n.CreatePhonePath="/{user}/phones",n.GetPhoneDataForNewPath="/{user}/phones/data-for-new",n.GetPhoneDataForEditPath="/phones/{idOrNumber}/data-for-edit",n.ViewPhonePath="/phones/{idOrNumber}",n.UpdatePhonePath="/phones/{idOrNumber}",n.DeletePhonePath="/phones/{idOrNumber}",n.GetPasswordInputForRemovePhonePath="/phones/{idOrNumber}/password-for-remove",n.SendPhoneVerificationCodePath="/phones/{idOrNumber}/send-verification-code",n.VerifyPhonePath="/phones/{idOrNumber}/verify",n.EnablePhoneForSmsPath="/phones/{idOrNumber}/enable-for-sms",n.DisablePhoneForSmsPath="/phones/{idOrNumber}/disable-for-sms",n.GetPasswordInputForDisablePhoneForSmsPath="/phones/{idOrNumber}/password-for-disable-sms",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ed=s(1902);const td=["codeField"];let nd=(()=>{class n extends Ue.H{constructor(t,i,o){super(t),this.modalRef=i,this.phonesService=o,this.verified=new e.vpe,this.message$=new oe.X(""),this.disabled=!1,this.code=this.formBuilder.control(null,_.kI.required)}ngOnInit(){super.ngOnInit(),this.message=this.i18n.phone.verify.message}sendCode(){this.addSub(this.phonesService.sendPhoneVerificationCode({idOrNumber:this.phone.id}).subscribe(t=>{this.message=this.i18n.phone.verify.done(t),this.code.setValue(null),this.codeField.focus()}))}set message(t){this.message$.next(t)}get disableLabel(){return t=>this.i18n.phone.verify.sendDisabled(t)}verify(){!(0,m.pt)(this.code)||this.addSub(this.phonesService.verifyPhone({idOrNumber:this.phone.id,code:this.code.value}).subscribe(t=>{switch(t){case ze.SUCCESS:this.disabled=!0,this.verified.emit(!0);break;case ze.MAX_ATTEMPTS_REACHED:this.notification.error(this.i18n.phone.error.verify.maxAttempts);break;default:this.notification.error(this.i18n.phone.error.verify.invalid)}}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.UZ),e.Y36(tn))},n.\u0275cmp=e.Xpm({type:n,selectors:[["verify-phone"]],viewQuery:function(t,i){if(1&t&&e.Gf(td,7),2&t){let o;e.iGM(o=e.CRH())&&(i.codeField=o.first)}},inputs:{phone:"phone"},outputs:{verified:"verified"},features:[e.qOj],decls:18,vars:14,consts:[[1,"row"],[1,"col-3","col-form-label"],["for","smsCode"],[1,"col-6"],["id","smsCode","fieldSize","small","type","number","focused","",3,"formControl"],["codeField",""],[1,"col-3"],[1,"d-block","w-100",3,"label","disabledKey","disabledSeconds","action"],[1,"mt-3","pb-1"],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.TgZ(2,"div",0)(3,"div",1)(4,"label",2),e._uU(5),e.qZA()(),e.TgZ(6,"div",3),e._UZ(7,"input-field",4,5),e.qZA(),e.TgZ(9,"div",6)(10,"countdown-button",7),e.NdJ("action",function(){return i.sendCode()}),e.qZA()()(),e.TgZ(11,"div",8),e._uU(12),e.ALo(13,"async"),e.qZA(),e.TgZ(14,"actions")(15,"action-button",9),e.NdJ("action",function(){return i.verify()}),e.ALo(16,"async"),e.qZA(),e.TgZ(17,"action-button",10),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()()),2&t&&(e.xp6(1),e.hij(" ",i.i18n.phone.verify.title(i.phone.number),"\n"),e.xp6(4),e.hij(" ",i.i18n.phone.verify.code," "),e.xp6(2),e.Q6J("formControl",i.code),e.xp6(3),e.Q6J("label",i.i18n.phone.verify.send)("disabledKey",i.disableLabel)("disabledSeconds",30),e.xp6(2),e.Oqu(e.lcZ(13,10,i.message$)),e.xp6(3),e.Q6J("disabled",e.lcZ(16,12,i.requesting$))("label",i.i18n.general.confirm),e.xp6(2),e.Q6J("label",i.i18n.general.cancel))},directives:[ge.q,tt.A,_.JJ,_.oH,ed.E,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var id=s(2986),nn=s(7595),od=s(1787),on=s(8064),ad=s(3551),rd=s(6247),sd=s(7229),cd=s(48),an=s(2208),ld=s(4976),ud=s(9597),pd=s(507),Zt=s(3077),dd=s(5910),_d=s(3812);function gd(n,a){if(1&n&&e._UZ(0,"avatar-lightbox",22),2&n){const t=e.oxw(4);e.Q6J("image",t.images[0])("roundBorders",!1)}}function md(n,a){if(1&n&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.i18n.user.noImage," ")}}function fd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(5).removeAllImages()}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.field.image.remove)}}function hd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"actions",24)(1,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(),e.MAs(7).perform()}),e.qZA(),e.TgZ(2,"action-button",25),e.NdJ("action",function(){e.CHM(t),e.oxw();const o=e.MAs(7);return e.oxw(3).captureCamera(o)}),e.qZA(),e.YNc(3,fd,1,1,"action-button",26),e.qZA()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.field.image.upload),e.xp6(1),e.Q6J("label",t.i18n.field.image.camera),e.xp6(1),e.Q6J("ngIf",t.images.length>0&&"required"!==t.data.imageConfiguration.availability)}}function bd(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h2",15),e._uU(2),e.qZA(),e.TgZ(3,"div",16),e.YNc(4,gd,1,2,"avatar-lightbox",17),e.YNc(5,md,2,1,"div",18),e.qZA(),e.TgZ(6,"image-upload",19,20),e.NdJ("uploadDone",function(o){return e.CHM(t),e.oxw(3).onUploadDone(o)}),e.qZA(),e.YNc(8,hd,4,3,"actions",21),e.ALo(9,"async"),e.BQk()}if(2&n){const t=e.MAs(7),i=e.oxw(3);e.xp6(2),e.hij(" ",i.i18n.user.title.image," "),e.xp6(2),e.Q6J("ngIf",i.images.length>0),e.xp6(1),e.Q6J("ngIf",0===i.images.length),e.xp6(1),e.Q6J("owner",i.param),e.xp6(2),e.Q6J("ngIf",i.canEdit("image")&&!1===e.lcZ(9,5,t.uploading$))}}function xd(n,a){if(1&n&&(e.TgZ(0,"div",34),e._UZ(1,"avatar-lightbox",35),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(4);e.xp6(1),e.Q6J("image",t)("roundBorders",!1)("additionalImages",i.images)}}function vd(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",36),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(2),e.hij(" ",t.i18n.user.noImages," ")}}function yd(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(2),e.MAs(9).perform()}),e.qZA(),e.TgZ(2,"action-button",25),e.NdJ("action",function(){e.CHM(t),e.oxw(2);const o=e.MAs(9);return e.oxw(3).captureCamera(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("label",t.i18n.field.image.upload),e.xp6(1),e.Q6J("label",t.i18n.field.image.camera)}}function Td(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(5).manageImages()}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.field.image.manage)}}function Ad(n,a){if(1&n&&(e.TgZ(0,"actions",37),e.YNc(1,yd,3,2,"ng-container",4),e.ALo(2,"async"),e.YNc(3,Td,1,1,"action-button",26),e.qZA()),2&n){e.oxw();const t=e.MAs(9),i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.canUploadImages&&!1===e.lcZ(2,2,t.uploading$)),e.xp6(2),e.Q6J("ngIf",i.images.length>0)}}function Cd(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h2",27)(2,"div",28),e._uU(3),e.qZA()(),e.TgZ(4,"div",29),e.YNc(5,xd,2,3,"div",30),e.YNc(6,vd,3,1,"ng-container",4),e.qZA(),e.YNc(7,Ad,4,4,"actions",31),e.TgZ(8,"image-upload",32,33),e.NdJ("uploadDone",function(o){return e.CHM(t),e.oxw(3).onUploadDone(o)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(3),e.hij(" ",t.i18n.user.title.images," "),e.xp6(2),e.Q6J("ngForOf",t.images),e.xp6(1),e.Q6J("ngIf",0===t.images.length),e.xp6(1),e.Q6J("ngIf",t.canEdit("image")),e.xp6(1),e.Q6J("owner",t.param)("max",t.data.imageConfiguration.maxImages-t.images.length)}}function wd(n,a){if(1&n&&(e.ynx(0),e.YNc(1,bd,10,7,"ng-container",4),e.YNc(2,Cd,10,6,"ng-container",4),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","single"===t.imagesAvailability),e.xp6(1),e.Q6J("ngIf","multiple"===t.imagesAvailability)}}function Ed(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._UZ(1,"user-link",39),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.user.operatorOwner),e.xp6(1),e.Q6J("user",t.data.userConfiguration.details.user)}}function Zd(n,a){if(1&n&&e._UZ(0,"input-field",40),2&n){const t=e.oxw(2);e.Q6J("label",t.data.userConfiguration.nameLabel||t.i18n.user.name)("required",t.canEdit("name"))}}function Id(n,a){if(1&n&&e._UZ(0,"input-field",41),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.user.username)("required",t.canEdit("username"))}}function Sd(n,a){if(1&n&&e._UZ(0,"field-privacy",45),2&n){const t=e.oxw(3);e.Q6J("control",t.user.get("hiddenFields"))}}function Ud(n,a){if(1&n&&(e.TgZ(0,"label-value",42),e._UZ(1,"input-field",43),e.YNc(2,Sd,1,1,"field-privacy",44),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.user.email)("kind",t.canEdit("email")?"field":"fieldView")("forId","email")("ignoreExtraCell",!t.canManagePrivacy("email"))("required",t.canEdit("email")&&t.data.userConfiguration.emailRequired),e.xp6(1),e.Q6J("id","email")("required",t.canEdit("email")&&t.data.userConfiguration.emailRequired)}}function Nd(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.user.emailPending),e.xp6(1),e.hij(" ",t.data.userConfiguration.emailPendingValidation," ")}}function kd(n,a){if(1&n&&e._UZ(0,"custom-field-input",51),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("field",t)("formControlName",t.internalName)("binaryValues",i.data.userConfiguration.binaryValues)}}function Od(n,a){if(1&n&&e._UZ(0,"format-field-value",52),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("fieldValue",i.fieldValue(t))}}function Pd(n,a){if(1&n&&e._UZ(0,"field-privacy",53),2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("field",t.internalName)("control",i.user.get("hiddenFields"))}}function Qd(n,a){if(1&n&&(e.TgZ(0,"label-value",47),e.YNc(1,kd,1,3,"custom-field-input",48),e.YNc(2,Od,1,1,"ng-template",null,49,e.W1O),e.YNc(4,Pd,1,2,"field-privacy",50),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw().$implicit,o=e.oxw(2);e.Q6J("label",i.name)("kind",o.canEdit(i)?"field":"fieldView")("forId",i.internalName)("labelPosition","boolean"===i.type?"sideForced":"auto")("maximizeLabel","boolean"===i.type)("ignoreExtraCell",!o.canManagePrivacy(i))("required",o.canEdit(i)&&i.required)("informationText",i.informationText)("fieldSize",o.fieldSize(i)),e.xp6(1),e.Q6J("ngIf",o.canEdit(i))("ngIfElse",t)}}function Jd(n,a){if(1&n&&(e.ynx(0,6),e.YNc(1,Qd,5,11,"label-value",46),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("formGroup",i.user.get("customValues")),e.xp6(1),e.Q6J("ngIf",i.canEdit(t)||!i.isEmpty(t))}}function Dd(n,a){if(1&n&&(e.TgZ(0,"div",55),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.informationText,"")}}function Fd(n,a){if(1&n&&e._UZ(0,"custom-field-input",51),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("field",t)("formControlName",t.internalName)("binaryValues",i.data.userConfiguration.binaryValues)}}function Rd(n,a){if(1&n&&e._UZ(0,"format-field-value",52),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("fieldValue",i.fieldValue(t))}}function qd(n,a){if(1&n&&e._UZ(0,"field-privacy",53),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("field",t.internalName)("control",i.user.get("hiddenFields"))}}function Md(n,a){if(1&n&&(e.TgZ(0,"label-value",57),e.YNc(1,Fd,1,3,"custom-field-input",48),e.YNc(2,Rd,1,1,"ng-template",null,49,e.W1O),e.YNc(4,qd,1,2,"field-privacy",50),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw().$implicit,o=e.oxw(3);e.Q6J("label",i.name)("kind",o.canEdit(i)?"field":"fieldView")("forId",i.internalName)("labelPosition","boolean"===i.type?"sideForced":"auto")("ignoreExtraCell",!o.canManagePrivacy(i))("required",i.required)("informationText",i.informationText)("fieldSize",o.fieldSize(i)),e.xp6(1),e.Q6J("ngIf",o.canEdit(i))("ngIfElse",t)}}function Ld(n,a){if(1&n&&(e.ynx(0,6),e.YNc(1,Md,5,10,"label-value",56),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("formGroup",i.user.get("customValues")),e.xp6(1),e.Q6J("ngIf",i.canEdit(t)||!i.isEmpty(t))}}function Yd(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.YNc(3,Dd,2,1,"div",54),e.YNc(4,Ld,2,2,"ng-container",11),e.BQk()),2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.informationText),e.xp6(1),e.Q6J("ngForOf",i.fieldsWithSection.get(t))}}function Bd(n,a){if(1&n&&e._UZ(0,"input-field",63),2&n){const t=e.oxw(3);e.Q6J("id","mobilePhoneNumber")("placeholder",t.data.phoneConfiguration.mobileExample)}}function Gd(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(3);e.hij(" ",t.singleMobile.get("number").value," ")}}function $d(n,a){if(1&n&&e._UZ(0,"field-privacy",64),2&n){const t=e.oxw(3);e.Q6J("control",t.singleMobile.get("hidden"))}}function Hd(n,a){if(1&n&&e._UZ(0,"boolean-field",67),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.verified)("formControl",t.singleMobile.get("verified"))}}function Vd(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.verified),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.singleMobile.get("verified").value)," ")}}function jd(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Hd,1,2,"boolean-field",65),e.YNc(2,Vd,2,2,"ng-template",null,66,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.canEdit("phone"))("ngIfElse",t)}}function zd(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"boolean-field",70),e.NdJ("onClick",function(o){return e.CHM(t),e.oxw(4).maybeVerify(o)}),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.enabledSms)("formControl",t.singleMobile.get("enabledForSms"))}}function Xd(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.enabledSms),e.xp6(1),e.hij(" ",t.format.formatBoolean(t.singleMobile.get("enabledForSms").value)," ")}}function Kd(n,a){if(1&n&&(e.ynx(0),e.YNc(1,zd,1,2,"boolean-field",68),e.YNc(2,Xd,2,2,"ng-template",null,69,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.canEdit("phone"))("ngIfElse",t)}}function Wd(n,a){if(1&n&&(e.ynx(0,6),e.TgZ(1,"h2",58),e._uU(2),e.qZA(),e.TgZ(3,"label-value",59),e.YNc(4,Bd,1,2,"input-field",60),e.YNc(5,Gd,1,1,"ng-template",null,61,e.W1O),e.YNc(7,$d,1,1,"field-privacy",62),e.qZA(),e.YNc(8,jd,4,2,"ng-container",4),e.YNc(9,Kd,4,2,"ng-container",4),e.BQk()),2&n){const t=e.MAs(6),i=e.oxw(2);e.Q6J("formGroup",i.singleMobile),e.xp6(2),e.Oqu(i.i18n.phone.mobile),e.xp6(1),e.Q6J("label",i.i18n.phone.mobile)("forId","mobilePhoneNumber")("required","required"===i.data.phoneConfiguration.mobileAvailability)("ignoreExtraCell",!i.canManagePrivacy("phone")),e.xp6(1),e.Q6J("ngIf",i.canEdit("phone"))("ngIfElse",t),e.xp6(4),e.Q6J("ngIf",i.phoneHasSms(i.singleMobileManage)&&i.byManager),e.xp6(1),e.Q6J("ngIf",i.phoneHasSms(i.singleMobileManage)&&i.showEnableForSms(i.singleMobile))}}function e_(n,a){if(1&n&&e._UZ(0,"input-field",63),2&n){const t=e.oxw(3);e.Q6J("id","landLinePhoneNumber")("placeholder",t.data.phoneConfiguration.landLineExample)}}function t_(n,a){if(1&n&&e._uU(0),2&n){const t=e.oxw(3);e.hij(" ",t.singleLandLine.get("number").value," ")}}function n_(n,a){if(1&n&&e._UZ(0,"field-privacy",64),2&n){const t=e.oxw(3);e.Q6J("control",t.singleLandLine.get("hidden"))}}function i_(n,a){if(1&n&&e._UZ(0,"input-field",72),2&n){const t=e.oxw(4);e.Q6J("label",t.i18n.phone.extension)}}function o_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,i_,1,1,"input-field",71),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf",!t.disabled||t.value)}}function a_(n,a){if(1&n&&(e.ynx(0,6),e.TgZ(1,"h2",58),e._uU(2),e.qZA(),e.TgZ(3,"label-value",59),e.YNc(4,e_,1,2,"input-field",60),e.YNc(5,t_,1,1,"ng-template",null,61,e.W1O),e.YNc(7,n_,1,1,"field-privacy",62),e.qZA(),e.YNc(8,o_,2,1,"ng-container",4),e.BQk()),2&n){const t=e.MAs(6),i=e.oxw(2);e.Q6J("formGroup",i.singleLandLine),e.xp6(2),e.Oqu(i.i18n.phone.landLine),e.xp6(1),e.Q6J("label",i.i18n.phone.landLine)("forId","landLinePhoneNumber")("required","required"===i.data.phoneConfiguration.landLineAvailability)("ignoreExtraCell",!i.canManagePrivacy("address")),e.xp6(1),e.Q6J("ngIf",i.canEdit("phone"))("ngIfElse",t),e.xp6(4),e.Q6J("ngIf",i.data.phoneConfiguration.extensionEnabled&&i.singleLandLine.get("extension"))}}function r_(n,a){if(1&n&&e._UZ(0,"boolean-field",74),2&n){const t=e.oxw(3);e.Q6J("formControl",t.defineSingleAddress)("label",t.i18n.user.addressDefine)}}function s_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"static-map",80),e.NdJ("imageLoaded",function(){e.CHM(t);const o=e.oxw(5);return o.mapShown(o.singleAddress)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("address",t.singleAddress.value)}}function c_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(6);return o.locateAddress(o.singleAddress)}),e.qZA()}if(2&n){const t=e.oxw(6);e.Q6J("label",t.i18n.general.mapView)}}function l_(n,a){if(1&n&&(e.YNc(0,c_,1,1,"action-button",81),e.ALo(1,"async")),2&n){const t=e.oxw(5),i=e.MAs(4);e.Q6J("ngIf",!1===e.lcZ(1,2,t.singleAddress.locating$))("ngIfElse",i)}}function u_(n,a){if(1&n&&(e.TgZ(0,"label-value",77),e.YNc(1,s_,1,1,"static-map",78),e.YNc(2,l_,2,4,"ng-template",null,79,e.W1O),e.qZA()),2&n){const t=e.MAs(3),i=e.oxw(4);e.Q6J("label",i.i18n.general.map),e.xp6(1),e.Q6J("ngIf",null!=i.singleAddress.get("location").value.latitude)("ngIfElse",t)}}function p_(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"address-form",75),e.YNc(2,u_,4,3,"label-value",76),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("addressForm",t.singleAddress)("configuration",t.data.addressConfiguration)("managePrivacy",t.data.addressConfiguration.managePrivacy)("binaryValues",t.data.addressBinaryValues[null==t.data.addresses[0]?null:t.data.addresses[0].id]),e.xp6(1),e.Q6J("ngIf",t.maps.enabled)}}function d_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",58),e._uU(2),e.qZA(),e.YNc(3,r_,1,2,"boolean-field",73),e.YNc(4,p_,3,5,"ng-container",4),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Oqu(t.i18n.address.address),e.xp6(1),e.Q6J("ngIf",t.canEdit("address")&&"required"!==t.data.addressConfiguration.availability),e.xp6(1),e.Q6J("ngIf",t.defineSingleAddress.value)}}function __(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",88,89)(2,"button",90),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).addLandLine()}),e._uU(3),e.qZA(),e.TgZ(4,"button",90),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).addMobile()}),e._uU(5),e.qZA()()}if(2&n){const t=e.oxw(4);e.xp6(3),e.hij(" ",t.i18n.user.phoneAddLandLine," "),e.xp6(2),e.hij(" ",t.i18n.user.phoneAddMobile," ")}}function g_(n,a){if(1&n&&(e.TgZ(0,"div",85)(1,"button",86),e._uU(2),e.qZA(),e.YNc(3,__,6,2,"div",87),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.hij(" ",t.i18n.user.phoneAdd," ")}}function m_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",91)(1,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).addLandLine()}),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.user.phoneAddLandLine)}}function f_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",91)(1,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).addMobile()}),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.user.phoneAddMobile)}}function h_(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.user.phoneNone," ")}}function b_(n,a){if(1&n&&e._UZ(0,"input-field",72),2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.phone.extension)}}function x_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,b_,1,1,"input-field",71),e.BQk()),2&n){const t=a.ngIf;e.xp6(1),e.Q6J("ngIf",!t.disabled||t.value)}}function v_(n,a){if(1&n&&e._UZ(0,"boolean-field",97),2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.phone.verified)}}function y_(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.phone.verified),e.xp6(1),e.hij(" ",i.format.formatBoolean(t.verified)," ")}}function T_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,v_,1,1,"boolean-field",96),e.YNc(2,y_,2,2,"ng-template",null,66,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i.byManager&&i.canEdit("phone"))("ngIfElse",t)}}function A_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"boolean-field",99),e.NdJ("onClick",function(o){e.CHM(t);const r=e.oxw(2).$implicit;return e.oxw(3).maybeVerify(o,r.id)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.phone.enabledSms)}}function C_(n,a){if(1&n&&(e.TgZ(0,"label-value",38),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.phone.enabledSms),e.xp6(1),e.hij(" ",i.format.formatBoolean(t.enabledForSms)," ")}}function w_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,A_,1,1,"boolean-field",98),e.YNc(2,C_,2,2,"ng-template",null,69,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i.canEdit("phone"))("ngIfElse",t)}}function E_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).removePhone(o)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.phoneRemove)}}function Z_(n,a){if(1&n&&(e.TgZ(0,"label-value",100)(1,"div",101),e._UZ(2,"field-privacy",102),e.YNc(3,E_,1,1,"action-button",26),e.ALo(4,"async"),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.field.privacy.name),e.xp6(2),e.Q6J("control",t.form.get("hidden")),e.xp6(1),e.Q6J("ngIf",i.editableFields.has("phone")&&e.lcZ(4,3,i.layout.gtxxs$))}}function I_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).removePhone(o)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.phoneRemove)}}const S_=function(n){return{"mt-3":n}};function U_(n,a){if(1&n&&(e.TgZ(0,"div",103),e.YNc(1,I_,1,1,"action-button",26),e.qZA()),2&n){const t=e.oxw(4);e.Q6J("ngClass",e.VKq(2,S_,!t.data.phoneConfiguration.managePrivacy)),e.xp6(1),e.Q6J("ngIf",t.editableFields.has("phone"))}}function N_(n,a){1&n&&e._UZ(0,"hr")}function k_(n,a){if(1&n&&(e.ynx(0,6),e._UZ(1,"input-field",92)(2,"input-field",93),e.YNc(3,x_,2,1,"ng-container",4),e.YNc(4,T_,4,2,"ng-container",4),e.YNc(5,w_,4,2,"ng-container",4),e.YNc(6,Z_,5,5,"label-value",94),e.YNc(7,U_,2,4,"div",95),e.ALo(8,"async"),e.YNc(9,N_,1,0,"hr",4),e.BQk()),2&n){const t=a.$implicit,i=a.last,o=e.oxw(3);e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("id","phone_name"+t.idSuffix)("label",o.phoneNameLabel(t)),e.xp6(1),e.Q6J("id","phone_number"+t.idSuffix)("label",o.phoneNumberLabel(t))("placeholder",o.phoneExample(t)),e.xp6(1),e.Q6J("ngIf",o.hasExtension(t)&&t.form.get("extension")),e.xp6(1),e.Q6J("ngIf",o.byManager&&o.phoneHasSms(t)),e.xp6(1),e.Q6J("ngIf",o.phoneHasSms(t)&&o.showEnableForSms(t.form)),e.xp6(1),e.Q6J("ngIf",o.canManagePrivacy("phone")),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,12,o.layout.xxs$)||!o.data.phoneConfiguration.managePrivacy),e.xp6(2),e.Q6J("ngIf",!i)}}function O_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",82)(2,"div",28),e._uU(3),e.qZA(),e.YNc(4,g_,4,1,"div",83),e.YNc(5,m_,2,1,"div",84),e.YNc(6,f_,2,1,"div",84),e.qZA(),e.YNc(7,h_,2,1,"div",4),e.YNc(8,k_,10,14,"ng-container",11),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.i18n.user.title.phones," "),e.xp6(1),e.Q6J("ngIf",t.canCreateLandLine&&t.canCreateMobile),e.xp6(1),e.Q6J("ngIf",t.canCreateLandLine&&!t.canCreateMobile),e.xp6(1),e.Q6J("ngIf",!t.canCreateLandLine&&t.canCreateMobile),e.xp6(1),e.Q6J("ngIf",0==t.phones.length),e.xp6(1),e.Q6J("ngForOf",t.phones)}}function P_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).addAddress()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.addressAdd)}}function Q_(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.user.addressNone," ")}}function J_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).removeAddress(o)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.addressRemove)}}function D_(n,a){if(1&n&&(e.TgZ(0,"label-value",108)(1,"div",101),e._UZ(2,"field-privacy",102),e.YNc(3,J_,1,1,"action-button",26),e.ALo(4,"async"),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.field.privacy.name),e.xp6(2),e.Q6J("control",t.form.get("hidden")),e.xp6(1),e.Q6J("ngIf",i.editableFields.has("address")&&!i.maps.enabled&&e.lcZ(4,3,i.layout.gtxxs$))}}function F_(n,a){1&n&&e.GkF(0)}function R_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"label-value",109)(1,"static-map",80),e.NdJ("imageLoaded",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).mapShown(o.form)}),e.qZA(),e.YNc(2,F_,1,0,"ng-container",110),e.ALo(3,"async"),e.qZA()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(3),o=e.MAs(4);e.Q6J("label",i.i18n.general.map),e.xp6(1),e.Q6J("address",t.form.value),e.xp6(1),e.Q6J("ngIf",e.lcZ(3,4,t.form.locating$))("ngIfThen",o)}}function q_(n,a){1&n&&e._UZ(0,"div",115)}function M_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).removeAddress(o)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.addressRemove)}}function L_(n,a){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"div",116),e.TgZ(2,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).locateAddress(o.form)}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(5);e.xp6(2),e.Q6J("label",t.i18n.general.mapView)}}function Y_(n,a){if(1&n&&(e.TgZ(0,"div",111),e.YNc(1,q_,1,0,"div",112),e.ALo(2,"async"),e.TgZ(3,"div",113)(4,"actions",114),e.YNc(5,M_,1,1,"action-button",26),e.YNc(6,L_,3,1,"ng-container",4),e.ALo(7,"async"),e.qZA()()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,i.layout.gtxs$)),e.xp6(4),e.Q6J("ngIf",i.editableFields.has("address")),e.xp6(1),e.Q6J("ngIf",null==t.form.get("location").value.latitude&&!1===e.lcZ(7,5,t.form.locating$))}}function B_(n,a){1&n&&e._UZ(0,"hr")}function G_(n,a){if(1&n&&(e.ynx(0,6),e._UZ(1,"input-field",92)(2,"address-form",104),e.YNc(3,D_,5,5,"label-value",105),e.YNc(4,R_,4,6,"label-value",106),e.ALo(5,"async"),e.YNc(6,Y_,8,7,"div",107),e.ALo(7,"async"),e.YNc(8,B_,1,0,"hr",4),e.BQk()),2&n){const t=a.$implicit,i=a.last,o=e.oxw(3);e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("id","address_name"+t.idSuffix)("label",o.i18n.general.name),e.xp6(1),e.Q6J("addressForm",t.form)("ignoreContactFields",1===o.addresses.length)("configuration",o.data.addressConfiguration)("idSuffix",t.idSuffix)("managePrivacy",!1)("binaryValues",o.data.addressBinaryValues[t.id]),e.xp6(1),e.Q6J("ngIf",o.canManagePrivacy("address")),e.xp6(1),e.Q6J("ngIf",o.maps.enabled&&(null!=t.form.get("location").value.latitude||e.lcZ(5,13,t.form.locating$))),e.xp6(2),e.Q6J("ngIf",o.maps.enabled||e.lcZ(7,15,o.layout.xxs$)||!o.data.addressConfiguration.managePrivacy),e.xp6(2),e.Q6J("ngIf",!i)}}function $_(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",82)(2,"div",28),e._uU(3),e.qZA(),e.TgZ(4,"div",91),e.YNc(5,P_,1,1,"action-button",26),e.qZA()(),e.YNc(6,Q_,2,1,"div",4),e.YNc(7,G_,9,17,"ng-container",11),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.i18n.user.title.addresses," "),e.xp6(2),e.Q6J("ngIf",t.canCreateAddress),e.xp6(1),e.Q6J("ngIf",0==t.data.addresses.length),e.xp6(1),e.Q6J("ngForOf",t.addresses)}}function H_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){return e.CHM(t),e.oxw(3).addContactInfo()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("label",t.i18n.user.contactInfoAdd)}}function V_(n,a){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.i18n.user.contactInfoNone," ")}}function j_(n,a){if(1&n&&e._UZ(0,"input-field",124),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("id","contact-info_landLineExtension"+t.idSuffix)("label",i.i18n.phone.extension)}}function z_(n,a){if(1&n&&e._UZ(0,"field-option",126),2&n){const t=e.oxw().$implicit;e.Q6J("value",t.id)("text",t.name)}}function X_(n,a){if(1&n&&(e.ynx(0),e.YNc(1,z_,1,2,"field-option",125),e.BQk()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",t.id)}}function K_(n,a){if(1&n&&(e.ynx(0,6),e._UZ(1,"custom-field-input",127),e.BQk()),2&n){const t=a.$implicit,i=e.oxw().$implicit,o=e.oxw(3);e.Q6J("formGroup",i.form.get("customValues")),e.xp6(1),e.Q6J("field",t)("formControlName",t.internalName)("binaryValues",o.data.contactInfoBinaryValues[i.id])}}function W_(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw(2).$implicit;return e.oxw(3).removeContactInfo(o)}),e.qZA()}if(2&n){const t=e.oxw(5);e.Q6J("label",t.i18n.user.contactInfoRemove)}}function eg(n,a){if(1&n&&(e.TgZ(0,"label-value",108)(1,"div",101),e._UZ(2,"field-privacy",102),e.YNc(3,W_,1,1,"action-button",26),e.ALo(4,"async"),e.qZA()()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("label",i.i18n.field.privacy.name),e.xp6(2),e.Q6J("control",t.form.get("hidden")),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,3,i.layout.gtxxs$)&&i.data.contactInfoConfiguration.edit)}}function tg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",128)(1,"action-button",25),e.NdJ("action",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).removeContactInfo(o)}),e.qZA()()}if(2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.user.contactInfoRemove)}}function ng(n,a){1&n&&e._UZ(0,"hr")}function ig(n,a){if(1&n&&(e.ynx(0,6),e._UZ(1,"images-field",117)(2,"input-field",92)(3,"input-field",118)(4,"input-field",119)(5,"input-field",120),e.YNc(6,j_,1,2,"input-field",121),e.TgZ(7,"single-selection-field",122),e.YNc(8,X_,2,1,"ng-container",12),e.qZA(),e.YNc(9,K_,2,4,"ng-container",11),e.YNc(10,eg,5,5,"label-value",105),e.YNc(11,tg,2,1,"div",123),e.ALo(12,"async"),e.YNc(13,ng,1,0,"hr",4),e.BQk()),2&n){const t=a.$implicit,i=a.last,o=e.oxw(3);e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",o.i18n.general.image)("initialImages",null==o.data.contactInfoBinaryValues[t.id]?null:o.data.contactInfoBinaryValues[t.id].image),e.xp6(1),e.Q6J("id","contact-info_name"+t.idSuffix)("label",o.i18n.general.name),e.xp6(1),e.Q6J("id","contact-info_email"+t.idSuffix)("label",o.i18n.user.email),e.xp6(1),e.Q6J("id","contact-info_mobilePhone"+t.idSuffix)("label",o.i18n.phone.mobile),e.xp6(1),e.Q6J("id","contact-info_landLinePhone"+t.idSuffix)("label",o.i18n.phone.landLine),e.xp6(1),e.Q6J("ngIf",o.data.phoneConfiguration.extensionEnabled),e.xp6(1),e.Q6J("id","contact-info_address"+t.idSuffix)("label",o.i18n.address.address),e.xp6(1),e.Q6J("ngForOf",o.data.addresses),e.xp6(1),e.Q6J("ngForOf",o.data.contactInfoConfiguration.customFields),e.xp6(1),e.Q6J("ngIf",o.canManagePrivacy("contactInfo")),e.xp6(1),e.Q6J("ngIf",(e.lcZ(12,19,o.layout.xxs$)||!o.data.contactInfoConfiguration.managePrivacy)&&o.data.contactInfoConfiguration.edit),e.xp6(2),e.Q6J("ngIf",!i)}}function og(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",82)(2,"div",28),e._uU(3),e.qZA(),e.TgZ(4,"div",91),e.YNc(5,H_,1,1,"action-button",26),e.qZA()(),e.YNc(6,V_,2,1,"div",4),e.YNc(7,ig,14,21,"ng-container",11),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.i18n.user.title.contactInfos," "),e.xp6(2),e.Q6J("ngIf",t.canCreateContactInfo),e.xp6(1),e.Q6J("ngIf",0==t.contactInfos.length),e.xp6(1),e.Q6J("ngForOf",t.contactInfos)}}function ag(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.YNc(2,wd,3,2,"ng-container",4),e.TgZ(3,"h2",5),e._uU(4),e.qZA(),e.ynx(5,6),e.YNc(6,Ed,2,2,"label-value",7),e.YNc(7,Zd,1,2,"input-field",8),e.YNc(8,Id,1,2,"input-field",9),e.YNc(9,Ud,3,7,"label-value",10),e.YNc(10,Nd,2,2,"label-value",7),e.BQk(),e.YNc(11,Jd,2,2,"ng-container",11),e.YNc(12,Yd,5,3,"ng-container",12),e.YNc(13,Wd,10,10,"ng-container",13),e.YNc(14,a_,9,9,"ng-container",13),e.YNc(15,d_,5,3,"ng-container",4),e.YNc(16,O_,9,6,"ng-container",4),e.YNc(17,$_,8,4,"ng-container",4),e.YNc(18,og,8,4,"ng-container",4),e.TgZ(19,"actions")(20,"action-button",14),e.NdJ("action",function(){return e.CHM(t),e.oxw().saveOrConfirm()}),e.ALo(21,"async"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("heading",t.i18n.user.title.editProfile)("mobileHeading",t.i18n.user.mobileTitle.editProfile)("headingActions",e.lcZ(1,22,t.headingActions$)),e.xp6(2),e.Q6J("ngIf","disabled"!==t.imagesAvailability),e.xp6(1),e.Q6J("ngClass","disabled"===t.imagesAvailability?"border-0 mt-2 mt-md-0":null),e.xp6(1),e.hij(" ",t.i18n.user.title.fields," "),e.xp6(1),e.Q6J("formGroup",t.user),e.xp6(1),e.Q6J("ngIf",t.operatorOfManagedUser),e.xp6(1),e.Q6J("ngIf",t.hasField("name")),e.xp6(1),e.Q6J("ngIf",t.hasField("username")),e.xp6(1),e.Q6J("ngIf",t.hasField("email")),e.xp6(1),e.Q6J("ngIf",t.hasField("email")&&t.data.userConfiguration.emailPendingValidation),e.xp6(1),e.Q6J("ngForOf",t.fieldsWithoutSection),e.xp6(1),e.Q6J("ngForOf",t.fieldsWithSection.keys()),e.xp6(1),e.Q6J("ngIf",t.singleMobile),e.xp6(1),e.Q6J("ngIf",t.singleLandLine),e.xp6(1),e.Q6J("ngIf",t.singleAddress),e.xp6(1),e.Q6J("ngIf","multiple"===t.landLineAvailability||"multiple"===t.mobileAvailability),e.xp6(1),e.Q6J("ngIf","multiple"===t.addressAvailability),e.xp6(1),e.Q6J("ngIf","disabled"!==t.contactInfoAvailability),e.xp6(2),e.Q6J("disabled",e.lcZ(21,24,t.requesting$))("label",t.i18n.general.save)}}function rg(n,a){1&n&&e._UZ(0,"spinner")}const sg=["name","username","email"];let cg=0,rn=(()=>{class n extends y.y{constructor(t,i,o,r,p,C,I,$,be){super(t),this.usersService=i,this.imagesService=o,this.phonesService=r,this.maps=p,this.addressHelper=C,this.modal=I,this.camera=$,this.changeDetector=be,this.ready$=new oe.X(!1),this.fieldsWithSection=new Map,this.createLandLinePhones=[],this.modifyLandLinePhones=[],this.createMobilePhones=[],this.modifyMobilePhones=[],this.createAddresses=[],this.modifyAddresses=[],this.createContactInfos=[],this.modifyContactInfos=[]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||f.S.SELF,this.createDeviceConfirmation=()=>({type:Ct.l.EDIT_PROFILE}),this.headingActions=[new Q.Yu(F.l.Search,this.i18n.general.view,()=>this.router.navigate(["/users",this.param,"profile"]),!0)],this.addSub(this.usersService.getDataForEditFullProfile({user:this.param}).subscribe(t=>{this.data=t;const i=t.userConfiguration.role,o=t.userConfiguration.details,r=this.authHelper.isSelf(o);this.byManager=!this.authHelper.isSelfOrOwner(o),this.operatorOfManagedUser="operator"===i&&!this.authHelper.isSelf(o.user),r&&this.login.user$.next({id:this.login.user.id,display:t.userConfiguration.details.display,image:(0,m.cS)(t.images)?null:t.images[0]}),this.initialize(t),this.canConfirm=this.authHelper.canConfirm(t.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(t.confirmationPasswordInput)),this.ready$.next(!0)}))}locateControl(t){return(0,m.xB)(this,t)}hasField(t){return this.enabledFields.has(t)}isRequired(t){var i;if(!this.canEdit(t))return!1;if("name"===t||"username"===t)return!0;if("email"===t)return this.data.userConfiguration.emailRequired;{const o=((null===(i=this.data.userConfiguration)||void 0===i?void 0:i.customFields)||[]).find(r=>r.internalName===t||r.id===t);return o&&o.required}}fieldName(t){return"string"==typeof t?t:t.internalName}isEmpty(t){const i=this.fieldName(t);if("string"==typeof t)return(0,m.cS)(this.user.get(i).value);{const o=this.user.get("customValues");return!o||(0,m.cS)(o.get(i).value)}}canEdit(t){return this.editableFields.has(this.fieldName(t))}canManagePrivacy(t){if(!this.data.userConfiguration.enablePrivacy)return!1;switch(t){case"phone":return this.data.phoneConfiguration.managePrivacy;case"address":return this.data.addressConfiguration.managePrivacy;case"contactInfo":return this.data.contactInfoConfiguration.managePrivacy;default:return this.managePrivacyFields.has(this.fieldName(t))}}get landLineAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxLandLines)}get mobileAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxMobiles)}get addressAvailability(){return this.getAvailability((this.data.addressConfiguration||{}).maxAddresses)}get contactInfoAvailability(){return this.getAvailability((this.data.contactInfoConfiguration||{}).maxContactInfos)}get imagesAvailability(){return this.getAvailability((this.data.imageConfiguration||{}).maxImages)}getAvailability(t){return null==t||t<=0?"disabled":1===t?"single":"multiple"}resolveFormGroup(){return new _.cw({user:this.user,createLandLinePhones:new _.Oe(this.createLandLinePhones),modifyLandLinePhones:new _.Oe(this.modifyLandLinePhones),createMobilePhones:new _.Oe(this.createMobilePhones),modifyMobilePhones:new _.Oe(this.modifyMobilePhones),createAddresses:new _.Oe(this.createAddresses),modifyAddresses:new _.Oe(this.modifyAddresses),createContactInfos:new _.Oe(this.createContactInfos),modifyContactInfos:new _.Oe(this.modifyContactInfos)})}saveOrConfirm(){!(0,m.pt)(this.resolveFormGroup())||(this.data.confirmationPasswordInput?this.confirmation.confirm({title:this.i18n.user.title.confirmation,passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:this.createDeviceConfirmation,callback:t=>{this.save(t.confirmationPassword)}}):this.save())}save(t){!t&&this.confirmationPassword&&(t=this.confirmationPassword.value);const i=this.editForSubmit(),o=()=>{this.notification.snackBar(this.i18n.user.profileSaved),this.reload(),(0,m.SM)()},r=this.usersService.saveUserFullProfile({user:this.param,confirmationPassword:t,body:i});this.mainImageChanged()?this.addSub(this.usersService.getDataForEditFullProfile({user:this.param,fields:["user.version"]}).subscribe(p=>{i.user.version=p.user.version,this.addSub(r.subscribe(o))})):this.addSub(r.subscribe(o))}editForSubmit(){const t={user:(0,m.CI)(this.user)?this.user.value:null,createLandLinePhones:this.createLandLinePhones.map(i=>i.value),modifyLandLinePhones:this.modifyLandLinePhones.map(i=>i.value),createMobilePhones:this.createMobilePhones.map(i=>i.value),modifyMobilePhones:this.modifyMobilePhones.map(i=>i.value),removePhones:this.removedPhones,createAddresses:this.createAddresses.map(i=>i.value),modifyAddresses:this.modifyAddresses.map(i=>i.value),removeAddresses:this.removedAddresses,createContactInfos:this.createContactInfos.map(i=>i.value),modifyContactInfos:this.modifyContactInfos.map(i=>i.value),removeContactInfos:this.removedContactInfos};if(this.singleMobile){const i=this.singleMobile.value,o=i.id;o?(0,m.cS)(i.number)?t.removePhones.push(o):(0,m.CI)(this.singleMobile)&&(t.modifyMobilePhones=[i]):(0,m.cS)(i.number)||(t.createMobilePhones=[i])}if(this.singleLandLine){const i=this.singleLandLine.value,o=i.id;o?(0,m.cS)(i.number)?t.removePhones.push(o):(0,m.CI)(this.singleLandLine)&&(t.modifyLandLinePhones=[i]):(0,m.cS)(i.number)||(t.createLandLinePhones=[i])}if(this.singleAddress){const i=this.singleAddress.value,o=i.id,r=this.defineSingleAddress.value;o?r?(0,m.CI)(this.singleAddress)&&(t.modifyAddresses=[i]):t.removeAddresses.push(o):r&&(t.createAddresses=[i])}return t}mainImageChanged(){const t=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null;return null==this.mainImage&&null==t&&this.hasRemovedImages||this.mainImage!==t}initialize(t){var i;this.enabledFields=new Set,this.editableFields=new Set,this.managePrivacyFields=new Set,this.removedPhones=[],this.removedAddresses=[],this.removedContactInfos=[],t.contactInfoConfiguration&&t.contactInfoConfiguration.availability!==ut.e.DISABLED&&(t.addressConfiguration.contactInfoEnabled=!0,t.addressConfiguration.contactInfoFields=t.contactInfoConfiguration.customFields);const o=t.userConfiguration.profileFieldActions;for(const C in o){if(!o.hasOwnProperty(C))continue;this.enabledFields.add(C);const I=o[C];I.edit&&this.editableFields.add(C),I.managePrivacy&&this.managePrivacyFields.add(C)}this.user=this.buildUserForm(),t.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("",_.kI.required)),this.images=this.data.images.slice(),this.mainImage=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null,this.phones=[],"single"===this.mobileAvailability?(this.canEdit("phone")||!(0,m.cS)(t.mobilePhones))&&(this.singleMobileManage=(0,m.cS)(t.mobilePhones)?t.phoneConfiguration.mobilePhone:t.mobilePhones[0],this.singleMobile=this.buildMobileForm(this.singleMobileManage)):(t.mobilePhones||[]).forEach(C=>{const I=this.buildMobileForm(C);"multiple"===this.mobileAvailability&&(this.phones.push(C),this.addSub(I.valueChanges.subscribe(()=>{this.modifyMobilePhones.includes(I)||this.modifyMobilePhones.push(I)})))}),"single"===this.landLineAvailability?(this.canEdit("phone")||!(0,m.cS)(t.landLinePhones))&&(this.singleLandLineManage=(0,m.cS)(t.landLinePhones)?t.phoneConfiguration.landLinePhone:t.landLinePhones[0],this.singleLandLine=this.buildLandLineForm(this.singleLandLineManage)):(t.landLinePhones||[]).forEach(C=>{const I=this.buildLandLineForm(C);"multiple"===this.landLineAvailability&&(this.phones.push(C),this.addSub(I.valueChanges.subscribe(()=>{this.modifyLandLinePhones.includes(I)||this.modifyLandLinePhones.push(I)})))}),"single"===this.addressAvailability?(this.canEdit("address")||!(0,m.cS)(t.addresses))&&(this.defineSingleAddress=this.formBuilder.control(!(0,m.cS)(t.addresses)||"required"===t.addressConfiguration.availability),this.singleAddressManage=(0,m.cS)(t.addresses)?t.addressConfiguration.address:t.addresses[0],this.singleAddress=this.buildAddressForm(this.singleAddressManage)):((t.addresses||[]).forEach(C=>{const I=this.buildAddressForm(C);"multiple"===this.addressAvailability&&this.addSub(I.valueChanges.subscribe(()=>{this.modifyAddresses.includes(I)||this.modifyAddresses.push(I)}))}),this.addresses=(t.addresses||[]).slice()),(t.contactInfos||[]).forEach(C=>{const I=this.buildContactInfoForm(C);this.addSub(I.valueChanges.subscribe(()=>{this.modifyContactInfos.includes(I)||this.modifyContactInfos.push(I)}))}),this.contactInfos=(t.contactInfos||[]).slice();const r=(null===(i=t.userConfiguration)||void 0===i?void 0:i.customFields)||[];this.fieldsWithoutSection=r.filter(C=>null==C.section)||[];const p=new Map;r.map(C=>C.section).forEach(C=>{null!=C&&p.set(C.id,C)}),p.forEach(C=>{const I=r.filter($=>null!=$.section&&$.section.id===C.id);(0,m.cS)(I)||I.forEach($=>{(this.canEdit($)||!this.isEmpty($))&&this.fieldsWithSection.set(C,I)})})}buildUserForm(){const t=this.data.userConfiguration,i=this.data.user,o=this.formBuilder.group({version:i.version,hiddenFields:[i.hiddenFields||[]]});for(const r of sg)this.hasField(r)?o.setControl(r,this.formBuilder.control({value:i[r],disabled:!this.canEdit(r)},this.isRequired(r)?_.kI.required:null)):o.removeControl(r);return o.setControl("customValues",this.fieldHelper.customValuesFormGroup(t.customFields,{currentValues:i.customValues,disabledProvider:r=>!this.canEdit(r.internalName),requiredProvider:r=>this.canEdit(r.internalName)&&r.required})),o}stampDataAndInitForm(t,i){t.idSuffix=`_${t.id||cg++}`,t.form=i,i.locating$=new oe.X(!1),i.patchValue(t)}buildLandLineForm(t){t.kind=Ee.k.LAND_LINE;const i=this.data.phoneConfiguration,r=this.buildPhoneForm(1===i.maxLandLines,i.landLineAvailability===ut.e.REQUIRED);if(i.extensionEnabled){const p=this.formBuilder.control(null);this.editableFields.has("phone")||p.disable(),r.setControl("extension",p)}return this.stampDataAndInitForm(t,r),r}buildMobileForm(t){t.kind=Ee.k.MOBILE;const i=this.data.phoneConfiguration,r=this.buildPhoneForm(1===i.maxMobiles,i.mobileAvailability===ut.e.REQUIRED);return i.smsEnabled&&(r.setControl("verified",this.formBuilder.control(t.verified)),r.setControl("enabledForSms",this.formBuilder.control(t.enabledForSms))),this.stampDataAndInitForm(t,r),r}buildPhoneForm(t,i){const r=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,_.kI.required],number:[null,!t||i?_.kI.required:null]});return this.editableFields.has("phone")||r.disable(),r}buildAddressForm(t){const i=this.data.addressConfiguration,o=this.addressHelper.addressFormGroup(i);this.stampDataAndInitForm(t,o);for(const r of i.enabledFields){let p=t[r]||null;this.addSub(o.get(r).valueChanges.subscribe(C=>{p!==C&&o.get("location").patchValue({latitude:null,longitude:null}),p=C}))}return this.editableFields.has("address")||o.disable(),o}buildContactInfoForm(t){const i=this.data.contactInfoConfiguration,o=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,_.kI.required],image:null,email:null,mobilePhone:null,landLinePhone:null,landLineExtension:null,address:null});return o.setControl("customValues",this.fieldHelper.customValuesFormGroup(i.customFields)),this.data.contactInfoConfiguration.edit||o.disable(),this.stampDataAndInitForm(t,o),o}phoneNameLabel(t){return t.kind===Ee.k.LAND_LINE?this.i18n.phone.nameLandLine:this.i18n.phone.nameMobile}phoneExample(t){return t.kind===Ee.k.LAND_LINE?this.data.phoneConfiguration.landLineExample:this.data.phoneConfiguration.mobileExample}phoneNumberLabel(t){return t.kind===Ee.k.LAND_LINE?this.i18n.phone.numberLandLine:this.i18n.phone.numberMobile}phoneHasSms(t){return!!this.data.phoneConfiguration.smsEnabled&&t.id&&t.number===t.form.value.number&&t.kind===Ee.k.MOBILE}hasExtension(t){return this.data.phoneConfiguration.extensionEnabled&&t.kind===Ee.k.LAND_LINE}get canCreateLandLine(){if("multiple"!==this.landLineAvailability||!this.editableFields.has("phone"))return!1;const t=this.data.phoneConfiguration.maxLandLines;return this.phones.filter(o=>o.kind===Ee.k.LAND_LINE).length<t}get canCreateMobile(){if("multiple"!==this.mobileAvailability||!this.editableFields.has("phone"))return!1;const t=this.data.phoneConfiguration.maxMobiles;return this.phones.filter(o=>o.kind===Ee.k.MOBILE).length<t}get canCreateAddress(){return!("multiple"!==this.addressAvailability||!this.editableFields.has("address"))&&this.addresses.length<this.data.addressConfiguration.maxAddresses}get canCreateContactInfo(){return!(!this.data.contactInfoConfiguration.edit||"multiple"!==this.contactInfoAvailability)&&this.contactInfos.length<this.data.contactInfoConfiguration.maxContactInfos}get canUploadImages(){return this.images.length<this.data.imageConfiguration.maxImages}addMobile(){const t=(0,S.Z)(this.data.phoneConfiguration.mobilePhone);t.name="",this.createMobilePhones.push(this.buildMobileForm(t)),this.phones=[t,...this.phones],this.setFocus("phone_name",t)}addLandLine(){const t=(0,S.Z)(this.data.phoneConfiguration.landLinePhone);t.name="",this.createLandLinePhones.push(this.buildLandLineForm(t)),this.phones=[t,...this.phones],this.setFocus("phone_name",t)}addAddress(){const t=(0,S.Z)(this.data.addressConfiguration.address);t.name="",this.createAddresses.push(this.buildAddressForm(t)),this.addresses=[t,...this.addresses],this.setFocus("address_name",t)}addContactInfo(){const t=(0,S.Z)(this.data.contactInfoConfiguration.contactInfo);this.createContactInfos.push(this.buildContactInfoForm(t)),this.contactInfos=[t,...this.contactInfos],this.setFocus("contact-info_name",t)}removePhone(t){this.phones=this.phones.filter(o=>o!==t);const i=t.id;if(i)this.removedPhones.push(i);else{const o=t.form;this.createMobilePhones=this.createMobilePhones.filter(r=>r!==o),this.createLandLinePhones=this.createLandLinePhones.filter(r=>r!==o)}}removeAddress(t){this.addresses=this.addresses.filter(o=>o!==t);const i=t.id;if(i)this.removedAddresses.push(i);else{const o=t.form;this.createAddresses=this.createAddresses.filter(r=>r!==o)}}removeContactInfo(t){this.contactInfos=this.contactInfos.filter(o=>o!==t);const i=t.id;if(i)this.removedContactInfos.push(i);else{const o=t.form;this.createContactInfos=this.createContactInfos.filter(r=>r!==o)}}setFocus(t,i){const o=t+i.idSuffix;setTimeout(()=>document.getElementById(o).focus(),10)}showEnableForSms(t){return!!this.data.phoneConfiguration.smsEnabled&&(!this.byManager||t.value.verified)}maybeVerify(t,i){if(this.byManager)return;let o;if(o=this.singleMobile?this.singleMobileManage:this.phones.find(r=>r.id===i),null==o)throw new Error(`Mobile phone not found: ${i}`);o.verified||(this.verify(o),t.preventDefault(),t.stopPropagation())}verify(t){const i=this.modal.show(nd,{class:"modal-form",initialState:{phone:t}});this.addSub(i.content.verified.pipe((0,id.q)(1)).subscribe(r=>{r&&this.phonesService.getPhoneDataForEdit({idOrNumber:t.id,fields:["phone"]}).subscribe(p=>{const C=p.phone;C.id=t.id,C.enabledForSms=!0;const I=this.buildMobileForm(C);I.markAsTouched();const $=(this.phones||[]).findIndex(be=>be.id===t.id);if($>=0){const be=this.phones.slice();be[$]=C,this.phones=be;const Me=this.modifyMobilePhones.findIndex(Rf=>Rf.value.id===t.id),Ut=this.modifyMobilePhones.slice();Me>=0?Ut[Me]=I:Ut.push(I),this.modifyMobilePhones=Ut}this.singleMobile&&(this.singleMobile=I),i.hide(),this.changeDetector.detectChanges()})}))}onUploadDone(t){const i=1===this.data.imageConfiguration.maxImages;this.images=i?[t[0]]:[...this.images,...t],this.changeDetector.detectChanges(),self&&i&&this.login.user$.next(Object.assign(Object.assign({},this.login.user$.value),{image:t[0]}))}captureCamera(t){this.camera.capture(i=>t.uploadFile(i))}manageImages(){var t;const i=this.modal.show(Wp.A,{class:"modal-form",initialState:{images:this.images,requireAtLeastOne:(null===(t=this.data.imageConfiguration)||void 0===t?void 0:t.availability)===ut.e.REQUIRED}});i.content.result.pipe((0,Re.P)()).subscribe(r=>{null!=r.order&&(this.images=r.order.map(p=>this.images.find(C=>C.id===p)),this.addSub(this.imagesService.reorderProfileImages({ids:r.order,user:this.param}).subscribe())),self&&this.login.user$.next(Object.assign(Object.assign({},this.login.user$.value),{image:this.images[0]})),i.hide(),this.changeDetector.detectChanges()})}removeAllImages(){for(const t of this.images||[])this.addSub(this.imagesService.deleteImage({idOrKey:t.id}).subscribe());this.images=[],this.changeDetector.detectChanges()}fieldSize(t){return this.fieldHelper.fieldSize(t)}locateAddress(t){const i=t.value;t.locating$.next(!0),this.addSub(this.maps.geocode(i).subscribe(o=>{t.patchValue({location:o}),this.changeDetector.detectChanges()},()=>this.mapShown(t)))}mapShown(t){t.locating$.next(!1),this.changeDetector.detectChanges()}resolveMenu(t){return this.menu.userMenu(t.userConfiguration.details,v.v2.EDIT_MY_PROFILE)}fieldValue(t){const i=this.user.get("customValues").get(t.internalName).value;return this.fieldHelper.asFieldValue(t,i,this.data.userConfiguration.binaryValues)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(nn.f),e.Y36(od.C),e.Y36(tn),e.Y36(on.Q),e.Y36(ad.u),e.Y36(X.tT),e.Y36(rd.y),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["edit-profile"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["locatingSpinner",""],["last","",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"mt-4","mb-2",3,"ngClass"],[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name",3,"label","required",4,"ngIf"],["formControlName","username",3,"label","required",4,"ngIf"],[3,"label","kind","forId","ignoreExtraCell","required",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],[1,"mb-3","border-0","mt-2","mt-md-0"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge",3,"image","roundBorders",4,"ngIf"],["class","my-3",4,"ngIf"],["containerClass","mt-3","target","profile",3,"owner","uploadDone"],["singleUpload",""],["kind","secondary","class","mt-3","reverseRow","",4,"ngIf"],["size","huge",3,"image","roundBorders"],[1,"my-3"],["kind","secondary","reverseRow","",1,"mt-3"],["outline","",3,"label","action"],["outline","",3,"label","action",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["kind","secondary","class","mt-2","reverseRow","",4,"ngIf"],["target","profile",3,"owner","max","uploadDone"],["multiUpload",""],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],["kind","secondary","reverseRow","",1,"mt-2"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","name",3,"label","required"],["formControlName","username",3,"label","required"],[3,"label","kind","forId","ignoreExtraCell","required"],["formControlName","email",3,"id","required"],["field","email",3,"control",4,"extraCell"],["field","email",3,"control"],[3,"label","kind","forId","labelPosition","maximizeLabel","ignoreExtraCell","required","informationText","fieldSize",4,"ngIf"],[3,"label","kind","forId","labelPosition","maximizeLabel","ignoreExtraCell","required","informationText","fieldSize"],["hideLabel","","hideInformationText","",3,"field","formControlName","binaryValues",4,"ngIf","ngIfElse"],["plainFieldValue",""],[3,"field","control",4,"extraCell"],["hideLabel","","hideInformationText","",3,"field","formControlName","binaryValues"],[3,"fieldValue"],[3,"field","control"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[3,"label","kind","forId","labelPosition","ignoreExtraCell","required","informationText","fieldSize",4,"ngIf"],[3,"label","kind","forId","labelPosition","ignoreExtraCell","required","informationText","fieldSize"],[1,"mb-2"],["kind","field","fieldSize","small",3,"label","forId","required","ignoreExtraCell"],["formControlName","number",3,"id","placeholder",4,"ngIf","ngIfElse"],["plainPhoneNumber",""],[3,"control",4,"extraCell"],["formControlName","number",3,"id","placeholder"],[3,"control"],[3,"label","formControl",4,"ngIf","ngIfElse"],["plainVerified",""],[3,"label","formControl"],[3,"label","formControl","onClick",4,"ngIf","ngIfElse"],["plainSms",""],[3,"label","formControl","onClick"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy","binaryValues"],["kind","field",3,"label",4,"ngIf"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"],["outline","",3,"label","action",4,"ngIf","ngIfElse"],[1,"mt-4","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],["class","section-title-action","dropdown","",4,"ngIf"],["class","section-title-action",4,"ngIf"],["dropdown","",1,"section-title-action"],["dropdownToggle","","type","button","type","button","aria-controls","newPhoneDropDown",1,"btn","btn-outline-primary","dropdown-toggle"],["class","dropdown-menu dropdown-menu-right","role","listbox","id","newPhoneDropDown",4,"dropdownMenu"],["role","listbox","id","newPhoneDropDown",1,"dropdown-menu","dropdown-menu-right"],["dropDownMenu",""],["type","button",1,"dropdown-item",3,"click"],[1,"section-title-action"],["formControlName","name","required","",3,"id","label"],["type","tel","formControlName","number","required","",3,"id","label","placeholder"],["labelPosition","sideForced","kind","field",3,"label",4,"ngIf"],["class","d-flex justify-content-end",3,"ngClass",4,"ngIf"],["formControlName","verified",3,"label",4,"ngIf","ngIfElse"],["formControlName","verified",3,"label"],["formControlName","enabledForSms",3,"label","onClick",4,"ngIf","ngIfElse"],["formControlName","enabledForSms",3,"label","onClick"],["labelPosition","sideForced","kind","field",3,"label"],[1,"d-flex","w-100","justify-content-between"],["justifyStart","",3,"control"],[1,"d-flex","justify-content-end",3,"ngClass"],["idPrefix","address_",3,"addressForm","ignoreContactFields","configuration","idSuffix","managePrivacy","binaryValues"],["kind","field","labelPosition","sideForced",3,"label",4,"ngIf"],["kind","field","class","pb-0",3,"label",4,"ngIf"],["class","row mt-3 no-gutters",4,"ngIf"],["kind","field","labelPosition","sideForced",3,"label"],["kind","field",1,"pb-0",3,"label"],[4,"ngIf","ngIfThen"],[1,"row","mt-3","no-gutters"],["class","col-4",4,"ngIf"],[1,"col-12","col-sm-8"],["kind","secondary","forceRow","",1,"mt-0"],[1,"col-4"],[1,"flex-grow-1"],["formControlName","image","target","contactInfo","separator","@","avatarSize","xlarge",3,"label","initialImages"],["formControlName","email",3,"id","label"],["formControlName","mobilePhone",3,"id","label"],["formControlName","landLinePhone",3,"id","label"],["formControlName","landLineExtension",3,"id","label",4,"ngIf"],["formControlName","address",3,"id","label"],["class","d-flex justify-content-end",4,"ngIf"],["formControlName","landLineExtension",3,"id","label"],[3,"value","text",4,"ngIf"],[3,"value","text"],[3,"field","formControlName","binaryValues"],[1,"d-flex","justify-content-end"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,ag,22,26,"page-content",1),e.qZA(),e.YNc(3,rg,1,0,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,sd.X,cd.J,k.h,N.x,d.sg,d.mk,_.JL,_.sg,Y.t,ae.F,ge.q,_.JJ,_.u,_.Q7,an.j,ld.x,ft.G,zt.x,O.M,_.oH,ud.C,pd.O,Zt.TO,Zt.Mq,Zt.Hz,dd.o,ue.f,W.s,_d.O],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var sn=s(9593);let lg=(()=>{class n extends y.y{constructor(t,i){super(t),this.validationService=i}get userId(){return this.data}ngOnInit(){this.addSub(this.validationService.validateEmailChange({key:this.route.snapshot.params.key}).subscribe(()=>{this.notification.snackBar(this.i18n.user.newEmailConfirmed),this.router.navigate(["/users","self","profile"])}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(sn.R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["validate-email-change"]],features:[e.qOj],decls:0,vars:0,template:function(t,i){},encapsulation:2,changeDetection:0}),n})();var It=s(7437),pt=s(4167),ug=s(8571),pg=s(8929),cn=s(1086),ln=s(7545),dg=s(13),_g=s(3410),gg=s(9474);function mg(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"user-info",10)(2,"hr"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("user",t.data.user)}}function fg(n,a){if(1&n&&(e.TgZ(0,"div",16),e._UZ(1,"icon",17),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("icon",t.SvgIcon.ArrowDownUp)}}const un=function(n){return{"cursor-pointer":n}};function hg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw(2).disableItem(r)}),e.TgZ(1,"div",12),e._UZ(2,"icon",13),e.qZA(),e.TgZ(3,"div",14),e._uU(4),e.qZA(),e.YNc(5,fg,2,1,"div",15),e.qZA()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(5,un,i.data.canEdit))("cdkDragDisabled",!i.data.canEdit),e.xp6(2),e.Q6J("icon",t.icon),e.xp6(2),e.hij(" ",t.label," "),e.xp6(1),e.Q6J("ngIf",i.layout.ltlg)}}function bg(n,a){1&n&&e._UZ(0,"hr")}function xg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){const r=e.CHM(t).index;return e.oxw(2).enableItem(r)}),e.TgZ(1,"div",12),e._UZ(2,"icon",13),e.qZA(),e.TgZ(3,"div",14),e._uU(4),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("ngClass",e.VKq(3,un,i.data.canEdit)),e.xp6(2),e.Q6J("icon",t.icon),e.xp6(2),e.hij(" ",t.label," ")}}function vg(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,mg,3,1,"ng-container",1),e.TgZ(4,"div"),e._uU(5),e.qZA(),e._UZ(6,"hr"),e.TgZ(7,"div",3)(8,"div",4)(9,"div",5),e._uU(10),e.qZA(),e.TgZ(11,"div",6),e.NdJ("cdkDropListSorted",function(o){return e.CHM(t),e.oxw().sort(o)}),e.YNc(12,hg,6,7,"div",7),e.qZA()(),e.YNc(13,bg,1,0,"hr",1),e.ALo(14,"async"),e.TgZ(15,"div",4)(16,"div",5),e._uU(17),e.qZA(),e.TgZ(18,"div",8),e.YNc(19,xg,5,5,"div",9),e.qZA()()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.quickAccessSettings.title)("mobileHeading",t.i18n.quickAccessSettings.mobileTitle)("headingActions",e.lcZ(2,10,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(2),e.Oqu(t.i18n.quickAccessSettings.information),e.xp6(5),e.Oqu(t.i18n.quickAccessSettings.enabled),e.xp6(2),e.Q6J("ngForOf",t.enabledItems),e.xp6(1),e.Q6J("ngIf",e.lcZ(14,12,t.layout.ltmd$)),e.xp6(4),e.Oqu(t.i18n.quickAccessSettings.disabled),e.xp6(2),e.Q6J("ngForOf",t.disabledItems)}}let yg=(()=>{class n extends y.y{constructor(t,i,o,r){super(t),this.frontendService=i,this.quickAccessHelper=o,this.iconLoadingService=r,this.allItems$=new pg.xQ}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.addSub(this.frontendService.getDataForUserQuickAccess({user:this.param}).pipe((0,ln.w)(t=>this.loadIcons(t))).subscribe(t=>this.data=t))}loadIcons(t){var i;const o=null===(i=t.quickAccess)||void 0===i?void 0:i.map(r=>this.quickAccessHelper.iconAndLabel(r).icon).filter(r=>!!r);return 0===o.length?(0,cn.of)(t):this.iconLoadingService.load(o,!1).pipe((0,ln.w)(()=>(0,cn.of)(t)))}onDataInitialized(t){const i=o=>{var r,p,C,I,$,be,Me;return Object.assign(Object.assign({},this.quickAccessHelper.iconAndLabel(o)),{type:o.type,entity:null!==(be=null!==(I=null!==(p=null===(r=o.operation)||void 0===r?void 0:r.id)&&void 0!==p?p:null===(C=o.wizard)||void 0===C?void 0:C.id)&&void 0!==I?I:null===($=o.recordType)||void 0===$?void 0:$.id)&&void 0!==be?be:null===(Me=o.tokenType)||void 0===Me?void 0:Me.id,enabled:!!o.enabled,originalOrder:o.originalOrder})};this.self=this.authHelper.isSelf(t.user),this.enabledItems=t.quickAccess.filter(o=>o.enabled).map(i),this.disabledItems=t.quickAccess.filter(o=>!o.enabled).map(i),this.sortDisabled(),t.canEdit&&(this.addSub(this.allItems$.pipe((0,dg.b)(1e3)).subscribe(o=>this.save(o))),this.headingActions=[new Q.Yu(F.l.ArrowClockwise,this.i18n.quickAccessSettings.restoreDefaults,()=>this.restoreDefaults())])}enableItem(t){if(this.data.canEdit){const i=this.disabledItems[t];i.enabled=!0,this.disabledItems=this.disabledItems.filter(o=>o!==i),this.enabledItems=[i,...this.enabledItems],this.updateItems()}}disableItem(t){if(this.data.canEdit){const i=this.enabledItems[t];i.enabled=!1,this.enabledItems=this.enabledItems.filter(o=>o!==i),this.disabledItems=[i,...this.disabledItems],this.sortDisabled(),this.updateItems()}}resolveMenu(){var t;return this.menu.userMenu(null===(t=this.data)||void 0===t?void 0:t.user,v.v2.QUICK_ACCESS_SETTINGS)}sort(t){(0,pt.bA)(this.enabledItems,t.previousIndex,t.currentIndex),this.updateItems()}restoreDefaults(){this.addSub(this.frontendService.restoreUserQuickAccessDefaults({user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.quickAccessSettings.restoreDefaultsDone),this.router.navigateByUrl(this.router.url)}))}sortDisabled(){this.disabledItems.sort((t,i)=>t.originalOrder-i.originalOrder)}updateItems(){this.allItems$.next(this.itemsAsArray())}itemsAsArray(){return[...this.enabledItems,...this.disabledItems].map(t=>({type:t.type,entity:t.entity,enabled:t.enabled}))}save(t){this.addSub(this.frontendService.saveUserQuickAccess({user:this.param,body:{quickAccess:t}}).subscribe())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(_g.O),e.Y36(ug.Z),e.Y36(gg.C))},n.\u0275cmp=e.Xpm({type:n,selectors:[["quick-access-settings"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[1,"quick-access-container","d-flex","flex-column","flex-md-row","w-100"],[1,"d-flex","flex-column","flex-grow-1","w-100"],[1,"mb-2"],["cdkDropList","",1,"enabled-quick-access",3,"cdkDropListSorted"],["class","quick-access-setting-item","cdkDragLockAxis","y","cdkDrag","",3,"ngClass","cdkDragDisabled","click",4,"ngFor","ngForOf"],[1,"disabled-quick-access"],["class","quick-access-setting-item disabled",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"user"],["cdkDragLockAxis","y","cdkDrag","",1,"quick-access-setting-item",3,"ngClass","cdkDragDisabled","click"],[1,"quick-access-icon"],["size","2.2rem",3,"icon"],[1,"quick-access-text"],["class","quick-access-drag-handle","cdkDragHandle","",4,"ngIf"],["cdkDragHandle","",1,"quick-access-drag-handle"],[3,"icon"],[1,"quick-access-setting-item","disabled",3,"ngClass","click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,vg,20,14,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,pt.Wj,d.sg,pt.Zt,d.mk,ne.o,pt.Bh],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})(),St=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserReferencesDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserReferencesDataForSearchPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserReferencesDataForSearch(t,i){return this.getUserReferencesDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchUserReferences$Response(t,i){const o=new b.c(this.rootUrl,n.SearchUserReferencesPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("direction",t.direction,{}),o.query("levels",t.levels,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("period",t.period,{}),o.query("relatedUser",t.relatedUser,{}),o.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchUserReferences(t,i){return this.searchUserReferences$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserReferenceStatistics$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserReferenceStatisticsPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1}),o.query("direction",t.direction,{}),o.query("periods",t.periods,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserReferenceStatistics(t,i){return this.getUserReferenceStatistics$Response(t,i).pipe((0,c.U)(o=>o.body))}getReferenceDataForSet$Response(t,i){const o=new b.c(this.rootUrl,n.GetReferenceDataForSetPath,"get");return t&&(o.path("from",t.from,{}),o.path("to",t.to,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getReferenceDataForSet(t,i){return this.getReferenceDataForSet$Response(t,i).pipe((0,c.U)(o=>o.body))}setReference$Response(t,i){const o=new b.c(this.rootUrl,n.SetReferencePath,"post");return t&&(o.path("from",t.from,{}),o.path("to",t.to,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}setReference(t,i){return this.setReference$Response(t,i).pipe((0,c.U)(o=>o.body))}viewReference$Response(t,i){const o=new b.c(this.rootUrl,n.ViewReferencePath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewReference(t,i){return this.viewReference$Response(t,i).pipe((0,c.U)(o=>o.body))}updateReference$Response(t,i){const o=new b.c(this.rootUrl,n.UpdateReferencePath,"put");return t&&(o.path("id",t.id,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}updateReference(t,i){return this.updateReference$Response(t,i).pipe((0,c.U)(o=>o.body))}deleteReference$Response(t,i){const o=new b.c(this.rootUrl,n.DeleteReferencePath,"delete");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}deleteReference(t,i){return this.deleteReference$Response(t,i).pipe((0,c.U)(o=>o.body))}getReferenceDataForEdit$Response(t,i){const o=new b.c(this.rootUrl,n.GetReferenceDataForEditPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getReferenceDataForEdit(t,i){return this.getReferenceDataForEdit$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserReferencesDataForSearchPath="/{user}/references/data-for-search",n.SearchUserReferencesPath="/{user}/references",n.GetUserReferenceStatisticsPath="/{user}/references/statistics",n.GetReferenceDataForSetPath="/{from}/reference/{to}/data-for-set",n.SetReferencePath="/{from}/reference/{to}",n.ViewReferencePath="/references/{id}",n.UpdateReferencePath="/references/{id}",n.DeleteReferencePath="/references/{id}",n.GetReferenceDataForEditPath="/references/{id}/data-for-edit",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Tg(n,a){1&n&&e._UZ(0,"div",10)}function Ag(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",10)(2,"label-value",11),e._UZ(3,"user-link",12),e.qZA()(),e.YNc(4,Tg,1,0,"div",13),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function Cg(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",10)(2,"radio-group-field",14),e._UZ(3,"field-option",15)(4,"field-option",15),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.reference.direction.direction),e.xp6(1),e.Q6J("value",t.ReferenceDirectionEnum.GIVEN)("text",t.i18n.reference.direction.given),e.xp6(1),e.Q6J("value",t.ReferenceDirectionEnum.RECEIVED)("text",t.i18n.reference.direction.received)}}function wg(n,a){1&n&&e.GkF(0)}function Eg(n,a){1&n&&e.GkF(0)}const pn=function(n,a){return{count:n,total:a}};function Zg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"rating-stats",23),e.qZA(),e.TgZ(3,"td",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).filter(r.level,!0)}),e.YNc(4,wg,1,0,"ng-container",24),e.qZA(),e.TgZ(5,"td",22),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).filter(r.level)}),e.YNc(6,Eg,1,0,"ng-container",24),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3),o=e.MAs(4);e.xp6(2),e.Q6J("level",t.level)("textLeft",t.text),e.xp6(2),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(6,pn,null==i.allTime?null:i.allTime.counts[t.level],null==i.allTime?null:i.allTime.total)),e.xp6(2),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.WLB(9,pn,null==i.last30Days?null:i.last30Days.counts[t.level],null==i.last30Days?null:i.last30Days.total))}}function Ig(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",16)(1,"table",17)(2,"thead")(3,"th",18),e._uU(4),e.qZA(),e.TgZ(5,"th",19),e._uU(6),e.qZA(),e.TgZ(7,"th",19),e._uU(8),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,Zg,7,12,"tr",20),e.TgZ(11,"tr")(12,"td",21),e._uU(13),e.qZA(),e.TgZ(14,"td",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).filter(null,!0)}),e._uU(15),e.qZA(),e.TgZ(16,"td",22),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).filter()}),e._uU(17),e.qZA()(),e.TgZ(18,"tr")(19,"td",21),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"percent"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"percent"),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.xp6(4),e.Oqu(t.i18n.reference.value),e.xp6(2),e.Oqu(t.i18n.reference.allTime),e.xp6(2),e.Oqu(t.i18n.reference.last30Days),e.xp6(2),e.Q6J("ngForOf",t.levels),e.xp6(3),e.Oqu(t.i18n.reference.total),e.xp6(2),e.hij(" ",null==t.allTime?null:t.allTime.total," "),e.xp6(2),e.hij(" ",null==t.last30Days?null:t.last30Days.total,""),e.xp6(3),e.hij(" ",t.i18n.reference.percentagePositive,""),e.xp6(2),e.hij(" ",e.lcZ(23,10,(null==t.allTime?null:t.allTime.totalPositive)/(null==t.allTime?null:t.allTime.total)||0)," "),e.xp6(3),e.hij(" ",e.lcZ(26,12,(null==t.last30Days?null:t.last30Days.totalPositive)/(null==t.last30Days?null:t.last30Days.total)||0)," ")}}function Sg(n,a){if(1&n&&(e.TgZ(0,"mobile-result",25)(1,"div",26)(2,"div")(3,"div",27),e._uU(4),e.qZA(),e.TgZ(5,"div",28),e._uU(6),e.ALo(7,"dateTime"),e.qZA(),e.TgZ(8,"div",29),e._UZ(9,"rating-stats",30),e.qZA()()()()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("avatarImage",t.relatedUser.image)("avatarIcon",i.SvgIcon.Person),e.xp6(4),e.hij(" ",t.relatedUser.display," "),e.xp6(2),e.hij(" ",e.lcZ(7,5,t.date)," "),e.xp6(3),e.Q6J("level",t.level)}}function Ug(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(3).remove(o)}),e._UZ(1,"icon",38),e.qZA()}if(2&n){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.remove),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function Ng(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",34),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(3);return p.router.navigate(p.path(r))}),e.TgZ(2,"td"),e._uU(3),e.ALo(4,"dateTime"),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"rating-stats",30),e.qZA(),e.TgZ(9,"td",35),e.YNc(10,Ug,2,2,"button",36),e.qZA()(),e.BQk()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,4,t.date)),e.xp6(3),e.Oqu(t.relatedUser.display),e.xp6(2),e.Q6J("level",t.level),e.xp6(2),e.Q6J("ngIf",i.data.manage)}}function kg(n,a){if(1&n&&(e.TgZ(0,"table",31)(1,"thead")(2,"th",32),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e._UZ(8,"th",33),e.qZA(),e.TgZ(9,"tbody"),e.YNc(10,Ng,11,6,"ng-container",20),e.ALo(11,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.name),e.xp6(2),e.Oqu(t.i18n.reference.level.level),e.xp6(3),e.Q6J("ngForOf",null==(i=e.lcZ(11,4,t.results$))?null:i.results)}}function Og(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",3),e.ALo(2,"async"),e.TgZ(3,"div",4)(4,"div",5),e.YNc(5,Ag,5,3,"ng-container",1),e.YNc(6,Cg,5,5,"ng-container",1),e.qZA()()(),e.YNc(7,Ig,27,14,"page-content",6),e.ALo(8,"async"),e.ALo(9,"async"),e.TgZ(10,"results-layout",7),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(11,"async"),e.YNc(12,Sg,10,7,"mobile-result",8),e.YNc(13,kg,12,6,"table",9),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("mode",t.userFilter||t.directionsFilter?"filters":"emptyFilters")("heading",t.resolveHeading())("mobileHeading",t.resolveHeading(!0))("headingActions",e.lcZ(2,11,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.userFilter),e.xp6(1),e.Q6J("ngIf",t.directionsFilter),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,13,t.layout.gtsm$)&&e.lcZ(9,15,t.stats$)),e.xp6(3),e.Q6J("results",e.lcZ(11,17,t.results$))("rendering$",t.rendering$)("toLink",t.toLink)}}const Pg=function(n){return{width:n}};function Qg(n,a){if(1&n&&(e.TgZ(0,"div",42),e._uU(1," \xa0"),e.qZA()),2&n){const t=e.oxw();e.Q6J("ngStyle",e.VKq(1,Pg,t.count/t.total*190+"px"))}}const Jg=function(n){return{"pl-2":n}};function Dg(n,a){if(1&n&&(e.TgZ(0,"div",39),e.YNc(1,Qg,2,3,"div",40),e.TgZ(2,"span",41),e._uU(3),e.qZA()()),2&n){const t=a.count;e.xp6(1),e.Q6J("ngIf",t>0),e.xp6(1),e.Q6J("ngClass",e.VKq(3,Jg,t>0)),e.xp6(1),e.Oqu(t)}}let Fg=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.referenceHelper=i,this.referencesService=o,this.ReferenceDirectionEnum=we,this.ReferenceLevelEnum=me.U,this.stats$=new oe.X(null)}getFormControlNames(){return["direction","levels","period"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.referencesService.getUserReferencesDataForSearch({user:this.param}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),t.set&&!this.isOwner&&(this.headingActions=[new Q.Yu(F.l.Star,this.i18n.reference.set,()=>{this.router.navigate(t.current?["/users","references","edit",t.current.id]:["/users","references","set","self",this.param])},!0)]),this.levels=[{level:me.U.VERY_GOOD,text:this.i18n.reference.level.veryGood},{level:me.U.GOOD,text:this.i18n.reference.level.good},{level:me.U.NEUTRAL,text:this.i18n.reference.level.neutral},{level:me.U.BAD,text:this.i18n.reference.level.bad},{level:me.U.VERY_BAD,text:this.i18n.reference.level.veryBad}],this.searchStatistics(),this.addSub(this.form.controls.direction.valueChanges.subscribe(()=>this.searchStatistics()))}searchStatistics(){this.addSub(this.referencesService.getUserReferenceStatistics({user:this.param,direction:this.form.controls.direction.value}).subscribe(t=>this.stats=t))}toSearchParams(t){return t.user=this.param,t}doSearch(t){return this.referencesService.searchUserReferences$Response(t)}filter(t,i){this.form.patchValue({levels:t?[t]:null,period:i?null:[this.dataForFrontendHolder.now().clone().subtract(30,"day").startOf("day").format(Qt.m),null]})}get toLink(){return t=>this.path(t)}get stats(){return this.stats$.value}set stats(t){this.stats$.next(t),this.allTime=t.periods.filter(i=>null==i.period)[0],this.last30Days=t.periods.filter(i=>null!=i.period)[0]}remove(t){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.referencesService.deleteReference({id:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}path(t){return["/users","references","view",t.id]}resolveMenu(t){return this.isOwner?v.v2.REFERENCES:this.menu.searchUsersMenu(t.user)}resolveHeading(t=!1){var i,o,r;const p=1===(null===(i=this.data.directions)||void 0===i?void 0:i.length),C=p&&(null===(o=this.data.directions)||void 0===o?void 0:o.includes(we.GIVEN)),I=p&&(null===(r=this.data.directions)||void 0===r?void 0:r.includes(we.RECEIVED));return C?t?this.i18n.reference.mobileTitle.searchGiven:this.i18n.reference.title.searchGiven:I?t?this.i18n.reference.mobileTitle.searchReceived:this.i18n.reference.title.searchReceived:t?this.i18n.reference.mobileTitle.search:this.i18n.reference.title.search}get userFilter(){return this.data.user&&!this.isOwner}get directionsFilter(){var t;return 2===(null===(t=this.data.directions)||void 0===t?void 0:t.length)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(nt.o),e.Y36(St))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-references"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["columnData",""],[3,"mode","heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["mode","table",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["formControlName","direction",3,"label"],[3,"value","text"],["mode","table"],[1,"table","table-hover","small-height"],["width","40%"],["width","30%"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"],[1,"link","link-undecorated",3,"click"],[1,"w-100","pr-3",3,"level","textLeft"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[3,"level"],[1,"table","table-hover","cursor-pointer"],["width","33%"],[1,"actions"],[3,"click"],[1,"actions","actions-multiple"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"stats"],["class","bar",3,"ngStyle",4,"ngIf"],[1,"count",3,"ngClass"],[1,"bar",3,"ngStyle"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Og,14,19,"ng-container",1),e.qZA(),e.YNc(3,Dg,4,5,"ng-template",null,2,e.W1O)),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,it.Y,_.JJ,_.u,W.s,d.sg,ot.m,d.tP,V.D,j.E,K.t,te.p,ie.i9,ne.o,d.PC,d.mk],pipes:[d.Ov,d.Zx,_e.i],encapsulation:2,changeDetection:0}),n})();function Rg(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.date)," ")}}function qg(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.ynx(3,3),e.YNc(4,Rg,3,4,"label-value",4),e.TgZ(5,"label-value",5),e._UZ(6,"user-link",6),e.qZA(),e.TgZ(7,"label-value",5),e._UZ(8,"user-link",6),e.qZA(),e.TgZ(9,"single-selection-field",7),e._UZ(10,"field-option",8)(11,"field-option",8)(12,"field-option",8)(13,"field-option",8)(14,"field-option",8),e.qZA(),e._UZ(15,"textarea-field",9),e.BQk(),e.TgZ(16,"actions",10)(17,"action-button",11),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(18,"async"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.create?t.i18n.reference.title.set:t.i18n.reference.title.edit)("mobileHeading",t.create?t.i18n.reference.mobileTitle.set:t.i18n.reference.title.edit)("headingActions",e.lcZ(2,23,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("ngIf",!t.create),e.xp6(1),e.Q6J("label",t.i18n.reference.from),e.xp6(1),e.Q6J("user",t.data.from),e.xp6(1),e.Q6J("label",t.i18n.reference.to),e.xp6(1),e.Q6J("user",t.data.to),e.xp6(1),e.Q6J("label",t.i18n.reference.level.level),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.VERY_BAD)("text",t.i18n.reference.level.veryBad),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.BAD)("text",t.i18n.reference.level.bad),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.NEUTRAL)("text",t.i18n.reference.level.neutral),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.GOOD)("text",t.i18n.reference.level.good),e.xp6(1),e.Q6J("value",t.ReferenceLevelEnum.VERY_GOOD)("text",t.i18n.reference.level.veryGood),e.xp6(1),e.Q6J("label",t.i18n.general.comments),e.xp6(2),e.Q6J("disabled",e.lcZ(18,25,t.requesting$))("label",t.i18n.general.submit)}}let dn=(()=>{class n extends y.y{constructor(t,i){super(t),this.referencesService=i,this.ReferenceLevelEnum=me.U}ngOnInit(){super.ngOnInit(),this.from=this.route.snapshot.params.from,this.to=this.route.snapshot.params.to,this.id=this.route.snapshot.params.id,this.create=null==this.id;const t=this.create?this.referencesService.getReferenceDataForSet({from:this.from,to:this.to}):this.referencesService.getReferenceDataForEdit({id:this.id});this.addSub(t.subscribe(i=>{this.data=i}))}onDataInitialized(t){const i=t.reference;this.form=this.formBuilder.group({level:[i.level,_.kI.required],comments:[i.comments,_.kI.required],version:i.version})}save(){if(!(0,m.pt)(this.form))return;const t=this.form.value,i=this.create?this.referencesService.setReference({body:t,from:this.ApiHelper.SELF,to:this.data.to.id}):this.referencesService.updateReference({id:this.id,body:t});this.addSub(i.subscribe(()=>{this.notification.snackBar(this.i18n.reference.referenceSet),history.back()}))}resolveMenu(t){return this.menu.userMenu(t.from,v.v2.REFERENCES)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(St))},n.\u0275cmp=e.Xpm({type:n,selectors:[["set-reference"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],[3,"label",4,"ngIf"],[3,"label"],[3,"user"],["formControlName","level","required","",3,"label"],[3,"value","text"],["formControlName","comments","required","",3,"label"],["forceRow",""],[3,"disabled","label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,qg,19,27,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,Y.t,ae.F,ue.f,_.JJ,_.u,_.Q7,W.s,Fe.u,k.h,N.x],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();function Mg(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"label-value",3),e._uU(4),e.ALo(5,"dateTime"),e.qZA(),e.TgZ(6,"label-value",3),e._UZ(7,"user-link",4),e.qZA(),e.TgZ(8,"label-value",3),e._UZ(9,"user-link",4),e.qZA(),e.TgZ(10,"label-value",3),e._UZ(11,"rating-stats",5),e.qZA(),e.TgZ(12,"label-value",3),e._uU(13),e.qZA()(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.i18n.reference.title.view)("mobileHeading",t.i18n.reference.mobileTitle.view)("headingActions",e.lcZ(2,13,t.headingActions$)),e.xp6(2),e.Q6J("label",t.i18n.general.date),e.xp6(1),e.hij(" ",e.lcZ(5,15,t.data.date)," "),e.xp6(2),e.Q6J("label",t.i18n.reference.from),e.xp6(1),e.Q6J("user",t.data.from),e.xp6(1),e.Q6J("label",t.i18n.reference.to),e.xp6(1),e.Q6J("user",t.data.to),e.xp6(1),e.Q6J("label",t.i18n.reference.level.level),e.xp6(1),e.Q6J("level",t.data.level),e.xp6(1),e.Q6J("label",t.i18n.general.comments),e.xp6(1),e.hij(" ",t.data.comments," ")}}let Lg=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.referencesService=i,this.referenceHelper=o}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.referencesService.viewReference({id:this.id}).subscribe(t=>this.data=t))}onDataInitialized(t){this.self=this.authHelper.isSelfOrOwner(t.from)||this.authHelper.isSelfOrOwner(t.to);const i=[];t.canEdit&&i.push(new Q.Yu(F.l.Pencil,this.i18n.general.edit,()=>this.router.navigate(["/users","references","edit",this.id]),!0)),this.headingActions=i}resolveMenu(){return this.self?v.v2.REFERENCES:this.menu.searchUsersMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(St),e.Y36(nt.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-reference"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label"],[3,"user"],[3,"level"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Mg,14,17,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,Y.t,ae.F,ot.m],pipes:[d.Ov,_e.i],encapsulation:2,changeDetection:0}),n})();var _n=s(4514),Yg=s(2290);function Bg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content"),e._UZ(1,"registration-step-done",2),e.TgZ(2,"actions")(3,"action-button",3),e.NdJ("action",function(){return e.CHM(t),e.oxw().goToLogin()}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("result",t.result),e.xp6(2),e.Q6J("label",t.i18n.menu.login)}}let Gg=(()=>{class n extends y.y{constructor(t,i){super(t),this.validationService=i}get result(){return this.data}ngOnInit(){this.addSub(this.validationService.validateUserRegistration({key:this.route.snapshot.params.key}).subscribe(i=>{this.data=i}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(sn.R))},n.\u0275cmp=e.Xpm({type:n,selectors:[["validate-registration"]],features:[e.qOj],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"result"],[3,"label","action"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Bg,4,2,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,Yg.F,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var de=s(8473),$g=s(3032),gn=s(6168);const Hg=["usersResults"];function Vg(n,a){1&n&&e.GkF(0)}const mn=function(n){return{"d-none":n}};function jg(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.ALo(2,"async"),e.TgZ(3,"div",4),e._UZ(4,"result-type-field",5),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"users-results",6,7),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e.ALo(11,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(25,mn,e.lcZ(1,11,t.layout.xxs$)))("heading",t.i18n.user.title.contactList)("mobileHeading",t.i18n.user.mobileTitle.contactList)("headingActions",e.lcZ(2,13,t.headingActions$)),e.xp6(4),e.Q6J("formControl",t.resultTypeControl)("allowedResultTypes",e.lcZ(5,15,t.allowedResultTypes$)),e.xp6(2),e.Q6J("ngClass",e.VKq(27,mn,e.lcZ(8,17,t.rendering$)))("results",e.lcZ(9,19,t.results$))("rendering$",t.rendering$)("data",e.lcZ(10,21,t.data$))("resultType",e.lcZ(11,23,t.resultType$))}}let zg=(()=>{class n extends xe.t{constructor(t,i,o){super(t),this.modal=i,this.contactsService=o,this.ResultType=de.X}getFormControlNames(){return["user","keywords"]}getInitialResultType(){return this.layout.xxs?de.X.LIST:de.X.TILES}ngOnInit(){super.ngOnInit(),this.allowedResultTypes=[de.X.TILES,de.X.LIST],this.stateManager.cache("data",this.contactsService.getContactListDataForSearch({user:f.S.SELF})).subscribe(t=>this.data=t)}toSearchParams(t){return t.user=f.S.SELF,t}doSearch(t){return this.contactsService.searchContactList$Response(t)}onDataInitialized(t){var i,o,r;super.onDataInitialized(t);const p=(t.fieldsInList||[]).slice();p.includes("display")||(p.unshift("display"),t.fieldsInList=p);const I=(this.login.auth||{}).permissions||{};((null===(i=I.users)||void 0===i?void 0:i.search)||(null===(r=null===(o=I.banking)||void 0===o?void 0:o.payments)||void 0===r?void 0:r.user))&&(this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.general.addNew,()=>this.addNew(),!0)])}addNew(){var t,i,o;const r=null===(o=null===(i=null===(t=this.login.auth)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.users)||void 0===o?void 0:o.search,C=this.modal.show(Pt,{class:"modal-form",initialState:{excludeContacts:!0,title:this.i18n.user.title.addContact,label:this.i18n.user.contact,allowSearch:r}}).content;this.addSub(C.done.subscribe(I=>{this.addSub(this.contactsService.createContact({user:f.S.SELF,body:{contact:I.id}}).subscribe(()=>{this.notification.snackBar(this.i18n.user.profile.addContactDone(I.display)),this.reload()}))}))}resolveMenu(t){return this.menu.userMenu(t.user,v.v2.CONTACTS)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.tT),e.Y36($g.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["contact-list"]],viewQuery:function(t,i){if(1&t&&e.Gf(Hg,5),2&t){let o;e.iGM(o=e.CRH())&&(i.usersResults=o.first)}},features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"ngClass","heading","mobileHeading","headingActions"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["resultKind","contact",3,"ngClass","results","rendering$","data","resultType","update"],["usersResults",""]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Vg,1,0,"ng-container",1),e.qZA(),e.YNc(3,jg,12,29,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,d.mk,gn.P,_.JJ,_.oH,At],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Xg=s(3931),Te=s(7279),Kg=s(957),Wg=s(7072),em=s(1112);function tm(n,a){1&n&&e.GkF(0)}function nm(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"label-value",12),e._UZ(2,"user-link",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.broker)}}function im(n,a){1&n&&e._UZ(0,"div",14)}function om(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"input-field",15),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.keywords)}}function am(n,a){if(1&n&&e._UZ(0,"field-option",19),2&n){const t=a.$implicit,i=e.oxw(4);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function rm(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",17),e.YNc(2,am,1,5,"field-option",18),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function sm(n,a){if(1&n&&e._UZ(0,"basic-profile-field-filter",21),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.field))}}function cm(n,a){if(1&n&&e._UZ(0,"custom-field-filter",21),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.internalName))}}function lm(n,a){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,sm,1,2,"basic-profile-field-filter",20),e.YNc(2,cm,1,2,"custom-field-filter",20),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",!t.id),e.xp6(1),e.Q6J("ngIf",t.id)}}function um(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"distance-selection-field",23),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("data",t.data.searchByDistanceData)("label",t.i18n.general.distanceFilter)}}function pm(n,a){if(1&n&&e._UZ(0,"field-option",26),2&n){const t=a.$implicit,i=e.oxw(5);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function dm(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",24),e.YNc(2,pm,1,4,"field-option",25),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.assignedProducts),e.xp6(1),e.Q6J("ngForOf",t.data.products)}}function _m(n,a){if(1&n&&e._UZ(0,"field-option",26),2&n){const t=a.$implicit,i=e.oxw(5);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function gm(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",27),e.YNc(2,_m,1,4,"field-option",25),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.acceptedAgreements),e.xp6(1),e.Q6J("ngForOf",t.data.agreements)}}function mm(n,a){if(1&n&&e._UZ(0,"field-option",26),2&n){const t=a.$implicit,i=e.oxw(5);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)}}function fm(n,a){if(1&n&&(e.TgZ(0,"div",11)(1,"multi-selection-field",28),e.YNc(2,mm,1,4,"field-option",25),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.user.notAcceptedAgreements),e.xp6(1),e.Q6J("ngForOf",t.data.agreements)}}function hm(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"multi-selection-field",29),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyLabel",t.i18n.user.statusEmptyLabel)}}const bm=function(){return{includeGlobal:!0}};function xm(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"user-field",30),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.user.invitedBy)("allowSelf",!0)("filters",e.DdM(3,bm))}}function vm(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"boolean-field",31),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.user.invitedByMe)}}function ym(n,a){if(1&n&&(e.TgZ(0,"div",32)(1,"div",11),e._UZ(2,"date-field",33),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"date-field",34),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(2),e.Q6J("label",t.i18n.user.creationBegin),e.xp6(2),e.Q6J("label",t.i18n.user.creationEnd)}}function Tm(n,a){if(1&n&&(e.TgZ(0,"div",32)(1,"div",11),e._UZ(2,"date-field",35),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"date-field",36),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(2),e.Q6J("label",t.i18n.user.beginUserActivationDate),e.xp6(2),e.Q6J("label",t.i18n.user.endUserActivationDate)}}function Am(n,a){if(1&n&&(e.TgZ(0,"div",32)(1,"div",11),e._UZ(2,"date-field",37),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"date-field",38),e.qZA()()),2&n){const t=e.oxw(4);e.xp6(2),e.Q6J("label",t.i18n.user.beginLastLoginDate),e.xp6(2),e.Q6J("label",t.i18n.user.endLastLoginDate)}}function Cm(n,a){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"user-field",39),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("label",t.i18n.general.usersOfBroker)("filters",t.userSearchFilters())("allowContacts",!1)}}function wm(n,a){if(1&n&&e._UZ(0,"basic-profile-field-filter",21),2&n){const t=e.oxw().$implicit,i=e.oxw(4);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.field))}}function Em(n,a){if(1&n&&e._UZ(0,"custom-field-filter",21),2&n){const t=e.oxw().$implicit,i=e.oxw(4);e.Q6J("field",t)("formControl",i.form.get("profileFields").get(t.internalName))}}function Zm(n,a){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,wm,1,2,"basic-profile-field-filter",20),e.YNc(2,Em,1,2,"custom-field-filter",20),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",!t.id),e.xp6(1),e.Q6J("ngIf",t.id)}}function Im(n,a){if(1&n&&(e.ynx(0),e.YNc(1,um,2,2,"div",6),e.YNc(2,dm,3,3,"div",6),e.YNc(3,gm,3,3,"div",6),e.YNc(4,fm,3,3,"div",6),e.YNc(5,hm,2,3,"div",6),e.YNc(6,xm,2,4,"div",6),e.YNc(7,vm,2,1,"div",6),e.YNc(8,ym,5,2,"div",22),e.YNc(9,Tm,5,2,"div",22),e.YNc(10,Am,5,2,"div",22),e.YNc(11,Cm,2,3,"div",6),e.YNc(12,Zm,3,2,"div",16),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.data.searchByDistanceData&&!t.pendingSearch),e.xp6(1),e.Q6J("ngIf",t.byManager&&(null==t.data.products?null:t.data.products.length)>1),e.xp6(1),e.Q6J("ngIf",t.byManager&&(null==t.data.agreements?null:t.data.agreements.length)>1),e.xp6(1),e.Q6J("ngIf",t.byManager&&(null==t.data.agreements?null:t.data.agreements.length)>1),e.xp6(1),e.Q6J("ngIf",t.byManager&&!t.pendingSearch),e.xp6(1),e.Q6J("ngIf",t.byManager),e.xp6(1),e.Q6J("ngIf",!t.byManager&&(null==t.dataForFrontendHolder.auth||null==t.dataForFrontendHolder.auth.permissions?null:t.dataForFrontendHolder.auth.permissions.invite)),e.xp6(1),e.Q6J("ngIf",t.byManager),e.xp6(1),e.Q6J("ngIf",t.byManager),e.xp6(1),e.Q6J("ngIf",t.byManager),e.xp6(1),e.Q6J("ngIf",t.byManager),e.xp6(1),e.Q6J("ngForOf",t.fieldsInAdvancedSearch)}}function Sm(n,a){if(1&n&&(e.ynx(0),e.YNc(1,rm,3,2,"div",6),e.YNc(2,lm,3,2,"div",16),e.YNc(3,Im,13,12,"ng-container",8),e.ALo(4,"async"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("ngForOf",t.fieldsInBasicSearch),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,3,t.moreFilters$))}}function Um(n,a){if(1&n&&(e.TgZ(0,"div",44)(1,"single-selection-field",45),e._UZ(2,"field-option",46)(3,"field-option",47),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("formControl",t.form.get("orderBy"))("display",t.i18n.general.orderBy)("emptyOption",t.i18n.general.orderByRelevance),e.xp6(1),e.Q6J("text",t.i18n.user.orderBy.alphabeticallyAsc),e.xp6(1),e.Q6J("text",t.i18n.user.orderBy.alphabeticallyDesc)}}function Nm(n,a){if(1&n&&(e.TgZ(0,"div",40)(1,"div",41),e._UZ(2,"result-type-field",42),e.ALo(3,"async"),e.qZA(),e.YNc(4,Um,4,5,"div",43),e.ALo(5,"async"),e.ALo(6,"async"),e.qZA()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("allowedResultTypes",e.lcZ(3,3,t.allowedResultTypes$))("formControl",t.resultTypeControl),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,t.layout.gtxxs$)&&"map"!==e.lcZ(6,7,t.resultType$))}}function km(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"form",4)(3,"div",5),e.YNc(4,nm,3,2,"div",6),e.YNc(5,im,1,0,"div",7),e.ALo(6,"async"),e.YNc(7,om,2,1,"div",6),e.YNc(8,Sm,5,5,"ng-container",8),e.ALo(9,"async"),e.qZA()(),e.YNc(10,Nm,7,9,"div",9),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"users-results",10),e.NdJ("update",function(o){return e.CHM(t),e.oxw().update(o)}),e.ALo(13,"async"),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",e.lcZ(1,15,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",!t.self&&t.broker),e.xp6(1),e.Q6J("ngIf",e.lcZ(6,17,t.layout.gtsm$)&&!t.self&&t.broker),e.xp6(2),e.Q6J("ngIf",t.data.allowKeywords),e.xp6(1),e.Q6J("ngIf",e.lcZ(9,19,t.layout.gtxxs$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(11,21,t.allowedResultTypes$).length>1),e.xp6(2),e.Q6J("results",e.lcZ(13,23,t.results$))("rendering$",t.rendering$)("data",e.lcZ(14,25,t.data$))("resultType",e.lcZ(15,27,t.resultType$))("referencePoint",(e.lcZ(16,29,t.form.valueChanges)||t.form.value).distanceFilter)("removeAction",t.removeAction)}}var z=(()=>{return(n=z||(z={}))[n.Public=0]="Public",n[n.Member=1]="Member",n[n.Admin=2]="Admin",n[n.Broker=3]="Broker",n[n.Pending=4]="Pending",z;var n})();let dt=(()=>{class n extends xe.t{constructor(t,i,o,r,p){super(t),this.usersService=i,this.userHelper=o,this.countriesResolve=r,this.mapService=p,this.ResultType=de.X,this.UserSearchKind=z,this.empty=m.cS}getFormControlNames(){return["keywords","groups","customValues","distanceFilter","orderBy","statuses","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","endLastLoginPeriod","notAcceptedAgreements","acceptedAgreements","products","brokers","invitedBy","invitedByMe"]}doCanSearch(){var t,i,o;const r=null===(o=null===(i=null===(t=this.login.auth)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.users)||void 0===o?void 0:o.search;return this.router.url.includes("brokerings")||!this.dataForFrontendHolder.dataForUi.hideUserSearchInMenu&&r}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||f.S.SELF,this.self=this.authHelper.isSelf(this.param);const t=this.login.auth,i=null==t?null:t.role,o=this.router.url;o.includes("pending")?this.kind=z.Pending:o.includes("search")?this.kind=null==i?z.Public:i===ee.g.ADMINISTRATOR?z.Admin:z.Member:o.includes("brokerings")&&(this.kind=z.Broker),this.manager=[z.Admin,z.Broker].includes(this.kind);const r=[z.Public,z.Member].includes(this.kind);r?(this.heading=this.i18n.user.title.directory,this.mobileHeading=this.i18n.user.mobileTitle.directory):this.kind===z.Broker?this.self?(this.heading=this.i18n.user.title.myBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.myBrokerings):(this.heading=this.i18n.user.title.userBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.userBrokerings):this.kind===z.Admin?(this.heading=this.i18n.user.title.search,this.mobileHeading=this.i18n.user.mobileTitle.search):this.kind===z.Pending&&(this.heading=this.i18n.user.title.searchPending,this.mobileHeading=this.i18n.user.mobileTitle.searchPending);const C=((t||{}).permissions||{}).users||{};this.canSearch=this.kind===z.Broker||C.search&&!this.dataForFrontendHolder.dataForUi.hideUserSearchInMenu,this.canViewMap=r&&C.map&&this.mapService.enabled,this.canSearch||this.canViewMap?(this.kind===z.Pending&&C.managePending&&(this.removeAction=I=>{this.confirmation.confirm({message:this.i18n.general.removeConfirm(I.display),callback:()=>this.addSub(this.usersService.deletePendingUser({user:I.id}).subscribe(()=>{this.update(this.pageData),this.notification.snackBar(this.i18n.general.removeDone(I.display))}))})}),this.countries$=this.countriesResolve.data,this.onResultTypeChanged(this.doCanSearch()?null:de.X.MAP,null)):this.errorHandler.handleForbiddenError({})}get statusOptions(){return this.data.statuses.map(t=>({value:t,text:this.userHelper.userStatus(t)}))}shouldUpdateOnResultTypeChange(){return!1}prepareForm(t){var i,o;this.customFieldsInSearch=[],this.basicFieldsInSearch=[],this.fieldsInBasicSearch=[],this.fieldsInAdvancedSearch=[],null===(i=t.fieldsInBasicSearch)||void 0===i||i.forEach(r=>{let p=t.customFields.find(C=>C.internalName===r);p?this.customFieldsInSearch.push(p):(p=t.basicFields.find(C=>C.field===r),this.basicFieldsInSearch.push(p)),this.fieldsInBasicSearch.push(p)}),null===(o=t.fieldsInAdvancedSearch)||void 0===o||o.forEach(r=>{let p=t.customFields.find(C=>C.internalName===r);p?this.customFieldsInSearch.push(p):(p=t.basicFields.find(C=>C.field===r),this.basicFieldsInSearch.push(p)),this.fieldsInAdvancedSearch.push(p)}),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(this.basicFieldsInSearch,this.customFieldsInSearch,t.query.profileFields))}onResultTypeChanged(t,i){const o=t===de.X.MAP,p=null==i;(o!==(i===de.X.MAP)||p)&&(this.data=null,this.resetPage());const C=I=>{(0,m.cS)(I.fieldsInList)&&(I.fieldsInList=["display"]),this.doIgnoringUpdate(()=>{const $=[];this.pendingSearch?$.push(de.X.LIST):(this.canSearch&&(I.canViewImages&&$.push(de.X.TILES),$.push(de.X.LIST)),(this.canViewMap||this.manager)&&$.push(de.X.MAP)),this.allowedResultTypes=$,null==t?this.resultType=this.getResultType(I.resultType):p&&(this.resultType=t),!this.broker&&I.broker&&(this.broker=I.broker),this.data=I,this.headingActions=[...this.doShowMoreFilters()?[]:[this.moreFiltersAction],...this.exportHelper.headingActions(this.data.exportFormats,be=>this.usersService.exportUsers$Response(Object.assign({format:be.internalName},this.toSearchParams(this.form.value))))]})};null==this.data&&(this.rendering=!0,o&&!this.manager?this.stateManager.cache("dataForMap",this.usersService.getDataForMapDirectory()).subscribe(C):this.stateManager.cache("dataForSearch",this.usersService.getUserDataForSearch({fromMenu:!0,broker:this.kind===z.Broker?this.param:null})).subscribe(C))}doShowMoreFilters(){var t,i;return(0,m.cS)(this.data.fieldsInAdvancedSearch)&&!this.byManager&&!(null===(i=null===(t=this.dataForFrontendHolder.auth)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.invite)&&this.data.searchByDistanceData}get brokeringSearch(){return this.kind===z.Broker}get byManager(){return[z.Broker,z.Admin].includes(this.kind)}get pendingSearch(){return z.Pending===this.kind}toSearchParams(t){const i=Object.assign({},t);this.brokeringSearch&&(i.brokers=[this.param]),i.activationPeriod=f.S.dateRangeFilter(t.beginActivationPeriod,t.endActivationPeriod),i.creationPeriod=f.S.dateRangeFilter(t.beginCreationPeriod,t.endCreationPeriod),i.lastLoginPeriod=f.S.dateRangeFilter(t.beginLastLoginPeriod,t.endLastLoginPeriod),i.profileFields=this.fieldHelper.toProfileFieldsFilter(t.profileFields),t.invitedByMe&&(i.invitedBy=f.S.SELF);const o=t.distanceFilter;o&&(i.maxDistance=o.maxDistance,i.latitude=o.latitude,i.longitude=o.longitude);const r=this.resultType===de.X.MAP;return i.fromMenu=this.kind!==z.Broker,r&&(i.pageSize=99999,i.addressResult=Xg.s.ALL),this.pendingSearch&&(i.statuses=[Te.b.PENDING]),i}userSearchFilters(){return{roles:[ee.g.BROKER]}}doSearch(t){return this.resultType!==de.X.MAP||this.manager?this.usersService.searchUsers$Response(t):this.usersService.searchMapDirectory$Response(t)}resolveMenu(){switch(this.kind){case z.Broker:return v.v2.MY_BROKERED_USERS;case z.Public:return v.v2.PUBLIC_DIRECTORY;default:return v.v2.SEARCH_USERS}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(nn.f),e.Y36(le.T),e.Y36(g.W),e.Y36(on.Q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-users"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-md-6",4,"ngIf"],[4,"ngIf"],["class","row filters-row",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","removeAction","update"],[1,"col-12","col-md-6"],[3,"label"],[3,"user"],[1,"col-md-6"],["formControlName","keywords",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],[3,"field","formControl",4,"ngIf"],[3,"field","formControl"],["class","row no-gutters col-12",4,"ngIf"],["formControlName","distanceFilter",3,"data","label"],["formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["formControlName","acceptedAgreements",3,"emptyLabel","label"],["formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["formControlName","invitedBy",3,"label","allowSelf","filters"],["formControlName","invitedByMe",3,"label"],[1,"row","no-gutters","col-12"],["formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","brokers",3,"label","filters","allowContacts"],[1,"row","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","alphabeticallyAsc",3,"text"],["value","alphabeticallyDesc",3,"text"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,tm,1,0,"ng-container",1),e.qZA(),e.YNc(3,km,17,31,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,_._Y,_.JL,_.sg,Y.t,ae.F,ge.q,_.JJ,_.u,Ie.x,d.sg,W.s,Kg.z,_.oH,Wg.L,em.r,ve.l,O.M,et.Q,gn.P,ue.f,At],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})(),fn=(()=>{class n extends U.b{constructor(t,i){super(t,i)}getUserStatus$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserStatusPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserStatus(t,i){return this.getUserStatus$Response(t,i).pipe((0,c.U)(o=>o.body))}changeUserStatus$Response(t,i){const o=new b.c(this.rootUrl,n.ChangeUserStatusPath,"post");return t&&(o.path("user",t.user,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}changeUserStatus(t,i){return this.changeUserStatus$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.GetUserStatusPath="/{user}/status",n.ChangeUserStatusPath="/{user}/status",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Om(n,a){1&n&&e.GkF(0)}function Pm(n,a){if(1&n&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.AsE(" ",i.i18n.general.performedBy,": ",t.by.display," ")}}function Qm(n,a){if(1&n&&(e.TgZ(0,"mobile-result",8)(1,"div",9),e._uU(2),e.qZA(),e.YNc(3,Pm,2,2,"div",10),e.qZA()),2&n){const t=a.$implicit,i=e.oxw(2);e.Q6J("date",null==t.period?null:t.period.date),e.xp6(2),e.AsE(" ",i.i18n.general.status,": ",i.userHelper.userStatus(t.status)," "),e.xp6(1),e.Q6J("ngIf",t.by)}}function Jm(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA()()),2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,3,null==t.period?null:t.period.begin)),e.xp6(3),e.Oqu(i.userHelper.userStatus(t.status)),e.xp6(2),e.Oqu(null==t.by?null:t.by.display)}}function Dm(n,a){if(1&n&&(e.TgZ(0,"table",12)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA()(),e.TgZ(8,"tbody"),e.YNc(9,Jm,8,5,"tr",13),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.i18n.general.date),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Oqu(t.i18n.general.performedBy),e.xp6(2),e.Q6J("ngForOf",t.data.history)}}function Fm(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e._UZ(1,"user-info",4),e.qZA(),e.TgZ(2,"results-layout",5),e.YNc(3,Qm,4,4,"mobile-result",6),e.YNc(4,Dm,10,4,"table",7),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.operator?t.i18n.userStatus.title.historyOperator:t.i18n.userStatus.title.historyUser)("mobileHeading",t.operator?t.i18n.userStatus.mobileTitle.historyOperator:t.i18n.userStatus.mobileTitle.historyUser),e.xp6(1),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("results",t.data.history)}}let Rm=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.userStatusService=i,this.userHelper=o}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["user","history"]}).subscribe(t=>{this.data=t}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(fn),e.Y36(le.T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-user-status-history"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Om,1,0,"ng-container",1),e.qZA(),e.YNc(3,Fm,5,4,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,te.p,d.sg],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})();function qm(n,a){if(1&n&&e._UZ(0,"field-option",11),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",t)("text",i.userHelper.userStatus(t))}}function Mm(n,a){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"hr"),e.ynx(2,6),e.TgZ(3,"single-selection-field",7),e.YNc(4,qm,1,2,"field-option",8),e.qZA(),e._UZ(5,"textarea-field",9),e.BQk(),e.TgZ(6,"actions")(7,"action-button",10),e.NdJ("action",function(){return e.CHM(t),e.oxw(2).save()}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("label",t.i18n.userStatus.new),e.xp6(1),e.Q6J("ngForOf",t.data.possibleNewStatuses),e.xp6(1),e.Q6J("label",t.i18n.general.comments),e.xp6(2),e.Q6J("label",t.i18n.general.submit)}}function Lm(n,a){if(1&n&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e._UZ(2,"user-info",3),e.TgZ(3,"label-value",4),e._uU(4),e.qZA(),e.YNc(5,Mm,8,5,"ng-container",5),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",t.operator?t.i18n.userStatus.title.statusOperator:t.i18n.userStatus.title.statusUser)("mobileHeading",t.operator?t.i18n.userStatus.mobileTitle.statusOperator:t.i18n.userStatus.mobileTitle.statusUser)("headingActions",e.lcZ(1,7,t.headingActions$)),e.xp6(2),e.Q6J("user",t.data.user),e.xp6(1),e.Q6J("label",t.i18n.userStatus.current),e.xp6(1),e.hij(" ",t.userHelper.userStatus(t.data.status)," "),e.xp6(1),e.Q6J("ngIf",t.editable)}}let Ym=(()=>{class n extends ce.k{constructor(t,i,o){super(t),this.userStatusService=i,this.userHelper=o}get editable(){return!(0,m.cS)(this.data.possibleNewStatuses)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["-history"]}).subscribe(t=>{this.data=t})),this.form=this.formBuilder.group({status:[null,_.kI.required],comment:null}),this.headingActions=[new Q.Yu(F.l.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"status","history"]),!0)]}save(){if(!(0,m.pt)(this.form))return;const i=this.form.value.status;let o;const r=this.data.user,p=this.userHelper.isOperator(r);switch(i){case Te.b.ACTIVE:o=this.i18n.userStatus.confirm.active(r.display);break;case Te.b.BLOCKED:o=this.i18n.userStatus.confirm.blocked(r.display);break;case Te.b.DISABLED:o=this.i18n.userStatus.confirm.disabled(r.display);break;case Te.b.REMOVED:o=this.i18n.userStatus.confirm.removed(r.display);break;case Te.b.PURGED:o=this.i18n.userStatus.confirm.purged(r.display)}let C;C=p?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,this.confirmation.confirm({title:C,message:o,callback:()=>this.submit(i)})}submit(t){const i=this.data.user.display;this.addSub(this.userStatusService.changeUserStatus({user:this.param,body:this.form.value}).subscribe(()=>{let o;switch(t){case Te.b.ACTIVE:o=this.i18n.userStatus.done.active(i);break;case Te.b.BLOCKED:o=this.i18n.userStatus.done.blocked(i);break;case Te.b.DISABLED:o=this.i18n.userStatus.done.disabled(i);break;case Te.b.REMOVED:o=this.i18n.userStatus.done.removed(i);break;case Te.b.PURGED:o=this.i18n.userStatus.done.purged(i)}this.notification.snackBar(o),this.reload()}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(t){return this.menu.searchUsersMenu(t.user)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(fn),e.Y36(le.T))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-user-status"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","status","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Lm,6,9,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,Y.t,_.JL,_.sg,ue.f,_.JJ,_.u,_.Q7,d.sg,W.s,Fe.u,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Ze=s(6962),Pe=s(3919),Bm=s(1375);let Xe=(()=>{class n extends U.b{constructor(t,i){super(t,i)}listUserTokenTypes$Response(t,i){const o=new b.c(this.rootUrl,n.ListUserTokenTypesPath,"get");return t&&(o.path("user",t.user,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}listUserTokenTypes(t,i){return this.listUserTokenTypes$Response(t,i).pipe((0,c.U)(o=>o.body))}getUserTokens$Response(t,i){const o=new b.c(this.rootUrl,n.GetUserTokensPath,"get");return t&&(o.path("user",t.user,{}),o.path("type",t.type,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getUserTokens(t,i){return this.getUserTokens$Response(t,i).pipe((0,c.U)(o=>o.body))}activateToken$Response(t,i){const o=new b.c(this.rootUrl,n.ActivateTokenPath,"post");return t&&(o.path("user",t.user,{}),o.path("type",t.type,{}),o.body(t.body,"text/plain")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}activateToken(t,i){return this.activateToken$Response(t,i).pipe((0,c.U)(o=>o.body))}viewToken$Response(t,i){const o=new b.c(this.rootUrl,n.ViewTokenPath,"get");return t&&(o.path("id",t.id,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}viewToken(t,i){return this.viewToken$Response(t,i).pipe((0,c.U)(o=>o.body))}activatePendingToken$Response(t,i){const o=new b.c(this.rootUrl,n.ActivatePendingTokenPath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}activatePendingToken(t,i){return this.activatePendingToken$Response(t,i).pipe((0,c.U)(o=>o.body))}blockToken$Response(t,i){const o=new b.c(this.rootUrl,n.BlockTokenPath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}blockToken(t,i){return this.blockToken$Response(t,i).pipe((0,c.U)(o=>o.body))}unblockToken$Response(t,i){const o=new b.c(this.rootUrl,n.UnblockTokenPath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}unblockToken(t,i){return this.unblockToken$Response(t,i).pipe((0,c.U)(o=>o.body))}cancelToken$Response(t,i){const o=new b.c(this.rootUrl,n.CancelTokenPath,"post");return t&&o.path("id",t.id,{}),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}cancelToken(t,i){return this.cancelToken$Response(t,i).pipe((0,c.U)(o=>o.body))}assignToken$Response(t,i){const o=new b.c(this.rootUrl,n.AssignTokenPath,"post");return t&&(o.path("id",t.id,{}),o.path("user",t.user,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}assignToken(t,i){return this.assignToken$Response(t,i).pipe((0,c.U)(o=>o.body))}setTokenExpiryDate$Response(t,i){const o=new b.c(this.rootUrl,n.SetTokenExpiryDatePath,"post");return t&&(o.path("id",t.id,{}),o.query("date",t.date,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setTokenExpiryDate(t,i){return this.setTokenExpiryDate$Response(t,i).pipe((0,c.U)(o=>o.body))}setTokenActivationDeadline$Response(t,i){const o=new b.c(this.rootUrl,n.SetTokenActivationDeadlinePath,"post");return t&&(o.path("id",t.id,{}),o.query("date",t.date,{})),this.http.request(o.build({responseType:"text",accept:"*/*",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r.clone({body:void 0})))}setTokenActivationDeadline(t,i){return this.setTokenActivationDeadline$Response(t,i).pipe((0,c.U)(o=>o.body))}getTokenQrCode$Response(t,i){const o=new b.c(this.rootUrl,n.GetTokenQrCodePath,"get");return t&&(o.path("id",t.id,{}),o.query("size",t.size,{})),this.http.request(o.build({responseType:"blob",accept:"image/png",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getTokenQrCode(t,i){return this.getTokenQrCode$Response(t,i).pipe((0,c.U)(o=>o.body))}getTokenDataForNew$Response(t,i){const o=new b.c(this.rootUrl,n.GetTokenDataForNewPath,"get");return t&&(o.path("type",t.type,{}),o.query("fields",t.fields,{explode:!1}),o.query("user",t.user,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getTokenDataForNew(t,i){return this.getTokenDataForNew$Response(t,i).pipe((0,c.U)(o=>o.body))}createToken$Response(t,i){const o=new b.c(this.rootUrl,n.CreateTokenPath,"post");return t&&(o.path("type",t.type,{}),o.body(t.body,"application/json")),this.http.request(o.build({responseType:"text",accept:"text/plain",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}createToken(t,i){return this.createToken$Response(t,i).pipe((0,c.U)(o=>o.body))}getGeneralTokensDataForSearch$Response(t,i){const o=new b.c(this.rootUrl,n.GetGeneralTokensDataForSearchPath,"get");return t&&(o.path("type",t.type,{}),o.query("fields",t.fields,{explode:!1})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}getGeneralTokensDataForSearch(t,i){return this.getGeneralTokensDataForSearch$Response(t,i).pipe((0,c.U)(o=>o.body))}searchGeneralTokens$Response(t,i){const o=new b.c(this.rootUrl,n.SearchGeneralTokensPath,"get");return t&&(o.path("type",t.type,{}),o.query("fields",t.fields,{explode:!1}),o.query("activationPeriod",t.activationPeriod,{}),o.query("brokers",t.brokers,{}),o.query("expiryPeriod",t.expiryPeriod,{}),o.query("groups",t.groups,{}),o.query("page",t.page,{}),o.query("pageSize",t.pageSize,{}),o.query("skipTotalCount",t.skipTotalCount,{}),o.query("statuses",t.statuses,{}),o.query("user",t.user,{}),o.query("value",t.value,{})),this.http.request(o.build({responseType:"json",accept:"application/json",context:i})).pipe((0,T.h)(r=>r instanceof h.Zn),(0,c.U)(r=>r))}searchGeneralTokens(t,i){return this.searchGeneralTokens$Response(t,i).pipe((0,c.U)(o=>o.body))}}return n.ListUserTokenTypesPath="/{user}/token-types",n.GetUserTokensPath="/{user}/tokens/{type}",n.ActivateTokenPath="/{user}/tokens/{type}",n.ViewTokenPath="/tokens/{id}",n.ActivatePendingTokenPath="/tokens/{id}/activate",n.BlockTokenPath="/tokens/{id}/block",n.UnblockTokenPath="/tokens/{id}/unblock",n.CancelTokenPath="/tokens/{id}/cancel",n.AssignTokenPath="/tokens/{id}/assign/{user}",n.SetTokenExpiryDatePath="/tokens/{id}/set-expiry-date",n.SetTokenActivationDeadlinePath="/tokens/{id}/set-activation-deadline",n.GetTokenQrCodePath="/tokens/{id}/qr-code",n.GetTokenDataForNewPath="/tokens/{type}/data-for-new",n.CreateTokenPath="/tokens/{type}/new",n.GetGeneralTokensDataForSearchPath="/general-tokens/{type}/data-for-search",n.SearchGeneralTokensPath="/general-tokens/{type}",n.\u0275fac=function(t){return new(t||n)(e.LFG(G.p),e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Gm=s(9998);const $m=["inputField"];function Hm(n,a){if(1&n&&(e.TgZ(0,"label-value",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.user),e.xp6(1),e.hij(" ",t.user.display," ")}}function Vm(n,a){if(1&n&&e._UZ(0,"user-field",14),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.user)}}function jm(n,a){if(1&n&&e._UZ(0,"field-option",17),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.name)}}function zm(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",15),e.YNc(1,jm,1,2,"field-option",16),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.operator)("emptyOption",t.i18n.general.notSet),e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,3,t.operators$))}}function Xm(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",19,20),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).showScanQrCode()}),e._UZ(2,"icon",21),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("tooltip",t.i18n.field.user.scanQrCodeTooltip),e.xp6(2),e.Q6J("icon",t.SvgIcon.QrCodeScan)}}function Km(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Xm,3,2,"button",18),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.type.physicalType===t.physicalType.QR_CODE)}}function Wm(n,a){if(1&n&&e._UZ(0,"boolean-field",22),2&n){const t=e.oxw();e.Q6J("label",t.i18n.token.action.activate)}}function ef(n,a){1&n&&e._uU(0,"\xa0")}let hn=(()=>{class n extends Ue.H{constructor(t,i,o,r,p){super(t),this.modalRef=i,this.tokensService=o,this.operatorsService=r,this.modal=p,this.physicalType=Pe.q,this.operators$=new oe.X(null),this.canActivate$=new oe.X(null)}ngOnInit(){this.canActivate$.next(!!this.user),this.form=this.formBuilder.group({user:this.user?this.user.id:null,operator:null,value:[null,_.kI.required],activateNow:!1}),this.user||this.form.get("user").valueChanges.subscribe(()=>this.fillOperatorsField())}fillOperatorsField(){const t=this.form.get("user").value;t?(this.canActivate$.next(!0),this.operatorsService.searchUserOperators$Response({user:t,skipTotalCount:!0,pageSize:9999999}).subscribe(i=>{var o;i.ok&&(null===(o=i.body)||void 0===o?void 0:o.length)>0?this.operators$.next(i.body):this.operators$.next(null)})):(this.canActivate$.next(!1),this.operators$.next(null))}showScanQrCode(){this.modal.show(Bm.u,{class:"modal-form"}).content.select.pipe((0,Re.P)()).subscribe(o=>this.form.controls.value.setValue(o)),this.modal.onHide.pipe((0,Re.P)()).subscribe(()=>(0,m.T_)(this.inputField,!0))}submit(){if(!(0,m.pt)(this.form))return;const t=(0,S.Z)(this.form.value);t.operator&&(t.user=t.operator,delete t.operator),this.tokensService.createToken({type:this.type.id,body:t}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.created),this.updateAction()}),this.modalRef.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.UZ),e.Y36(Xe),e.Y36(rt),e.Y36(X.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["create-token"]],viewQuery:function(t,i){if(1&t&&e.Gf($m,5),2&t){let o;e.iGM(o=e.CRH())&&(i.inputField=o.first)}},inputs:{type:"type",user:"user",required:"required",updateAction:"updateAction"},features:[e.qOj],decls:19,vars:18,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],["formControlName","user",3,"label",4,"ngIf"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["kind","field",3,"label"],["required","","formControlName","value",3,"mask","placeholder"],["inputField",""],[4,"extraCell"],["formControlName","activateNow",3,"label",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["kind","fieldView","labelPosition","side",3,"label"],["formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],[3,"icon"],["formControlName","activateNow",3,"label"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.ynx(2,0),e.YNc(3,Hm,2,2,"label-value",1),e.YNc(4,Vm,1,1,"user-field",2),e.YNc(5,zm,3,5,"single-selection-field",3),e.ALo(6,"async"),e.TgZ(7,"label-value",4),e._UZ(8,"input-field",5,6),e.YNc(10,Km,2,1,"div",7),e.qZA(),e.YNc(11,Wm,1,1,"boolean-field",8),e.ALo(12,"async"),e.TgZ(13,"actions",9)(14,"action-button",10),e.NdJ("action",function(){return i.submit()}),e.ALo(15,"async"),e.qZA(),e.YNc(16,ef,1,0,"ng-template",null,11,e.W1O),e.TgZ(18,"action-button",12),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()(),e.BQk()),2&t){let o;e.xp6(1),e.Oqu(i.i18n.token.title.new(i.type.name)),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("ngIf",i.user),e.xp6(1),e.Q6J("ngIf",!i.user),e.xp6(1),e.Q6J("ngIf",(null==(o=e.lcZ(6,12,i.operators$))?null:o.length)>0),e.xp6(2),e.Q6J("label",i.i18n.token.value),e.xp6(1),e.Q6J("mask",i.type.mask)("placeholder",i.type.mask?i.type.mask:""),e.xp6(3),e.Q6J("ngIf",e.lcZ(12,14,i.canActivate$)),e.xp6(3),e.Q6J("label",i.i18n.general.submit)("disabled",e.lcZ(15,16,i.requesting$)),e.xp6(4),e.Q6J("label",i.i18n.general.cancel)}},directives:[_.JL,_.sg,d.O5,Y.t,ve.l,_.JJ,_.u,ue.f,d.sg,W.s,ge.q,_.Q7,Gm.h,an.j,ie.i9,ne.o,O.M,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();function tf(n,a){if(1&n&&e._UZ(0,"user-info",7),2&n){const t=e.oxw(2);e.Q6J("user",t.data.user)}}function nf(n,a){if(1&n&&(e.TgZ(0,"label-value",10),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("label",i.i18n.general.operator),e.xp6(1),e.hij(" ",null!=t.user&&t.user.user?t.user.display:""," ")}}function of(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result")(1,"div",8)(2,"div"),e.YNc(3,nf,2,2,"label-value",9),e.TgZ(4,"label-value",10),e._uU(5),e.qZA(),e.TgZ(6,"label-value",10),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"label-value",10),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"label-value",10),e._uU(13),e.ALo(14,"date"),e.qZA(),e.TgZ(15,"label-value",10),e._uU(16),e.qZA()(),e.TgZ(17,"div",11)(18,"button",12),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(2);return C.router.navigate(C.view(p)),o.stopPropagation(),o.preventDefault()}),e._UZ(19,"icon",13),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("ngIf",!i.self),e.xp6(1),e.Q6J("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("label",i.i18n.token.creationDate),e.xp6(1),e.hij(" ",e.lcZ(8,13,t.creationDate)," "),e.xp6(2),e.Q6J("label",i.i18n.token.activationDate),e.xp6(1),e.hij(" ",e.lcZ(11,15,t.activationDate)," "),e.xp6(2),e.Q6J("label",i.i18n.token.expiryDate),e.xp6(1),e.hij(" ",e.lcZ(14,17,t.expiryDate)," "),e.xp6(2),e.Q6J("label",i.i18n.general.status),e.xp6(1),e.hij(" ",i.statusDisplay(t.status)," "),e.xp6(2),e.Q6J("tooltip",i.i18n.general.view),e.xp6(1),e.Q6J("icon",i.SvgIcon.Search)}}function af(n,a){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.operator)}}function rf(n,a){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("",null!=t.user&&t.user.user?t.user.display:""," ")}}function sf(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",16),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(3);return C.router.navigate(C.view(p)),o.stopPropagation(),o.preventDefault()}),e.YNc(1,rf,2,1,"td",1),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!i.self),e.xp6(2),e.Oqu(t.value),e.xp6(2),e.Oqu(e.lcZ(6,6,t.creationDate)),e.xp6(3),e.Oqu(e.lcZ(9,8,t.activationDate)),e.xp6(3),e.Oqu(e.lcZ(12,10,t.expiryDate)),e.xp6(3),e.Oqu(i.statusDisplay(t.status))}}function cf(n,a){if(1&n&&(e.TgZ(0,"table",14)(1,"thead"),e.YNc(2,af,2,1,"th",1),e.TgZ(3,"th"),e._uU(4),e.qZA(),e.TgZ(5,"th"),e._uU(6),e.qZA(),e.TgZ(7,"th"),e._uU(8),e.qZA(),e.TgZ(9,"th"),e._uU(10),e.qZA(),e.TgZ(11,"th"),e._uU(12),e.qZA()(),e.TgZ(13,"tbody"),e.YNc(14,sf,15,12,"tr",15),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(2),e.Oqu(t.isNfc()?t.i18n.token.label:t.i18n.token.value),e.xp6(2),e.Oqu(t.i18n.token.creationDate),e.xp6(2),e.Oqu(t.i18n.token.activationDate),e.xp6(2),e.Oqu(t.i18n.token.expiryDate),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Q6J("ngForOf",t.data.tokens)}}function lf(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,tf,1,1,"user-info",3),e.qZA(),e.TgZ(4,"results-layout",4),e.YNc(5,of,20,19,"mobile-result",5),e.YNc(6,cf,15,7,"table",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("heading",null==t.data?null:t.data.type.pluralName)("mobileHeading",null==t.data?null:t.data.type.pluralName)("headingActions",e.lcZ(2,6,t.headingActions$))("mode",t.self?"empty":"normal"),e.xp6(2),e.Q6J("ngIf",!t.self),e.xp6(1),e.Q6J("results",t.data.tokens)}}let uf=(()=>{class n extends y.y{constructor(t,i,o,r){super(t),this.modal=i,this.userHelper=o,this.tokenService=r}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getUserTokens({user:this.user,type:this.type}).subscribe(t=>this.data=t))}onDataInitialized(t){var i;1!==t.maxPerUser||1!==(null===(i=t.tokens)||void 0===i?void 0:i.length)||t.tokens[0].status!==Ze.u.ACTIVE?(super.onDataInitialized(t),this.self=this.authHelper.isSelf(t.user),this.canCreate()&&t.type.physicalType!==Pe.q.NFC_TAG&&(this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.general.add,()=>{this.modal.show(hn,{class:"modal-form",initialState:{type:t.type,user:t.user,required:!0,updateAction:()=>this.reload()}})},!0)]),this.canActivate()&&(this.headingActions=[new Q.Yu(F.l.CheckCircle,this.i18n.token.action.activate,()=>{this.confirmation.confirm({title:this.i18n.token.action.activate,customFields:[{internalName:"value",name:this.i18n.token.value,type:$e.L.STRING,pattern:t.type.mask,required:!0}],callback:o=>this.tokenService.activateToken({user:this.user,type:this.type,body:o.customValues.value}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.expiryChanged),this.reload()})})},!0)])):this.router.navigate(this.view(t.tokens[0]),{replaceUrl:!0})}isNfc(){return this.data.type.physicalType===Pe.q.NFC_TAG}canCreate(){var t;return!this.self&&(null===(t=this.dataForFrontendHolder.auth.permissions.tokens.user.find(i=>i.type.id===this.type))||void 0===t?void 0:t.create)}canActivate(){var t;return!!this.self&&(null===(t=this.dataForFrontendHolder.auth.permissions.tokens.my.find(i=>i.type.id===this.type))||void 0===t?void 0:t.activate)}statusDisplay(t){return this.userHelper.tokenStatus(t)}view(t){return["/users","tokens","view",t.id]}resolveMenu(t){return this.authHelper.isSelf(t.user)?new v.oX(v.v2.MY_TOKENS,{tokenType:t.type}):t.user.user&&this.authHelper.isSelf(t.user.user)?v.v2.MY_OPERATORS:this.dataForFrontendHolder.role===ee.g.BROKER?v.v2.MY_BROKERED_USERS:v.v2.SEARCH_USERS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.tT),e.Y36(le.T),e.Y36(Xe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["list-token"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,lf,7,8,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,d.O5,E.Y,H.M,V.D,j.E,K.t,Y.t,ie.i9,ne.o,te.p,d.sg],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})();function pf(n,a){1&n&&e.GkF(0)}function df(n,a){if(1&n&&e._UZ(0,"field-option",20),2&n){const t=a.$implicit,i=e.oxw(3);e.Q6J("value",i.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function _f(n,a){if(1&n&&(e.TgZ(0,"div",6)(1,"multi-selection-field",18),e.YNc(2,df,1,5,"field-option",19),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.user.groupFilter),e.xp6(1),e.Q6J("ngForOf",t.data.groups)}}function gf(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mobile-result")(1,"div",21)(2,"div")(3,"label-value",22),e._uU(4),e.qZA(),e.TgZ(5,"label-value",22),e._uU(6),e.qZA(),e.TgZ(7,"label-value",22),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"label-value",22),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"label-value",22),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"label-value",22),e._uU(17),e.qZA()(),e.TgZ(18,"div",23)(19,"button",24),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(2);return C.router.navigate(C.view(p)),o.stopPropagation(),o.preventDefault()}),e._UZ(20,"icon",25),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.oxw(2);e.xp6(3),e.Q6J("label",i.i18n.general.user),e.xp6(1),e.hij(" ",t.user?t.user.display:i.i18n.token.unassigned," "),e.xp6(1),e.Q6J("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),e.xp6(1),e.hij(" ",t.value," "),e.xp6(1),e.Q6J("label",i.i18n.token.creationDate),e.xp6(1),e.hij(" ",e.lcZ(9,14,t.creationDate)," "),e.xp6(2),e.Q6J("label",i.i18n.token.activationDate),e.xp6(1),e.hij(" ",e.lcZ(12,16,t.activationDate)," "),e.xp6(2),e.Q6J("label",i.i18n.token.expiryDate),e.xp6(1),e.hij(" ",e.lcZ(15,18,t.expiryDate)," "),e.xp6(2),e.Q6J("label",i.i18n.general.status),e.xp6(1),e.hij(" ",i.statusDisplay(t.status)," "),e.xp6(2),e.Q6J("tooltip",i.i18n.general.view),e.xp6(1),e.Q6J("icon",i.SvgIcon.Search)}}function mf(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",28),e.NdJ("click",function(o){const p=e.CHM(t).$implicit,C=e.oxw(3);return C.router.navigate(C.view(p)),o.stopPropagation(),o.preventDefault()}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA()()}if(2&n){const t=a.$implicit,i=e.oxw(3);e.xp6(2),e.Oqu(t.user?t.user.display:i.i18n.token.unassigned),e.xp6(2),e.Oqu(t.value),e.xp6(2),e.Oqu(e.lcZ(7,6,t.creationDate)),e.xp6(3),e.Oqu(e.lcZ(10,8,t.activationDate)),e.xp6(3),e.Oqu(e.lcZ(13,10,t.expiryDate)),e.xp6(3),e.Oqu(i.statusDisplay(t.status))}}function ff(n,a){if(1&n&&(e.TgZ(0,"table",26)(1,"thead")(2,"th"),e._uU(3),e.qZA(),e.TgZ(4,"th"),e._uU(5),e.qZA(),e.TgZ(6,"th"),e._uU(7),e.qZA(),e.TgZ(8,"th"),e._uU(9),e.qZA(),e.TgZ(10,"th"),e._uU(11),e.qZA(),e.TgZ(12,"th"),e._uU(13),e.qZA()(),e.TgZ(14,"tbody"),e.YNc(15,mf,16,12,"tr",27),e.ALo(16,"async"),e.qZA()()),2&n){const t=e.oxw(2);let i;e.xp6(3),e.Oqu(t.i18n.general.user),e.xp6(2),e.Oqu(t.isNfc()?t.i18n.token.label:t.i18n.token.value),e.xp6(2),e.Oqu(t.i18n.token.creationDate),e.xp6(2),e.Oqu(t.i18n.token.activationDate),e.xp6(2),e.Oqu(t.i18n.token.expiryDate),e.xp6(2),e.Oqu(t.i18n.general.status),e.xp6(2),e.Q6J("ngForOf",null==(i=e.lcZ(16,7,t.results$))?null:i.results)}}function hf(n,a){if(1&n&&(e.TgZ(0,"page-content",3),e.ALo(1,"async"),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6),e._UZ(5,"user-field",7),e.qZA(),e._UZ(6,"div",8),e.TgZ(7,"div",6),e._UZ(8,"date-field",9),e.qZA(),e.TgZ(9,"div",6),e._UZ(10,"date-field",10),e.qZA(),e._UZ(11,"div",8),e.TgZ(12,"div",6),e._UZ(13,"date-field",11),e.qZA(),e.TgZ(14,"div",6),e._UZ(15,"date-field",12),e.qZA()(),e.TgZ(16,"div",6),e._UZ(17,"multi-selection-field",13),e.qZA(),e.YNc(18,_f,3,2,"div",14),e.qZA()(),e.TgZ(19,"results-layout",15),e.ALo(20,"async"),e.YNc(21,gf,21,20,"mobile-result",16),e.YNc(22,ff,17,9,"table",17),e.qZA()),2&n){const t=e.oxw();e.Q6J("heading",null==t.data?null:t.data.type.pluralName)("mobileHeading",null==t.data?null:t.data.type.pluralName)("headingActions",e.lcZ(1,15,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(3),e.Q6J("label",t.i18n.general.user),e.xp6(3),e.Q6J("label",t.i18n.token.activationBeginDate),e.xp6(2),e.Q6J("label",t.i18n.token.activationEndDate),e.xp6(3),e.Q6J("label",t.i18n.token.expiryBeginDate),e.xp6(2),e.Q6J("label",t.i18n.token.expiryEndDate),e.xp6(2),e.Q6J("emptyLabel",t.i18n.general.notApplied)("label",t.i18n.general.status)("fieldOptions",t.statusOptions),e.xp6(1),e.Q6J("ngIf",(null==t.data.groups?null:t.data.groups.length)>1),e.xp6(1),e.Q6J("results",e.lcZ(20,17,t.results$))("rendering$",t.rendering$)}}let bf=(()=>{class n extends xe.t{constructor(t,i,o,r){super(t),this.userHelper=i,this.modal=o,this.tokenService=r}getFormControlNames(){return["user","statuses","groups","activationBeginDate","activationEndDate","expiryBeginDate","expiryEndDate"]}ngOnInit(){super.ngOnInit(),this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getGeneralTokensDataForSearch({type:this.type}).subscribe(t=>this.data=t))}onDataInitialized(t){super.onDataInitialized(t),t.type.physicalType!==Pe.q.NFC_TAG&&(this.headingActions=[new Q.Yu(F.l.PlusCircle,this.i18n.general.add,()=>{this.modal.show(hn,{class:"modal-form",initialState:{type:t.type,updateAction:()=>this.reload()}})},!0)])}doSearch(t){return this.tokenService.searchGeneralTokens$Response(t)}toSearchParams(t){const i=t;return i.type=this.type,i.activationPeriod=f.S.dateRangeFilter(t.activationBeginDate,t.activationEndDate),i.expiryPeriod=f.S.dateRangeFilter(t.expiryBeginDate,t.expiryEndDate),i}get statusOptions(){return Object.values(Ze.u).map(t=>({value:t,text:this.statusDisplay(t)}))}statusDisplay(t){return this.userHelper.tokenStatus(t)}isNfc(){return this.data.type.physicalType===Pe.q.NFC_TAG}view(t){return["/users","tokens","view",t.id]}resolveMenu(t){return new v.oX(v.v2.USER_TOKENS,{tokenType:t.type})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(X.tT),e.Y36(Xe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["search-token"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["formControlName","user",3,"label"],[1,"w-100"],["formControlName","activationBeginDate","minDate","past100","maxDate","today","fieldSize","full",3,"label"],["formControlName","activationEndDate","minDate","past100","fieldSize","full",3,"label"],["formControlName","expiryBeginDate","minDate","past100","fieldSize","full",3,"label"],["formControlName","expiryEndDate","minDate","past100","fieldSize","full",3,"label"],["formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,pf,1,0,"ng-container",1),e.qZA(),e.YNc(3,hf,23,19,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(4);e.Q6J("ready",e.lcZ(1,3,i.data$)),e.xp6(2),e.Q6J("ngIf",i.data)("ngIfThen",o)}},directives:[Z.w,d.O5,E.Y,_.JL,_.sg,ve.l,_.JJ,_.u,et.Q,Ie.x,d.sg,W.s,V.D,j.E,K.t,Y.t,ie.i9,ne.o,te.p],pipes:[d.Ov,Ce.u],encapsulation:2,changeDetection:0}),n})();var xf=s(8796);function vf(n,a){if(1&n&&e._UZ(0,"field-option",9),2&n){const t=a.$implicit;e.Q6J("value",t.id)("text",t.display)}}function yf(n,a){if(1&n&&(e.TgZ(0,"single-selection-field",7),e.YNc(1,vf,1,2,"field-option",8),e.ALo(2,"async"),e.qZA()),2&n){const t=e.oxw();e.Q6J("label",t.i18n.general.operator)("emptyOption",t.i18n.general.notSet),e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,3,t.operators$))}}function Tf(n,a){1&n&&e._uU(0,"\xa0")}let Af=(()=>{class n extends Ue.H{constructor(t,i,o,r){super(t),this.modalRef=i,this.tokensService=o,this.operatorsService=r,this.operators$=new oe.X(null)}ngOnInit(){this.form=this.formBuilder.group({user:[null,_.kI.required],operator:null}),this.form.get("user").valueChanges.subscribe(t=>this.fillOperatorsField(t))}fillOperatorsField(t){this.operatorsService.searchUserOperators$Response({user:t.id,skipTotalCount:!0,pageSize:999999}).subscribe(i=>{this.operators$.next(i.ok?i.body:null)})}submit(){if(!(0,m.pt)(this.form))return;const t=(0,S.Z)(this.form.value);this.tokensService.assignToken({id:this.token,user:t.operator?t.operator:t.user}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.assigned),this.updateAction()}),this.modalRef.hide()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(X.UZ),e.Y36(Xe),e.Y36(rt))},n.\u0275cmp=e.Xpm({type:n,selectors:[["assign-token"]],inputs:{token:"token",updateAction:"updateAction"},features:[e.qOj],decls:12,vars:11,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["required","","formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.ynx(2,0),e._UZ(3,"user-field",1),e.YNc(4,yf,3,5,"single-selection-field",2),e.ALo(5,"async"),e.TgZ(6,"actions",3)(7,"action-button",4),e.NdJ("action",function(){return i.submit()}),e.ALo(8,"async"),e.qZA(),e.YNc(9,Tf,1,0,"ng-template",null,5,e.W1O),e.TgZ(11,"action-button",6),e.NdJ("action",function(){return i.modalRef.hide()}),e.qZA()(),e.BQk()),2&t){let o;e.xp6(1),e.Oqu(i.i18n.token.title.assign),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(1),e.Q6J("label",i.i18n.general.user),e.xp6(1),e.Q6J("ngIf",(null==(o=e.lcZ(5,7,i.operators$))?null:o.length)>0),e.xp6(3),e.Q6J("label",i.i18n.general.submit)("disabled",e.lcZ(8,9,i.requesting$)),e.xp6(4),e.Q6J("label",i.i18n.general.cancel)}},directives:[_.JL,_.sg,ve.l,_.Q7,_.JJ,_.u,d.O5,ue.f,d.sg,W.s,k.h,N.x],pipes:[d.Ov],encapsulation:2,changeDetection:0}),n})();var Cf=s(134);function wf(n,a){if(1&n&&(e.TgZ(0,"label-value",7),e._UZ(1,"user-link",8),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",null!=t.data.user&&t.data.user.user?t.data.user.user:t.data.user)}}function Ef(n,a){if(1&n&&(e.TgZ(0,"label-value",7),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.operator),e.xp6(1),e.hij(" ",t.data.user.display," ")}}function Zf(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.creationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.creationDate)," ")}}function If(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.token.activationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.data.activationDate)," ")}}function Sf(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.general.status),e.xp6(1),e.hij(" ",t.statusDisplay(t.data.status)," ")}}function Uf(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.token.activationDeadline),e.xp6(1),e.hij(" ",t.data.activationDeadline?e.lcZ(2,2,t.data.activationDeadline):t.i18n.token.noDeadline," ")}}function Nf(n,a){if(1&n&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("label",t.i18n.token.expiryDate),e.xp6(1),e.hij(" ",t.data.expiryDate?e.lcZ(2,2,t.data.expiryDate):t.i18n.token.noExpiryDate," ")}}function kf(n,a){1&n&&(e._UZ(0,"img",12),e.ALo(1,"trust")),2&n&&e.Q6J("src",e.xi3(1,1,a.ngIf,"url"),e.LSH)}function Of(n,a){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"hr",9),e.TgZ(2,"div",10),e.YNc(3,kf,2,4,"img",11),e.ALo(4,"async"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",e.lcZ(4,1,t.qrCodeUrl$))}}function Pf(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",3),e.YNc(2,wf,2,2,"label-value",4),e.YNc(3,Ef,2,2,"label-value",4),e.TgZ(4,"label-value",5),e._uU(5),e.qZA(),e.YNc(6,Zf,3,4,"label-value",6),e.YNc(7,If,3,4,"label-value",6),e.YNc(8,Sf,2,2,"label-value",6),e.YNc(9,Uf,3,4,"label-value",6),e.YNc(10,Nf,3,4,"label-value",6),e.YNc(11,Of,5,3,"div",2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.showUser()),e.xp6(1),e.Q6J("ngIf",null==t.data.user?null:t.data.user.user),e.xp6(1),e.Q6J("label",t.valueLabel()),e.xp6(1),e.hij(" ",t.data.value," "),e.xp6(1),e.Q6J("ngIf",t.data.creationDate),e.xp6(1),e.Q6J("ngIf",t.data.activationDate),e.xp6(1),e.Q6J("ngIf",t.data.status),e.xp6(1),e.Q6J("ngIf",t.showDeadLine()),e.xp6(1),e.Q6J("ngIf",t.showExpiryDate()),e.xp6(1),e.Q6J("ngIf",t.isQrCode(t.data))}}const Jf=[{path:"",children:[{path:"search",component:dt},{path:"search/pending",component:dt},{path:"messages/search",component:Fr,canActivate:[l.b]},{path:"messages/view/:id",component:as,canActivate:[l.b]},{path:"messages/send",component:Bt,canActivate:[l.b]},{path:"messages/reply/:id",component:Bt,canActivate:[l.b]},{path:"brokerings",component:dt,canActivate:[l.b]},{path:":user/brokerings",component:dt,canActivate:[l.b]},{path:":user/brokers",component:yi,canActivate:[l.b]},{path:":user/brokers/history",component:Ii,canActivate:[l.b]},{path:":user/brokers/new",component:ai,canActivate:[l.b]},{path:":user/profile",component:It.W,resolve:{countries:g.W}},{path:":user/profile/edit",component:rn,canActivate:[l.b],resolve:{countries:g.W}},{path:"operators",component:Xt,canActivate:[l.b]},{path:":user/operators",component:Xt,canActivate:[l.b]},{path:":user/operators/registration",component:Yl,canActivate:[l.b]},{path:"operators/:user",component:It.W,canActivate:[l.b]},{path:"operators/:user/edit",component:rn,canActivate:[l.b]},{path:":user/status",component:Ym,canActivate:[l.b]},{path:":user/status/history",component:Rm,canActivate:[l.b]},{path:":user/group",component:La,canActivate:[l.b]},{path:":user/group/history",component:Fa,canActivate:[l.b]},{path:":user/agreements",component:zn,canActivate:[l.b]},{path:":user/agreements/history",component:On,canActivate:[l.b]},{path:"operator-groups",component:Ht,canActivate:[l.b]},{path:":user/operator-groups",component:Ht,canActivate:[l.b]},{path:":user/operator-groups/new",component:Vt,canActivate:[l.b]},{path:"operator-groups/:id",component:yl,canActivate:[l.b]},{path:"operator-groups/:id/edit",component:Vt,canActivate:[l.b]},{path:"contacts",component:zg,canActivate:[l.b]},{path:"contacts/:user",component:It.W,canActivate:[l.b],resolve:{countries:g.W}},{path:":user/passwords",component:Cp,canActivate:[l.b]},{path:":user/passwords/history",component:Np,canActivate:[l.b]},{path:":user/identity-providers",component:ar,canActivate:[l.b]},{path:"registration",component:_n.B,resolve:{countries:g.W}},{path:"registration/:externalPaymentToken",component:_n.B,resolve:{countries:g.W}},{path:"validate-registration/:key",component:Gg},{path:"connected",component:Mi},{path:"alerts",component:ni},{path:"validate-email-change/:key",component:lg},{path:":user/notification-settings",component:Ys,canActivate:[l.b]},{path:"documents",component:co,canActivate:[l.b]},{path:":user/documents/search",component:Zo,canActivate:[l.b]},{path:"documents/edit/:id",component:kt,canActivate:[l.b]},{path:"documents/view/:id",component:qo,canActivate:[l.b]},{path:":user/documents/new",component:kt,canActivate:[l.b]},{path:"documents/process-dynamic/:id",component:_o,canActivate:[l.b]},{path:":user/tokens/:type",component:uf,canActivate:[l.b]},{path:"tokens/search/:type",component:bf,canActivate:[l.b]},{path:"tokens/view/:id",component:(()=>{class n extends ce.k{constructor(t,i,o,r,p){super(t),this.userHelper=i,this.modal=o,this.tokenHelper=r,this.tokenService=p,this.qrCodeUrl$=new oe.X(null)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.tokenService.viewToken({id:this.id}).subscribe(t=>this.data=t))}isQrCode(t){return t.type.physicalType===Pe.q.QR_CODE}onDataInitialized(t){this.isQrCode(t)&&this.getTokenQrCodeUrl();const i=[];t.assign&&i.push(new Q.Yu(F.l.PersonPlus,this.i18n.token.action.assign,()=>{t.status===Ze.u.UNASSIGNED&&this.modal.show(Af,{class:"modal-form",initialState:{token:this.id,updateAction:()=>this.reload()}})})),t.setActivationDeadline&&i.push(new Q.Yu(F.l.CalendarEvent,this.i18n.token.action.changeDeadline,()=>{this.confirmation.confirm({title:this.i18n.token.action.changeDeadline,customFields:[{internalName:"deadline",name:this.i18n.token.activationDeadline,type:$e.L.DATE,required:!0}],callback:o=>this.tokenService.setTokenActivationDeadline({id:this.id,date:o.customValues.deadline}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.deadlineChanged))})})),t.setExpiryDate&&i.push(new Q.Yu(F.l.CalendarEvent,this.i18n.token.action.changeExpiry,()=>{this.confirmation.confirm({title:this.i18n.token.action.changeExpiry,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:$e.L.DATE,required:!0}],callback:o=>this.tokenService.setTokenExpiryDate({id:this.id,date:o.customValues.expiry}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.expiryChanged))})})),t.block&&i.push(new Q.Yu(F.l.Lock,this.i18n.token.action.block,()=>{this.tokenService.blockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.blocked))})),t.unblock&&i.push(new Q.Yu(F.l.Unlock,this.i18n.token.action.unblock,()=>{this.tokenService.unblockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.unblocked))})),t.activate&&i.push(new Q.Yu(this.tokenHelper.icon(t.type),this.i18n.token.action.activate,()=>{this.tokenService.activatePendingToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.activated))})),t.cancel&&i.push(new Q.Yu(F.l.XCircle,this.i18n.token.action.cancel,()=>{this.confirmation.confirm({title:this.i18n.token.action.cancel,message:this.i18n.token.action.message.cancel,callback:()=>this.tokenService.cancelToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.canceled))})})),this.headingActions=i}notifyDoneAndReload(t){this.notification.snackBar(t),this.reload()}getTokenQrCodeUrl(){this.addSub(this.tokenService.getTokenQrCode({id:this.id,size:xf.r.MEDIUM}).subscribe(t=>this.qrCodeUrl$.next(URL.createObjectURL(t))))}statusDisplay(t){return this.userHelper.tokenStatus(t)}showUser(){var t;return!(this.authHelper.isSelf(this.data.user)||(null===(t=this.data.user)||void 0===t?void 0:t.user)&&this.authHelper.isSelf(this.data.user.user))}valueLabel(){return this.data.type.physicalType===Pe.q.NFC_TAG?this.i18n.token.label:this.i18n.token.value}showDeadLine(){return this.data.status===Ze.u.ACTIVATION_EXPIRED||this.data.status===Ze.u.PENDING}showExpiryDate(){return[Ze.u.ACTIVE,Ze.u.BLOCKED,Ze.u.CANCELED,Ze.u.EXPIRED].includes(this.data.status)}resolveMenu(t){return this.dataForFrontendHolder.role===ee.g.ADMINISTRATOR?new v.oX(v.v2.USER_TOKENS,{tokenType:t.type}):this.authHelper.isSelf(t.user)?new v.oX(v.v2.MY_TOKENS,{tokenType:t.type}):t.user.user&&this.authHelper.isSelf(t.user.user)?v.v2.MY_OPERATORS:this.dataForFrontendHolder.role===ee.g.BROKER?v.v2.MY_BROKERED_USERS:v.v2.SEARCH_USERS}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(le.T),e.Y36(X.tT),e.Y36(Cf.X),e.Y36(Xe))},n.\u0275cmp=e.Xpm({type:n,selectors:[["view-token"]],features:[e.qOj],decls:5,vars:9,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.TgZ(2,"page-content",1),e.ALo(3,"async"),e.YNc(4,Pf,12,10,"ng-container",2),e.qZA()()),2&t&&(e.Q6J("ready",e.lcZ(1,5,i.data$)),e.xp6(2),e.Q6J("heading",i.i18n.token.title.view(null==i.data?null:i.data.type.name))("mobileHeading",i.i18n.token.mobileTitle.view(null==i.data?null:i.data.type.name))("headingActions",e.lcZ(3,7,i.headingActions$)),e.xp6(2),e.Q6J("ngIf",i.data))},directives:[Z.w,E.Y,d.O5,Y.t,ae.F],pipes:[d.Ov,Ce.u,ht.a],encapsulation:2,changeDetection:0}),n})(),canActivate:[l.b]},{path:":user/product-assignment",component:$p,canActivate:[l.b]},{path:":user/product-assignment/history",component:Kp,canActivate:[l.b]},{path:":user/privacy-settings",component:We,canActivate:[l.b]},{path:":user/privacy-settings/edit",component:q,canActivate:[l.b]},{path:"feedbacks/search-awaiting",component:fa,canActivate:[l.b]},{path:":user/feedbacks/search",component:ua,canActivate:[l.b]},{path:":user/references/search",component:Fg,canActivate:[l.b]},{path:"references/view/:id",component:Lg,canActivate:[l.b]},{path:"feedbacks/view/:id",component:Na,canActivate:[l.b]},{path:"references/set/:from/:to",component:dn,canActivate:[l.b]},{path:"references/edit/:id",component:dn,canActivate:[l.b]},{path:"feedbacks/set/:transactionId",component:Dt,canActivate:[l.b]},{path:"feedbacks/edit/:id",component:Dt,canActivate:[l.b]},{path:"feedbacks/settings",component:Ho,canActivate:[l.b]},{path:":user/quick-access/settings",component:yg,canActivate:[l.b]}]}];let Df=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[x.Bz.forChild(Jf)],x.Bz]}),n})(),Ff=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[Df,A.C]]}),n})()},4901:B=>{"use strict";var w={single_source_shortest_paths:function(s,A,x){var g={},l={};l[A]=0;var y,m,v,S,e,U,f=w.PriorityQueue.make();for(f.push(A,0);!f.empty();)for(v in S=(y=f.pop()).cost,e=s[m=y.value]||{})e.hasOwnProperty(v)&&(U=S+e[v],(void 0===l[v]||l[v]>U)&&(l[v]=U,f.push(v,U),g[v]=m));if(void 0!==x&&void 0===l[x]){var c=["Could not find a path from ",A," to ",x,"."].join("");throw new Error(c)}return g},extract_shortest_path_from_predecessor_list:function(s,A){for(var x=[],g=A;g;)x.push(g),g=s[g];return x.reverse(),x},find_path:function(s,A,x){var g=w.single_source_shortest_paths(s,A,x);return w.extract_shortest_path_from_predecessor_list(g,x)},PriorityQueue:{make:function(s){var g,A=w.PriorityQueue,x={};for(g in s=s||{},A)A.hasOwnProperty(g)&&(x[g]=A[g]);return x.queue=[],x.sorter=s.sorter||A.default_sorter,x},default_sorter:function(s,A){return s.cost-A.cost},push:function(s,A){this.queue.push({value:s,cost:A}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};B.exports=w},8419:B=>{"use strict";B.exports=function(s){for(var A=[],x=s.length,g=0;g<x;g++){var l=s.charCodeAt(g);if(l>=55296&&l<=56319&&x>g+1){var f=s.charCodeAt(g+1);f>=56320&&f<=57343&&(l=1024*(l-55296)+f-56320+65536,g+=1)}l<128?A.push(l):l<2048?(A.push(l>>6|192),A.push(63&l|128)):l<55296||l>=57344&&l<65536?(A.push(l>>12|224),A.push(l>>6&63|128),A.push(63&l|128)):l>=65536&&l<=1114111?(A.push(l>>18|240),A.push(l>>12&63|128),A.push(l>>6&63|128),A.push(63&l|128)):A.push(239,191,189)}return new Uint8Array(A).buffer}},3259:(B,w,s)=>{const A=s(8695),x=s(1465),g=s(3210),l=s(2334);function f(y,m,v,S,e){const h=[].slice.call(arguments,1),U=h.length,b="function"==typeof h[U-1];if(!b&&!A())throw new Error("Callback required as last argument");if(!b){if(U<1)throw new Error("Too few arguments provided");return 1===U?(v=m,m=S=void 0):2===U&&!m.getContext&&(S=v,v=m,m=void 0),new Promise(function(T,c){try{const G=x.create(v,S);T(y(G,m,S))}catch(G){c(G)}})}if(U<2)throw new Error("Too few arguments provided");2===U?(e=v,v=m,m=S=void 0):3===U&&(m.getContext&&void 0===e?(e=S,S=void 0):(e=S,S=v,v=m,m=void 0));try{const T=x.create(v,S);e(null,y(T,m,S))}catch(T){e(T)}}w.create=x.create,w.toCanvas=f.bind(null,g.render),w.toDataURL=f.bind(null,g.renderToDataURL),w.toString=f.bind(null,function(y,m,v){return l.render(y,v)})},8695:B=>{B.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},6221:(B,w,s)=>{const A=s(4792).getSymbolSize;w.getRowColCoords=function(g){if(1===g)return[];const l=Math.floor(g/7)+2,f=A(g),y=145===f?26:2*Math.ceil((f-13)/(2*l-2)),m=[f-7];for(let v=1;v<l-1;v++)m[v]=m[v-1]-y;return m.push(6),m.reverse()},w.getPositions=function(g){const l=[],f=w.getRowColCoords(g),y=f.length;for(let m=0;m<y;m++)for(let v=0;v<y;v++)0===m&&0===v||0===m&&v===y-1||m===y-1&&0===v||l.push([f[m],f[v]]);return l}},2424:(B,w,s)=>{const A=s(4016),x=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function g(l){this.mode=A.ALPHANUMERIC,this.data=l}g.getBitsLength=function(f){return 11*Math.floor(f/2)+f%2*6},g.prototype.getLength=function(){return this.data.length},g.prototype.getBitsLength=function(){return g.getBitsLength(this.data.length)},g.prototype.write=function(f){let y;for(y=0;y+2<=this.data.length;y+=2){let m=45*x.indexOf(this.data[y]);m+=x.indexOf(this.data[y+1]),f.put(m,11)}this.data.length%2&&f.put(x.indexOf(this.data[y]),6)},B.exports=g},2118:B=>{function w(){this.buffer=[],this.length=0}w.prototype={get:function(s){const A=Math.floor(s/8);return 1==(this.buffer[A]>>>7-s%8&1)},put:function(s,A){for(let x=0;x<A;x++)this.putBit(1==(s>>>A-x-1&1))},getLengthInBits:function(){return this.length},putBit:function(s){const A=Math.floor(this.length/8);this.buffer.length<=A&&this.buffer.push(0),s&&(this.buffer[A]|=128>>>this.length%8),this.length++}},B.exports=w},4425:B=>{function w(s){if(!s||s<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=s,this.data=new Uint8Array(s*s),this.reservedBit=new Uint8Array(s*s)}w.prototype.set=function(s,A,x,g){const l=s*this.size+A;this.data[l]=x,g&&(this.reservedBit[l]=!0)},w.prototype.get=function(s,A){return this.data[s*this.size+A]},w.prototype.xor=function(s,A,x){this.data[s*this.size+A]^=x},w.prototype.isReserved=function(s,A){return this.reservedBit[s*this.size+A]},B.exports=w},5663:(B,w,s)=>{const A=s(8419),x=s(4016);function g(l){this.mode=x.BYTE,"string"==typeof l&&(l=A(l)),this.data=new Uint8Array(l)}g.getBitsLength=function(f){return 8*f},g.prototype.getLength=function(){return this.data.length},g.prototype.getBitsLength=function(){return g.getBitsLength(this.data.length)},g.prototype.write=function(l){for(let f=0,y=this.data.length;f<y;f++)l.put(this.data[f],8)},B.exports=g},4655:(B,w,s)=>{const A=s(2259),x=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],g=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];w.getBlocksCount=function(f,y){switch(y){case A.L:return x[4*(f-1)+0];case A.M:return x[4*(f-1)+1];case A.Q:return x[4*(f-1)+2];case A.H:return x[4*(f-1)+3];default:return}},w.getTotalCodewordsCount=function(f,y){switch(y){case A.L:return g[4*(f-1)+0];case A.M:return g[4*(f-1)+1];case A.Q:return g[4*(f-1)+2];case A.H:return g[4*(f-1)+3];default:return}}},2259:(B,w)=>{w.L={bit:1},w.M={bit:0},w.Q={bit:3},w.H={bit:2},w.isValid=function(x){return x&&void 0!==x.bit&&x.bit>=0&&x.bit<4},w.from=function(x,g){if(w.isValid(x))return x;try{return function s(A){if("string"!=typeof A)throw new Error("Param is not a string");switch(A.toLowerCase()){case"l":case"low":return w.L;case"m":case"medium":return w.M;case"q":case"quartile":return w.Q;case"h":case"high":return w.H;default:throw new Error("Unknown EC Level: "+A)}}(x)}catch(l){return g}}},3114:(B,w,s)=>{const A=s(4792).getSymbolSize;w.getPositions=function(l){const f=A(l);return[[0,0],[f-7,0],[0,f-7]]}},7078:(B,w,s)=>{const A=s(4792),l=A.getBCHDigit(1335);w.getEncodedBits=function(y,m){const v=y.bit<<3|m;let S=v<<10;for(;A.getBCHDigit(S)-l>=0;)S^=1335<<A.getBCHDigit(S)-l;return 21522^(v<<10|S)}},5339:(B,w)=>{const s=new Uint8Array(512),A=new Uint8Array(256);(function(){let g=1;for(let l=0;l<255;l++)s[l]=g,A[g]=l,g<<=1,256&g&&(g^=285);for(let l=255;l<512;l++)s[l]=s[l-255]})(),w.log=function(g){if(g<1)throw new Error("log("+g+")");return A[g]},w.exp=function(g){return s[g]},w.mul=function(g,l){return 0===g||0===l?0:s[A[g]+A[l]]}},449:(B,w,s)=>{const A=s(4016),x=s(4792);function g(l){this.mode=A.KANJI,this.data=l}g.getBitsLength=function(f){return 13*f},g.prototype.getLength=function(){return this.data.length},g.prototype.getBitsLength=function(){return g.getBitsLength(this.data.length)},g.prototype.write=function(l){let f;for(f=0;f<this.data.length;f++){let y=x.toSJIS(this.data[f]);if(y>=33088&&y<=40956)y-=33088;else{if(!(y>=57408&&y<=60351))throw new Error("Invalid SJIS character: "+this.data[f]+"\nMake sure your charset is UTF-8");y-=49472}y=192*(y>>>8&255)+(255&y),l.put(y,13)}},B.exports=g},3667:(B,w)=>{w.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function A(x,g,l){switch(x){case w.Patterns.PATTERN000:return(g+l)%2==0;case w.Patterns.PATTERN001:return g%2==0;case w.Patterns.PATTERN010:return l%3==0;case w.Patterns.PATTERN011:return(g+l)%3==0;case w.Patterns.PATTERN100:return(Math.floor(g/2)+Math.floor(l/3))%2==0;case w.Patterns.PATTERN101:return g*l%2+g*l%3==0;case w.Patterns.PATTERN110:return(g*l%2+g*l%3)%2==0;case w.Patterns.PATTERN111:return(g*l%3+(g+l)%2)%2==0;default:throw new Error("bad maskPattern:"+x)}}w.isValid=function(g){return null!=g&&""!==g&&!isNaN(g)&&g>=0&&g<=7},w.from=function(g){return w.isValid(g)?parseInt(g,10):void 0},w.getPenaltyN1=function(g){const l=g.size;let f=0,y=0,m=0,v=null,S=null;for(let e=0;e<l;e++){y=m=0,v=S=null;for(let h=0;h<l;h++){let U=g.get(e,h);U===v?y++:(y>=5&&(f+=y-5+3),v=U,y=1),U=g.get(h,e),U===S?m++:(m>=5&&(f+=m-5+3),S=U,m=1)}y>=5&&(f+=y-5+3),m>=5&&(f+=m-5+3)}return f},w.getPenaltyN2=function(g){const l=g.size;let f=0;for(let y=0;y<l-1;y++)for(let m=0;m<l-1;m++){const v=g.get(y,m)+g.get(y,m+1)+g.get(y+1,m)+g.get(y+1,m+1);(4===v||0===v)&&f++}return 3*f},w.getPenaltyN3=function(g){const l=g.size;let f=0,y=0,m=0;for(let v=0;v<l;v++){y=m=0;for(let S=0;S<l;S++)y=y<<1&2047|g.get(v,S),S>=10&&(1488===y||93===y)&&f++,m=m<<1&2047|g.get(S,v),S>=10&&(1488===m||93===m)&&f++}return 40*f},w.getPenaltyN4=function(g){let l=0;const f=g.data.length;for(let m=0;m<f;m++)l+=g.data[m];return 10*Math.abs(Math.ceil(100*l/f/5)-10)},w.applyMask=function(g,l){const f=l.size;for(let y=0;y<f;y++)for(let m=0;m<f;m++)l.isReserved(m,y)||l.xor(m,y,A(g,m,y))},w.getBestMask=function(g,l){const f=Object.keys(w.Patterns).length;let y=0,m=1/0;for(let v=0;v<f;v++){l(v),w.applyMask(v,g);const S=w.getPenaltyN1(g)+w.getPenaltyN2(g)+w.getPenaltyN3(g)+w.getPenaltyN4(g);w.applyMask(v,g),S<m&&(m=S,y=v)}return y}},4016:(B,w,s)=>{const A=s(4406),x=s(2699);w.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},w.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},w.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},w.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},w.MIXED={bit:-1},w.getCharCountIndicator=function(f,y){if(!f.ccBits)throw new Error("Invalid mode: "+f);if(!A.isValid(y))throw new Error("Invalid version: "+y);return y>=1&&y<10?f.ccBits[0]:y<27?f.ccBits[1]:f.ccBits[2]},w.getBestModeForData=function(f){return x.testNumeric(f)?w.NUMERIC:x.testAlphanumeric(f)?w.ALPHANUMERIC:x.testKanji(f)?w.KANJI:w.BYTE},w.toString=function(f){if(f&&f.id)return f.id;throw new Error("Invalid mode")},w.isValid=function(f){return f&&f.bit&&f.ccBits},w.from=function(f,y){if(w.isValid(f))return f;try{return function g(l){if("string"!=typeof l)throw new Error("Param is not a string");switch(l.toLowerCase()){case"numeric":return w.NUMERIC;case"alphanumeric":return w.ALPHANUMERIC;case"kanji":return w.KANJI;case"byte":return w.BYTE;default:throw new Error("Unknown mode: "+l)}}(f)}catch(m){return y}}},7783:(B,w,s)=>{const A=s(4016);function x(g){this.mode=A.NUMERIC,this.data=g.toString()}x.getBitsLength=function(l){return 10*Math.floor(l/3)+(l%3?l%3*3+1:0)},x.prototype.getLength=function(){return this.data.length},x.prototype.getBitsLength=function(){return x.getBitsLength(this.data.length)},x.prototype.write=function(l){let f,y,m;for(f=0;f+3<=this.data.length;f+=3)y=this.data.substr(f,3),m=parseInt(y,10),l.put(m,10);const v=this.data.length-f;v>0&&(y=this.data.substr(f),m=parseInt(y,10),l.put(m,3*v+1))},B.exports=x},1106:(B,w,s)=>{const A=s(5339);w.mul=function(g,l){const f=new Uint8Array(g.length+l.length-1);for(let y=0;y<g.length;y++)for(let m=0;m<l.length;m++)f[y+m]^=A.mul(g[y],l[m]);return f},w.mod=function(g,l){let f=new Uint8Array(g);for(;f.length-l.length>=0;){const y=f[0];for(let v=0;v<l.length;v++)f[v]^=A.mul(l[v],y);let m=0;for(;m<f.length&&0===f[m];)m++;f=f.slice(m)}return f},w.generateECPolynomial=function(g){let l=new Uint8Array([1]);for(let f=0;f<g;f++)l=w.mul(l,new Uint8Array([1,A.exp(f)]));return l}},1465:(B,w,s)=>{const A=s(4792),x=s(2259),g=s(2118),l=s(4425),f=s(6221),y=s(3114),m=s(3667),v=s(4655),S=s(2636),e=s(2088),h=s(7078),U=s(4016),b=s(2033);function Z(O,k,N){const P=O.size,M=h.getEncodedBits(k,N);let D,J;for(D=0;D<15;D++)J=1==(M>>D&1),O.set(D<6?D:D<8?D+1:P-15+D,8,J,!0),O.set(8,D<8?P-D-1:D<9?15-D-1+1:15-D-1,J,!0);O.set(P-8,8,1,!0)}function H(O,k,N,P){let M;if(Array.isArray(O))M=b.fromArray(O);else{if("string"!=typeof O)throw new Error("Invalid data");{let Y=k;if(!Y){const Oe=b.rawSplit(O);Y=e.getBestVersionForData(Oe,N)}M=b.fromString(O,Y||40)}}const D=e.getBestVersionForData(M,N);if(!D)throw new Error("The amount of data is too big to be stored in a QR Code");if(k){if(k<D)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+D+".\n")}else k=D;const J=function d(O,k,N){const P=new g;N.forEach(function(q){P.put(q.mode.bit,4),P.put(q.getLength(),U.getCharCountIndicator(q.mode,O)),q.write(P)});const J=8*(A.getSymbolTotalCodewords(O)-v.getTotalCodewordsCount(O,k));for(P.getLengthInBits()+4<=J&&P.put(0,4);P.getLengthInBits()%8!=0;)P.putBit(0);const L=(J-P.getLengthInBits())/8;for(let q=0;q<L;q++)P.put(q%2?17:236,8);return function _(O,k,N){const P=A.getSymbolTotalCodewords(k),D=P-v.getTotalCodewordsCount(k,N),J=v.getBlocksCount(k,N),q=J-P%J,Y=Math.floor(P/J),Oe=Math.floor(D/J),_t=Oe+1,Ke=Y-Oe,gt=new S(Ke);let Le=0;const Qe=new Array(J),We=new Array(J);let Ye=0;const ce=new Uint8Array(O.buffer);for(let j=0;j<J;j++){const K=j<q?Oe:_t;Qe[j]=ce.slice(Le,Le+K),We[j]=gt.encode(Qe[j]),Le+=K,Ye=Math.max(Ye,K)}const Je=new Uint8Array(P);let X,V,le=0;for(X=0;X<Ye;X++)for(V=0;V<J;V++)X<Qe[V].length&&(Je[le++]=Qe[V][X]);for(X=0;X<Ke;X++)for(V=0;V<J;V++)Je[le++]=We[V][X];return Je}(P,O,k)}(k,N,M),L=A.getSymbolSize(k),q=new l(L);return function T(O,k){const N=O.size,P=y.getPositions(k);for(let M=0;M<P.length;M++){const D=P[M][0],J=P[M][1];for(let L=-1;L<=7;L++)if(!(D+L<=-1||N<=D+L))for(let q=-1;q<=7;q++)J+q<=-1||N<=J+q||O.set(D+L,J+q,L>=0&&L<=6&&(0===q||6===q)||q>=0&&q<=6&&(0===L||6===L)||L>=2&&L<=4&&q>=2&&q<=4,!0)}}(q,k),function c(O){const k=O.size;for(let N=8;N<k-8;N++){const P=N%2==0;O.set(N,6,P,!0),O.set(6,N,P,!0)}}(q),function G(O,k){const N=f.getPositions(k);for(let P=0;P<N.length;P++){const M=N[P][0],D=N[P][1];for(let J=-2;J<=2;J++)for(let L=-2;L<=2;L++)O.set(M+J,D+L,-2===J||2===J||-2===L||2===L||0===J&&0===L,!0)}}(q,k),Z(q,N,0),k>=7&&function R(O,k){const N=O.size,P=e.getEncodedBits(k);let M,D,J;for(let L=0;L<18;L++)M=Math.floor(L/3),D=L%3+N-8-3,J=1==(P>>L&1),O.set(M,D,J,!0),O.set(D,M,J,!0)}(q,k),function E(O,k){const N=O.size;let P=-1,M=N-1,D=7,J=0;for(let L=N-1;L>0;L-=2)for(6===L&&L--;;){for(let q=0;q<2;q++)if(!O.isReserved(M,L-q)){let Y=!1;J<k.length&&(Y=1==(k[J]>>>D&1)),O.set(M,L-q,Y),D--,-1===D&&(J++,D=7)}if(M+=P,M<0||N<=M){M-=P,P=-P;break}}}(q,J),isNaN(P)&&(P=m.getBestMask(q,Z.bind(null,q,N))),m.applyMask(P,q),Z(q,N,P),{modules:q,version:k,errorCorrectionLevel:N,maskPattern:P,segments:M}}w.create=function(k,N){if(void 0===k||""===k)throw new Error("No input text");let M,D,P=x.M;return void 0!==N&&(P=x.from(N.errorCorrectionLevel,x.M),M=e.from(N.version),D=m.from(N.maskPattern),N.toSJISFunc&&A.setToSJISFunction(N.toSJISFunc)),H(k,M,P,D)}},2636:(B,w,s)=>{const A=s(1106);function x(g){this.genPoly=void 0,this.degree=g,this.degree&&this.initialize(this.degree)}x.prototype.initialize=function(l){this.degree=l,this.genPoly=A.generateECPolynomial(this.degree)},x.prototype.encode=function(l){if(!this.genPoly)throw new Error("Encoder not initialized");const f=new Uint8Array(l.length+this.degree);f.set(l);const y=A.mod(f,this.genPoly),m=this.degree-y.length;if(m>0){const v=new Uint8Array(this.degree);return v.set(y,m),v}return y},B.exports=x},2699:(B,w)=>{const s="[0-9]+";let x="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";x=x.replace(/u/g,"\\u");const g="(?:(?![A-Z0-9 $%*+\\-./:]|"+x+")(?:.|[\r\n]))+";w.KANJI=new RegExp(x,"g"),w.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),w.BYTE=new RegExp(g,"g"),w.NUMERIC=new RegExp(s,"g"),w.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const l=new RegExp("^"+x+"$"),f=new RegExp("^"+s+"$"),y=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");w.testKanji=function(v){return l.test(v)},w.testNumeric=function(v){return f.test(v)},w.testAlphanumeric=function(v){return y.test(v)}},2033:(B,w,s)=>{const A=s(4016),x=s(7783),g=s(2424),l=s(5663),f=s(449),y=s(2699),m=s(4792),v=s(4901);function S(R){return unescape(encodeURIComponent(R)).length}function e(R,Z,E){const d=[];let _;for(;null!==(_=R.exec(E));)d.push({data:_[0],index:_.index,mode:Z,length:_[0].length});return d}function h(R){const Z=e(y.NUMERIC,A.NUMERIC,R),E=e(y.ALPHANUMERIC,A.ALPHANUMERIC,R);let d,_;return m.isKanjiModeEnabled()?(d=e(y.BYTE,A.BYTE,R),_=e(y.KANJI,A.KANJI,R)):(d=e(y.BYTE_KANJI,A.BYTE,R),_=[]),Z.concat(E,d,_).sort(function(O,k){return O.index-k.index}).map(function(O){return{data:O.data,mode:O.mode,length:O.length}})}function U(R,Z){switch(Z){case A.NUMERIC:return x.getBitsLength(R);case A.ALPHANUMERIC:return g.getBitsLength(R);case A.KANJI:return f.getBitsLength(R);case A.BYTE:return l.getBitsLength(R)}}function G(R,Z){let E;const d=A.getBestModeForData(R);if(E=A.from(Z,d),E!==A.BYTE&&E.bit<d.bit)throw new Error('"'+R+'" cannot be encoded with mode '+A.toString(E)+".\n Suggested mode is: "+A.toString(d));switch(E===A.KANJI&&!m.isKanjiModeEnabled()&&(E=A.BYTE),E){case A.NUMERIC:return new x(R);case A.ALPHANUMERIC:return new g(R);case A.KANJI:return new f(R);case A.BYTE:return new l(R)}}w.fromArray=function(Z){return Z.reduce(function(E,d){return"string"==typeof d?E.push(G(d,null)):d.data&&E.push(G(d.data,d.mode)),E},[])},w.fromString=function(Z,E){const _=function T(R){const Z=[];for(let E=0;E<R.length;E++){const d=R[E];switch(d.mode){case A.NUMERIC:Z.push([d,{data:d.data,mode:A.ALPHANUMERIC,length:d.length},{data:d.data,mode:A.BYTE,length:d.length}]);break;case A.ALPHANUMERIC:Z.push([d,{data:d.data,mode:A.BYTE,length:d.length}]);break;case A.KANJI:Z.push([d,{data:d.data,mode:A.BYTE,length:S(d.data)}]);break;case A.BYTE:Z.push([{data:d.data,mode:A.BYTE,length:S(d.data)}])}}return Z}(h(Z,m.isKanjiModeEnabled())),H=function c(R,Z){const E={},d={start:{}};let _=["start"];for(let H=0;H<R.length;H++){const O=R[H],k=[];for(let N=0;N<O.length;N++){const P=O[N],M=""+H+N;k.push(M),E[M]={node:P,lastCount:0},d[M]={};for(let D=0;D<_.length;D++){const J=_[D];E[J]&&E[J].node.mode===P.mode?(d[J][M]=U(E[J].lastCount+P.length,P.mode)-U(E[J].lastCount,P.mode),E[J].lastCount+=P.length):(E[J]&&(E[J].lastCount=P.length),d[J][M]=U(P.length,P.mode)+4+A.getCharCountIndicator(P.mode,Z))}}_=k}for(let H=0;H<_.length;H++)d[_[H]].end=0;return{map:d,table:E}}(_,E),O=v.find_path(H.map,"start","end"),k=[];for(let N=1;N<O.length-1;N++)k.push(H.table[O[N]].node);return w.fromArray(function b(R){return R.reduce(function(Z,E){const d=Z.length-1>=0?Z[Z.length-1]:null;return d&&d.mode===E.mode?(Z[Z.length-1].data+=E.data,Z):(Z.push(E),Z)},[])}(k))},w.rawSplit=function(Z){return w.fromArray(h(Z,m.isKanjiModeEnabled()))}},4792:(B,w)=>{let s;const A=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];w.getSymbolSize=function(g){if(!g)throw new Error('"version" cannot be null or undefined');if(g<1||g>40)throw new Error('"version" should be in range from 1 to 40');return 4*g+17},w.getSymbolTotalCodewords=function(g){return A[g]},w.getBCHDigit=function(x){let g=0;for(;0!==x;)g++,x>>>=1;return g},w.setToSJISFunction=function(g){if("function"!=typeof g)throw new Error('"toSJISFunc" is not a valid function.');s=g},w.isKanjiModeEnabled=function(){return void 0!==s},w.toSJIS=function(g){return s(g)}},4406:(B,w)=>{w.isValid=function(A){return!isNaN(A)&&A>=1&&A<=40}},2088:(B,w,s)=>{const A=s(4792),x=s(4655),g=s(2259),l=s(4016),f=s(4406),m=A.getBCHDigit(7973);function S(U,b){return l.getCharCountIndicator(U,b)+4}function e(U,b){let T=0;return U.forEach(function(c){T+=S(c.mode,b)+c.getBitsLength()}),T}w.from=function(b,T){return f.isValid(b)?parseInt(b,10):T},w.getCapacity=function(b,T,c){if(!f.isValid(b))throw new Error("Invalid QR Code version");void 0===c&&(c=l.BYTE);const Z=8*(A.getSymbolTotalCodewords(b)-x.getTotalCodewordsCount(b,T));if(c===l.MIXED)return Z;const E=Z-S(c,b);switch(c){case l.NUMERIC:return Math.floor(E/10*3);case l.ALPHANUMERIC:return Math.floor(E/11*2);case l.KANJI:return Math.floor(E/13);default:return Math.floor(E/8)}},w.getBestVersionForData=function(b,T){let c;const G=g.from(T,g.M);if(Array.isArray(b)){if(b.length>1)return function h(U,b){for(let T=1;T<=40;T++)if(e(U,T)<=w.getCapacity(T,b,l.MIXED))return T}(b,G);if(0===b.length)return 1;c=b[0]}else c=b;return function v(U,b,T){for(let c=1;c<=40;c++)if(b<=w.getCapacity(c,T,U))return c}(c.mode,c.getLength(),G)},w.getEncodedBits=function(b){if(!f.isValid(b)||b<7)throw new Error("Invalid QR Code version");let T=b<<12;for(;A.getBCHDigit(T)-m>=0;)T^=7973<<A.getBCHDigit(T)-m;return b<<12|T}},3210:(B,w,s)=>{const A=s(6355);w.render=function(f,y,m){let v=m,S=y;void 0===v&&(!y||!y.getContext)&&(v=y,y=void 0),y||(S=function g(){try{return document.createElement("canvas")}catch(l){throw new Error("You need to specify a canvas element")}}()),v=A.getOptions(v);const e=A.getImageWidth(f.modules.size,v),h=S.getContext("2d"),U=h.createImageData(e,e);return A.qrToImageData(U.data,f,v),function x(l,f,y){l.clearRect(0,0,f.width,f.height),f.style||(f.style={}),f.height=y,f.width=y,f.style.height=y+"px",f.style.width=y+"px"}(h,S,e),h.putImageData(U,0,0),S},w.renderToDataURL=function(f,y,m){let v=m;return void 0===v&&(!y||!y.getContext)&&(v=y,y=void 0),v||(v={}),w.render(f,y,v).toDataURL(v.type||"image/png",(v.rendererOpts||{}).quality)}},2334:(B,w,s)=>{const A=s(6355);function x(f,y){const m=f.a/255,v=y+'="'+f.hex+'"';return m<1?v+" "+y+'-opacity="'+m.toFixed(2).slice(1)+'"':v}function g(f,y,m){let v=f+y;return void 0!==m&&(v+=" "+m),v}w.render=function(y,m,v){const S=A.getOptions(m),e=y.modules.size,h=y.modules.data,U=e+2*S.margin,b=S.color.light.a?"<path "+x(S.color.light,"fill")+' d="M0 0h'+U+"v"+U+'H0z"/>':"",T="<path "+x(S.color.dark,"stroke")+' d="'+function l(f,y,m){let v="",S=0,e=!1,h=0;for(let U=0;U<f.length;U++){const b=Math.floor(U%y),T=Math.floor(U/y);!b&&!e&&(e=!0),f[U]?(h++,U>0&&b>0&&f[U-1]||(v+=e?g("M",b+m,.5+T+m):g("m",S,0),S=0,e=!1),b+1<y&&f[U+1]||(v+=g("h",h),h=0)):S++}return v}(h,e,S.margin)+'"/>',R='<svg xmlns="http://www.w3.org/2000/svg" '+(S.width?'width="'+S.width+'" height="'+S.width+'" ':"")+'viewBox="0 0 '+U+" "+U+'" shape-rendering="crispEdges">'+b+T+"</svg>\n";return"function"==typeof v&&v(null,R),R}},6355:(B,w)=>{function s(A){if("number"==typeof A&&(A=A.toString()),"string"!=typeof A)throw new Error("Color should be defined as hex string");let x=A.slice().replace("#","").split("");if(x.length<3||5===x.length||x.length>8)throw new Error("Invalid hex color: "+A);(3===x.length||4===x.length)&&(x=Array.prototype.concat.apply([],x.map(function(l){return[l,l]}))),6===x.length&&x.push("F","F");const g=parseInt(x.join(""),16);return{r:g>>24&255,g:g>>16&255,b:g>>8&255,a:255&g,hex:"#"+x.slice(0,6).join("")}}w.getOptions=function(x){x||(x={}),x.color||(x.color={});const l=x.width&&x.width>=21?x.width:void 0;return{width:l,scale:l?4:x.scale||4,margin:null==x.margin||x.margin<0?4:x.margin,color:{dark:s(x.color.dark||"#000000ff"),light:s(x.color.light||"#ffffffff")},type:x.type,rendererOpts:x.rendererOpts||{}}},w.getScale=function(x,g){return g.width&&g.width>=x+2*g.margin?g.width/(x+2*g.margin):g.scale},w.getImageWidth=function(x,g){const l=w.getScale(x,g);return Math.floor((x+2*g.margin)*l)},w.qrToImageData=function(x,g,l){const f=g.modules.size,y=g.modules.data,m=w.getScale(f,l),v=Math.floor((f+2*l.margin)*m),S=l.margin*m,e=[l.color.light,l.color.dark];for(let h=0;h<v;h++)for(let U=0;U<v;U++){let b=4*(h*v+U),T=l.color.light;h>=S&&U>=S&&h<v-S&&U<v-S&&(T=e[y[Math.floor((h-S)/m)*f+Math.floor((U-S)/m)]?1:0]),x[b++]=T.r,x[b++]=T.g,x[b++]=T.b,x[b]=T.a}}}}]);