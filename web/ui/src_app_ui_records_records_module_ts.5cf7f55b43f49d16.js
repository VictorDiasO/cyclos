"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([["src_app_ui_records_records_module_ts"],{3629:(At,Z,c)=>{c.r(Z),c.d(Z,{RecordsModule:()=>Ut});var C=c(5300),_=c(5747),F=c(871),y=c(3344),J=c(2614),b=c(6163),$=c(6526),e=c(6435),d=c(520),D=c(1352),p=c(8637),u=c(2198),a=c(4850),Y=c(297);let g=(()=>{class o extends D.b{constructor(t,r){super(t,r)}listRecordTypesByOwner$Response(t,r){const n=new p.c(this.rootUrl,o.ListRecordTypesByOwnerPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("owner",t.owner,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}listRecordTypesByOwner(t,r){return this.listRecordTypesByOwner$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordTypeByOwner$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordTypeByOwnerPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("owner",t.owner,{}),n.path("type",t.type,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordTypeByOwner(t,r){return this.getRecordTypeByOwner$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordDataForOwnerSearch$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordDataForOwnerSearchPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("owner",t.owner,{}),n.path("type",t.type,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordDataForOwnerSearch(t,r){return this.getRecordDataForOwnerSearch$Response(t,r).pipe((0,a.U)(n=>n.body))}searchOwnerRecords$Response(t,r){const n=new p.c(this.rootUrl,o.SearchOwnerRecordsPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("owner",t.owner,{}),n.path("type",t.type,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}searchOwnerRecords(t,r){return this.searchOwnerRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}createRecord$Response(t,r){const n=new p.c(this.rootUrl,o.CreateRecordPath,"post");return t&&(n.path("owner",t.owner,{}),n.path("type",t.type,{}),n.header("confirmationPassword",t.confirmationPassword,{}),n.body(t.body,"application/json")),this.http.request(n.build({responseType:"text",accept:"text/plain",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}createRecord(t,r){return this.createRecord$Response(t,r).pipe((0,a.U)(n=>n.body))}exportOwnerRecords$Response(t,r){const n=new p.c(this.rootUrl,o.ExportOwnerRecordsPath,"get");return t&&(n.path("owner",t.owner,{}),n.path("type",t.type,{}),n.path("format",t.format,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{})),this.http.request(n.build({responseType:"blob",accept:"*/*",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}exportOwnerRecords(t,r){return this.exportOwnerRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordDataForNew$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordDataForNewPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("owner",t.owner,{}),n.path("type",t.type,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordDataForNew(t,r){return this.getRecordDataForNew$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordDataForEdit$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordDataForEditPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("id",t.id,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordDataForEdit(t,r){return this.getRecordDataForEdit$Response(t,r).pipe((0,a.U)(n=>n.body))}viewRecord$Response(t,r){const n=new p.c(this.rootUrl,o.ViewRecordPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("id",t.id,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}viewRecord(t,r){return this.viewRecord$Response(t,r).pipe((0,a.U)(n=>n.body))}updateRecord$Response(t,r){const n=new p.c(this.rootUrl,o.UpdateRecordPath,"put");return t&&(n.path("id",t.id,{}),n.header("confirmationPassword",t.confirmationPassword,{}),n.body(t.body,"application/json")),this.http.request(n.build({responseType:"text",accept:"*/*",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s.clone({body:void 0})))}updateRecord(t,r){return this.updateRecord$Response(t,r).pipe((0,a.U)(n=>n.body))}deleteRecord$Response(t,r){const n=new p.c(this.rootUrl,o.DeleteRecordPath,"delete");return t&&(n.path("id",t.id,{}),n.header("confirmationPassword",t.confirmationPassword,{})),this.http.request(n.build({responseType:"text",accept:"*/*",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s.clone({body:void 0})))}deleteRecord(t,r){return this.deleteRecord$Response(t,r).pipe((0,a.U)(n=>n.body))}getPasswordInputForRemoveRecord$Response(t,r){const n=new p.c(this.rootUrl,o.GetPasswordInputForRemoveRecordPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("id",t.id,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getPasswordInputForRemoveRecord(t,r){return this.getPasswordInputForRemoveRecord$Response(t,r).pipe((0,a.U)(n=>n.body))}listRecordTypesForGeneralSearch$Response(t,r){const n=new p.c(this.rootUrl,o.ListRecordTypesForGeneralSearchPath,"get");return t&&n.query("fields",t.fields,{explode:!1}),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}listRecordTypesForGeneralSearch(t,r){return this.listRecordTypesForGeneralSearch$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordDataForGeneralSearch$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordDataForGeneralSearchPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("type",t.type,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordDataForGeneralSearch(t,r){return this.getRecordDataForGeneralSearch$Response(t,r).pipe((0,a.U)(n=>n.body))}searchGeneralRecords$Response(t,r){const n=new p.c(this.rootUrl,o.SearchGeneralRecordsPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.path("type",t.type,{}),n.query("brokers",t.brokers,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("groups",t.groups,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{}),n.query("user",t.user,{}),n.query("userStatuses",t.userStatuses,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}searchGeneralRecords(t,r){return this.searchGeneralRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}exportGeneralRecords$Response(t,r){const n=new p.c(this.rootUrl,o.ExportGeneralRecordsPath,"get");return t&&(n.path("type",t.type,{}),n.path("format",t.format,{}),n.query("brokers",t.brokers,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("groups",t.groups,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{}),n.query("user",t.user,{}),n.query("userStatuses",t.userStatuses,{})),this.http.request(n.build({responseType:"blob",accept:"*/*",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}exportGeneralRecords(t,r){return this.exportGeneralRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}getRecordDataForSharedSearch$Response(t,r){const n=new p.c(this.rootUrl,o.GetRecordDataForSharedSearchPath,"get");return t&&n.query("fields",t.fields,{explode:!1}),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}getRecordDataForSharedSearch(t,r){return this.getRecordDataForSharedSearch$Response(t,r).pipe((0,a.U)(n=>n.body))}searchSharedRecords$Response(t,r){const n=new p.c(this.rootUrl,o.SearchSharedRecordsPath,"get");return t&&(n.query("fields",t.fields,{explode:!1}),n.query("brokers",t.brokers,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("groups",t.groups,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{}),n.query("types",t.types,{}),n.query("user",t.user,{}),n.query("userStatuses",t.userStatuses,{})),this.http.request(n.build({responseType:"json",accept:"application/json",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}searchSharedRecords(t,r){return this.searchSharedRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}exportSharedRecords$Response(t,r){const n=new p.c(this.rootUrl,o.ExportSharedRecordsPath,"get");return t&&(n.path("format",t.format,{}),n.query("brokers",t.brokers,{}),n.query("createdBy",t.createdBy,{}),n.query("creationPeriod",t.creationPeriod,{}),n.query("customFields",t.customFields,{}),n.query("groups",t.groups,{}),n.query("keywords",t.keywords,{}),n.query("page",t.page,{}),n.query("pageSize",t.pageSize,{}),n.query("profileFields",t.profileFields,{}),n.query("skipTotalCount",t.skipTotalCount,{}),n.query("types",t.types,{}),n.query("user",t.user,{}),n.query("userStatuses",t.userStatuses,{})),this.http.request(n.build({responseType:"blob",accept:"*/*",context:r})).pipe((0,u.h)(s=>s instanceof d.Zn),(0,a.U)(s=>s))}exportSharedRecords(t,r){return this.exportSharedRecords$Response(t,r).pipe((0,a.U)(n=>n.body))}}return o.ListRecordTypesByOwnerPath="/{owner}/record-types",o.GetRecordTypeByOwnerPath="/{owner}/record-types/{type}",o.GetRecordDataForOwnerSearchPath="/{owner}/records/{type}/data-for-search",o.SearchOwnerRecordsPath="/{owner}/records/{type}",o.CreateRecordPath="/{owner}/records/{type}",o.ExportOwnerRecordsPath="/{owner}/records/{type}/export/{format}",o.GetRecordDataForNewPath="/{owner}/records/{type}/data-for-new",o.GetRecordDataForEditPath="/records/{id}/data-for-edit",o.ViewRecordPath="/records/{id}",o.UpdateRecordPath="/records/{id}",o.DeleteRecordPath="/records/{id}",o.GetPasswordInputForRemoveRecordPath="/records/{id}/password-for-remove",o.ListRecordTypesForGeneralSearchPath="/general-records/record-types",o.GetRecordDataForGeneralSearchPath="/general-records/{type}/data-for-search",o.SearchGeneralRecordsPath="/general-records/{type}",o.ExportGeneralRecordsPath="/general-records/{type}/export/{format}",o.GetRecordDataForSharedSearchPath="/shared-records/data-for-search",o.SearchSharedRecordsPath="/shared-records",o.ExportSharedRecordsPath="/shared-records/export/{format}",o.\u0275fac=function(t){return new(t||o)(e.LFG(Y.p),e.LFG(d.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var v=c(2620),m=c(1963),h=c(9808),x=c(2032),P=c(9653),f=c(3075),Q=c(1076),B=c(1602),q=c(6903),N=c(1556);function V(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"user-info",9)(2,"hr"),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("user",t.data.user)}}function L(o,i){1&o&&e._UZ(0,"hr",12)}function j(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"rich-text-container",10),e.YNc(2,L,1,0,"hr",11),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("value",t.data.type.informationText),e.xp6(1),e.Q6J("ngIf",t.data.fields)}}const k=function(o,i,t){return{"mb-0":o,"mb-2":i,"border-top-0":t}};function G(o,i){if(1&o&&(e.TgZ(0,"h2",13),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("ngClass",e.kEZ(2,k,"above"===t.labelPosition,"above"!==t.labelPosition,!t.data.type.informationText)),e.xp6(1),e.hij(" ",t.i18n.record.fields," ")}}function H(o,i){if(1&o&&e._UZ(0,"custom-field-input",14),2&o){const t=i.$implicit,r=e.oxw(2);e.Tol(r.resolveColumnClass(t)),e.Q6J("labelPosition",r.labelPosition)("field",t)("formControl",r.form.get("customValues").get(t.internalName))("binaryValues",r.binaryValues)}}function M(o,i){if(1&o&&(e.TgZ(0,"div",16),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.informationText,"")}}function E(o,i){if(1&o&&e._UZ(0,"custom-field-input",14),2&o){const t=i.$implicit,r=e.oxw(3);e.Tol(r.resolveColumnClass(t)),e.Q6J("labelPosition",r.labelPosition)("field",t)("formControl",r.form.get("customValues").get(t.internalName))("binaryValues",r.binaryValues)}}const z=function(o,i,t,r){return{"mb-0":o,"mb-2":i,"mt-4":t,"border-top-0":r}};function W(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"h2",13),e._uU(2),e.qZA(),e.YNc(3,M,2,1,"div",15),e.YNc(4,E,1,6,"custom-field-input",6),e.BQk()),2&o){const t=i.$implicit,r=i.first,n=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.l5B(4,z,"above"===n.labelPosition,"above"!==n.labelPosition,n.fieldsWithoutSection.length>0,r&&0==n.fieldsWithoutSection.length)),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.informationText),e.xp6(1),e.Q6J("ngForOf",n.fieldsWithSection.get(t))}}const K=function(o){return{"mr-n3":o}};function X(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"page-content",2),e.YNc(1,V,3,1,"ng-container",3),e.TgZ(2,"div",4),e.YNc(3,j,3,2,"ng-container",3),e.YNc(4,G,2,6,"h2",5),e.YNc(5,H,1,6,"custom-field-input",6),e.YNc(6,W,5,9,"ng-container",7),e.qZA(),e.TgZ(7,"actions")(8,"action-button",8),e.NdJ("action",function(){return e.CHM(t),e.oxw().save()}),e.ALo(9,"async"),e.qZA()()()}if(2&o){const t=e.oxw();e.Q6J("heading",t.create?t.i18n.record.title.new(t.data.type.name):t.i18n.record.title.edit(t.data.type.name))("mobileHeading",t.create?t.i18n.record.mobileTitle.new(t.data.type.name):t.i18n.record.mobileTitle.edit(t.data.type.name)),e.xp6(1),e.Q6J("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),e.xp6(1),e.Q6J("formGroup",t.form)("ngClass",e.VKq(13,K,t.columnLayout)),e.xp6(1),e.Q6J("ngIf",t.data.type.informationText),e.xp6(1),e.Q6J("ngIf",t.fieldsWithoutSection.length>0),e.xp6(1),e.Q6J("ngForOf",t.fieldsWithoutSection),e.xp6(1),e.Q6J("ngForOf",t.fieldsWithSection.keys()),e.xp6(2),e.Q6J("disabled",e.lcZ(9,11,t.requesting$))("label",t.i18n.general.save)}}let U=(()=>{class o extends J.y{constructor(t,r,n){super(t),this.recordsService=r,this.recordsHelper=n,this.fieldsWithSection=new Map}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.create=null!=this.param,this.id=this.route.snapshot.paramMap.get("id");const t=this.create?this.recordsService.getRecordDataForNew({owner:this.param,type:this.type}):this.recordsService.getRecordDataForEdit({id:this.id});this.addSub(t.subscribe(r=>{this.data=r}))}onDataInitialized(t){this.columnLayout=this.recordsHelper.isColumnLayout(t.type),this.fieldsWithoutSection=t.fields.filter(r=>null==r.section)||[],(t.type.sections||[]).forEach(r=>{const n=t.fields.filter(s=>null!=s.section&&s.section.id===r.id);(0,b.cS)(n)||this.fieldsWithSection.set(r,n)}),this.form=this.formBuilder.group({}),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(t.fields,{currentValues:t.record.customValues,disabledProvider:r=>!this.create&&-1===(t.editableFields||[]).indexOf(r.internalName)}))}resolveColumnClass(t){return this.recordsHelper.resolveColumnClass(t,this.data.type)}get binaryValues(){return this.data.binaryValues}get labelPosition(){return this.columnLayout?"above":"auto"}resolveMenu(t){return this.menu.menuForRecordType(t.user,t.type)}save(){if(!(0,b.pt)(this.form))return;const t=(0,$.Z)(this.data.record);t.customValues=this.form.value.customValues,this.data.confirmationPasswordInput?this.confirmation.confirm({passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:()=>({type:F.l.MANAGE_RECORD,recordType:this.data.type.id}),callback:r=>this.doSave(t,r.confirmationPassword)}):this.doSave(t)}doSave(t,r){const n=this.create?this.recordsService.createRecord({owner:this.param,type:this.type,confirmationPassword:r,body:t}):this.recordsService.updateRecord({id:this.id,confirmationPassword:r,body:t});this.addSub(n.subscribe(s=>{this.notification.snackBar(this.create?this.i18n.record.created(this.data.type.name):this.i18n.record.saved(this.data.type.name));const l=null==this.id;if(l&&this.data.type.layout===y.v.SINGLE)for(const O of this.recordsHelper.recordPermissions(null==this.data.user))O.type.id===this.data.type.id&&(O.singleRecordId=s);this.router.navigate(["/records","view",s||this.id],{replaceUrl:l})}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.zs3),e.Y36(g),e.Y36(v.w))},o.\u0275cmp=e.Xpm({type:o,selectors:[["record-form"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[3,"formGroup","ngClass"],[3,"ngClass",4,"ngIf"],[3,"labelPosition","field","formControl","class","binaryValues",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"disabled","label","action"],[3,"user"],[3,"value"],["class","border-0",4,"ngIf"],[1,"border-0"],[3,"ngClass"],[3,"labelPosition","field","formControl","binaryValues"],["class","mb-2",4,"ngIf"],[1,"mb-2"]],template:function(t,r){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,X,10,15,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,r.data$)),e.xp6(2),e.Q6J("ngIf",r.data))},directives:[m.w,h.O5,x.Y,P.M,f.JL,f.sg,h.mk,Q.J,h.sg,B.G,f.JJ,f.oH,q.h,N.x],pipes:[h.Ov],encapsulation:2,changeDetection:0}),o})();var w=c(1879),R=c(5466),ee=c(7e3),te=c(2292),oe=c(6849),T=c(195),A=c(7107),ne=c(3728),re=c(5255),ie=c(8868),se=c(8747),ce=c(8170),ae=c(7072),le=c(957),de=c(8687),pe=c(1441),ue=c(629),I=c(1873),he=c(8397),fe=c(70),_e=c(1015),S=c(2754);function ge(o,i){1&o&&e._UZ(0,"div",10)}function me(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",10)(2,"label-value",11),e._UZ(3,"user-link",12),e.qZA()(),e.YNc(4,ge,1,0,"div",5),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.user),e.xp6(1),e.Q6J("ngIf",t.layout.gtsm$)}}function xe(o,i){if(1&o&&(e.TgZ(0,"div",10),e._UZ(1,"input-field",13),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("label",t.i18n.general.keywords)}}function ye(o,i){if(1&o&&e._UZ(0,"field-option",18),2&o){const t=i.$implicit,r=e.oxw(4);e.Q6J("value",t)("text",r.userHelper.userStatus(t))}}function be(o,i){if(1&o&&(e.TgZ(0,"div",10)(1,"multi-selection-field",16),e.YNc(2,ye,1,2,"field-option",17),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.user.profile.statusUser),e.xp6(1),e.Q6J("ngForOf",t.userStatuses)}}function ve(o,i){if(1&o&&e._UZ(0,"field-option",21),2&o){const t=i.$implicit,r=e.oxw(4);e.Q6J("value",r.ApiHelper.internalNameOrId(t))("internalName",t.internalName)("id",t.id)("text",t.name)("parent",t.groupSet)}}function we(o,i){if(1&o&&(e.TgZ(0,"div",10)(1,"multi-selection-field",19),e.YNc(2,ve,1,5,"field-option",20),e.qZA()()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("label",t.i18n.user.groups),e.xp6(1),e.Q6J("ngForOf",t.groups)}}const Re=function(){return["broker"]},Te=function(o){return{roles:o}};function Se(o,i){if(1&o&&(e.ynx(0),e.YNc(1,be,3,2,"div",5),e.YNc(2,we,3,2,"div",5),e.TgZ(3,"div",10),e._UZ(4,"user-field",14),e.qZA(),e.TgZ(5,"div",10),e._UZ(6,"user-field",15),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.userStatuses.length>1),e.xp6(1),e.Q6J("ngIf",t.groups.length>1),e.xp6(2),e.Q6J("label",t.i18n.user.broker)("filters",e.VKq(6,Te,e.DdM(5,Re))),e.xp6(2),e.Q6J("label",t.i18n.general.user)}}function Ze(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"div",23),e.TgZ(2,"div",10),e._UZ(3,"date-field",24),e.qZA(),e.TgZ(4,"div",10),e._UZ(5,"date-field",25),e.qZA(),e.BQk()),2&o){const t=e.oxw(3);e.xp6(3),e.Q6J("label",t.i18n.general.beginDate),e.xp6(2),e.Q6J("label",t.i18n.general.endDate)}}function Ce(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",10),e._UZ(2,"user-field",22),e.qZA(),e.YNc(3,Ze,6,2,"ng-container",1),e.BQk()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("allowSelf",!0)("label",t.i18n.record.createdBy),e.xp6(1),e.Q6J("ngIf",!t.data.hideDateOnList)}}function Fe(o,i){if(1&o&&(e.TgZ(0,"div",10),e._UZ(1,"custom-field-filter",26),e.qZA()),2&o){const t=i.$implicit,r=e.oxw(2);e.xp6(1),e.Q6J("field",t)("formControl",r.form.get("customValues").get(t.internalName))}}function Je(o,i){if(1&o&&(e.TgZ(0,"div",10),e._UZ(1,"basic-profile-field-filter",26),e.qZA()),2&o){const t=i.$implicit,r=e.oxw(3);e.xp6(1),e.Q6J("field",t)("formControl",r.form.get("profileFields").get(t.field))}}function Pe(o,i){if(1&o&&(e.TgZ(0,"div",10),e._UZ(1,"custom-field-filter",26),e.qZA()),2&o){const t=i.$implicit,r=e.oxw(3);e.xp6(1),e.Q6J("field",t)("formControl",r.form.get("profileFields").get(t.internalName))}}function Qe(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Je,2,2,"div",6),e.YNc(2,Pe,2,2,"div",6),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.basicProfileFields),e.xp6(1),e.Q6J("ngForOf",t.customProfileFields)}}function qe(o,i){if(1&o&&(e.TgZ(0,"label-value",33),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.Q6J("label",r.i18n.general.creationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.creationDate)," ")}}function Ne(o,i){if(1&o&&(e.TgZ(0,"label-value",33),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.Q6J("label",r.i18n.general.user),e.xp6(1),e.hij(" ",r.recordOwner(t)," ")}}function Ue(o,i){if(1&o&&(e.TgZ(0,"label-value",33),e._UZ(1,"format-field-value",34),e.qZA()),2&o){const t=i.$implicit,r=e.oxw().$implicit,n=e.oxw(2);e.Q6J("label",t.name),e.xp6(1),e.Q6J("fields",n.data.customFields)("plainText",!0)("fieldName",t.internalName)("object",r)("customValues",r.customValues)}}function Ae(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw(2);return l.router.navigate(l.editPath(s)),n.stopPropagation(),n.preventDefault()}),e._UZ(1,"icon",36),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.edit),e.xp6(1),e.Q6J("icon",t.SvgIcon.Pencil)}}const Ie=function(o){return{"mt-2":o}};function Oe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(n){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(2).remove(s),n.stopPropagation(),n.preventDefault()}),e._UZ(1,"icon",36),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("tooltip",t.i18n.general.remove)("ngClass",e.VKq(3,Ie,t.data.edit)),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function $e(o,i){if(1&o&&(e.TgZ(0,"mobile-result")(1,"div",27)(2,"div"),e.YNc(3,qe,3,4,"label-value",28),e.YNc(4,Ne,2,2,"label-value",28),e.YNc(5,Ue,2,6,"label-value",29),e.qZA(),e.TgZ(6,"div",30),e.YNc(7,Ae,2,2,"button",31),e.YNc(8,Oe,2,5,"button",32),e.qZA()()()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",!t.data.hideDateOnList),e.xp6(1),e.Q6J("ngIf",t.generalSearch),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Q6J("ngIf",t.data.edit),e.xp6(1),e.Q6J("ngIf",t.data.remove)}}function De(o,i){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij("",t.i18n.general.creationDate," ")}}function Ye(o,i){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Oqu(t.i18n.general.user)}}function Be(o,i){if(1&o&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&o){const t=i.$implicit,r=e.oxw(3);e.xp6(1),e.hij(" ",r.fieldName(t.internalName)," ")}}function Ve(o,i){if(1&o&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,t.creationDate)," ")}}function Le(o,i){if(1&o&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(3);e.xp6(1),e.Oqu(r.recordOwner(t))}}function je(o,i){if(1&o&&(e.TgZ(0,"td"),e._UZ(1,"format-field-value",34),e.qZA()),2&o){const t=i.$implicit,r=e.oxw().$implicit,n=e.oxw(3);e.xp6(1),e.Q6J("fields",n.data.customFields)("plainText",!0)("fieldName",t.internalName)("object",r)("customValues",r.customValues)}}function ke(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw(3);return l.router.navigate(l.editPath(s)),n.stopPropagation()}),e._UZ(1,"icon",36),e.qZA()}if(2&o){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.edit),e.xp6(1),e.Q6J("icon",t.SvgIcon.Pencil)}}function Ge(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(n){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3).remove(s),n.stopPropagation()}),e._UZ(1,"icon",36),e.qZA()}if(2&o){const t=e.oxw(4);e.Q6J("tooltip",t.i18n.general.remove)("ngClass",t.data.edit?"ml-3":""),e.xp6(1),e.Q6J("icon",t.SvgIcon.Trash)}}function He(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"tr",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw(3);return l.router.navigate(l.viewPath(s))}),e.YNc(1,Ve,3,3,"td",1),e.YNc(2,Le,2,1,"td",1),e.YNc(3,je,2,5,"td",39),e.TgZ(4,"td",43),e.YNc(5,ke,2,2,"button",31),e.YNc(6,Ge,2,3,"button",32),e.qZA()()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",!t.data.hideDateOnList),e.xp6(1),e.Q6J("ngIf",t.generalSearch),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(2),e.Q6J("ngIf",t.data.edit),e.xp6(1),e.Q6J("ngIf",t.data.remove)}}function Me(o,i){if(1&o&&(e.TgZ(0,"table",38)(1,"thead"),e.YNc(2,De,2,1,"th",1),e.YNc(3,Ye,2,1,"th",1),e.YNc(4,Be,2,1,"th",39),e._UZ(5,"th",40),e.qZA(),e.TgZ(6,"tbody"),e.YNc(7,He,7,5,"tr",41),e.ALo(8,"async"),e.qZA()()),2&o){const t=e.oxw(2);let r;e.xp6(2),e.Q6J("ngIf",!t.data.hideDateOnList),e.xp6(1),e.Q6J("ngIf",t.generalSearch),e.xp6(1),e.Q6J("ngForOf",t.fieldsInList),e.xp6(3),e.Q6J("ngForOf",null==(r=e.lcZ(8,4,t.results$))?null:r.results)}}function Ee(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.TgZ(3,"div",3)(4,"div",4),e.YNc(5,me,5,3,"ng-container",1),e.YNc(6,xe,2,1,"div",5),e.YNc(7,Se,7,8,"ng-container",1),e.YNc(8,Ce,4,3,"ng-container",1),e.YNc(9,Fe,2,2,"div",6),e.YNc(10,Qe,3,2,"ng-container",1),e.qZA()()(),e.TgZ(11,"results-layout",7),e.NdJ("update",function(n){return e.CHM(t),e.oxw().update(n)}),e.ALo(12,"async"),e.YNc(13,$e,9,5,"mobile-result",8),e.YNc(14,Me,9,6,"table",9),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.data.type.pluralName)("mobileHeading",t.data.type.pluralName)("headingActions",e.lcZ(2,13,t.headingActions$)),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.user&&!t.authHelper.isSelf(t.user)),e.xp6(1),e.Q6J("ngIf",t.showKeywords()),e.xp6(1),e.Q6J("ngIf",t.generalSearch),e.xp6(1),e.Q6J("ngIf",t.generalSearch||!t.isOwnRecords()),e.xp6(1),e.Q6J("ngForOf",t.fieldsInSearch),e.xp6(1),e.Q6J("ngIf",t.generalSearch),e.xp6(1),e.Q6J("results",e.lcZ(12,15,t.results$))("rendering$",t.rendering$)("toLink",t.toLink)}}let ze=(()=>{class o extends te.t{constructor(t,r,n){super(t),this.recordsService=r,this.userHelper=n}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.addSub(this.generalSearch?this.recordsService.getRecordDataForGeneralSearch({type:this.type}).subscribe(t=>this.data=t):this.recordsService.getRecordDataForOwnerSearch({owner:this.param,type:this.type}).subscribe(t=>this.data=t))}prepareForm(t){if(this.fieldsInSearch=t.customFields.filter(r=>t.fieldsInSearch.includes(r.internalName)),this.form.setControl("customValues",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch,t.query.customFields)),this.generalSearch){const r=t;this.basicProfileFields=r.basicProfileFields,this.customProfileFields=r.customProfileFields,this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(this.basicProfileFields,this.customProfileFields))}}onDataInitialized(t){if(super.onDataInitialized(t),!this.generalSearch&&t.type.layout!==y.v.LIST)throw new Error(`Invalid record layout: ${t.type.layout}`);if(this.fieldsInList=t.customFields.filter(s=>t.fieldsInList.includes(s.internalName)),this.generalSearch){const s=t;this.groups=s.groups||[],this.userStatuses=s.userStatuses||[]}const r=[];!this.generalSearch&&t.create&&r.push(new R.Yu(w.l.PlusCircle,this.i18n.general.addNew,()=>this.router.navigate(["/records",this.param,this.type,"new"]),!0));const n=this.exportHelper.headingActions(t.exportFormats,s=>{const l=Object.assign({format:s.internalName},this.toSearchParams(this.form.value));return this.generalSearch?this.recordsService.exportGeneralRecords$Response(l):this.recordsService.exportOwnerRecords$Response(l)});this.headingActions=[...r,...n]}showKeywords(){return!this.data.hideKeywordsSearch||!this.isOwnRecords()}isOwnRecords(){return!this.generalSearch&&this.authHelper.isSelfOrOwner(this.data.user)}doSearch(t){return this.generalSearch?this.recordsService.searchGeneralRecords$Response(t):this.recordsService.searchOwnerRecords$Response(t)}remove(t){this.addSub(this.recordsService.getPasswordInputForRemoveRecord({id:t.id}).subscribe(r=>this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,passwordInput:r,createDeviceConfirmation:()=>({type:F.l.MANAGE_RECORD,recordType:this.data.type.id}),callback:n=>this.doRemove(t,n.confirmationPassword)})))}doRemove(t,r){this.addSub(this.recordsService.deleteRecord({id:t.id,confirmationPassword:r}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.update()}))}recordOwner(t){return this.generalSearch?t.user.display:""}fieldName(t){return this.fieldHelper.fieldDisplay(t,this.data.customFields)}viewPath(t){return["/records","view",t.id]}editPath(t){return["/records","edit",t.id]}get toLink(){return t=>this.viewPath(t)}get user(){return this.data?this.data.user:null}toSearchParams(t){const r=Object.assign({},t);if(r.customFields=this.fieldHelper.toCustomValuesFilter(t.customValues),r.profileFields=this.fieldHelper.toProfileFieldsFilter(t.profileFields),r.creationPeriod=ee.S.dateRangeFilter(t.beginDate,t.endDate),this.generalSearch){const n=r;n.brokers=t.broker?[t.broker]:[],delete n.broker}else r.owner=this.param;return r.type=this.type,r}getFormControlNames(){return["keywords","customValues","createdBy","beginDate","endDate","broker","groups","user","profileFields","userStatuses"]}resolveMenu(t){return this.menu.menuForRecordType(this.generalSearch?null:t.user,t.type)}get generalSearch(){return this.param===v.w.GENERAL_SEARCH}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.zs3),e.Y36(g),e.Y36(oe.T))},o.\u0275cmp=e.Xpm({type:o,selectors:[["search-records"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["resultType","list",3,"results","rendering$","toLink","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","keywords","fieldSize","full",3,"label"],["formControlName","broker",3,"label","filters"],["formControlName","user",3,"label"],["formControlName","userStatuses",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["formControlName","createdBy",3,"allowSelf","label"],[1,"w-100"],["formControlName","beginDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","endDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],[3,"field","formControl"],[1,"d-flex"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label",4,"ngFor","ngForOf"],[1,"ml-auto","text-right","d-flex","flex-column"],["type","button","class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["type","button","class","btn btn-icon",3,"tooltip","ngClass","click",4,"ngIf"],["labelPosition","above",3,"label"],[3,"fields","plainText","fieldName","object","customValues"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],["type","button",1,"btn","btn-icon",3,"tooltip","ngClass","click"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"actions","actions-multiple"]],template:function(t,r){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Ee,15,17,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,r.data$)),e.xp6(2),e.Q6J("ngIf",r.data))},directives:[m.w,h.O5,x.Y,f.JL,f.sg,T.t,A.F,ne.q,f.JJ,f.u,re.x,h.sg,ie.s,se.l,ce.Q,ae.L,f.oH,le.z,de.D,pe.E,ue.t,I.x,he.i9,fe.o,h.mk,_e.p],pipes:[h.Ov,S.i],encapsulation:2,changeDetection:0}),o})();var We=c(591);function Ke(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"user-info",4)(2,"hr"),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("user",t.data.user)}}function Xe(o,i){1&o&&e._UZ(0,"hr")}function et(o,i){if(1&o&&(e.TgZ(0,"label-value",5),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.Q6J("label",r.i18n.record.lastModificationDate),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.lastModificationDate)," ")}}function tt(o,i){if(1&o&&(e.TgZ(0,"label-value",5),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,r=e.oxw(2);e.Q6J("label",r.i18n.record.lastModifiedBy),e.xp6(1),e.hij(" ",t.lastModifiedBy.display," ")}}function ot(o,i){if(1&o&&(e.TgZ(0,"label-value",5),e._UZ(1,"format-field-value",12),e.qZA()),2&o){const t=i.$implicit,r=e.oxw().$implicit,n=e.oxw(2);e.Q6J("label",t.name),e.xp6(1),e.Q6J("fields",n.data.customFields)("plainText",!0)("fieldName",t.internalName)("object",r)("customValues",r.customValues)}}function nt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"action-button",10),e.NdJ("action",function(){e.CHM(t);const n=e.oxw().$implicit,s=e.oxw(2);return s.router.navigate(s.editPath(n))}),e.ALo(1,"async"),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.edit)}}function rt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"action-button",13),e.NdJ("action",function(){e.CHM(t);const n=e.oxw().$implicit;return e.oxw(2).remove(n)}),e.ALo(1,"async"),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("disabled",e.lcZ(1,2,t.requesting$))("label",t.i18n.general.remove)}}function it(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.YNc(1,Xe,1,0,"hr",1),e.TgZ(2,"label-value",5),e._uU(3),e.ALo(4,"dateTime"),e.qZA(),e.TgZ(5,"label-value",5),e._uU(6),e.qZA(),e.YNc(7,et,3,4,"label-value",6),e.YNc(8,tt,2,2,"label-value",6),e.YNc(9,ot,2,6,"label-value",7),e.TgZ(10,"actions",8),e.YNc(11,nt,2,4,"action-button",9),e.TgZ(12,"action-button",10),e.NdJ("action",function(){const s=e.CHM(t).$implicit,l=e.oxw(2);return l.router.navigate(l.viewPath(s))}),e.ALo(13,"async"),e.qZA(),e.YNc(14,rt,2,4,"action-button",11),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,r=i.first,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!r),e.xp6(1),e.Q6J("label",n.i18n.general.creationDate),e.xp6(1),e.hij(" ",e.lcZ(4,12,t.creationDate)," "),e.xp6(2),e.Q6J("label",n.i18n.record.createdBy),e.xp6(1),e.hij(" ",t.createdBy.display," "),e.xp6(1),e.Q6J("ngIf",t.lastModifiedBy),e.xp6(1),e.Q6J("ngIf",t.lastModifiedBy),e.xp6(1),e.Q6J("ngForOf",n.fieldsInList),e.xp6(2),e.Q6J("ngIf",n.data.edit),e.xp6(1),e.Q6J("disabled",e.lcZ(13,14,n.requesting$))("label",n.i18n.general.view),e.xp6(2),e.Q6J("ngIf",n.data.remove)}}function st(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"page-content",2),e.ALo(2,"async"),e.YNc(3,Ke,3,1,"ng-container",1),e.YNc(4,it,15,16,"ng-container",3),e.ALo(5,"async"),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("heading",t.data.type.pluralName)("mobileHeading",t.data.type.pluralName)("headingActions",e.lcZ(2,5,t.headingActions$)),e.xp6(2),e.Q6J("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(5,7,t.results$))}}let ct=(()=>{class o extends J.y{constructor(t,r){super(t),this.recordsService=r,this.results$=new We.X(null)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.addSub(this.recordsService.getRecordDataForOwnerSearch({owner:this.param,type:this.type}).subscribe(t=>{if(t.type.layout!==y.v.TILED)throw new Error(`Invalid record layout: ${t.type.layout}`);this.fieldsInList=t.customFields.filter(r=>t.fieldsInList.includes(r.internalName)),this.data=t}))}onDataInitialized(t){const r=[];t.create&&r.push(new R.Yu(w.l.PlusCircle,this.i18n.general.addNew,()=>this.router.navigate(["/records",this.param,this.type,"new"]),!0)),this.headingActions=r,this.addSub(this.doSearch(this.toSearchParams()).subscribe(n=>{this.results$.next(n.body)}))}editPath(t){return["/records","edit",t.id]}viewPath(t){return["/records","view",t.id]}remove(t){this.confirmation.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove(t)})}doRemove(t){this.addSub(this.recordsService.deleteRecord({id:t.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}toSearchParams(){return{pageSize:2147483647,owner:this.param,type:this.type}}doSearch(t){return this.recordsService.searchOwnerRecords$Response(t)}getFormControlNames(){return[]}resolveMenu(t){return this.menu.menuForRecordType(t.user,t.type)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.zs3),e.Y36(g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["tiled-records"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[4,"ngFor","ngForOf"],[3,"user"],[3,"label"],[3,"label",4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[1,"mb-3"],[3,"disabled","label","action",4,"ngIf"],[3,"disabled","label","action"],["outline","",3,"disabled","label","action",4,"ngIf"],[3,"fields","plainText","fieldName","object","customValues"],["outline","",3,"disabled","label","action"]],template:function(t,r){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,st,6,9,"ng-container",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,r.data$)),e.xp6(2),e.Q6J("ngIf",r.data))},directives:[m.w,h.O5,x.Y,P.M,h.sg,T.t,I.x,q.h,N.x],pipes:[h.Ov,S.i],encapsulation:2,changeDetection:0}),o})();var at=c(7300),lt=c(7055),dt=c(5178);function pt(o,i){if(1&o&&(e.TgZ(0,"label-value",9),e._UZ(1,"user-link",10),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.resolveColumnClass()),e.Q6J("labelPosition",t.labelPosition)("label",t.i18n.general.user),e.xp6(1),e.Q6J("user",t.data.user)}}function ut(o,i){if(1&o&&(e.TgZ(0,"label-value",9),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.resolveColumnClass()),e.Q6J("labelPosition",t.labelPosition)("label",t.i18n.general.creationDate),e.xp6(1),e.hij(" ",e.lcZ(2,5,t.data.creationDate)," ")}}function ht(o,i){if(1&o&&(e.TgZ(0,"label-value",9),e._UZ(1,"user-link",10),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.resolveColumnClass()),e.Q6J("labelPosition",t.labelPosition)("label",t.i18n.record.createdBy),e.xp6(1),e.Q6J("user",t.data.createdBy)}}function ft(o,i){if(1&o&&(e.TgZ(0,"label-value",9),e._uU(1),e.ALo(2,"dateTime"),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.resolveColumnClass()),e.Q6J("labelPosition",t.labelPosition)("label",t.i18n.record.lastModificationDate),e.xp6(1),e.hij(" ",e.lcZ(2,5,t.data.lastModificationDate)," ")}}function _t(o,i){if(1&o&&(e.TgZ(0,"label-value",9),e._UZ(1,"user-link",10),e.qZA()),2&o){const t=e.oxw(2);e.Tol(t.resolveColumnClass()),e.Q6J("labelPosition",t.labelPosition)("label",t.i18n.record.lastModifiedBy),e.xp6(1),e.Q6J("user",t.data.lastModifiedBy)}}function gt(o,i){1&o&&e._UZ(0,"hr")}function mt(o,i){1&o&&e._UZ(0,"hr")}function xt(o,i){if(1&o&&(e.ynx(0),e.YNc(1,gt,1,0,"hr",5),e._UZ(2,"rich-text-container",11),e.YNc(3,mt,1,0,"hr",5),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.hasPreviousFields),e.xp6(1),e.Q6J("value",t.data.type.informationText),e.xp6(1),e.Q6J("ngIf",t.data.customValues)}}const yt=function(o,i,t){return{"mt-2 pt-0 border-0":o,"mb-0":i,"mb-2":t}};function bt(o,i){if(1&o&&(e.TgZ(0,"h2",3),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.Q6J("ngClass",e.kEZ(2,yt,t.data.type.informationText,"above"===t.labelPosition,"above"!==t.labelPosition)),e.xp6(1),e.hij(" ",t.i18n.record.fields," ")}}const vt=function(o){return{"mt-0":o}};function wt(o,i){if(1&o&&e._UZ(0,"custom-field-value",12),2&o){const t=i.$implicit,r=e.oxw(2);e.Tol(r.resolveColumnClass(t)),e.Q6J("labelPosition",r.labelPosition)("fieldValue",t)("ngClass",e.VKq(5,vt,!(r.hasPreviousFields&&r.valuesWithoutSection.length>0)))}}function Rt(o,i){if(1&o&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.informationText,"")}}function Tt(o,i){if(1&o&&e._UZ(0,"custom-field-value",16),2&o){const t=i.$implicit,r=e.oxw(3);e.Tol(r.resolveColumnClass(t)),e.Q6J("labelPosition",r.labelPosition)("fieldValue",t)}}const St=function(o,i,t,r){return{"mt-4":o,"mb-0":i,"mb-2":t,"border-top-0":r}};function Zt(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"h2",3),e._uU(2),e.qZA(),e.YNc(3,Rt,2,1,"div",13),e.YNc(4,Tt,1,4,"custom-field-value",14),e.BQk()),2&o){const t=i.$implicit,r=i.first,n=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.l5B(4,St,n.valuesWithoutSection.length>0,"above"===n.labelPosition,"above"!==n.labelPosition,r&&0==n.valuesWithoutSection.length&&(!n.hasPreviousFields||n.data.type.informationText))),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.informationText),e.xp6(1),e.Q6J("ngForOf",n.valuesWithSection.get(t))}}const Ct=function(o,i){return{"d-flex flex-row-reverse":o,"mt-n3":i}},Ft=function(o,i){return{"d-flex flex-grow-1 flex-column":o,"mr-n3":i}};function Jt(o,i){if(1&o&&(e.TgZ(0,"page-content",2),e.ALo(1,"async"),e.TgZ(2,"div",3)(3,"div",3),e.YNc(4,pt,2,5,"label-value",4),e.YNc(5,ut,3,7,"label-value",4),e.YNc(6,ht,2,5,"label-value",4),e.YNc(7,ft,3,7,"label-value",4),e.YNc(8,_t,2,5,"label-value",4),e.YNc(9,xt,4,3,"ng-container",5),e.YNc(10,bt,2,6,"h2",6),e.YNc(11,wt,1,7,"custom-field-value",7),e.YNc(12,Zt,5,9,"ng-container",8),e.qZA()()()),2&o){const t=e.oxw();e.Q6J("heading",t.i18n.record.title.details(t.title))("mobileHeading",t.i18n.record.mobileTitle.details(t.title))("headingActions",e.lcZ(1,14,t.headingActions$)),e.xp6(2),e.Q6J("ngClass",e.WLB(16,Ct,!t.columnLayout,t.hasPreviousFields&&t.columnLayout)),e.xp6(1),e.Q6J("ngClass",e.WLB(19,Ft,!t.columnLayout,t.columnLayout)),e.xp6(1),e.Q6J("ngIf",!t.isOwner()),e.xp6(1),e.Q6J("ngIf",t.data.creationDate),e.xp6(1),e.Q6J("ngIf",t.data.createdBy),e.xp6(1),e.Q6J("ngIf",t.data.lastModificationDate),e.xp6(1),e.Q6J("ngIf",t.data.lastModifiedBy),e.xp6(1),e.Q6J("ngIf",t.data.type.informationText),e.xp6(1),e.Q6J("ngIf",t.hasPreviousFields&&t.valuesWithoutSection.length>0),e.xp6(1),e.Q6J("ngForOf",t.valuesWithoutSection),e.xp6(1),e.Q6J("ngForOf",t.valuesWithSection.keys())}}const Qt=[{path:":owner/:type/list",component:ze,canActivate:[_.b]},{path:":owner/:type/tiled",component:ct,canActivate:[_.b]},{path:"view/:id",component:(()=>{class o extends at.k{constructor(t,r,n,s){super(t),this.recordsService=r,this.recordsHelper=n,this.runOperationHelper=s,this.valuesWithSection=new Map}ngOnInit(){super.ngOnInit();const t=this.route.snapshot.paramMap.get("id");this.addSub(this.recordsService.viewRecord({id:t}).subscribe(r=>{this.data=r}))}onDataInitialized(t){this.headingActions=[],this.title=(0,b.cS)(t.display)?t.type.name:t.display,this.columnLayout=this.recordsHelper.isColumnLayout(t.type);const r=t.customValues||[];this.valuesWithoutSection=r.filter(n=>null==n.field.section)||[],(t.type.sections||[]).forEach(n=>{const s=r.filter(l=>null!=l.field.section&&l.field.section.id===n.id&&(t.canEdit||this.fieldHelper.getValue(l)));s.length>0&&this.valuesWithSection.set(n,s)}),t.canEdit&&this.headingActions.push(new R.Yu(w.l.Pencil,this.i18n.general.edit,()=>{this.router.navigate(["/records","edit",t.id])},!0));for(const n of t.operations||[])this.headingActions.push(this.runOperationHelper.headingAction(n,t.id))}resolveColumnClass(t=null){return this.recordsHelper.resolveColumnClass(null==t?null:t.field,this.data.type)}get labelPosition(){return this.columnLayout?"above":"auto"}get hasPreviousFields(){return this.data.createdBy||this.data.lastModifiedBy}isOwner(){return this.authHelper.isSelf(this.data.user)}resolveMenu(t){return this.menu.menuForRecordType(t.user,t.type)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.zs3),e.Y36(g),e.Y36(v.w),e.Y36(lt.Y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["view-record"]],features:[e.qOj],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"ngClass"],[3,"labelPosition","class","label",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],[3,"labelPosition","fieldValue","class","ngClass",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"labelPosition","label"],[3,"user"],[3,"value"],[3,"labelPosition","fieldValue","ngClass"],["class","mb-2",4,"ngIf"],[3,"labelPosition","fieldValue","class",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"labelPosition","fieldValue"]],template:function(t,r){1&t&&(e.TgZ(0,"page-layout",0),e.ALo(1,"async"),e.YNc(2,Jt,13,22,"page-content",1),e.qZA()),2&t&&(e.Q6J("ready",e.lcZ(1,2,r.data$)),e.xp6(2),e.Q6J("ngIf",r.data))},directives:[m.w,h.O5,x.Y,h.mk,T.t,A.F,Q.J,h.sg,dt.W],pipes:[h.Ov,S.i],encapsulation:2,changeDetection:0}),o})(),canActivate:[_.b]},{path:":owner/:type/new",component:U,canActivate:[_.b]},{path:"edit/:id",component:U,canActivate:[_.b]}];let qt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[C.Bz.forChild(Qt)],C.Bz]}),o})();var Nt=c(4443);let Ut=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[qt,Nt.C]]}),o})()}}]);